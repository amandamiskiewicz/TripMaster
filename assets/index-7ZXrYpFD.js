(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function sd(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const he={},Jr=[],gi=()=>{},_T=()=>!1,Gc=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),rd=e=>e.startsWith("onUpdate:"),an=Object.assign,od=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},gT=Object.prototype.hasOwnProperty,se=(e,t)=>gT.call(e,t),Pt=Array.isArray,to=e=>el(e)==="[object Map]",bo=e=>el(e)==="[object Set]",Xf=e=>el(e)==="[object Date]",Ut=e=>typeof e=="function",Ve=e=>typeof e=="string",bi=e=>typeof e=="symbol",me=e=>e!==null&&typeof e=="object",x_=e=>(me(e)||Ut(e))&&Ut(e.then)&&Ut(e.catch),k_=Object.prototype.toString,el=e=>k_.call(e),vT=e=>el(e).slice(8,-1),L_=e=>el(e)==="[object Object]",ad=e=>Ve(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,wa=sd(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Zc=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},yT=/-(\w)/g,qn=Zc(e=>e.replace(yT,(t,n)=>n?n.toUpperCase():"")),wT=/\B([A-Z])/g,Ns=Zc(e=>e.replace(wT,"-$1").toLowerCase()),Qc=Zc(e=>e.charAt(0).toUpperCase()+e.slice(1)),Hu=Zc(e=>e?`on${Qc(e)}`:""),bs=(e,t)=>!Object.is(e,t),rc=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},M_=(e,t,n,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:n})},wc=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Jf;const Yc=()=>Jf||(Jf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function nl(e){if(Pt(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],r=Ve(i)?IT(i):nl(i);if(r)for(const o in r)t[o]=r[o]}return t}else if(Ve(e)||me(e))return e}const TT=/;(?![^(]*\))/g,ET=/:([^]+)/,bT=/\/\*[^]*?\*\//g;function IT(e){const t={};return e.replace(bT,"").split(TT).forEach(n=>{if(n){const i=n.split(ET);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function cr(e){let t="";if(Ve(e))t=e;else if(Pt(e))for(let n=0;n<e.length;n++){const i=cr(e[n]);i&&(t+=i+" ")}else if(me(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const PT="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",AT=sd(PT);function O_(e){return!!e||e===""}function CT(e,t){if(e.length!==t.length)return!1;let n=!0;for(let i=0;n&&i<e.length;i++)n=il(e[i],t[i]);return n}function il(e,t){if(e===t)return!0;let n=Xf(e),i=Xf(t);if(n||i)return n&&i?e.getTime()===t.getTime():!1;if(n=bi(e),i=bi(t),n||i)return e===t;if(n=Pt(e),i=Pt(t),n||i)return n&&i?CT(e,t):!1;if(n=me(e),i=me(t),n||i){if(!n||!i)return!1;const r=Object.keys(e).length,o=Object.keys(t).length;if(r!==o)return!1;for(const l in e){const h=e.hasOwnProperty(l),d=t.hasOwnProperty(l);if(h&&!d||!h&&d||!il(e[l],t[l]))return!1}}return String(e)===String(t)}function ld(e,t){return e.findIndex(n=>il(n,t))}const D_=e=>!!(e&&e.__v_isRef===!0),It=e=>Ve(e)?e:e==null?"":Pt(e)||me(e)&&(e.toString===k_||!Ut(e.toString))?D_(e)?It(e.value):JSON.stringify(e,N_,2):String(e),N_=(e,t)=>D_(t)?N_(e,t.value):to(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[i,r],o)=>(n[$u(i,o)+" =>"]=r,n),{})}:bo(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>$u(n))}:bi(t)?$u(t):me(t)&&!Pt(t)&&!L_(t)?String(t):t,$u=(e,t="")=>{var n;return bi(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Sn;class RT{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Sn,!t&&Sn&&(this.index=(Sn.scopes||(Sn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=Sn;try{return Sn=this,t()}finally{Sn=n}}}on(){Sn=this}off(){Sn=this.parent}stop(t){if(this._active){this._active=!1;let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(this.effects.length=0,n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function ST(){return Sn}let de;const qu=new WeakSet;class V_{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Sn&&Sn.active&&Sn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,qu.has(this)&&(qu.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||F_(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,tp(this),B_(this);const t=de,n=ni;de=this,ni=!0;try{return this.fn()}finally{z_(this),de=t,ni=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)hd(t);this.deps=this.depsTail=void 0,tp(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?qu.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){ph(this)&&this.run()}get dirty(){return ph(this)}}let U_=0,Ta,Ea;function F_(e,t=!1){if(e.flags|=8,t){e.next=Ea,Ea=e;return}e.next=Ta,Ta=e}function cd(){U_++}function ud(){if(--U_>0)return;if(Ea){let t=Ea;for(Ea=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;Ta;){let t=Ta;for(Ta=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){e||(e=i)}t=n}}if(e)throw e}function B_(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function z_(e){let t,n=e.depsTail,i=n;for(;i;){const r=i.prevDep;i.version===-1?(i===n&&(n=r),hd(i),xT(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=r}e.deps=t,e.depsTail=n}function ph(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(j_(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function j_(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Va))return;e.globalVersion=Va;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!ph(e)){e.flags&=-3;return}const n=de,i=ni;de=e,ni=!0;try{B_(e);const r=e.fn(e._value);(t.version===0||bs(r,e._value))&&(e._value=r,t.version++)}catch(r){throw t.version++,r}finally{de=n,ni=i,z_(e),e.flags&=-3}}function hd(e,t=!1){const{dep:n,prevSub:i,nextSub:r}=e;if(i&&(i.nextSub=r,e.prevSub=void 0),r&&(r.prevSub=i,e.nextSub=void 0),n.subs===e&&(n.subs=i,!i&&n.computed)){n.computed.flags&=-5;for(let o=n.computed.deps;o;o=o.nextDep)hd(o,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function xT(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let ni=!0;const H_=[];function Vs(){H_.push(ni),ni=!1}function Us(){const e=H_.pop();ni=e===void 0?!0:e}function tp(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=de;de=void 0;try{t()}finally{de=n}}}let Va=0;class kT{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class dd{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!de||!ni||de===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==de)n=this.activeLink=new kT(de,this),de.deps?(n.prevDep=de.depsTail,de.depsTail.nextDep=n,de.depsTail=n):de.deps=de.depsTail=n,$_(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const i=n.nextDep;i.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=i),n.prevDep=de.depsTail,n.nextDep=void 0,de.depsTail.nextDep=n,de.depsTail=n,de.deps===n&&(de.deps=i)}return n}trigger(t){this.version++,Va++,this.notify(t)}notify(t){cd();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{ud()}}}function $_(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)$_(i)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const mh=new WeakMap,ar=Symbol(""),_h=Symbol(""),Ua=Symbol("");function Je(e,t,n){if(ni&&de){let i=mh.get(e);i||mh.set(e,i=new Map);let r=i.get(n);r||(i.set(n,r=new dd),r.map=i,r.key=n),r.track()}}function ji(e,t,n,i,r,o){const l=mh.get(e);if(!l){Va++;return}const h=d=>{d&&d.trigger()};if(cd(),t==="clear")l.forEach(h);else{const d=Pt(e),p=d&&ad(n);if(d&&n==="length"){const _=Number(i);l.forEach((y,T)=>{(T==="length"||T===Ua||!bi(T)&&T>=_)&&h(y)})}else switch((n!==void 0||l.has(void 0))&&h(l.get(n)),p&&h(l.get(Ua)),t){case"add":d?p&&h(l.get("length")):(h(l.get(ar)),to(e)&&h(l.get(_h)));break;case"delete":d||(h(l.get(ar)),to(e)&&h(l.get(_h)));break;case"set":to(e)&&h(l.get(ar));break}}ud()}function Wr(e){const t=ie(e);return t===e?t:(Je(t,"iterate",Ua),Hn(e)?t:t.map(tn))}function Xc(e){return Je(e=ie(e),"iterate",Ua),e}const LT={__proto__:null,[Symbol.iterator](){return Wu(this,Symbol.iterator,tn)},concat(...e){return Wr(this).concat(...e.map(t=>Pt(t)?Wr(t):t))},entries(){return Wu(this,"entries",e=>(e[1]=tn(e[1]),e))},every(e,t){return Fi(this,"every",e,t,void 0,arguments)},filter(e,t){return Fi(this,"filter",e,t,n=>n.map(tn),arguments)},find(e,t){return Fi(this,"find",e,t,tn,arguments)},findIndex(e,t){return Fi(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Fi(this,"findLast",e,t,tn,arguments)},findLastIndex(e,t){return Fi(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Fi(this,"forEach",e,t,void 0,arguments)},includes(...e){return Ku(this,"includes",e)},indexOf(...e){return Ku(this,"indexOf",e)},join(e){return Wr(this).join(e)},lastIndexOf(...e){return Ku(this,"lastIndexOf",e)},map(e,t){return Fi(this,"map",e,t,void 0,arguments)},pop(){return la(this,"pop")},push(...e){return la(this,"push",e)},reduce(e,...t){return ep(this,"reduce",e,t)},reduceRight(e,...t){return ep(this,"reduceRight",e,t)},shift(){return la(this,"shift")},some(e,t){return Fi(this,"some",e,t,void 0,arguments)},splice(...e){return la(this,"splice",e)},toReversed(){return Wr(this).toReversed()},toSorted(e){return Wr(this).toSorted(e)},toSpliced(...e){return Wr(this).toSpliced(...e)},unshift(...e){return la(this,"unshift",e)},values(){return Wu(this,"values",tn)}};function Wu(e,t,n){const i=Xc(e),r=i[t]();return i!==e&&!Hn(e)&&(r._next=r.next,r.next=()=>{const o=r._next();return o.value&&(o.value=n(o.value)),o}),r}const MT=Array.prototype;function Fi(e,t,n,i,r,o){const l=Xc(e),h=l!==e&&!Hn(e),d=l[t];if(d!==MT[t]){const y=d.apply(e,o);return h?tn(y):y}let p=n;l!==e&&(h?p=function(y,T){return n.call(this,tn(y),T,e)}:n.length>2&&(p=function(y,T){return n.call(this,y,T,e)}));const _=d.call(l,p,i);return h&&r?r(_):_}function ep(e,t,n,i){const r=Xc(e);let o=n;return r!==e&&(Hn(e)?n.length>3&&(o=function(l,h,d){return n.call(this,l,h,d,e)}):o=function(l,h,d){return n.call(this,l,tn(h),d,e)}),r[t](o,...i)}function Ku(e,t,n){const i=ie(e);Je(i,"iterate",Ua);const r=i[t](...n);return(r===-1||r===!1)&&md(n[0])?(n[0]=ie(n[0]),i[t](...n)):r}function la(e,t,n=[]){Vs(),cd();const i=ie(e)[t].apply(e,n);return ud(),Us(),i}const OT=sd("__proto__,__v_isRef,__isVue"),q_=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(bi));function DT(e){bi(e)||(e=String(e));const t=ie(this);return Je(t,"has",e),t.hasOwnProperty(e)}class W_{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,i){if(n==="__v_skip")return t.__v_skip;const r=this._isReadonly,o=this._isShallow;if(n==="__v_isReactive")return!r;if(n==="__v_isReadonly")return r;if(n==="__v_isShallow")return o;if(n==="__v_raw")return i===(r?o?qT:Q_:o?Z_:G_).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const l=Pt(t);if(!r){let d;if(l&&(d=LT[n]))return d;if(n==="hasOwnProperty")return DT}const h=Reflect.get(t,n,rn(t)?t:i);return(bi(n)?q_.has(n):OT(n))||(r||Je(t,"get",n),o)?h:rn(h)?l&&ad(n)?h:h.value:me(h)?r?X_(h):Jc(h):h}}class K_ extends W_{constructor(t=!1){super(!1,t)}set(t,n,i,r){let o=t[n];if(!this._isShallow){const d=ur(o);if(!Hn(i)&&!ur(i)&&(o=ie(o),i=ie(i)),!Pt(t)&&rn(o)&&!rn(i))return d?!1:(o.value=i,!0)}const l=Pt(t)&&ad(n)?Number(n)<t.length:se(t,n),h=Reflect.set(t,n,i,rn(t)?t:r);return t===ie(r)&&(l?bs(i,o)&&ji(t,"set",n,i):ji(t,"add",n,i)),h}deleteProperty(t,n){const i=se(t,n);t[n];const r=Reflect.deleteProperty(t,n);return r&&i&&ji(t,"delete",n,void 0),r}has(t,n){const i=Reflect.has(t,n);return(!bi(n)||!q_.has(n))&&Je(t,"has",n),i}ownKeys(t){return Je(t,"iterate",Pt(t)?"length":ar),Reflect.ownKeys(t)}}class NT extends W_{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const VT=new K_,UT=new NT,FT=new K_(!0);const gh=e=>e,Gl=e=>Reflect.getPrototypeOf(e);function BT(e,t,n){return function(...i){const r=this.__v_raw,o=ie(r),l=to(o),h=e==="entries"||e===Symbol.iterator&&l,d=e==="keys"&&l,p=r[e](...i),_=n?gh:t?vh:tn;return!t&&Je(o,"iterate",d?_h:ar),{next(){const{value:y,done:T}=p.next();return T?{value:y,done:T}:{value:h?[_(y[0]),_(y[1])]:_(y),done:T}},[Symbol.iterator](){return this}}}}function Zl(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function zT(e,t){const n={get(r){const o=this.__v_raw,l=ie(o),h=ie(r);e||(bs(r,h)&&Je(l,"get",r),Je(l,"get",h));const{has:d}=Gl(l),p=t?gh:e?vh:tn;if(d.call(l,r))return p(o.get(r));if(d.call(l,h))return p(o.get(h));o!==l&&o.get(r)},get size(){const r=this.__v_raw;return!e&&Je(ie(r),"iterate",ar),Reflect.get(r,"size",r)},has(r){const o=this.__v_raw,l=ie(o),h=ie(r);return e||(bs(r,h)&&Je(l,"has",r),Je(l,"has",h)),r===h?o.has(r):o.has(r)||o.has(h)},forEach(r,o){const l=this,h=l.__v_raw,d=ie(h),p=t?gh:e?vh:tn;return!e&&Je(d,"iterate",ar),h.forEach((_,y)=>r.call(o,p(_),p(y),l))}};return an(n,e?{add:Zl("add"),set:Zl("set"),delete:Zl("delete"),clear:Zl("clear")}:{add(r){!t&&!Hn(r)&&!ur(r)&&(r=ie(r));const o=ie(this);return Gl(o).has.call(o,r)||(o.add(r),ji(o,"add",r,r)),this},set(r,o){!t&&!Hn(o)&&!ur(o)&&(o=ie(o));const l=ie(this),{has:h,get:d}=Gl(l);let p=h.call(l,r);p||(r=ie(r),p=h.call(l,r));const _=d.call(l,r);return l.set(r,o),p?bs(o,_)&&ji(l,"set",r,o):ji(l,"add",r,o),this},delete(r){const o=ie(this),{has:l,get:h}=Gl(o);let d=l.call(o,r);d||(r=ie(r),d=l.call(o,r)),h&&h.call(o,r);const p=o.delete(r);return d&&ji(o,"delete",r,void 0),p},clear(){const r=ie(this),o=r.size!==0,l=r.clear();return o&&ji(r,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(r=>{n[r]=BT(r,e,t)}),n}function fd(e,t){const n=zT(e,t);return(i,r,o)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?i:Reflect.get(se(n,r)&&r in i?n:i,r,o)}const jT={get:fd(!1,!1)},HT={get:fd(!1,!0)},$T={get:fd(!0,!1)};const G_=new WeakMap,Z_=new WeakMap,Q_=new WeakMap,qT=new WeakMap;function WT(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function KT(e){return e.__v_skip||!Object.isExtensible(e)?0:WT(vT(e))}function Jc(e){return ur(e)?e:pd(e,!1,VT,jT,G_)}function Y_(e){return pd(e,!1,FT,HT,Z_)}function X_(e){return pd(e,!0,UT,$T,Q_)}function pd(e,t,n,i,r){if(!me(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const o=r.get(e);if(o)return o;const l=KT(e);if(l===0)return e;const h=new Proxy(e,l===2?i:n);return r.set(e,h),h}function eo(e){return ur(e)?eo(e.__v_raw):!!(e&&e.__v_isReactive)}function ur(e){return!!(e&&e.__v_isReadonly)}function Hn(e){return!!(e&&e.__v_isShallow)}function md(e){return e?!!e.__v_raw:!1}function ie(e){const t=e&&e.__v_raw;return t?ie(t):e}function GT(e){return!se(e,"__v_skip")&&Object.isExtensible(e)&&M_(e,"__v_skip",!0),e}const tn=e=>me(e)?Jc(e):e,vh=e=>me(e)?X_(e):e;function rn(e){return e?e.__v_isRef===!0:!1}function sn(e){return J_(e,!1)}function ZT(e){return J_(e,!0)}function J_(e,t){return rn(e)?e:new QT(e,t)}class QT{constructor(t,n){this.dep=new dd,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:ie(t),this._value=n?t:tn(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,i=this.__v_isShallow||Hn(t)||ur(t);t=i?t:ie(t),bs(t,n)&&(this._rawValue=t,this._value=i?t:tn(t),this.dep.trigger())}}function no(e){return rn(e)?e.value:e}const YT={get:(e,t,n)=>t==="__v_raw"?e:no(Reflect.get(e,t,n)),set:(e,t,n,i)=>{const r=e[t];return rn(r)&&!rn(n)?(r.value=n,!0):Reflect.set(e,t,n,i)}};function tg(e){return eo(e)?e:new Proxy(e,YT)}class XT{constructor(t,n,i){this.fn=t,this.setter=n,this._value=void 0,this.dep=new dd(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Va-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&de!==this)return F_(this,!0),!0}get value(){const t=this.dep.track();return j_(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function JT(e,t,n=!1){let i,r;return Ut(e)?i=e:(i=e.get,r=e.set),new XT(i,r,n)}const Ql={},Tc=new WeakMap;let ir;function tE(e,t=!1,n=ir){if(n){let i=Tc.get(n);i||Tc.set(n,i=[]),i.push(e)}}function eE(e,t,n=he){const{immediate:i,deep:r,once:o,scheduler:l,augmentJob:h,call:d}=n,p=tt=>r?tt:Hn(tt)||r===!1||r===0?Hi(tt,1):Hi(tt);let _,y,T,I,U=!1,B=!1;if(rn(e)?(y=()=>e.value,U=Hn(e)):eo(e)?(y=()=>p(e),U=!0):Pt(e)?(B=!0,U=e.some(tt=>eo(tt)||Hn(tt)),y=()=>e.map(tt=>{if(rn(tt))return tt.value;if(eo(tt))return p(tt);if(Ut(tt))return d?d(tt,2):tt()})):Ut(e)?t?y=d?()=>d(e,2):e:y=()=>{if(T){Vs();try{T()}finally{Us()}}const tt=ir;ir=_;try{return d?d(e,3,[I]):e(I)}finally{ir=tt}}:y=gi,t&&r){const tt=y,Et=r===!0?1/0:r;y=()=>Hi(tt(),Et)}const j=ST(),et=()=>{_.stop(),j&&j.active&&od(j.effects,_)};if(o&&t){const tt=t;t=(...Et)=>{tt(...Et),et()}}let X=B?new Array(e.length).fill(Ql):Ql;const Q=tt=>{if(!(!(_.flags&1)||!_.dirty&&!tt))if(t){const Et=_.run();if(r||U||(B?Et.some((kt,k)=>bs(kt,X[k])):bs(Et,X))){T&&T();const kt=ir;ir=_;try{const k=[Et,X===Ql?void 0:B&&X[0]===Ql?[]:X,I];d?d(t,3,k):t(...k),X=Et}finally{ir=kt}}}else _.run()};return h&&h(Q),_=new V_(y),_.scheduler=l?()=>l(Q,!1):Q,I=tt=>tE(tt,!1,_),T=_.onStop=()=>{const tt=Tc.get(_);if(tt){if(d)d(tt,4);else for(const Et of tt)Et();Tc.delete(_)}},t?i?Q(!0):X=_.run():l?l(Q.bind(null,!0),!0):_.run(),et.pause=_.pause.bind(_),et.resume=_.resume.bind(_),et.stop=et,et}function Hi(e,t=1/0,n){if(t<=0||!me(e)||e.__v_skip||(n=n||new Set,n.has(e)))return e;if(n.add(e),t--,rn(e))Hi(e.value,t,n);else if(Pt(e))for(let i=0;i<e.length;i++)Hi(e[i],t,n);else if(bo(e)||to(e))e.forEach(i=>{Hi(i,t,n)});else if(L_(e)){for(const i in e)Hi(e[i],t,n);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&Hi(e[i],t,n)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function sl(e,t,n,i){try{return i?e(...i):e()}catch(r){tu(r,t,n)}}function Ii(e,t,n,i){if(Ut(e)){const r=sl(e,t,n,i);return r&&x_(r)&&r.catch(o=>{tu(o,t,n)}),r}if(Pt(e)){const r=[];for(let o=0;o<e.length;o++)r.push(Ii(e[o],t,n,i));return r}}function tu(e,t,n,i=!0){const r=t?t.vnode:null,{errorHandler:o,throwUnhandledErrorInProduction:l}=t&&t.appContext.config||he;if(t){let h=t.parent;const d=t.proxy,p=`https://vuejs.org/error-reference/#runtime-${n}`;for(;h;){const _=h.ec;if(_){for(let y=0;y<_.length;y++)if(_[y](e,d,p)===!1)return}h=h.parent}if(o){Vs(),sl(o,null,10,[e,d,p]),Us();return}}nE(e,n,r,i,l)}function nE(e,t,n,i=!0,r=!1){if(r)throw e;console.error(e)}const pn=[];let di=-1;const io=[];let ps=null,Kr=0;const eg=Promise.resolve();let Ec=null;function _d(e){const t=Ec||eg;return e?t.then(this?e.bind(this):e):t}function iE(e){let t=di+1,n=pn.length;for(;t<n;){const i=t+n>>>1,r=pn[i],o=Fa(r);o<e||o===e&&r.flags&2?t=i+1:n=i}return t}function gd(e){if(!(e.flags&1)){const t=Fa(e),n=pn[pn.length-1];!n||!(e.flags&2)&&t>=Fa(n)?pn.push(e):pn.splice(iE(t),0,e),e.flags|=1,ng()}}function ng(){Ec||(Ec=eg.then(sg))}function sE(e){Pt(e)?io.push(...e):ps&&e.id===-1?ps.splice(Kr+1,0,e):e.flags&1||(io.push(e),e.flags|=1),ng()}function np(e,t,n=di+1){for(;n<pn.length;n++){const i=pn[n];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;pn.splice(n,1),n--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function ig(e){if(io.length){const t=[...new Set(io)].sort((n,i)=>Fa(n)-Fa(i));if(io.length=0,ps){ps.push(...t);return}for(ps=t,Kr=0;Kr<ps.length;Kr++){const n=ps[Kr];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}ps=null,Kr=0}}const Fa=e=>e.id==null?e.flags&2?-1:1/0:e.id;function sg(e){try{for(di=0;di<pn.length;di++){const t=pn[di];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),sl(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;di<pn.length;di++){const t=pn[di];t&&(t.flags&=-2)}di=-1,pn.length=0,ig(),Ec=null,(pn.length||io.length)&&sg()}}let kn=null,rg=null;function bc(e){const t=kn;return kn=e,rg=e&&e.type.__scopeId||null,t}function Io(e,t=kn,n){if(!t||e._n)return e;const i=(...r)=>{i._d&&dp(-1);const o=bc(t);let l;try{l=e(...r)}finally{bc(o),i._d&&dp(1)}return l};return i._n=!0,i._c=!0,i._d=!0,i}function fe(e,t){if(kn===null)return e;const n=ru(kn),i=e.dirs||(e.dirs=[]);for(let r=0;r<t.length;r++){let[o,l,h,d=he]=t[r];o&&(Ut(o)&&(o={mounted:o,updated:o}),o.deep&&Hi(l),i.push({dir:o,instance:n,value:l,oldValue:void 0,arg:h,modifiers:d}))}return e}function er(e,t,n,i){const r=e.dirs,o=t&&t.dirs;for(let l=0;l<r.length;l++){const h=r[l];o&&(h.oldValue=o[l].value);let d=h.dir[i];d&&(Vs(),Ii(d,n,8,[e.el,h,e,t]),Us())}}const rE=Symbol("_vte"),oE=e=>e.__isTeleport;function vd(e,t){e.shapeFlag&6&&e.component?(e.transition=t,vd(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}/*! #__NO_SIDE_EFFECTS__ */function og(e,t){return Ut(e)?an({name:e.name},t,{setup:e}):e}function ag(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function Ic(e,t,n,i,r=!1){if(Pt(e)){e.forEach((U,B)=>Ic(U,t&&(Pt(t)?t[B]:t),n,i,r));return}if(ba(i)&&!r){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&Ic(e,t,n,i.component.subTree);return}const o=i.shapeFlag&4?ru(i.component):i.el,l=r?null:o,{i:h,r:d}=e,p=t&&t.r,_=h.refs===he?h.refs={}:h.refs,y=h.setupState,T=ie(y),I=y===he?()=>!1:U=>se(T,U);if(p!=null&&p!==d&&(Ve(p)?(_[p]=null,I(p)&&(y[p]=null)):rn(p)&&(p.value=null)),Ut(d))sl(d,h,12,[l,_]);else{const U=Ve(d),B=rn(d);if(U||B){const j=()=>{if(e.f){const et=U?I(d)?y[d]:_[d]:d.value;r?Pt(et)&&od(et,o):Pt(et)?et.includes(o)||et.push(o):U?(_[d]=[o],I(d)&&(y[d]=_[d])):(d.value=[o],e.k&&(_[e.k]=d.value))}else U?(_[d]=l,I(d)&&(y[d]=l)):B&&(d.value=l,e.k&&(_[e.k]=l))};l?(j.id=-1,Rn(j,n)):j()}}}Yc().requestIdleCallback;Yc().cancelIdleCallback;const ba=e=>!!e.type.__asyncLoader,lg=e=>e.type.__isKeepAlive;function aE(e,t){cg(e,"a",t)}function lE(e,t){cg(e,"da",t)}function cg(e,t,n=nn){const i=e.__wdc||(e.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return e()});if(eu(t,i,n),n){let r=n.parent;for(;r&&r.parent;)lg(r.parent.vnode)&&cE(i,t,n,r),r=r.parent}}function cE(e,t,n,i){const r=eu(t,e,i,!0);ug(()=>{od(i[t],r)},n)}function eu(e,t,n=nn,i=!1){if(n){const r=n[e]||(n[e]=[]),o=t.__weh||(t.__weh=(...l)=>{Vs();const h=rl(n),d=Ii(t,n,e,l);return h(),Us(),d});return i?r.unshift(o):r.push(o),o}}const ns=e=>(t,n=nn)=>{(!za||e==="sp")&&eu(e,(...i)=>t(...i),n)},uE=ns("bm"),nu=ns("m"),hE=ns("bu"),dE=ns("u"),fE=ns("bum"),ug=ns("um"),pE=ns("sp"),mE=ns("rtg"),_E=ns("rtc");function gE(e,t=nn){eu("ec",e,t)}const vE="components";function xn(e,t){return wE(vE,e,!0,t)||e}const yE=Symbol.for("v-ndc");function wE(e,t,n=!0,i=!1){const r=kn||nn;if(r){const o=r.type;{const h=ob(o,!1);if(h&&(h===t||h===qn(t)||h===Qc(qn(t))))return o}const l=ip(r[e]||o[e],t)||ip(r.appContext[e],t);return!l&&i?o:l}}function ip(e,t){return e&&(e[t]||e[qn(t)]||e[Qc(qn(t))])}function Qi(e,t,n,i){let r;const o=n,l=Pt(e);if(l||Ve(e)){const h=l&&eo(e);let d=!1;h&&(d=!Hn(e),e=Xc(e)),r=new Array(e.length);for(let p=0,_=e.length;p<_;p++)r[p]=t(d?tn(e[p]):e[p],p,void 0,o)}else if(typeof e=="number"){r=new Array(e);for(let h=0;h<e;h++)r[h]=t(h+1,h,void 0,o)}else if(me(e))if(e[Symbol.iterator])r=Array.from(e,(h,d)=>t(h,d,void 0,o));else{const h=Object.keys(e);r=new Array(h.length);for(let d=0,p=h.length;d<p;d++){const _=h[d];r[d]=t(e[_],_,d,o)}}else r=[];return r}const yh=e=>e?Lg(e)?ru(e):yh(e.parent):null,Ia=an(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>yh(e.parent),$root:e=>yh(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>dg(e),$forceUpdate:e=>e.f||(e.f=()=>{gd(e.update)}),$nextTick:e=>e.n||(e.n=_d.bind(e.proxy)),$watch:e=>zE.bind(e)}),Gu=(e,t)=>e!==he&&!e.__isScriptSetup&&se(e,t),TE={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:i,data:r,props:o,accessCache:l,type:h,appContext:d}=e;let p;if(t[0]!=="$"){const I=l[t];if(I!==void 0)switch(I){case 1:return i[t];case 2:return r[t];case 4:return n[t];case 3:return o[t]}else{if(Gu(i,t))return l[t]=1,i[t];if(r!==he&&se(r,t))return l[t]=2,r[t];if((p=e.propsOptions[0])&&se(p,t))return l[t]=3,o[t];if(n!==he&&se(n,t))return l[t]=4,n[t];wh&&(l[t]=0)}}const _=Ia[t];let y,T;if(_)return t==="$attrs"&&Je(e.attrs,"get",""),_(e);if((y=h.__cssModules)&&(y=y[t]))return y;if(n!==he&&se(n,t))return l[t]=4,n[t];if(T=d.config.globalProperties,se(T,t))return T[t]},set({_:e},t,n){const{data:i,setupState:r,ctx:o}=e;return Gu(r,t)?(r[t]=n,!0):i!==he&&se(i,t)?(i[t]=n,!0):se(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(o[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:r,propsOptions:o}},l){let h;return!!n[l]||e!==he&&se(e,l)||Gu(t,l)||(h=o[0])&&se(h,l)||se(i,l)||se(Ia,l)||se(r.config.globalProperties,l)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:se(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function sp(e){return Pt(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let wh=!0;function EE(e){const t=dg(e),n=e.proxy,i=e.ctx;wh=!1,t.beforeCreate&&rp(t.beforeCreate,e,"bc");const{data:r,computed:o,methods:l,watch:h,provide:d,inject:p,created:_,beforeMount:y,mounted:T,beforeUpdate:I,updated:U,activated:B,deactivated:j,beforeDestroy:et,beforeUnmount:X,destroyed:Q,unmounted:tt,render:Et,renderTracked:kt,renderTriggered:k,errorCaptured:P,serverPrefetch:S,expose:M,inheritAttrs:O,components:D,directives:R,filters:_e}=t;if(p&&bE(p,i,null),l)for(const Ft in l){const at=l[Ft];Ut(at)&&(i[Ft]=at.bind(n))}if(r){const Ft=r.call(n,n);me(Ft)&&(e.data=Jc(Ft))}if(wh=!0,o)for(const Ft in o){const at=o[Ft],Qe=Ut(at)?at.bind(n,n):Ut(at.get)?at.get.bind(n,n):gi,vt=!Ut(at)&&Ut(at.set)?at.set.bind(n):gi,Gt=ti({get:Qe,set:vt});Object.defineProperty(i,Ft,{enumerable:!0,configurable:!0,get:()=>Gt.value,set:Ht=>Gt.value=Ht})}if(h)for(const Ft in h)hg(h[Ft],i,n,Ft);if(d){const Ft=Ut(d)?d.call(n):d;Reflect.ownKeys(Ft).forEach(at=>{oc(at,Ft[at])})}_&&rp(_,e,"c");function Jt(Ft,at){Pt(at)?at.forEach(Qe=>Ft(Qe.bind(n))):at&&Ft(at.bind(n))}if(Jt(uE,y),Jt(nu,T),Jt(hE,I),Jt(dE,U),Jt(aE,B),Jt(lE,j),Jt(gE,P),Jt(_E,kt),Jt(mE,k),Jt(fE,X),Jt(ug,tt),Jt(pE,S),Pt(M))if(M.length){const Ft=e.exposed||(e.exposed={});M.forEach(at=>{Object.defineProperty(Ft,at,{get:()=>n[at],set:Qe=>n[at]=Qe})})}else e.exposed||(e.exposed={});Et&&e.render===gi&&(e.render=Et),O!=null&&(e.inheritAttrs=O),D&&(e.components=D),R&&(e.directives=R),S&&ag(e)}function bE(e,t,n=gi){Pt(e)&&(e=Th(e));for(const i in e){const r=e[i];let o;me(r)?"default"in r?o=vi(r.from||i,r.default,!0):o=vi(r.from||i):o=vi(r),rn(o)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:l=>o.value=l}):t[i]=o}}function rp(e,t,n){Ii(Pt(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,n)}function hg(e,t,n,i){let r=i.includes(".")?Ag(n,i):()=>n[i];if(Ve(e)){const o=t[e];Ut(o)&&Pa(r,o)}else if(Ut(e))Pa(r,e.bind(n));else if(me(e))if(Pt(e))e.forEach(o=>hg(o,t,n,i));else{const o=Ut(e.handler)?e.handler.bind(n):t[e.handler];Ut(o)&&Pa(r,o,e)}}function dg(e){const t=e.type,{mixins:n,extends:i}=t,{mixins:r,optionsCache:o,config:{optionMergeStrategies:l}}=e.appContext,h=o.get(t);let d;return h?d=h:!r.length&&!n&&!i?d=t:(d={},r.length&&r.forEach(p=>Pc(d,p,l,!0)),Pc(d,t,l)),me(t)&&o.set(t,d),d}function Pc(e,t,n,i=!1){const{mixins:r,extends:o}=t;o&&Pc(e,o,n,!0),r&&r.forEach(l=>Pc(e,l,n,!0));for(const l in t)if(!(i&&l==="expose")){const h=IE[l]||n&&n[l];e[l]=h?h(e[l],t[l]):t[l]}return e}const IE={data:op,props:ap,emits:ap,methods:da,computed:da,beforeCreate:fn,created:fn,beforeMount:fn,mounted:fn,beforeUpdate:fn,updated:fn,beforeDestroy:fn,beforeUnmount:fn,destroyed:fn,unmounted:fn,activated:fn,deactivated:fn,errorCaptured:fn,serverPrefetch:fn,components:da,directives:da,watch:AE,provide:op,inject:PE};function op(e,t){return t?e?function(){return an(Ut(e)?e.call(this,this):e,Ut(t)?t.call(this,this):t)}:t:e}function PE(e,t){return da(Th(e),Th(t))}function Th(e){if(Pt(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function fn(e,t){return e?[...new Set([].concat(e,t))]:t}function da(e,t){return e?an(Object.create(null),e,t):t}function ap(e,t){return e?Pt(e)&&Pt(t)?[...new Set([...e,...t])]:an(Object.create(null),sp(e),sp(t??{})):t}function AE(e,t){if(!e)return t;if(!t)return e;const n=an(Object.create(null),e);for(const i in t)n[i]=fn(e[i],t[i]);return n}function fg(){return{app:null,config:{isNativeTag:_T,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let CE=0;function RE(e,t){return function(i,r=null){Ut(i)||(i=an({},i)),r!=null&&!me(r)&&(r=null);const o=fg(),l=new WeakSet,h=[];let d=!1;const p=o.app={_uid:CE++,_component:i,_props:r,_container:null,_context:o,_instance:null,version:lb,get config(){return o.config},set config(_){},use(_,...y){return l.has(_)||(_&&Ut(_.install)?(l.add(_),_.install(p,...y)):Ut(_)&&(l.add(_),_(p,...y))),p},mixin(_){return o.mixins.includes(_)||o.mixins.push(_),p},component(_,y){return y?(o.components[_]=y,p):o.components[_]},directive(_,y){return y?(o.directives[_]=y,p):o.directives[_]},mount(_,y,T){if(!d){const I=p._ceVNode||pe(i,r);return I.appContext=o,T===!0?T="svg":T===!1&&(T=void 0),e(I,_,T),d=!0,p._container=_,_.__vue_app__=p,ru(I.component)}},onUnmount(_){h.push(_)},unmount(){d&&(Ii(h,p._instance,16),e(null,p._container),delete p._container.__vue_app__)},provide(_,y){return o.provides[_]=y,p},runWithContext(_){const y=so;so=p;try{return _()}finally{so=y}}};return p}}let so=null;function oc(e,t){if(nn){let n=nn.provides;const i=nn.parent&&nn.parent.provides;i===n&&(n=nn.provides=Object.create(i)),n[e]=t}}function vi(e,t,n=!1){const i=nn||kn;if(i||so){const r=so?so._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(r&&e in r)return r[e];if(arguments.length>1)return n&&Ut(t)?t.call(i&&i.proxy):t}}const pg={},mg=()=>Object.create(pg),_g=e=>Object.getPrototypeOf(e)===pg;function SE(e,t,n,i=!1){const r={},o=mg();e.propsDefaults=Object.create(null),gg(e,t,r,o);for(const l in e.propsOptions[0])l in r||(r[l]=void 0);n?e.props=i?r:Y_(r):e.type.props?e.props=r:e.props=o,e.attrs=o}function xE(e,t,n,i){const{props:r,attrs:o,vnode:{patchFlag:l}}=e,h=ie(r),[d]=e.propsOptions;let p=!1;if((i||l>0)&&!(l&16)){if(l&8){const _=e.vnode.dynamicProps;for(let y=0;y<_.length;y++){let T=_[y];if(iu(e.emitsOptions,T))continue;const I=t[T];if(d)if(se(o,T))I!==o[T]&&(o[T]=I,p=!0);else{const U=qn(T);r[U]=Eh(d,h,U,I,e,!1)}else I!==o[T]&&(o[T]=I,p=!0)}}}else{gg(e,t,r,o)&&(p=!0);let _;for(const y in h)(!t||!se(t,y)&&((_=Ns(y))===y||!se(t,_)))&&(d?n&&(n[y]!==void 0||n[_]!==void 0)&&(r[y]=Eh(d,h,y,void 0,e,!0)):delete r[y]);if(o!==h)for(const y in o)(!t||!se(t,y))&&(delete o[y],p=!0)}p&&ji(e.attrs,"set","")}function gg(e,t,n,i){const[r,o]=e.propsOptions;let l=!1,h;if(t)for(let d in t){if(wa(d))continue;const p=t[d];let _;r&&se(r,_=qn(d))?!o||!o.includes(_)?n[_]=p:(h||(h={}))[_]=p:iu(e.emitsOptions,d)||(!(d in i)||p!==i[d])&&(i[d]=p,l=!0)}if(o){const d=ie(n),p=h||he;for(let _=0;_<o.length;_++){const y=o[_];n[y]=Eh(r,d,y,p[y],e,!se(p,y))}}return l}function Eh(e,t,n,i,r,o){const l=e[n];if(l!=null){const h=se(l,"default");if(h&&i===void 0){const d=l.default;if(l.type!==Function&&!l.skipFactory&&Ut(d)){const{propsDefaults:p}=r;if(n in p)i=p[n];else{const _=rl(r);i=p[n]=d.call(null,t),_()}}else i=d;r.ce&&r.ce._setProp(n,i)}l[0]&&(o&&!h?i=!1:l[1]&&(i===""||i===Ns(n))&&(i=!0))}return i}const kE=new WeakMap;function vg(e,t,n=!1){const i=n?kE:t.propsCache,r=i.get(e);if(r)return r;const o=e.props,l={},h=[];let d=!1;if(!Ut(e)){const _=y=>{d=!0;const[T,I]=vg(y,t,!0);an(l,T),I&&h.push(...I)};!n&&t.mixins.length&&t.mixins.forEach(_),e.extends&&_(e.extends),e.mixins&&e.mixins.forEach(_)}if(!o&&!d)return me(e)&&i.set(e,Jr),Jr;if(Pt(o))for(let _=0;_<o.length;_++){const y=qn(o[_]);lp(y)&&(l[y]=he)}else if(o)for(const _ in o){const y=qn(_);if(lp(y)){const T=o[_],I=l[y]=Pt(T)||Ut(T)?{type:T}:an({},T),U=I.type;let B=!1,j=!0;if(Pt(U))for(let et=0;et<U.length;++et){const X=U[et],Q=Ut(X)&&X.name;if(Q==="Boolean"){B=!0;break}else Q==="String"&&(j=!1)}else B=Ut(U)&&U.name==="Boolean";I[0]=B,I[1]=j,(B||se(I,"default"))&&h.push(y)}}const p=[l,h];return me(e)&&i.set(e,p),p}function lp(e){return e[0]!=="$"&&!wa(e)}const yg=e=>e[0]==="_"||e==="$stable",yd=e=>Pt(e)?e.map(mi):[mi(e)],LE=(e,t,n)=>{if(t._n)return t;const i=Io((...r)=>yd(t(...r)),n);return i._c=!1,i},wg=(e,t,n)=>{const i=e._ctx;for(const r in e){if(yg(r))continue;const o=e[r];if(Ut(o))t[r]=LE(r,o,i);else if(o!=null){const l=yd(o);t[r]=()=>l}}},Tg=(e,t)=>{const n=yd(t);e.slots.default=()=>n},Eg=(e,t,n)=>{for(const i in t)(n||i!=="_")&&(e[i]=t[i])},ME=(e,t,n)=>{const i=e.slots=mg();if(e.vnode.shapeFlag&32){const r=t._;r?(Eg(i,t,n),n&&M_(i,"_",r,!0)):wg(t,i)}else t&&Tg(e,t)},OE=(e,t,n)=>{const{vnode:i,slots:r}=e;let o=!0,l=he;if(i.shapeFlag&32){const h=t._;h?n&&h===1?o=!1:Eg(r,t,n):(o=!t.$stable,wg(t,r)),l=t}else t&&(Tg(e,t),l={default:1});if(o)for(const h in r)!yg(h)&&l[h]==null&&delete r[h]},Rn=GE;function DE(e){return NE(e)}function NE(e,t){const n=Yc();n.__VUE__=!0;const{insert:i,remove:r,patchProp:o,createElement:l,createText:h,createComment:d,setText:p,setElementText:_,parentNode:y,nextSibling:T,setScopeId:I=gi,insertStaticContent:U}=e,B=(A,C,N,q=null,G=null,W=null,ot=void 0,it=null,nt=!!C.dynamicChildren)=>{if(A===C)return;A&&!ca(A,C)&&(q=$(A),Ht(A,G,W,!0),A=null),C.patchFlag===-2&&(nt=!1,C.dynamicChildren=null);const{type:J,ref:wt,shapeFlag:ht}=C;switch(J){case su:j(A,C,N,q);break;case hr:et(A,C,N,q);break;case ac:A==null&&X(C,N,q,ot);break;case qe:D(A,C,N,q,G,W,ot,it,nt);break;default:ht&1?Et(A,C,N,q,G,W,ot,it,nt):ht&6?R(A,C,N,q,G,W,ot,it,nt):(ht&64||ht&128)&&J.process(A,C,N,q,G,W,ot,it,nt,mt)}wt!=null&&G&&Ic(wt,A&&A.ref,W,C||A,!C)},j=(A,C,N,q)=>{if(A==null)i(C.el=h(C.children),N,q);else{const G=C.el=A.el;C.children!==A.children&&p(G,C.children)}},et=(A,C,N,q)=>{A==null?i(C.el=d(C.children||""),N,q):C.el=A.el},X=(A,C,N,q)=>{[A.el,A.anchor]=U(A.children,C,N,q,A.el,A.anchor)},Q=({el:A,anchor:C},N,q)=>{let G;for(;A&&A!==C;)G=T(A),i(A,N,q),A=G;i(C,N,q)},tt=({el:A,anchor:C})=>{let N;for(;A&&A!==C;)N=T(A),r(A),A=N;r(C)},Et=(A,C,N,q,G,W,ot,it,nt)=>{C.type==="svg"?ot="svg":C.type==="math"&&(ot="mathml"),A==null?kt(C,N,q,G,W,ot,it,nt):S(A,C,G,W,ot,it,nt)},kt=(A,C,N,q,G,W,ot,it)=>{let nt,J;const{props:wt,shapeFlag:ht,transition:_t,dirs:bt}=A;if(nt=A.el=l(A.type,W,wt&&wt.is,wt),ht&8?_(nt,A.children):ht&16&&P(A.children,nt,null,q,G,Zu(A,W),ot,it),bt&&er(A,null,q,"created"),k(nt,A,A.scopeId,ot,q),wt){for(const Mt in wt)Mt!=="value"&&!wa(Mt)&&o(nt,Mt,null,wt[Mt],W,q);"value"in wt&&o(nt,"value",null,wt.value,W),(J=wt.onVnodeBeforeMount)&&hi(J,q,A)}bt&&er(A,null,q,"beforeMount");const yt=VE(G,_t);yt&&_t.beforeEnter(nt),i(nt,C,N),((J=wt&&wt.onVnodeMounted)||yt||bt)&&Rn(()=>{J&&hi(J,q,A),yt&&_t.enter(nt),bt&&er(A,null,q,"mounted")},G)},k=(A,C,N,q,G)=>{if(N&&I(A,N),q)for(let W=0;W<q.length;W++)I(A,q[W]);if(G){let W=G.subTree;if(C===W||Rg(W.type)&&(W.ssContent===C||W.ssFallback===C)){const ot=G.vnode;k(A,ot,ot.scopeId,ot.slotScopeIds,G.parent)}}},P=(A,C,N,q,G,W,ot,it,nt=0)=>{for(let J=nt;J<A.length;J++){const wt=A[J]=it?ms(A[J]):mi(A[J]);B(null,wt,C,N,q,G,W,ot,it)}},S=(A,C,N,q,G,W,ot)=>{const it=C.el=A.el;let{patchFlag:nt,dynamicChildren:J,dirs:wt}=C;nt|=A.patchFlag&16;const ht=A.props||he,_t=C.props||he;let bt;if(N&&nr(N,!1),(bt=_t.onVnodeBeforeUpdate)&&hi(bt,N,C,A),wt&&er(C,A,N,"beforeUpdate"),N&&nr(N,!0),(ht.innerHTML&&_t.innerHTML==null||ht.textContent&&_t.textContent==null)&&_(it,""),J?M(A.dynamicChildren,J,it,N,q,Zu(C,G),W):ot||at(A,C,it,null,N,q,Zu(C,G),W,!1),nt>0){if(nt&16)O(it,ht,_t,N,G);else if(nt&2&&ht.class!==_t.class&&o(it,"class",null,_t.class,G),nt&4&&o(it,"style",ht.style,_t.style,G),nt&8){const yt=C.dynamicProps;for(let Mt=0;Mt<yt.length;Mt++){const Wt=yt[Mt],Be=ht[Wt],ke=_t[Wt];(ke!==Be||Wt==="value")&&o(it,Wt,Be,ke,G,N)}}nt&1&&A.children!==C.children&&_(it,C.children)}else!ot&&J==null&&O(it,ht,_t,N,G);((bt=_t.onVnodeUpdated)||wt)&&Rn(()=>{bt&&hi(bt,N,C,A),wt&&er(C,A,N,"updated")},q)},M=(A,C,N,q,G,W,ot)=>{for(let it=0;it<C.length;it++){const nt=A[it],J=C[it],wt=nt.el&&(nt.type===qe||!ca(nt,J)||nt.shapeFlag&70)?y(nt.el):N;B(nt,J,wt,null,q,G,W,ot,!0)}},O=(A,C,N,q,G)=>{if(C!==N){if(C!==he)for(const W in C)!wa(W)&&!(W in N)&&o(A,W,C[W],null,G,q);for(const W in N){if(wa(W))continue;const ot=N[W],it=C[W];ot!==it&&W!=="value"&&o(A,W,it,ot,G,q)}"value"in N&&o(A,"value",C.value,N.value,G)}},D=(A,C,N,q,G,W,ot,it,nt)=>{const J=C.el=A?A.el:h(""),wt=C.anchor=A?A.anchor:h("");let{patchFlag:ht,dynamicChildren:_t,slotScopeIds:bt}=C;bt&&(it=it?it.concat(bt):bt),A==null?(i(J,N,q),i(wt,N,q),P(C.children||[],N,wt,G,W,ot,it,nt)):ht>0&&ht&64&&_t&&A.dynamicChildren?(M(A.dynamicChildren,_t,N,G,W,ot,it),(C.key!=null||G&&C===G.subTree)&&bg(A,C,!0)):at(A,C,N,wt,G,W,ot,it,nt)},R=(A,C,N,q,G,W,ot,it,nt)=>{C.slotScopeIds=it,A==null?C.shapeFlag&512?G.ctx.activate(C,N,q,ot,nt):_e(C,N,q,G,W,ot,nt):_n(A,C,nt)},_e=(A,C,N,q,G,W,ot)=>{const it=A.component=eb(A,q,G);if(lg(A)&&(it.ctx.renderer=mt),nb(it,!1,ot),it.asyncDep){if(G&&G.registerDep(it,Jt,ot),!A.el){const nt=it.subTree=pe(hr);et(null,nt,C,N)}}else Jt(it,A,C,N,G,W,ot)},_n=(A,C,N)=>{const q=C.component=A.component;if(WE(A,C,N))if(q.asyncDep&&!q.asyncResolved){Ft(q,C,N);return}else q.next=C,q.update();else C.el=A.el,q.vnode=C},Jt=(A,C,N,q,G,W,ot)=>{const it=()=>{if(A.isMounted){let{next:ht,bu:_t,u:bt,parent:yt,vnode:Mt}=A;{const ze=Ig(A);if(ze){ht&&(ht.el=Mt.el,Ft(A,ht,ot)),ze.asyncDep.then(()=>{A.isUnmounted||it()});return}}let Wt=ht,Be;nr(A,!1),ht?(ht.el=Mt.el,Ft(A,ht,ot)):ht=Mt,_t&&rc(_t),(Be=ht.props&&ht.props.onVnodeBeforeUpdate)&&hi(Be,yt,ht,Mt),nr(A,!0);const ke=up(A),cn=A.subTree;A.subTree=ke,B(cn,ke,y(cn.el),$(cn),A,G,W),ht.el=ke.el,Wt===null&&KE(A,ke.el),bt&&Rn(bt,G),(Be=ht.props&&ht.props.onVnodeUpdated)&&Rn(()=>hi(Be,yt,ht,Mt),G)}else{let ht;const{el:_t,props:bt}=C,{bm:yt,m:Mt,parent:Wt,root:Be,type:ke}=A,cn=ba(C);nr(A,!1),yt&&rc(yt),!cn&&(ht=bt&&bt.onVnodeBeforeMount)&&hi(ht,Wt,C),nr(A,!0);{Be.ce&&Be.ce._injectChildStyle(ke);const ze=A.subTree=up(A);B(null,ze,N,q,A,G,W),C.el=ze.el}if(Mt&&Rn(Mt,G),!cn&&(ht=bt&&bt.onVnodeMounted)){const ze=C;Rn(()=>hi(ht,Wt,ze),G)}(C.shapeFlag&256||Wt&&ba(Wt.vnode)&&Wt.vnode.shapeFlag&256)&&A.a&&Rn(A.a,G),A.isMounted=!0,C=N=q=null}};A.scope.on();const nt=A.effect=new V_(it);A.scope.off();const J=A.update=nt.run.bind(nt),wt=A.job=nt.runIfDirty.bind(nt);wt.i=A,wt.id=A.uid,nt.scheduler=()=>gd(wt),nr(A,!0),J()},Ft=(A,C,N)=>{C.component=A;const q=A.vnode.props;A.vnode=C,A.next=null,xE(A,C.props,q,N),OE(A,C.children,N),Vs(),np(A),Us()},at=(A,C,N,q,G,W,ot,it,nt=!1)=>{const J=A&&A.children,wt=A?A.shapeFlag:0,ht=C.children,{patchFlag:_t,shapeFlag:bt}=C;if(_t>0){if(_t&128){vt(J,ht,N,q,G,W,ot,it,nt);return}else if(_t&256){Qe(J,ht,N,q,G,W,ot,it,nt);return}}bt&8?(wt&16&&At(J,G,W),ht!==J&&_(N,ht)):wt&16?bt&16?vt(J,ht,N,q,G,W,ot,it,nt):At(J,G,W,!0):(wt&8&&_(N,""),bt&16&&P(ht,N,q,G,W,ot,it,nt))},Qe=(A,C,N,q,G,W,ot,it,nt)=>{A=A||Jr,C=C||Jr;const J=A.length,wt=C.length,ht=Math.min(J,wt);let _t;for(_t=0;_t<ht;_t++){const bt=C[_t]=nt?ms(C[_t]):mi(C[_t]);B(A[_t],bt,N,null,G,W,ot,it,nt)}J>wt?At(A,G,W,!0,!1,ht):P(C,N,q,G,W,ot,it,nt,ht)},vt=(A,C,N,q,G,W,ot,it,nt)=>{let J=0;const wt=C.length;let ht=A.length-1,_t=wt-1;for(;J<=ht&&J<=_t;){const bt=A[J],yt=C[J]=nt?ms(C[J]):mi(C[J]);if(ca(bt,yt))B(bt,yt,N,null,G,W,ot,it,nt);else break;J++}for(;J<=ht&&J<=_t;){const bt=A[ht],yt=C[_t]=nt?ms(C[_t]):mi(C[_t]);if(ca(bt,yt))B(bt,yt,N,null,G,W,ot,it,nt);else break;ht--,_t--}if(J>ht){if(J<=_t){const bt=_t+1,yt=bt<wt?C[bt].el:q;for(;J<=_t;)B(null,C[J]=nt?ms(C[J]):mi(C[J]),N,yt,G,W,ot,it,nt),J++}}else if(J>_t)for(;J<=ht;)Ht(A[J],G,W,!0),J++;else{const bt=J,yt=J,Mt=new Map;for(J=yt;J<=_t;J++){const Le=C[J]=nt?ms(C[J]):mi(C[J]);Le.key!=null&&Mt.set(Le.key,J)}let Wt,Be=0;const ke=_t-yt+1;let cn=!1,ze=0;const Gn=new Array(ke);for(J=0;J<ke;J++)Gn[J]=0;for(J=bt;J<=ht;J++){const Le=A[J];if(Be>=ke){Ht(Le,G,W,!0);continue}let gn;if(Le.key!=null)gn=Mt.get(Le.key);else for(Wt=yt;Wt<=_t;Wt++)if(Gn[Wt-yt]===0&&ca(Le,C[Wt])){gn=Wt;break}gn===void 0?Ht(Le,G,W,!0):(Gn[gn-yt]=J+1,gn>=ze?ze=gn:cn=!0,B(Le,C[gn],N,null,G,W,ot,it,nt),Be++)}const Ci=cn?UE(Gn):Jr;for(Wt=Ci.length-1,J=ke-1;J>=0;J--){const Le=yt+J,gn=C[Le],oi=Le+1<wt?C[Le+1].el:q;Gn[J]===0?B(null,gn,N,oi,G,W,ot,it,nt):cn&&(Wt<0||J!==Ci[Wt]?Gt(gn,N,oi,2):Wt--)}}},Gt=(A,C,N,q,G=null)=>{const{el:W,type:ot,transition:it,children:nt,shapeFlag:J}=A;if(J&6){Gt(A.component.subTree,C,N,q);return}if(J&128){A.suspense.move(C,N,q);return}if(J&64){ot.move(A,C,N,mt);return}if(ot===qe){i(W,C,N);for(let ht=0;ht<nt.length;ht++)Gt(nt[ht],C,N,q);i(A.anchor,C,N);return}if(ot===ac){Q(A,C,N);return}if(q!==2&&J&1&&it)if(q===0)it.beforeEnter(W),i(W,C,N),Rn(()=>it.enter(W),G);else{const{leave:ht,delayLeave:_t,afterLeave:bt}=it,yt=()=>i(W,C,N),Mt=()=>{ht(W,()=>{yt(),bt&&bt()})};_t?_t(W,yt,Mt):Mt()}else i(W,C,N)},Ht=(A,C,N,q=!1,G=!1)=>{const{type:W,props:ot,ref:it,children:nt,dynamicChildren:J,shapeFlag:wt,patchFlag:ht,dirs:_t,cacheIndex:bt}=A;if(ht===-2&&(G=!1),it!=null&&Ic(it,null,N,A,!0),bt!=null&&(C.renderCache[bt]=void 0),wt&256){C.ctx.deactivate(A);return}const yt=wt&1&&_t,Mt=!ba(A);let Wt;if(Mt&&(Wt=ot&&ot.onVnodeBeforeUnmount)&&hi(Wt,C,A),wt&6)zt(A.component,N,q);else{if(wt&128){A.suspense.unmount(N,q);return}yt&&er(A,null,C,"beforeUnmount"),wt&64?A.type.remove(A,C,N,mt,q):J&&!J.hasOnce&&(W!==qe||ht>0&&ht&64)?At(J,C,N,!1,!0):(W===qe&&ht&384||!G&&wt&16)&&At(nt,C,N),q&&$t(A)}(Mt&&(Wt=ot&&ot.onVnodeUnmounted)||yt)&&Rn(()=>{Wt&&hi(Wt,C,A),yt&&er(A,null,C,"unmounted")},N)},$t=A=>{const{type:C,el:N,anchor:q,transition:G}=A;if(C===qe){oe(N,q);return}if(C===ac){tt(A);return}const W=()=>{r(N),G&&!G.persisted&&G.afterLeave&&G.afterLeave()};if(A.shapeFlag&1&&G&&!G.persisted){const{leave:ot,delayLeave:it}=G,nt=()=>ot(N,W);it?it(A.el,W,nt):nt()}else W()},oe=(A,C)=>{let N;for(;A!==C;)N=T(A),r(A),A=N;r(C)},zt=(A,C,N)=>{const{bum:q,scope:G,job:W,subTree:ot,um:it,m:nt,a:J}=A;cp(nt),cp(J),q&&rc(q),G.stop(),W&&(W.flags|=8,Ht(ot,A,C,N)),it&&Rn(it,C),Rn(()=>{A.isUnmounted=!0},C),C&&C.pendingBranch&&!C.isUnmounted&&A.asyncDep&&!A.asyncResolved&&A.suspenseId===C.pendingId&&(C.deps--,C.deps===0&&C.resolve())},At=(A,C,N,q=!1,G=!1,W=0)=>{for(let ot=W;ot<A.length;ot++)Ht(A[ot],C,N,q,G)},$=A=>{if(A.shapeFlag&6)return $(A.component.subTree);if(A.shapeFlag&128)return A.suspense.next();const C=T(A.anchor||A.el),N=C&&C[rE];return N?T(N):C};let ct=!1;const ut=(A,C,N)=>{A==null?C._vnode&&Ht(C._vnode,null,null,!0):B(C._vnode||null,A,C,null,null,null,N),C._vnode=A,ct||(ct=!0,np(),ig(),ct=!1)},mt={p:B,um:Ht,m:Gt,r:$t,mt:_e,mc:P,pc:at,pbc:M,n:$,o:e};return{render:ut,hydrate:void 0,createApp:RE(ut)}}function Zu({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function nr({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function VE(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function bg(e,t,n=!1){const i=e.children,r=t.children;if(Pt(i)&&Pt(r))for(let o=0;o<i.length;o++){const l=i[o];let h=r[o];h.shapeFlag&1&&!h.dynamicChildren&&((h.patchFlag<=0||h.patchFlag===32)&&(h=r[o]=ms(r[o]),h.el=l.el),!n&&h.patchFlag!==-2&&bg(l,h)),h.type===su&&(h.el=l.el)}}function UE(e){const t=e.slice(),n=[0];let i,r,o,l,h;const d=e.length;for(i=0;i<d;i++){const p=e[i];if(p!==0){if(r=n[n.length-1],e[r]<p){t[i]=r,n.push(i);continue}for(o=0,l=n.length-1;o<l;)h=o+l>>1,e[n[h]]<p?o=h+1:l=h;p<e[n[o]]&&(o>0&&(t[i]=n[o-1]),n[o]=i)}}for(o=n.length,l=n[o-1];o-- >0;)n[o]=l,l=t[l];return n}function Ig(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Ig(t)}function cp(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const FE=Symbol.for("v-scx"),BE=()=>vi(FE);function Pa(e,t,n){return Pg(e,t,n)}function Pg(e,t,n=he){const{immediate:i,deep:r,flush:o,once:l}=n,h=an({},n),d=t&&i||!t&&o!=="post";let p;if(za){if(o==="sync"){const I=BE();p=I.__watcherHandles||(I.__watcherHandles=[])}else if(!d){const I=()=>{};return I.stop=gi,I.resume=gi,I.pause=gi,I}}const _=nn;h.call=(I,U,B)=>Ii(I,_,U,B);let y=!1;o==="post"?h.scheduler=I=>{Rn(I,_&&_.suspense)}:o!=="sync"&&(y=!0,h.scheduler=(I,U)=>{U?I():gd(I)}),h.augmentJob=I=>{t&&(I.flags|=4),y&&(I.flags|=2,_&&(I.id=_.uid,I.i=_))};const T=eE(e,t,h);return za&&(p?p.push(T):d&&T()),T}function zE(e,t,n){const i=this.proxy,r=Ve(e)?e.includes(".")?Ag(i,e):()=>i[e]:e.bind(i,i);let o;Ut(t)?o=t:(o=t.handler,n=t);const l=rl(this),h=Pg(r,o.bind(i),n);return l(),h}function Ag(e,t){const n=t.split(".");return()=>{let i=e;for(let r=0;r<n.length&&i;r++)i=i[n[r]];return i}}const jE=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${qn(t)}Modifiers`]||e[`${Ns(t)}Modifiers`];function HE(e,t,...n){if(e.isUnmounted)return;const i=e.vnode.props||he;let r=n;const o=t.startsWith("update:"),l=o&&jE(i,t.slice(7));l&&(l.trim&&(r=n.map(_=>Ve(_)?_.trim():_)),l.number&&(r=n.map(wc)));let h,d=i[h=Hu(t)]||i[h=Hu(qn(t))];!d&&o&&(d=i[h=Hu(Ns(t))]),d&&Ii(d,e,6,r);const p=i[h+"Once"];if(p){if(!e.emitted)e.emitted={};else if(e.emitted[h])return;e.emitted[h]=!0,Ii(p,e,6,r)}}function Cg(e,t,n=!1){const i=t.emitsCache,r=i.get(e);if(r!==void 0)return r;const o=e.emits;let l={},h=!1;if(!Ut(e)){const d=p=>{const _=Cg(p,t,!0);_&&(h=!0,an(l,_))};!n&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}return!o&&!h?(me(e)&&i.set(e,null),null):(Pt(o)?o.forEach(d=>l[d]=null):an(l,o),me(e)&&i.set(e,l),l)}function iu(e,t){return!e||!Gc(t)?!1:(t=t.slice(2).replace(/Once$/,""),se(e,t[0].toLowerCase()+t.slice(1))||se(e,Ns(t))||se(e,t))}function up(e){const{type:t,vnode:n,proxy:i,withProxy:r,propsOptions:[o],slots:l,attrs:h,emit:d,render:p,renderCache:_,props:y,data:T,setupState:I,ctx:U,inheritAttrs:B}=e,j=bc(e);let et,X;try{if(n.shapeFlag&4){const tt=r||i,Et=tt;et=mi(p.call(Et,tt,_,y,I,T,U)),X=h}else{const tt=t;et=mi(tt.length>1?tt(y,{attrs:h,slots:l,emit:d}):tt(y,null)),X=t.props?h:$E(h)}}catch(tt){Aa.length=0,tu(tt,e,1),et=pe(hr)}let Q=et;if(X&&B!==!1){const tt=Object.keys(X),{shapeFlag:Et}=Q;tt.length&&Et&7&&(o&&tt.some(rd)&&(X=qE(X,o)),Q=co(Q,X,!1,!0))}return n.dirs&&(Q=co(Q,null,!1,!0),Q.dirs=Q.dirs?Q.dirs.concat(n.dirs):n.dirs),n.transition&&vd(Q,n.transition),et=Q,bc(j),et}const $E=e=>{let t;for(const n in e)(n==="class"||n==="style"||Gc(n))&&((t||(t={}))[n]=e[n]);return t},qE=(e,t)=>{const n={};for(const i in e)(!rd(i)||!(i.slice(9)in t))&&(n[i]=e[i]);return n};function WE(e,t,n){const{props:i,children:r,component:o}=e,{props:l,children:h,patchFlag:d}=t,p=o.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&d>=0){if(d&1024)return!0;if(d&16)return i?hp(i,l,p):!!l;if(d&8){const _=t.dynamicProps;for(let y=0;y<_.length;y++){const T=_[y];if(l[T]!==i[T]&&!iu(p,T))return!0}}}else return(r||h)&&(!h||!h.$stable)?!0:i===l?!1:i?l?hp(i,l,p):!0:!!l;return!1}function hp(e,t,n){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let r=0;r<i.length;r++){const o=i[r];if(t[o]!==e[o]&&!iu(n,o))return!0}return!1}function KE({vnode:e,parent:t},n){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=n,t=t.parent;else break}}const Rg=e=>e.__isSuspense;function GE(e,t){t&&t.pendingBranch?Pt(e)?t.effects.push(...e):t.effects.push(e):sE(e)}const qe=Symbol.for("v-fgt"),su=Symbol.for("v-txt"),hr=Symbol.for("v-cmt"),ac=Symbol.for("v-stc"),Aa=[];let Ln=null;function rt(e=!1){Aa.push(Ln=e?null:[])}function ZE(){Aa.pop(),Ln=Aa[Aa.length-1]||null}let Ba=1;function dp(e,t=!1){Ba+=e,e<0&&Ln&&t&&(Ln.hasOnce=!0)}function Sg(e){return e.dynamicChildren=Ba>0?Ln||Jr:null,ZE(),Ba>0&&Ln&&Ln.push(e),e}function lt(e,t,n,i,r,o){return Sg(E(e,t,n,i,r,o,!0))}function xg(e,t,n,i,r){return Sg(pe(e,t,n,i,r,!0))}function Ac(e){return e?e.__v_isVNode===!0:!1}function ca(e,t){return e.type===t.type&&e.key===t.key}const kg=({key:e})=>e??null,lc=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?Ve(e)||rn(e)||Ut(e)?{i:kn,r:e,k:t,f:!!n}:e:null);function E(e,t=null,n=null,i=0,r=null,o=e===qe?0:1,l=!1,h=!1){const d={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&kg(t),ref:t&&lc(t),scopeId:rg,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:kn};return h?(Td(d,n),o&128&&e.normalize(d)):n&&(d.shapeFlag|=Ve(n)?8:16),Ba>0&&!l&&Ln&&(d.patchFlag>0||o&6)&&d.patchFlag!==32&&Ln.push(d),d}const pe=QE;function QE(e,t=null,n=null,i=0,r=null,o=!1){if((!e||e===yE)&&(e=hr),Ac(e)){const h=co(e,t,!0);return n&&Td(h,n),Ba>0&&!o&&Ln&&(h.shapeFlag&6?Ln[Ln.indexOf(e)]=h:Ln.push(h)),h.patchFlag=-2,h}if(ab(e)&&(e=e.__vccOpts),t){t=YE(t);let{class:h,style:d}=t;h&&!Ve(h)&&(t.class=cr(h)),me(d)&&(md(d)&&!Pt(d)&&(d=an({},d)),t.style=nl(d))}const l=Ve(e)?1:Rg(e)?128:oE(e)?64:me(e)?4:Ut(e)?2:0;return E(e,t,n,i,r,l,o,!0)}function YE(e){return e?md(e)||_g(e)?an({},e):e:null}function co(e,t,n=!1,i=!1){const{props:r,ref:o,patchFlag:l,children:h,transition:d}=e,p=t?XE(r||{},t):r,_={__v_isVNode:!0,__v_skip:!0,type:e.type,props:p,key:p&&kg(p),ref:t&&t.ref?n&&o?Pt(o)?o.concat(lc(t)):[o,lc(t)]:lc(t):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:h,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==qe?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:d,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&co(e.ssContent),ssFallback:e.ssFallback&&co(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return d&&i&&vd(_,d.clone(_)),_}function Ot(e=" ",t=0){return pe(su,null,e,t)}function wd(e,t){const n=pe(ac,null,e);return n.staticCount=t,n}function Bt(e="",t=!1){return t?(rt(),xg(hr,null,e)):pe(hr,null,e)}function mi(e){return e==null||typeof e=="boolean"?pe(hr):Pt(e)?pe(qe,null,e.slice()):Ac(e)?ms(e):pe(su,null,String(e))}function ms(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:co(e)}function Td(e,t){let n=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(Pt(t))n=16;else if(typeof t=="object")if(i&65){const r=t.default;r&&(r._c&&(r._d=!1),Td(e,r()),r._c&&(r._d=!0));return}else{n=32;const r=t._;!r&&!_g(t)?t._ctx=kn:r===3&&kn&&(kn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Ut(t)?(t={default:t,_ctx:kn},n=32):(t=String(t),i&64?(n=16,t=[Ot(t)]):n=8);e.children=t,e.shapeFlag|=n}function XE(...e){const t={};for(let n=0;n<e.length;n++){const i=e[n];for(const r in i)if(r==="class")t.class!==i.class&&(t.class=cr([t.class,i.class]));else if(r==="style")t.style=nl([t.style,i.style]);else if(Gc(r)){const o=t[r],l=i[r];l&&o!==l&&!(Pt(o)&&o.includes(l))&&(t[r]=o?[].concat(o,l):l)}else r!==""&&(t[r]=i[r])}return t}function hi(e,t,n,i=null){Ii(e,t,7,[n,i])}const JE=fg();let tb=0;function eb(e,t,n){const i=e.type,r=(t?t.appContext:e.appContext)||JE,o={uid:tb++,vnode:e,type:i,parent:t,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new RT(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(r.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:vg(i,r),emitsOptions:Cg(i,r),emit:null,emitted:null,propsDefaults:he,inheritAttrs:i.inheritAttrs,ctx:he,data:he,props:he,attrs:he,slots:he,refs:he,setupState:he,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=t?t.root:o,o.emit=HE.bind(null,o),e.ce&&e.ce(o),o}let nn=null,Cc,bh;{const e=Yc(),t=(n,i)=>{let r;return(r=e[n])||(r=e[n]=[]),r.push(i),o=>{r.length>1?r.forEach(l=>l(o)):r[0](o)}};Cc=t("__VUE_INSTANCE_SETTERS__",n=>nn=n),bh=t("__VUE_SSR_SETTERS__",n=>za=n)}const rl=e=>{const t=nn;return Cc(e),e.scope.on(),()=>{e.scope.off(),Cc(t)}},fp=()=>{nn&&nn.scope.off(),Cc(null)};function Lg(e){return e.vnode.shapeFlag&4}let za=!1;function nb(e,t=!1,n=!1){t&&bh(t);const{props:i,children:r}=e.vnode,o=Lg(e);SE(e,i,o,t),ME(e,r,n);const l=o?ib(e,t):void 0;return t&&bh(!1),l}function ib(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,TE);const{setup:i}=n;if(i){Vs();const r=e.setupContext=i.length>1?rb(e):null,o=rl(e),l=sl(i,e,0,[e.props,r]),h=x_(l);if(Us(),o(),(h||e.sp)&&!ba(e)&&ag(e),h){if(l.then(fp,fp),t)return l.then(d=>{pp(e,d)}).catch(d=>{tu(d,e,0)});e.asyncDep=l}else pp(e,l)}else Mg(e)}function pp(e,t,n){Ut(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:me(t)&&(e.setupState=tg(t)),Mg(e)}function Mg(e,t,n){const i=e.type;e.render||(e.render=i.render||gi);{const r=rl(e);Vs();try{EE(e)}finally{Us(),r()}}}const sb={get(e,t){return Je(e,"get",""),e[t]}};function rb(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,sb),slots:e.slots,emit:e.emit,expose:t}}function ru(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(tg(GT(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Ia)return Ia[n](e)},has(t,n){return n in t||n in Ia}})):e.proxy}function ob(e,t=!0){return Ut(e)?e.displayName||e.name:e.name||t&&e.__name}function ab(e){return Ut(e)&&"__vccOpts"in e}const ti=(e,t)=>JT(e,t,za);function Og(e,t,n){const i=arguments.length;return i===2?me(t)&&!Pt(t)?Ac(t)?pe(e,null,[t]):pe(e,t):pe(e,null,t):(i>3?n=Array.prototype.slice.call(arguments,2):i===3&&Ac(n)&&(n=[n]),pe(e,t,n))}const lb="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ih;const mp=typeof window<"u"&&window.trustedTypes;if(mp)try{Ih=mp.createPolicy("vue",{createHTML:e=>e})}catch{}const Dg=Ih?e=>Ih.createHTML(e):e=>e,cb="http://www.w3.org/2000/svg",ub="http://www.w3.org/1998/Math/MathML",zi=typeof document<"u"?document:null,_p=zi&&zi.createElement("template"),hb={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,i)=>{const r=t==="svg"?zi.createElementNS(cb,e):t==="mathml"?zi.createElementNS(ub,e):n?zi.createElement(e,{is:n}):zi.createElement(e);return e==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:e=>zi.createTextNode(e),createComment:e=>zi.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>zi.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,i,r,o){const l=n?n.previousSibling:t.lastChild;if(r&&(r===o||r.nextSibling))for(;t.insertBefore(r.cloneNode(!0),n),!(r===o||!(r=r.nextSibling)););else{_p.innerHTML=Dg(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const h=_p.content;if(i==="svg"||i==="mathml"){const d=h.firstChild;for(;d.firstChild;)h.appendChild(d.firstChild);h.removeChild(d)}t.insertBefore(h,n)}return[l?l.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},db=Symbol("_vtc");function fb(e,t,n){const i=e[db];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const gp=Symbol("_vod"),pb=Symbol("_vsh"),mb=Symbol(""),_b=/(^|;)\s*display\s*:/;function gb(e,t,n){const i=e.style,r=Ve(n);let o=!1;if(n&&!r){if(t)if(Ve(t))for(const l of t.split(";")){const h=l.slice(0,l.indexOf(":")).trim();n[h]==null&&cc(i,h,"")}else for(const l in t)n[l]==null&&cc(i,l,"");for(const l in n)l==="display"&&(o=!0),cc(i,l,n[l])}else if(r){if(t!==n){const l=i[mb];l&&(n+=";"+l),i.cssText=n,o=_b.test(n)}}else t&&e.removeAttribute("style");gp in e&&(e[gp]=o?i.display:"",e[pb]&&(i.display="none"))}const vp=/\s*!important$/;function cc(e,t,n){if(Pt(n))n.forEach(i=>cc(e,t,i));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const i=vb(e,t);vp.test(n)?e.setProperty(Ns(i),n.replace(vp,""),"important"):e[i]=n}}const yp=["Webkit","Moz","ms"],Qu={};function vb(e,t){const n=Qu[t];if(n)return n;let i=qn(t);if(i!=="filter"&&i in e)return Qu[t]=i;i=Qc(i);for(let r=0;r<yp.length;r++){const o=yp[r]+i;if(o in e)return Qu[t]=o}return t}const wp="http://www.w3.org/1999/xlink";function Tp(e,t,n,i,r,o=AT(t)){i&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(wp,t.slice(6,t.length)):e.setAttributeNS(wp,t,n):n==null||o&&!O_(n)?e.removeAttribute(t):e.setAttribute(t,o?"":bi(n)?String(n):n)}function Ep(e,t,n,i,r){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?Dg(n):n);return}const o=e.tagName;if(t==="value"&&o!=="PROGRESS"&&!o.includes("-")){const h=o==="OPTION"?e.getAttribute("value")||"":e.value,d=n==null?e.type==="checkbox"?"on":"":String(n);(h!==d||!("_value"in e))&&(e.value=d),n==null&&e.removeAttribute(t),e._value=n;return}let l=!1;if(n===""||n==null){const h=typeof e[t];h==="boolean"?n=O_(n):n==null&&h==="string"?(n="",l=!0):h==="number"&&(n=0,l=!0)}try{e[t]=n}catch{}l&&e.removeAttribute(r||t)}function gs(e,t,n,i){e.addEventListener(t,n,i)}function yb(e,t,n,i){e.removeEventListener(t,n,i)}const bp=Symbol("_vei");function wb(e,t,n,i,r=null){const o=e[bp]||(e[bp]={}),l=o[t];if(i&&l)l.value=i;else{const[h,d]=Tb(t);if(i){const p=o[t]=Ib(i,r);gs(e,h,p,d)}else l&&(yb(e,h,l,d),o[t]=void 0)}}const Ip=/(?:Once|Passive|Capture)$/;function Tb(e){let t;if(Ip.test(e)){t={};let i;for(;i=e.match(Ip);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Ns(e.slice(2)),t]}let Yu=0;const Eb=Promise.resolve(),bb=()=>Yu||(Eb.then(()=>Yu=0),Yu=Date.now());function Ib(e,t){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;Ii(Pb(i,n.value),t,5,[i])};return n.value=e,n.attached=bb(),n}function Pb(e,t){if(Pt(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(i=>r=>!r._stopped&&i&&i(r))}else return t}const Pp=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Ab=(e,t,n,i,r,o)=>{const l=r==="svg";t==="class"?fb(e,i,l):t==="style"?gb(e,n,i):Gc(t)?rd(t)||wb(e,t,n,i,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Cb(e,t,i,l))?(Ep(e,t,i),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Tp(e,t,i,l,o,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Ve(i))?Ep(e,qn(t),i,o,t):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),Tp(e,t,i,l))};function Cb(e,t,n,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&Pp(t)&&Ut(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const r=e.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return Pp(t)&&Ve(n)?!1:t in e}const uo=e=>{const t=e.props["onUpdate:modelValue"]||!1;return Pt(t)?n=>rc(t,n):t};function Rb(e){e.target.composing=!0}function Ap(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Ki=Symbol("_assign"),Ae={created(e,{modifiers:{lazy:t,trim:n,number:i}},r){e[Ki]=uo(r);const o=i||r.props&&r.props.type==="number";gs(e,t?"change":"input",l=>{if(l.target.composing)return;let h=e.value;n&&(h=h.trim()),o&&(h=wc(h)),e[Ki](h)}),n&&gs(e,"change",()=>{e.value=e.value.trim()}),t||(gs(e,"compositionstart",Rb),gs(e,"compositionend",Ap),gs(e,"change",Ap))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:i,trim:r,number:o}},l){if(e[Ki]=uo(l),e.composing)return;const h=(o||e.type==="number")&&!/^0\d/.test(e.value)?wc(e.value):e.value,d=t??"";h!==d&&(document.activeElement===e&&e.type!=="range"&&(i&&t===n||r&&e.value.trim()===d)||(e.value=d))}},Ng={deep:!0,created(e,t,n){e[Ki]=uo(n),gs(e,"change",()=>{const i=e._modelValue,r=ja(e),o=e.checked,l=e[Ki];if(Pt(i)){const h=ld(i,r),d=h!==-1;if(o&&!d)l(i.concat(r));else if(!o&&d){const p=[...i];p.splice(h,1),l(p)}}else if(bo(i)){const h=new Set(i);o?h.add(r):h.delete(r),l(h)}else l(Ug(e,o))})},mounted:Cp,beforeUpdate(e,t,n){e[Ki]=uo(n),Cp(e,t,n)}};function Cp(e,{value:t,oldValue:n},i){e._modelValue=t;let r;if(Pt(t))r=ld(t,i.props.value)>-1;else if(bo(t))r=t.has(i.props.value);else{if(t===n)return;r=il(t,Ug(e,!0))}e.checked!==r&&(e.checked=r)}const Vg={deep:!0,created(e,{value:t,modifiers:{number:n}},i){const r=bo(t);gs(e,"change",()=>{const o=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>n?wc(ja(l)):ja(l));e[Ki](e.multiple?r?new Set(o):o:o[0]),e._assigning=!0,_d(()=>{e._assigning=!1})}),e[Ki]=uo(i)},mounted(e,{value:t}){Rp(e,t)},beforeUpdate(e,t,n){e[Ki]=uo(n)},updated(e,{value:t}){e._assigning||Rp(e,t)}};function Rp(e,t){const n=e.multiple,i=Pt(t);if(!(n&&!i&&!bo(t))){for(let r=0,o=e.options.length;r<o;r++){const l=e.options[r],h=ja(l);if(n)if(i){const d=typeof h;d==="string"||d==="number"?l.selected=t.some(p=>String(p)===String(h)):l.selected=ld(t,h)>-1}else l.selected=t.has(h);else if(il(ja(l),t)){e.selectedIndex!==r&&(e.selectedIndex=r);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function ja(e){return"_value"in e?e._value:e.value}function Ug(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const Sb=["ctrl","shift","alt","meta"],xb={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Sb.some(n=>e[`${n}Key`]&&!t.includes(n))},Is=(e,t)=>{const n=e._withMods||(e._withMods={}),i=t.join(".");return n[i]||(n[i]=(r,...o)=>{for(let l=0;l<t.length;l++){const h=xb[t[l]];if(h&&h(r,t))return}return e(r,...o)})},kb={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Ca=(e,t)=>{const n=e._withKeys||(e._withKeys={}),i=t.join(".");return n[i]||(n[i]=r=>{if(!("key"in r))return;const o=Ns(r.key);if(t.some(l=>l===o||kb[l]===o))return e(r)})},Lb=an({patchProp:Ab},hb);let Sp;function Mb(){return Sp||(Sp=DE(Lb))}const Ob=(...e)=>{const t=Mb().createApp(...e),{mount:n}=t;return t.mount=i=>{const r=Nb(i);if(!r)return;const o=t._component;!Ut(o)&&!o.render&&!o.template&&(o.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const l=n(r,!1,Db(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),l},t};function Db(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Nb(e){return Ve(e)?document.querySelector(e):e}const In=(e,t)=>{const n=e.__vccOpts||e;for(const[i,r]of t)n[i]=r;return n},Vb={name:"App"};function Ub(e,t,n,i,r,o){const l=xn("router-view");return rt(),lt("div",null,[pe(l)])}const Fb=In(Vb,[["render",Ub]]);/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Gr=typeof document<"u";function Fg(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Bb(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&Fg(e.default)}const ne=Object.assign;function Xu(e,t){const n={};for(const i in t){const r=t[i];n[i]=si(r)?r.map(e):e(r)}return n}const Ra=()=>{},si=Array.isArray,Bg=/#/g,zb=/&/g,jb=/\//g,Hb=/=/g,$b=/\?/g,zg=/\+/g,qb=/%5B/g,Wb=/%5D/g,jg=/%5E/g,Kb=/%60/g,Hg=/%7B/g,Gb=/%7C/g,$g=/%7D/g,Zb=/%20/g;function Ed(e){return encodeURI(""+e).replace(Gb,"|").replace(qb,"[").replace(Wb,"]")}function Qb(e){return Ed(e).replace(Hg,"{").replace($g,"}").replace(jg,"^")}function Ph(e){return Ed(e).replace(zg,"%2B").replace(Zb,"+").replace(Bg,"%23").replace(zb,"%26").replace(Kb,"`").replace(Hg,"{").replace($g,"}").replace(jg,"^")}function Yb(e){return Ph(e).replace(Hb,"%3D")}function Xb(e){return Ed(e).replace(Bg,"%23").replace($b,"%3F")}function Jb(e){return e==null?"":Xb(e).replace(jb,"%2F")}function Ha(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const tI=/\/$/,eI=e=>e.replace(tI,"");function Ju(e,t,n="/"){let i,r={},o="",l="";const h=t.indexOf("#");let d=t.indexOf("?");return h<d&&h>=0&&(d=-1),d>-1&&(i=t.slice(0,d),o=t.slice(d+1,h>-1?h:t.length),r=e(o)),h>-1&&(i=i||t.slice(0,h),l=t.slice(h,t.length)),i=rI(i??t,n),{fullPath:i+(o&&"?")+o+l,path:i,query:r,hash:Ha(l)}}function nI(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function xp(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function iI(e,t,n){const i=t.matched.length-1,r=n.matched.length-1;return i>-1&&i===r&&ho(t.matched[i],n.matched[r])&&qg(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function ho(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function qg(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!sI(e[n],t[n]))return!1;return!0}function sI(e,t){return si(e)?kp(e,t):si(t)?kp(t,e):e===t}function kp(e,t){return si(t)?e.length===t.length&&e.every((n,i)=>n===t[i]):e.length===1&&e[0]===t}function rI(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),i=e.split("/"),r=i[i.length-1];(r===".."||r===".")&&i.push("");let o=n.length-1,l,h;for(l=0;l<i.length;l++)if(h=i[l],h!==".")if(h==="..")o>1&&o--;else break;return n.slice(0,o).join("/")+"/"+i.slice(l).join("/")}const ds={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var $a;(function(e){e.pop="pop",e.push="push"})($a||($a={}));var Sa;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Sa||(Sa={}));function oI(e){if(!e)if(Gr){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),eI(e)}const aI=/^[^#]+#/;function lI(e,t){return e.replace(aI,"#")+t}function cI(e,t){const n=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-n.left-(t.left||0),top:i.top-n.top-(t.top||0)}}const ou=()=>({left:window.scrollX,top:window.scrollY});function uI(e){let t;if("el"in e){const n=e.el,i=typeof n=="string"&&n.startsWith("#"),r=typeof n=="string"?i?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;t=cI(r,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function Lp(e,t){return(history.state?history.state.position-t:-1)+e}const Ah=new Map;function hI(e,t){Ah.set(e,t)}function dI(e){const t=Ah.get(e);return Ah.delete(e),t}let fI=()=>location.protocol+"//"+location.host;function Wg(e,t){const{pathname:n,search:i,hash:r}=t,o=e.indexOf("#");if(o>-1){let h=r.includes(e.slice(o))?e.slice(o).length:1,d=r.slice(h);return d[0]!=="/"&&(d="/"+d),xp(d,"")}return xp(n,e)+i+r}function pI(e,t,n,i){let r=[],o=[],l=null;const h=({state:T})=>{const I=Wg(e,location),U=n.value,B=t.value;let j=0;if(T){if(n.value=I,t.value=T,l&&l===U){l=null;return}j=B?T.position-B.position:0}else i(I);r.forEach(et=>{et(n.value,U,{delta:j,type:$a.pop,direction:j?j>0?Sa.forward:Sa.back:Sa.unknown})})};function d(){l=n.value}function p(T){r.push(T);const I=()=>{const U=r.indexOf(T);U>-1&&r.splice(U,1)};return o.push(I),I}function _(){const{history:T}=window;T.state&&T.replaceState(ne({},T.state,{scroll:ou()}),"")}function y(){for(const T of o)T();o=[],window.removeEventListener("popstate",h),window.removeEventListener("beforeunload",_)}return window.addEventListener("popstate",h),window.addEventListener("beforeunload",_,{passive:!0}),{pauseListeners:d,listen:p,destroy:y}}function Mp(e,t,n,i=!1,r=!1){return{back:e,current:t,forward:n,replaced:i,position:window.history.length,scroll:r?ou():null}}function mI(e){const{history:t,location:n}=window,i={value:Wg(e,n)},r={value:t.state};r.value||o(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function o(d,p,_){const y=e.indexOf("#"),T=y>-1?(n.host&&document.querySelector("base")?e:e.slice(y))+d:fI()+e+d;try{t[_?"replaceState":"pushState"](p,"",T),r.value=p}catch(I){console.error(I),n[_?"replace":"assign"](T)}}function l(d,p){const _=ne({},t.state,Mp(r.value.back,d,r.value.forward,!0),p,{position:r.value.position});o(d,_,!0),i.value=d}function h(d,p){const _=ne({},r.value,t.state,{forward:d,scroll:ou()});o(_.current,_,!0);const y=ne({},Mp(i.value,d,null),{position:_.position+1},p);o(d,y,!1),i.value=d}return{location:i,state:r,push:h,replace:l}}function _I(e){e=oI(e);const t=mI(e),n=pI(e,t.state,t.location,t.replace);function i(o,l=!0){l||n.pauseListeners(),history.go(o)}const r=ne({location:"",base:e,go:i,createHref:lI.bind(null,e)},t,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>t.state.value}),r}function gI(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),_I(e)}function vI(e){return typeof e=="string"||e&&typeof e=="object"}function Kg(e){return typeof e=="string"||typeof e=="symbol"}const Gg=Symbol("");var Op;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(Op||(Op={}));function fo(e,t){return ne(new Error,{type:e,[Gg]:!0},t)}function Bi(e,t){return e instanceof Error&&Gg in e&&(t==null||!!(e.type&t))}const Dp="[^/]+?",yI={sensitive:!1,strict:!1,start:!0,end:!0},wI=/[.+*?^${}()[\]/\\]/g;function TI(e,t){const n=ne({},yI,t),i=[];let r=n.start?"^":"";const o=[];for(const p of e){const _=p.length?[]:[90];n.strict&&!p.length&&(r+="/");for(let y=0;y<p.length;y++){const T=p[y];let I=40+(n.sensitive?.25:0);if(T.type===0)y||(r+="/"),r+=T.value.replace(wI,"\\$&"),I+=40;else if(T.type===1){const{value:U,repeatable:B,optional:j,regexp:et}=T;o.push({name:U,repeatable:B,optional:j});const X=et||Dp;if(X!==Dp){I+=10;try{new RegExp(`(${X})`)}catch(tt){throw new Error(`Invalid custom RegExp for param "${U}" (${X}): `+tt.message)}}let Q=B?`((?:${X})(?:/(?:${X}))*)`:`(${X})`;y||(Q=j&&p.length<2?`(?:/${Q})`:"/"+Q),j&&(Q+="?"),r+=Q,I+=20,j&&(I+=-8),B&&(I+=-20),X===".*"&&(I+=-50)}_.push(I)}i.push(_)}if(n.strict&&n.end){const p=i.length-1;i[p][i[p].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&!r.endsWith("/")&&(r+="(?:/|$)");const l=new RegExp(r,n.sensitive?"":"i");function h(p){const _=p.match(l),y={};if(!_)return null;for(let T=1;T<_.length;T++){const I=_[T]||"",U=o[T-1];y[U.name]=I&&U.repeatable?I.split("/"):I}return y}function d(p){let _="",y=!1;for(const T of e){(!y||!_.endsWith("/"))&&(_+="/"),y=!1;for(const I of T)if(I.type===0)_+=I.value;else if(I.type===1){const{value:U,repeatable:B,optional:j}=I,et=U in p?p[U]:"";if(si(et)&&!B)throw new Error(`Provided param "${U}" is an array but it is not repeatable (* or + modifiers)`);const X=si(et)?et.join("/"):et;if(!X)if(j)T.length<2&&(_.endsWith("/")?_=_.slice(0,-1):y=!0);else throw new Error(`Missing required param "${U}"`);_+=X}}return _||"/"}return{re:l,score:i,keys:o,parse:h,stringify:d}}function EI(e,t){let n=0;for(;n<e.length&&n<t.length;){const i=t[n]-e[n];if(i)return i;n++}return e.length<t.length?e.length===1&&e[0]===80?-1:1:e.length>t.length?t.length===1&&t[0]===80?1:-1:0}function Zg(e,t){let n=0;const i=e.score,r=t.score;for(;n<i.length&&n<r.length;){const o=EI(i[n],r[n]);if(o)return o;n++}if(Math.abs(r.length-i.length)===1){if(Np(i))return 1;if(Np(r))return-1}return r.length-i.length}function Np(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const bI={type:0,value:""},II=/[a-zA-Z0-9_]/;function PI(e){if(!e)return[[]];if(e==="/")return[[bI]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(I){throw new Error(`ERR (${n})/"${p}": ${I}`)}let n=0,i=n;const r=[];let o;function l(){o&&r.push(o),o=[]}let h=0,d,p="",_="";function y(){p&&(n===0?o.push({type:0,value:p}):n===1||n===2||n===3?(o.length>1&&(d==="*"||d==="+")&&t(`A repeatable param (${p}) must be alone in its segment. eg: '/:ids+.`),o.push({type:1,value:p,regexp:_,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):t("Invalid state to consume buffer"),p="")}function T(){p+=d}for(;h<e.length;){if(d=e[h++],d==="\\"&&n!==2){i=n,n=4;continue}switch(n){case 0:d==="/"?(p&&y(),l()):d===":"?(y(),n=1):T();break;case 4:T(),n=i;break;case 1:d==="("?n=2:II.test(d)?T():(y(),n=0,d!=="*"&&d!=="?"&&d!=="+"&&h--);break;case 2:d===")"?_[_.length-1]=="\\"?_=_.slice(0,-1)+d:n=3:_+=d;break;case 3:y(),n=0,d!=="*"&&d!=="?"&&d!=="+"&&h--,_="";break;default:t("Unknown state");break}}return n===2&&t(`Unfinished custom RegExp for param "${p}"`),y(),l(),r}function AI(e,t,n){const i=TI(PI(e.path),n),r=ne(i,{record:e,parent:t,children:[],alias:[]});return t&&!r.record.aliasOf==!t.record.aliasOf&&t.children.push(r),r}function CI(e,t){const n=[],i=new Map;t=Bp({strict:!1,end:!0,sensitive:!1},t);function r(y){return i.get(y)}function o(y,T,I){const U=!I,B=Up(y);B.aliasOf=I&&I.record;const j=Bp(t,y),et=[B];if("alias"in y){const tt=typeof y.alias=="string"?[y.alias]:y.alias;for(const Et of tt)et.push(Up(ne({},B,{components:I?I.record.components:B.components,path:Et,aliasOf:I?I.record:B})))}let X,Q;for(const tt of et){const{path:Et}=tt;if(T&&Et[0]!=="/"){const kt=T.record.path,k=kt[kt.length-1]==="/"?"":"/";tt.path=T.record.path+(Et&&k+Et)}if(X=AI(tt,T,j),I?I.alias.push(X):(Q=Q||X,Q!==X&&Q.alias.push(X),U&&y.name&&!Fp(X)&&l(y.name)),Qg(X)&&d(X),B.children){const kt=B.children;for(let k=0;k<kt.length;k++)o(kt[k],X,I&&I.children[k])}I=I||X}return Q?()=>{l(Q)}:Ra}function l(y){if(Kg(y)){const T=i.get(y);T&&(i.delete(y),n.splice(n.indexOf(T),1),T.children.forEach(l),T.alias.forEach(l))}else{const T=n.indexOf(y);T>-1&&(n.splice(T,1),y.record.name&&i.delete(y.record.name),y.children.forEach(l),y.alias.forEach(l))}}function h(){return n}function d(y){const T=xI(y,n);n.splice(T,0,y),y.record.name&&!Fp(y)&&i.set(y.record.name,y)}function p(y,T){let I,U={},B,j;if("name"in y&&y.name){if(I=i.get(y.name),!I)throw fo(1,{location:y});j=I.record.name,U=ne(Vp(T.params,I.keys.filter(Q=>!Q.optional).concat(I.parent?I.parent.keys.filter(Q=>Q.optional):[]).map(Q=>Q.name)),y.params&&Vp(y.params,I.keys.map(Q=>Q.name))),B=I.stringify(U)}else if(y.path!=null)B=y.path,I=n.find(Q=>Q.re.test(B)),I&&(U=I.parse(B),j=I.record.name);else{if(I=T.name?i.get(T.name):n.find(Q=>Q.re.test(T.path)),!I)throw fo(1,{location:y,currentLocation:T});j=I.record.name,U=ne({},T.params,y.params),B=I.stringify(U)}const et=[];let X=I;for(;X;)et.unshift(X.record),X=X.parent;return{name:j,path:B,params:U,matched:et,meta:SI(et)}}e.forEach(y=>o(y));function _(){n.length=0,i.clear()}return{addRoute:o,resolve:p,removeRoute:l,clearRoutes:_,getRoutes:h,getRecordMatcher:r}}function Vp(e,t){const n={};for(const i of t)i in e&&(n[i]=e[i]);return n}function Up(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:RI(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function RI(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const i in e.components)t[i]=typeof n=="object"?n[i]:n;return t}function Fp(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function SI(e){return e.reduce((t,n)=>ne(t,n.meta),{})}function Bp(e,t){const n={};for(const i in e)n[i]=i in t?t[i]:e[i];return n}function xI(e,t){let n=0,i=t.length;for(;n!==i;){const o=n+i>>1;Zg(e,t[o])<0?i=o:n=o+1}const r=kI(e);return r&&(i=t.lastIndexOf(r,i-1)),i}function kI(e){let t=e;for(;t=t.parent;)if(Qg(t)&&Zg(e,t)===0)return t}function Qg({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function LI(e){const t={};if(e===""||e==="?")return t;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let r=0;r<i.length;++r){const o=i[r].replace(zg," "),l=o.indexOf("="),h=Ha(l<0?o:o.slice(0,l)),d=l<0?null:Ha(o.slice(l+1));if(h in t){let p=t[h];si(p)||(p=t[h]=[p]),p.push(d)}else t[h]=d}return t}function zp(e){let t="";for(let n in e){const i=e[n];if(n=Yb(n),i==null){i!==void 0&&(t+=(t.length?"&":"")+n);continue}(si(i)?i.map(o=>o&&Ph(o)):[i&&Ph(i)]).forEach(o=>{o!==void 0&&(t+=(t.length?"&":"")+n,o!=null&&(t+="="+o))})}return t}function MI(e){const t={};for(const n in e){const i=e[n];i!==void 0&&(t[n]=si(i)?i.map(r=>r==null?null:""+r):i==null?i:""+i)}return t}const OI=Symbol(""),jp=Symbol(""),au=Symbol(""),Yg=Symbol(""),Ch=Symbol("");function ua(){let e=[];function t(i){return e.push(i),()=>{const r=e.indexOf(i);r>-1&&e.splice(r,1)}}function n(){e=[]}return{add:t,list:()=>e.slice(),reset:n}}function _s(e,t,n,i,r,o=l=>l()){const l=i&&(i.enterCallbacks[r]=i.enterCallbacks[r]||[]);return()=>new Promise((h,d)=>{const p=T=>{T===!1?d(fo(4,{from:n,to:t})):T instanceof Error?d(T):vI(T)?d(fo(2,{from:t,to:T})):(l&&i.enterCallbacks[r]===l&&typeof T=="function"&&l.push(T),h())},_=o(()=>e.call(i&&i.instances[r],t,n,p));let y=Promise.resolve(_);e.length<3&&(y=y.then(p)),y.catch(T=>d(T))})}function th(e,t,n,i,r=o=>o()){const o=[];for(const l of e)for(const h in l.components){let d=l.components[h];if(!(t!=="beforeRouteEnter"&&!l.instances[h]))if(Fg(d)){const _=(d.__vccOpts||d)[t];_&&o.push(_s(_,n,i,l,h,r))}else{let p=d();o.push(()=>p.then(_=>{if(!_)throw new Error(`Couldn't resolve component "${h}" at "${l.path}"`);const y=Bb(_)?_.default:_;l.mods[h]=_,l.components[h]=y;const I=(y.__vccOpts||y)[t];return I&&_s(I,n,i,l,h,r)()}))}}return o}function Hp(e){const t=vi(au),n=vi(Yg),i=ti(()=>{const d=no(e.to);return t.resolve(d)}),r=ti(()=>{const{matched:d}=i.value,{length:p}=d,_=d[p-1],y=n.matched;if(!_||!y.length)return-1;const T=y.findIndex(ho.bind(null,_));if(T>-1)return T;const I=$p(d[p-2]);return p>1&&$p(_)===I&&y[y.length-1].path!==I?y.findIndex(ho.bind(null,d[p-2])):T}),o=ti(()=>r.value>-1&&FI(n.params,i.value.params)),l=ti(()=>r.value>-1&&r.value===n.matched.length-1&&qg(n.params,i.value.params));function h(d={}){if(UI(d)){const p=t[no(e.replace)?"replace":"push"](no(e.to)).catch(Ra);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>p),p}return Promise.resolve()}return{route:i,href:ti(()=>i.value.href),isActive:o,isExactActive:l,navigate:h}}function DI(e){return e.length===1?e[0]:e}const NI=og({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Hp,setup(e,{slots:t}){const n=Jc(Hp(e)),{options:i}=vi(au),r=ti(()=>({[qp(e.activeClass,i.linkActiveClass,"router-link-active")]:n.isActive,[qp(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const o=t.default&&DI(t.default(n));return e.custom?o:Og("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:r.value},o)}}}),VI=NI;function UI(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function FI(e,t){for(const n in t){const i=t[n],r=e[n];if(typeof i=="string"){if(i!==r)return!1}else if(!si(r)||r.length!==i.length||i.some((o,l)=>o!==r[l]))return!1}return!0}function $p(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const qp=(e,t,n)=>e??t??n,BI=og({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const i=vi(Ch),r=ti(()=>e.route||i.value),o=vi(jp,0),l=ti(()=>{let p=no(o);const{matched:_}=r.value;let y;for(;(y=_[p])&&!y.components;)p++;return p}),h=ti(()=>r.value.matched[l.value]);oc(jp,ti(()=>l.value+1)),oc(OI,h),oc(Ch,r);const d=sn();return Pa(()=>[d.value,h.value,e.name],([p,_,y],[T,I,U])=>{_&&(_.instances[y]=p,I&&I!==_&&p&&p===T&&(_.leaveGuards.size||(_.leaveGuards=I.leaveGuards),_.updateGuards.size||(_.updateGuards=I.updateGuards))),p&&_&&(!I||!ho(_,I)||!T)&&(_.enterCallbacks[y]||[]).forEach(B=>B(p))},{flush:"post"}),()=>{const p=r.value,_=e.name,y=h.value,T=y&&y.components[_];if(!T)return Wp(n.default,{Component:T,route:p});const I=y.props[_],U=I?I===!0?p.params:typeof I=="function"?I(p):I:null,j=Og(T,ne({},U,t,{onVnodeUnmounted:et=>{et.component.isUnmounted&&(y.instances[_]=null)},ref:d}));return Wp(n.default,{Component:j,route:p})||j}}});function Wp(e,t){if(!e)return null;const n=e(t);return n.length===1?n[0]:n}const zI=BI;function jI(e){const t=CI(e.routes,e),n=e.parseQuery||LI,i=e.stringifyQuery||zp,r=e.history,o=ua(),l=ua(),h=ua(),d=ZT(ds);let p=ds;Gr&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const _=Xu.bind(null,$=>""+$),y=Xu.bind(null,Jb),T=Xu.bind(null,Ha);function I($,ct){let ut,mt;return Kg($)?(ut=t.getRecordMatcher($),mt=ct):mt=$,t.addRoute(mt,ut)}function U($){const ct=t.getRecordMatcher($);ct&&t.removeRoute(ct)}function B(){return t.getRoutes().map($=>$.record)}function j($){return!!t.getRecordMatcher($)}function et($,ct){if(ct=ne({},ct||d.value),typeof $=="string"){const N=Ju(n,$,ct.path),q=t.resolve({path:N.path},ct),G=r.createHref(N.fullPath);return ne(N,q,{params:T(q.params),hash:Ha(N.hash),redirectedFrom:void 0,href:G})}let ut;if($.path!=null)ut=ne({},$,{path:Ju(n,$.path,ct.path).path});else{const N=ne({},$.params);for(const q in N)N[q]==null&&delete N[q];ut=ne({},$,{params:y(N)}),ct.params=y(ct.params)}const mt=t.resolve(ut,ct),Zt=$.hash||"";mt.params=_(T(mt.params));const A=nI(i,ne({},$,{hash:Qb(Zt),path:mt.path})),C=r.createHref(A);return ne({fullPath:A,hash:Zt,query:i===zp?MI($.query):$.query||{}},mt,{redirectedFrom:void 0,href:C})}function X($){return typeof $=="string"?Ju(n,$,d.value.path):ne({},$)}function Q($,ct){if(p!==$)return fo(8,{from:ct,to:$})}function tt($){return k($)}function Et($){return tt(ne(X($),{replace:!0}))}function kt($){const ct=$.matched[$.matched.length-1];if(ct&&ct.redirect){const{redirect:ut}=ct;let mt=typeof ut=="function"?ut($):ut;return typeof mt=="string"&&(mt=mt.includes("?")||mt.includes("#")?mt=X(mt):{path:mt},mt.params={}),ne({query:$.query,hash:$.hash,params:mt.path!=null?{}:$.params},mt)}}function k($,ct){const ut=p=et($),mt=d.value,Zt=$.state,A=$.force,C=$.replace===!0,N=kt(ut);if(N)return k(ne(X(N),{state:typeof N=="object"?ne({},Zt,N.state):Zt,force:A,replace:C}),ct||ut);const q=ut;q.redirectedFrom=ct;let G;return!A&&iI(i,mt,ut)&&(G=fo(16,{to:q,from:mt}),Gt(mt,mt,!0,!1)),(G?Promise.resolve(G):M(q,mt)).catch(W=>Bi(W)?Bi(W,2)?W:vt(W):at(W,q,mt)).then(W=>{if(W){if(Bi(W,2))return k(ne({replace:C},X(W.to),{state:typeof W.to=="object"?ne({},Zt,W.to.state):Zt,force:A}),ct||q)}else W=D(q,mt,!0,C,Zt);return O(q,mt,W),W})}function P($,ct){const ut=Q($,ct);return ut?Promise.reject(ut):Promise.resolve()}function S($){const ct=oe.values().next().value;return ct&&typeof ct.runWithContext=="function"?ct.runWithContext($):$()}function M($,ct){let ut;const[mt,Zt,A]=HI($,ct);ut=th(mt.reverse(),"beforeRouteLeave",$,ct);for(const N of mt)N.leaveGuards.forEach(q=>{ut.push(_s(q,$,ct))});const C=P.bind(null,$,ct);return ut.push(C),At(ut).then(()=>{ut=[];for(const N of o.list())ut.push(_s(N,$,ct));return ut.push(C),At(ut)}).then(()=>{ut=th(Zt,"beforeRouteUpdate",$,ct);for(const N of Zt)N.updateGuards.forEach(q=>{ut.push(_s(q,$,ct))});return ut.push(C),At(ut)}).then(()=>{ut=[];for(const N of A)if(N.beforeEnter)if(si(N.beforeEnter))for(const q of N.beforeEnter)ut.push(_s(q,$,ct));else ut.push(_s(N.beforeEnter,$,ct));return ut.push(C),At(ut)}).then(()=>($.matched.forEach(N=>N.enterCallbacks={}),ut=th(A,"beforeRouteEnter",$,ct,S),ut.push(C),At(ut))).then(()=>{ut=[];for(const N of l.list())ut.push(_s(N,$,ct));return ut.push(C),At(ut)}).catch(N=>Bi(N,8)?N:Promise.reject(N))}function O($,ct,ut){h.list().forEach(mt=>S(()=>mt($,ct,ut)))}function D($,ct,ut,mt,Zt){const A=Q($,ct);if(A)return A;const C=ct===ds,N=Gr?history.state:{};ut&&(mt||C?r.replace($.fullPath,ne({scroll:C&&N&&N.scroll},Zt)):r.push($.fullPath,Zt)),d.value=$,Gt($,ct,ut,C),vt()}let R;function _e(){R||(R=r.listen(($,ct,ut)=>{if(!zt.listening)return;const mt=et($),Zt=kt(mt);if(Zt){k(ne(Zt,{replace:!0,force:!0}),mt).catch(Ra);return}p=mt;const A=d.value;Gr&&hI(Lp(A.fullPath,ut.delta),ou()),M(mt,A).catch(C=>Bi(C,12)?C:Bi(C,2)?(k(ne(X(C.to),{force:!0}),mt).then(N=>{Bi(N,20)&&!ut.delta&&ut.type===$a.pop&&r.go(-1,!1)}).catch(Ra),Promise.reject()):(ut.delta&&r.go(-ut.delta,!1),at(C,mt,A))).then(C=>{C=C||D(mt,A,!1),C&&(ut.delta&&!Bi(C,8)?r.go(-ut.delta,!1):ut.type===$a.pop&&Bi(C,20)&&r.go(-1,!1)),O(mt,A,C)}).catch(Ra)}))}let _n=ua(),Jt=ua(),Ft;function at($,ct,ut){vt($);const mt=Jt.list();return mt.length?mt.forEach(Zt=>Zt($,ct,ut)):console.error($),Promise.reject($)}function Qe(){return Ft&&d.value!==ds?Promise.resolve():new Promise(($,ct)=>{_n.add([$,ct])})}function vt($){return Ft||(Ft=!$,_e(),_n.list().forEach(([ct,ut])=>$?ut($):ct()),_n.reset()),$}function Gt($,ct,ut,mt){const{scrollBehavior:Zt}=e;if(!Gr||!Zt)return Promise.resolve();const A=!ut&&dI(Lp($.fullPath,0))||(mt||!ut)&&history.state&&history.state.scroll||null;return _d().then(()=>Zt($,ct,A)).then(C=>C&&uI(C)).catch(C=>at(C,$,ct))}const Ht=$=>r.go($);let $t;const oe=new Set,zt={currentRoute:d,listening:!0,addRoute:I,removeRoute:U,clearRoutes:t.clearRoutes,hasRoute:j,getRoutes:B,resolve:et,options:e,push:tt,replace:Et,go:Ht,back:()=>Ht(-1),forward:()=>Ht(1),beforeEach:o.add,beforeResolve:l.add,afterEach:h.add,onError:Jt.add,isReady:Qe,install($){const ct=this;$.component("RouterLink",VI),$.component("RouterView",zI),$.config.globalProperties.$router=ct,Object.defineProperty($.config.globalProperties,"$route",{enumerable:!0,get:()=>no(d)}),Gr&&!$t&&d.value===ds&&($t=!0,tt(r.location).catch(Zt=>{}));const ut={};for(const Zt in ds)Object.defineProperty(ut,Zt,{get:()=>d.value[Zt],enumerable:!0});$.provide(au,ct),$.provide(Yg,Y_(ut)),$.provide(Ch,d);const mt=$.unmount;oe.add($),$.unmount=function(){oe.delete($),oe.size<1&&(p=ds,R&&R(),R=null,d.value=ds,$t=!1,Ft=!1),mt()}}};function At($){return $.reduce((ct,ut)=>ct.then(()=>S(ut)),Promise.resolve())}return zt}function HI(e,t){const n=[],i=[],r=[],o=Math.max(t.matched.length,e.matched.length);for(let l=0;l<o;l++){const h=t.matched[l];h&&(e.matched.find(p=>ho(p,h))?i.push(h):n.push(h));const d=e.matched[l];d&&(t.matched.find(p=>ho(p,d))||r.push(d))}return[n,i,r]}function lu(){return vi(au)}const bd="/TripMaster/icons/icon-192x192.png",$I={name:"Home",setup(){const e=lu();return{goToLogin:()=>{e.push("/login")},goToRegister:()=>{e.push("/register")},goToInfo:()=>{e.push("/info")}}}},qI={class:"home-page d-flex flex-column justify-content-center align-items-center min-vh-100 p-3 p-md-5"},WI={class:"auth-buttons d-flex flex-wrap justify-content-center gap-3 mb-4"},KI={class:"info-button"};function GI(e,t,n,i,r,o){return rt(),lt("div",qI,[t[3]||(t[3]=wd('<div class="logo-container text-center mb-4" data-v-0a155877><img src="'+bd+'" alt="TripMaster Logo" class="app-logo img-fluid" data-v-0a155877></div><div class="welcome-text text-center my-4" data-v-0a155877><h1 class="display-4 display-md-3 text-success" data-v-0a155877>TripMaster</h1><p class="slogan lead text-muted" data-v-0a155877>Start your adventure today and make every journey unforgettable!</p></div>',2)),E("div",WI,[E("button",{onClick:t[0]||(t[0]=(...l)=>i.goToLogin&&i.goToLogin(...l)),class:"btn btn-success px-4 py-2"},"Login"),E("button",{onClick:t[1]||(t[1]=(...l)=>i.goToRegister&&i.goToRegister(...l)),class:"btn btn-success px-4 py-2"},"Register")]),E("div",KI,[E("button",{onClick:t[2]||(t[2]=(...l)=>i.goToInfo&&i.goToInfo(...l)),class:"btn btn-outline-success px-4 py-2"},"Find out more about the app")])])}const ZI=In($I,[["render",GI],["__scopeId","data-v-0a155877"]]),QI=()=>{};var Kp={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xg=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=r&63|128):(r&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(e.charCodeAt(++i)&1023),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=r&63|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=r&63|128)}return t},YI=function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const o=e[n++];t[i++]=String.fromCharCode((r&31)<<6|o&63)}else if(r>239&&r<365){const o=e[n++],l=e[n++],h=e[n++],d=((r&7)<<18|(o&63)<<12|(l&63)<<6|h&63)-65536;t[i++]=String.fromCharCode(55296+(d>>10)),t[i++]=String.fromCharCode(56320+(d&1023))}else{const o=e[n++],l=e[n++];t[i++]=String.fromCharCode((r&15)<<12|(o&63)<<6|l&63)}}return t.join("")},Jg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<e.length;r+=3){const o=e[r],l=r+1<e.length,h=l?e[r+1]:0,d=r+2<e.length,p=d?e[r+2]:0,_=o>>2,y=(o&3)<<4|h>>4;let T=(h&15)<<2|p>>6,I=p&63;d||(I=64,l||(T=64)),i.push(n[_],n[y],n[T],n[I])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Xg(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):YI(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<e.length;){const o=n[e.charAt(r++)],h=r<e.length?n[e.charAt(r)]:0;++r;const p=r<e.length?n[e.charAt(r)]:64;++r;const y=r<e.length?n[e.charAt(r)]:64;if(++r,o==null||h==null||p==null||y==null)throw new XI;const T=o<<2|h>>4;if(i.push(T),p!==64){const I=h<<4&240|p>>2;if(i.push(I),y!==64){const U=p<<6&192|y;i.push(U)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class XI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const JI=function(e){const t=Xg(e);return Jg.encodeByteArray(t,!0)},Rc=function(e){return JI(e).replace(/\./g,"")},tv=function(e){try{return Jg.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t0(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e0=()=>t0().__FIREBASE_DEFAULTS__,n0=()=>{if(typeof process>"u"||typeof Kp>"u")return;const e=Kp.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},i0=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&tv(e[1]);return t&&JSON.parse(t)},cu=()=>{try{return QI()||e0()||n0()||i0()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},ev=e=>{var t,n;return(n=(t=cu())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},nv=e=>{const t=ev(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),i]:[t.substring(0,n),i]},iv=()=>{var e;return(e=cu())===null||e===void 0?void 0:e.config},sv=e=>{var t;return(t=cu())===null||t===void 0?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rv(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=t||"demo-project",r=e.iat||0,o=e.sub||e.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Rc(JSON.stringify(n)),Rc(JSON.stringify(l)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ln(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function r0(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ln())}function o0(){var e;const t=(e=cu())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function a0(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function l0(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function c0(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function u0(){const e=ln();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function h0(){return!o0()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function d0(){try{return typeof indexedDB=="object"}catch{return!1}}function f0(){return new Promise((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var o;t(((o=r.error)===null||o===void 0?void 0:o.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p0="FirebaseError";class Ai extends Error{constructor(t,n,i){super(n),this.code=t,this.customData=i,this.name=p0,Object.setPrototypeOf(this,Ai.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ol.prototype.create)}}class ol{constructor(t,n,i){this.service=t,this.serviceName=n,this.errors=i}create(t,...n){const i=n[0]||{},r=`${this.service}/${t}`,o=this.errors[t],l=o?m0(o,i):"Error",h=`${this.serviceName}: ${l} (${r}).`;return new Ai(r,h,i)}}function m0(e,t){return e.replace(_0,(n,i)=>{const r=t[i];return r!=null?String(r):`<${i}?>`})}const _0=/\{\$([^}]+)}/g;function g0(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function dr(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const o=e[r],l=t[r];if(Gp(o)&&Gp(l)){if(!dr(o,l))return!1}else if(o!==l)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function Gp(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function al(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach(r=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function fa(e){const t={};return e.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[r,o]=i.split("=");t[decodeURIComponent(r)]=decodeURIComponent(o)}}),t}function pa(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function v0(e,t){const n=new y0(e,t);return n.subscribe.bind(n)}class y0{constructor(t,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{t(this)}).catch(i=>{this.error(i)})}next(t){this.forEachObserver(n=>{n.next(t)})}error(t){this.forEachObserver(n=>{n.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,n,i){let r;if(t===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");w0(t,["next","error","complete"])?r=t:r={next:t,error:n,complete:i},r.next===void 0&&(r.next=eh),r.error===void 0&&(r.error=eh),r.complete===void 0&&(r.complete=eh);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),o}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,t)}sendOne(t,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{n(this.observers[t])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function w0(e,t){if(typeof e!="object"||e===null)return!1;for(const n of t)if(n in e&&typeof e[n]=="function")return!0;return!1}function eh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Te(e){return e&&e._delegate?e._delegate:e}class Ss{constructor(t,n,i){this.name=t,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const i=new s0;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),r=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(r)return null;throw o}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(b0(t))try{this.getOrInitializeService({instanceIdentifier:sr})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:r});i.resolve(o)}catch{}}}}clearInstance(t=sr){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=sr){return this.instances.has(t)}getOptions(t=sr){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[o,l]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(o);i===h&&l.resolve(r)}return r}onInit(t,n){var i;const r=this.normalizeInstanceIdentifier(n),o=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;o.add(t),this.onInitCallbacks.set(r,o);const l=this.instances.get(r);return l&&t(l,r),()=>{o.delete(t)}}invokeOnInitCallbacks(t,n){const i=this.onInitCallbacks.get(n);if(i)for(const r of i)try{r(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:E0(t),options:n}),this.instances.set(t,i),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=sr){return this.component?this.component.multipleInstances?t:sr:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function E0(e){return e===sr?void 0:e}function b0(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new T0(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yt;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Yt||(Yt={}));const P0={debug:Yt.DEBUG,verbose:Yt.VERBOSE,info:Yt.INFO,warn:Yt.WARN,error:Yt.ERROR,silent:Yt.SILENT},A0=Yt.INFO,C0={[Yt.DEBUG]:"log",[Yt.VERBOSE]:"log",[Yt.INFO]:"info",[Yt.WARN]:"warn",[Yt.ERROR]:"error"},R0=(e,t,...n)=>{if(t<e.logLevel)return;const i=new Date().toISOString(),r=C0[t];if(r)console[r](`[${i}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Id{constructor(t){this.name=t,this._logLevel=A0,this._logHandler=R0,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Yt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?P0[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Yt.DEBUG,...t),this._logHandler(this,Yt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Yt.VERBOSE,...t),this._logHandler(this,Yt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Yt.INFO,...t),this._logHandler(this,Yt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Yt.WARN,...t),this._logHandler(this,Yt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Yt.ERROR,...t),this._logHandler(this,Yt.ERROR,...t)}}const S0=(e,t)=>t.some(n=>e instanceof n);let Zp,Qp;function x0(){return Zp||(Zp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function k0(){return Qp||(Qp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ov=new WeakMap,Rh=new WeakMap,av=new WeakMap,nh=new WeakMap,Pd=new WeakMap;function L0(e){const t=new Promise((n,i)=>{const r=()=>{e.removeEventListener("success",o),e.removeEventListener("error",l)},o=()=>{n(Ps(e.result)),r()},l=()=>{i(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",l)});return t.then(n=>{n instanceof IDBCursor&&ov.set(n,e)}).catch(()=>{}),Pd.set(t,e),t}function M0(e){if(Rh.has(e))return;const t=new Promise((n,i)=>{const r=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",l),e.removeEventListener("abort",l)},o=()=>{n(),r()},l=()=>{i(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",o),e.addEventListener("error",l),e.addEventListener("abort",l)});Rh.set(e,t)}let Sh={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Rh.get(e);if(t==="objectStoreNames")return e.objectStoreNames||av.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ps(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function O0(e){Sh=e(Sh)}function D0(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const i=e.call(ih(this),t,...n);return av.set(i,t.sort?t.sort():[t]),Ps(i)}:k0().includes(e)?function(...t){return e.apply(ih(this),t),Ps(ov.get(this))}:function(...t){return Ps(e.apply(ih(this),t))}}function N0(e){return typeof e=="function"?D0(e):(e instanceof IDBTransaction&&M0(e),S0(e,x0())?new Proxy(e,Sh):e)}function Ps(e){if(e instanceof IDBRequest)return L0(e);if(nh.has(e))return nh.get(e);const t=N0(e);return t!==e&&(nh.set(e,t),Pd.set(t,e)),t}const ih=e=>Pd.get(e);function V0(e,t,{blocked:n,upgrade:i,blocking:r,terminated:o}={}){const l=indexedDB.open(e,t),h=Ps(l);return i&&l.addEventListener("upgradeneeded",d=>{i(Ps(l.result),d.oldVersion,d.newVersion,Ps(l.transaction),d)}),n&&l.addEventListener("blocked",d=>n(d.oldVersion,d.newVersion,d)),h.then(d=>{o&&d.addEventListener("close",()=>o()),r&&d.addEventListener("versionchange",p=>r(p.oldVersion,p.newVersion,p))}).catch(()=>{}),h}const U0=["get","getKey","getAll","getAllKeys","count"],F0=["put","add","delete","clear"],sh=new Map;function Yp(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(sh.get(t))return sh.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=F0.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(r||U0.includes(n)))return;const o=async function(l,...h){const d=this.transaction(l,r?"readwrite":"readonly");let p=d.store;return i&&(p=p.index(h.shift())),(await Promise.all([p[n](...h),r&&d.done]))[0]};return sh.set(t,o),o}O0(e=>({...e,get:(t,n,i)=>Yp(t,n)||e.get(t,n,i),has:(t,n)=>!!Yp(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(z0(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function z0(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const xh="@firebase/app",Xp="0.11.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi=new Id("@firebase/app"),j0="@firebase/app-compat",H0="@firebase/analytics-compat",$0="@firebase/analytics",q0="@firebase/app-check-compat",W0="@firebase/app-check",K0="@firebase/auth",G0="@firebase/auth-compat",Z0="@firebase/database",Q0="@firebase/data-connect",Y0="@firebase/database-compat",X0="@firebase/functions",J0="@firebase/functions-compat",tP="@firebase/installations",eP="@firebase/installations-compat",nP="@firebase/messaging",iP="@firebase/messaging-compat",sP="@firebase/performance",rP="@firebase/performance-compat",oP="@firebase/remote-config",aP="@firebase/remote-config-compat",lP="@firebase/storage",cP="@firebase/storage-compat",uP="@firebase/firestore",hP="@firebase/vertexai",dP="@firebase/firestore-compat",fP="firebase",pP="11.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kh="[DEFAULT]",mP={[xh]:"fire-core",[j0]:"fire-core-compat",[$0]:"fire-analytics",[H0]:"fire-analytics-compat",[W0]:"fire-app-check",[q0]:"fire-app-check-compat",[K0]:"fire-auth",[G0]:"fire-auth-compat",[Z0]:"fire-rtdb",[Q0]:"fire-data-connect",[Y0]:"fire-rtdb-compat",[X0]:"fire-fn",[J0]:"fire-fn-compat",[tP]:"fire-iid",[eP]:"fire-iid-compat",[nP]:"fire-fcm",[iP]:"fire-fcm-compat",[sP]:"fire-perf",[rP]:"fire-perf-compat",[oP]:"fire-rc",[aP]:"fire-rc-compat",[lP]:"fire-gcs",[cP]:"fire-gcs-compat",[uP]:"fire-fst",[dP]:"fire-fst-compat",[hP]:"fire-vertex","fire-js":"fire-js",[fP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sc=new Map,_P=new Map,Lh=new Map;function Jp(e,t){try{e.container.addComponent(t)}catch(n){Yi.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function fr(e){const t=e.name;if(Lh.has(t))return Yi.debug(`There were multiple attempts to register component ${t}.`),!1;Lh.set(t,e);for(const n of Sc.values())Jp(n,e);for(const n of _P.values())Jp(n,e);return!0}function uu(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Tn(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},As=new ol("app","Firebase",gP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(t,n,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Ss("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw As.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yr=pP;function lv(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const i=Object.assign({name:kh,automaticDataCollectionEnabled:!1},t),r=i.name;if(typeof r!="string"||!r)throw As.create("bad-app-name",{appName:String(r)});if(n||(n=iv()),!n)throw As.create("no-options");const o=Sc.get(r);if(o){if(dr(n,o.options)&&dr(i,o.config))return o;throw As.create("duplicate-app",{appName:r})}const l=new I0(r);for(const d of Lh.values())l.addComponent(d);const h=new vP(n,i,l);return Sc.set(r,h),h}function Ad(e=kh){const t=Sc.get(e);if(!t&&e===kh&&iv())return lv();if(!t)throw As.create("no-app",{appName:e});return t}function yi(e,t,n){var i;let r=(i=mP[e])!==null&&i!==void 0?i:e;n&&(r+=`-${n}`);const o=r.match(/\s|\//),l=t.match(/\s|\//);if(o||l){const h=[`Unable to register library "${r}" with version "${t}":`];o&&h.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&l&&h.push("and"),l&&h.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Yi.warn(h.join(" "));return}fr(new Ss(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yP="firebase-heartbeat-database",wP=1,qa="firebase-heartbeat-store";let rh=null;function cv(){return rh||(rh=V0(yP,wP,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(qa)}catch(n){console.warn(n)}}}}).catch(e=>{throw As.create("idb-open",{originalErrorMessage:e.message})})),rh}async function TP(e){try{const n=(await cv()).transaction(qa),i=await n.objectStore(qa).get(uv(e));return await n.done,i}catch(t){if(t instanceof Ai)Yi.warn(t.message);else{const n=As.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Yi.warn(n.message)}}}async function tm(e,t){try{const i=(await cv()).transaction(qa,"readwrite");await i.objectStore(qa).put(t,uv(e)),await i.done}catch(n){if(n instanceof Ai)Yi.warn(n.message);else{const i=As.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Yi.warn(i.message)}}}function uv(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EP=1024,bP=30;class IP{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new AP(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=em();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(l=>l.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:r}),this._heartbeatsCache.heartbeats.length>bP){const l=CP(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Yi.warn(i)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=em(),{heartbeatsToSend:i,unsentEntries:r}=PP(this._heartbeatsCache.heartbeats),o=Rc(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return Yi.warn(n),""}}}function em(){return new Date().toISOString().substring(0,10)}function PP(e,t=EP){const n=[];let i=e.slice();for(const r of e){const o=n.find(l=>l.agent===r.agent);if(o){if(o.dates.push(r.date),nm(n)>t){o.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),nm(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class AP{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return d0()?f0().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await TP(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return tm(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return tm(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}else return}}function nm(e){return Rc(JSON.stringify({version:2,heartbeats:e})).length}function CP(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let i=1;i<e.length;i++)e[i].date<n&&(n=e[i].date,t=i);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RP(e){fr(new Ss("platform-logger",t=>new B0(t),"PRIVATE")),fr(new Ss("heartbeat",t=>new IP(t),"PRIVATE")),yi(xh,Xp,e),yi(xh,Xp,"esm2017"),yi("fire-js","")}RP("");var im=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Cs,hv;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(k,P){function S(){}S.prototype=P.prototype,k.D=P.prototype,k.prototype=new S,k.prototype.constructor=k,k.C=function(M,O,D){for(var R=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)R[_e-2]=arguments[_e];return P.prototype[O].apply(M,R)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(i,n),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(k,P,S){S||(S=0);var M=Array(16);if(typeof P=="string")for(var O=0;16>O;++O)M[O]=P.charCodeAt(S++)|P.charCodeAt(S++)<<8|P.charCodeAt(S++)<<16|P.charCodeAt(S++)<<24;else for(O=0;16>O;++O)M[O]=P[S++]|P[S++]<<8|P[S++]<<16|P[S++]<<24;P=k.g[0],S=k.g[1],O=k.g[2];var D=k.g[3],R=P+(D^S&(O^D))+M[0]+3614090360&4294967295;P=S+(R<<7&4294967295|R>>>25),R=D+(O^P&(S^O))+M[1]+3905402710&4294967295,D=P+(R<<12&4294967295|R>>>20),R=O+(S^D&(P^S))+M[2]+606105819&4294967295,O=D+(R<<17&4294967295|R>>>15),R=S+(P^O&(D^P))+M[3]+3250441966&4294967295,S=O+(R<<22&4294967295|R>>>10),R=P+(D^S&(O^D))+M[4]+4118548399&4294967295,P=S+(R<<7&4294967295|R>>>25),R=D+(O^P&(S^O))+M[5]+1200080426&4294967295,D=P+(R<<12&4294967295|R>>>20),R=O+(S^D&(P^S))+M[6]+2821735955&4294967295,O=D+(R<<17&4294967295|R>>>15),R=S+(P^O&(D^P))+M[7]+4249261313&4294967295,S=O+(R<<22&4294967295|R>>>10),R=P+(D^S&(O^D))+M[8]+1770035416&4294967295,P=S+(R<<7&4294967295|R>>>25),R=D+(O^P&(S^O))+M[9]+2336552879&4294967295,D=P+(R<<12&4294967295|R>>>20),R=O+(S^D&(P^S))+M[10]+4294925233&4294967295,O=D+(R<<17&4294967295|R>>>15),R=S+(P^O&(D^P))+M[11]+2304563134&4294967295,S=O+(R<<22&4294967295|R>>>10),R=P+(D^S&(O^D))+M[12]+1804603682&4294967295,P=S+(R<<7&4294967295|R>>>25),R=D+(O^P&(S^O))+M[13]+4254626195&4294967295,D=P+(R<<12&4294967295|R>>>20),R=O+(S^D&(P^S))+M[14]+2792965006&4294967295,O=D+(R<<17&4294967295|R>>>15),R=S+(P^O&(D^P))+M[15]+1236535329&4294967295,S=O+(R<<22&4294967295|R>>>10),R=P+(O^D&(S^O))+M[1]+4129170786&4294967295,P=S+(R<<5&4294967295|R>>>27),R=D+(S^O&(P^S))+M[6]+3225465664&4294967295,D=P+(R<<9&4294967295|R>>>23),R=O+(P^S&(D^P))+M[11]+643717713&4294967295,O=D+(R<<14&4294967295|R>>>18),R=S+(D^P&(O^D))+M[0]+3921069994&4294967295,S=O+(R<<20&4294967295|R>>>12),R=P+(O^D&(S^O))+M[5]+3593408605&4294967295,P=S+(R<<5&4294967295|R>>>27),R=D+(S^O&(P^S))+M[10]+38016083&4294967295,D=P+(R<<9&4294967295|R>>>23),R=O+(P^S&(D^P))+M[15]+3634488961&4294967295,O=D+(R<<14&4294967295|R>>>18),R=S+(D^P&(O^D))+M[4]+3889429448&4294967295,S=O+(R<<20&4294967295|R>>>12),R=P+(O^D&(S^O))+M[9]+568446438&4294967295,P=S+(R<<5&4294967295|R>>>27),R=D+(S^O&(P^S))+M[14]+3275163606&4294967295,D=P+(R<<9&4294967295|R>>>23),R=O+(P^S&(D^P))+M[3]+4107603335&4294967295,O=D+(R<<14&4294967295|R>>>18),R=S+(D^P&(O^D))+M[8]+1163531501&4294967295,S=O+(R<<20&4294967295|R>>>12),R=P+(O^D&(S^O))+M[13]+2850285829&4294967295,P=S+(R<<5&4294967295|R>>>27),R=D+(S^O&(P^S))+M[2]+4243563512&4294967295,D=P+(R<<9&4294967295|R>>>23),R=O+(P^S&(D^P))+M[7]+1735328473&4294967295,O=D+(R<<14&4294967295|R>>>18),R=S+(D^P&(O^D))+M[12]+2368359562&4294967295,S=O+(R<<20&4294967295|R>>>12),R=P+(S^O^D)+M[5]+4294588738&4294967295,P=S+(R<<4&4294967295|R>>>28),R=D+(P^S^O)+M[8]+2272392833&4294967295,D=P+(R<<11&4294967295|R>>>21),R=O+(D^P^S)+M[11]+1839030562&4294967295,O=D+(R<<16&4294967295|R>>>16),R=S+(O^D^P)+M[14]+4259657740&4294967295,S=O+(R<<23&4294967295|R>>>9),R=P+(S^O^D)+M[1]+2763975236&4294967295,P=S+(R<<4&4294967295|R>>>28),R=D+(P^S^O)+M[4]+1272893353&4294967295,D=P+(R<<11&4294967295|R>>>21),R=O+(D^P^S)+M[7]+4139469664&4294967295,O=D+(R<<16&4294967295|R>>>16),R=S+(O^D^P)+M[10]+3200236656&4294967295,S=O+(R<<23&4294967295|R>>>9),R=P+(S^O^D)+M[13]+681279174&4294967295,P=S+(R<<4&4294967295|R>>>28),R=D+(P^S^O)+M[0]+3936430074&4294967295,D=P+(R<<11&4294967295|R>>>21),R=O+(D^P^S)+M[3]+3572445317&4294967295,O=D+(R<<16&4294967295|R>>>16),R=S+(O^D^P)+M[6]+76029189&4294967295,S=O+(R<<23&4294967295|R>>>9),R=P+(S^O^D)+M[9]+3654602809&4294967295,P=S+(R<<4&4294967295|R>>>28),R=D+(P^S^O)+M[12]+3873151461&4294967295,D=P+(R<<11&4294967295|R>>>21),R=O+(D^P^S)+M[15]+530742520&4294967295,O=D+(R<<16&4294967295|R>>>16),R=S+(O^D^P)+M[2]+3299628645&4294967295,S=O+(R<<23&4294967295|R>>>9),R=P+(O^(S|~D))+M[0]+4096336452&4294967295,P=S+(R<<6&4294967295|R>>>26),R=D+(S^(P|~O))+M[7]+1126891415&4294967295,D=P+(R<<10&4294967295|R>>>22),R=O+(P^(D|~S))+M[14]+2878612391&4294967295,O=D+(R<<15&4294967295|R>>>17),R=S+(D^(O|~P))+M[5]+4237533241&4294967295,S=O+(R<<21&4294967295|R>>>11),R=P+(O^(S|~D))+M[12]+1700485571&4294967295,P=S+(R<<6&4294967295|R>>>26),R=D+(S^(P|~O))+M[3]+2399980690&4294967295,D=P+(R<<10&4294967295|R>>>22),R=O+(P^(D|~S))+M[10]+4293915773&4294967295,O=D+(R<<15&4294967295|R>>>17),R=S+(D^(O|~P))+M[1]+2240044497&4294967295,S=O+(R<<21&4294967295|R>>>11),R=P+(O^(S|~D))+M[8]+1873313359&4294967295,P=S+(R<<6&4294967295|R>>>26),R=D+(S^(P|~O))+M[15]+4264355552&4294967295,D=P+(R<<10&4294967295|R>>>22),R=O+(P^(D|~S))+M[6]+2734768916&4294967295,O=D+(R<<15&4294967295|R>>>17),R=S+(D^(O|~P))+M[13]+1309151649&4294967295,S=O+(R<<21&4294967295|R>>>11),R=P+(O^(S|~D))+M[4]+4149444226&4294967295,P=S+(R<<6&4294967295|R>>>26),R=D+(S^(P|~O))+M[11]+3174756917&4294967295,D=P+(R<<10&4294967295|R>>>22),R=O+(P^(D|~S))+M[2]+718787259&4294967295,O=D+(R<<15&4294967295|R>>>17),R=S+(D^(O|~P))+M[9]+3951481745&4294967295,k.g[0]=k.g[0]+P&4294967295,k.g[1]=k.g[1]+(O+(R<<21&4294967295|R>>>11))&4294967295,k.g[2]=k.g[2]+O&4294967295,k.g[3]=k.g[3]+D&4294967295}i.prototype.u=function(k,P){P===void 0&&(P=k.length);for(var S=P-this.blockSize,M=this.B,O=this.h,D=0;D<P;){if(O==0)for(;D<=S;)r(this,k,D),D+=this.blockSize;if(typeof k=="string"){for(;D<P;)if(M[O++]=k.charCodeAt(D++),O==this.blockSize){r(this,M),O=0;break}}else for(;D<P;)if(M[O++]=k[D++],O==this.blockSize){r(this,M),O=0;break}}this.h=O,this.o+=P},i.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var P=1;P<k.length-8;++P)k[P]=0;var S=8*this.o;for(P=k.length-8;P<k.length;++P)k[P]=S&255,S/=256;for(this.u(k),k=Array(16),P=S=0;4>P;++P)for(var M=0;32>M;M+=8)k[S++]=this.g[P]>>>M&255;return k};function o(k,P){var S=h;return Object.prototype.hasOwnProperty.call(S,k)?S[k]:S[k]=P(k)}function l(k,P){this.h=P;for(var S=[],M=!0,O=k.length-1;0<=O;O--){var D=k[O]|0;M&&D==P||(S[O]=D,M=!1)}this.g=S}var h={};function d(k){return-128<=k&&128>k?o(k,function(P){return new l([P|0],0>P?-1:0)}):new l([k|0],0>k?-1:0)}function p(k){if(isNaN(k)||!isFinite(k))return y;if(0>k)return j(p(-k));for(var P=[],S=1,M=0;k>=S;M++)P[M]=k/S|0,S*=4294967296;return new l(P,0)}function _(k,P){if(k.length==0)throw Error("number format error: empty string");if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(k.charAt(0)=="-")return j(_(k.substring(1),P));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=p(Math.pow(P,8)),M=y,O=0;O<k.length;O+=8){var D=Math.min(8,k.length-O),R=parseInt(k.substring(O,O+D),P);8>D?(D=p(Math.pow(P,D)),M=M.j(D).add(p(R))):(M=M.j(S),M=M.add(p(R)))}return M}var y=d(0),T=d(1),I=d(16777216);e=l.prototype,e.m=function(){if(B(this))return-j(this).m();for(var k=0,P=1,S=0;S<this.g.length;S++){var M=this.i(S);k+=(0<=M?M:4294967296+M)*P,P*=4294967296}return k},e.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(U(this))return"0";if(B(this))return"-"+j(this).toString(k);for(var P=p(Math.pow(k,6)),S=this,M="";;){var O=tt(S,P).g;S=et(S,O.j(P));var D=((0<S.g.length?S.g[0]:S.h)>>>0).toString(k);if(S=O,U(S))return D+M;for(;6>D.length;)D="0"+D;M=D+M}},e.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function U(k){if(k.h!=0)return!1;for(var P=0;P<k.g.length;P++)if(k.g[P]!=0)return!1;return!0}function B(k){return k.h==-1}e.l=function(k){return k=et(this,k),B(k)?-1:U(k)?0:1};function j(k){for(var P=k.g.length,S=[],M=0;M<P;M++)S[M]=~k.g[M];return new l(S,~k.h).add(T)}e.abs=function(){return B(this)?j(this):this},e.add=function(k){for(var P=Math.max(this.g.length,k.g.length),S=[],M=0,O=0;O<=P;O++){var D=M+(this.i(O)&65535)+(k.i(O)&65535),R=(D>>>16)+(this.i(O)>>>16)+(k.i(O)>>>16);M=R>>>16,D&=65535,R&=65535,S[O]=R<<16|D}return new l(S,S[S.length-1]&-2147483648?-1:0)};function et(k,P){return k.add(j(P))}e.j=function(k){if(U(this)||U(k))return y;if(B(this))return B(k)?j(this).j(j(k)):j(j(this).j(k));if(B(k))return j(this.j(j(k)));if(0>this.l(I)&&0>k.l(I))return p(this.m()*k.m());for(var P=this.g.length+k.g.length,S=[],M=0;M<2*P;M++)S[M]=0;for(M=0;M<this.g.length;M++)for(var O=0;O<k.g.length;O++){var D=this.i(M)>>>16,R=this.i(M)&65535,_e=k.i(O)>>>16,_n=k.i(O)&65535;S[2*M+2*O]+=R*_n,X(S,2*M+2*O),S[2*M+2*O+1]+=D*_n,X(S,2*M+2*O+1),S[2*M+2*O+1]+=R*_e,X(S,2*M+2*O+1),S[2*M+2*O+2]+=D*_e,X(S,2*M+2*O+2)}for(M=0;M<P;M++)S[M]=S[2*M+1]<<16|S[2*M];for(M=P;M<2*P;M++)S[M]=0;return new l(S,0)};function X(k,P){for(;(k[P]&65535)!=k[P];)k[P+1]+=k[P]>>>16,k[P]&=65535,P++}function Q(k,P){this.g=k,this.h=P}function tt(k,P){if(U(P))throw Error("division by zero");if(U(k))return new Q(y,y);if(B(k))return P=tt(j(k),P),new Q(j(P.g),j(P.h));if(B(P))return P=tt(k,j(P)),new Q(j(P.g),P.h);if(30<k.g.length){if(B(k)||B(P))throw Error("slowDivide_ only works with positive integers.");for(var S=T,M=P;0>=M.l(k);)S=Et(S),M=Et(M);var O=kt(S,1),D=kt(M,1);for(M=kt(M,2),S=kt(S,2);!U(M);){var R=D.add(M);0>=R.l(k)&&(O=O.add(S),D=R),M=kt(M,1),S=kt(S,1)}return P=et(k,O.j(P)),new Q(O,P)}for(O=y;0<=k.l(P);){for(S=Math.max(1,Math.floor(k.m()/P.m())),M=Math.ceil(Math.log(S)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),D=p(S),R=D.j(P);B(R)||0<R.l(k);)S-=M,D=p(S),R=D.j(P);U(D)&&(D=T),O=O.add(D),k=et(k,R)}return new Q(O,k)}e.A=function(k){return tt(this,k).h},e.and=function(k){for(var P=Math.max(this.g.length,k.g.length),S=[],M=0;M<P;M++)S[M]=this.i(M)&k.i(M);return new l(S,this.h&k.h)},e.or=function(k){for(var P=Math.max(this.g.length,k.g.length),S=[],M=0;M<P;M++)S[M]=this.i(M)|k.i(M);return new l(S,this.h|k.h)},e.xor=function(k){for(var P=Math.max(this.g.length,k.g.length),S=[],M=0;M<P;M++)S[M]=this.i(M)^k.i(M);return new l(S,this.h^k.h)};function Et(k){for(var P=k.g.length+1,S=[],M=0;M<P;M++)S[M]=k.i(M)<<1|k.i(M-1)>>>31;return new l(S,k.h)}function kt(k,P){var S=P>>5;P%=32;for(var M=k.g.length-S,O=[],D=0;D<M;D++)O[D]=0<P?k.i(D+S)>>>P|k.i(D+S+1)<<32-P:k.i(D+S);return new l(O,k.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,hv=i,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=p,l.fromString=_,Cs=l}).apply(typeof im<"u"?im:typeof self<"u"?self:typeof window<"u"?window:{});var Yl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var dv,ma,fv,uc,Mh,pv,mv,_v;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,m,v){return c==Array.prototype||c==Object.prototype||(c[m]=v.value),c};function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Yl=="object"&&Yl];for(var m=0;m<c.length;++m){var v=c[m];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var i=n(this);function r(c,m){if(m)t:{var v=i;c=c.split(".");for(var b=0;b<c.length-1;b++){var V=c[b];if(!(V in v))break t;v=v[V]}c=c[c.length-1],b=v[c],m=m(b),m!=b&&m!=null&&t(v,c,{configurable:!0,writable:!0,value:m})}}function o(c,m){c instanceof String&&(c+="");var v=0,b=!1,V={next:function(){if(!b&&v<c.length){var H=v++;return{value:m(H,c[H]),done:!1}}return b=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}r("Array.prototype.values",function(c){return c||function(){return o(this,function(m,v){return v})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},h=this||self;function d(c){var m=typeof c;return m=m!="object"?m:c?Array.isArray(c)?"array":m:"null",m=="array"||m=="object"&&typeof c.length=="number"}function p(c){var m=typeof c;return m=="object"&&c!=null||m=="function"}function _(c,m,v){return c.call.apply(c.bind,arguments)}function y(c,m,v){if(!c)throw Error();if(2<arguments.length){var b=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,b),c.apply(m,V)}}return function(){return c.apply(m,arguments)}}function T(c,m,v){return T=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:y,T.apply(null,arguments)}function I(c,m){var v=Array.prototype.slice.call(arguments,1);return function(){var b=v.slice();return b.push.apply(b,arguments),c.apply(this,b)}}function U(c,m){function v(){}v.prototype=m.prototype,c.aa=m.prototype,c.prototype=new v,c.prototype.constructor=c,c.Qb=function(b,V,H){for(var st=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)st[ae-2]=arguments[ae];return m.prototype[V].apply(b,st)}}function B(c){const m=c.length;if(0<m){const v=Array(m);for(let b=0;b<m;b++)v[b]=c[b];return v}return[]}function j(c,m){for(let v=1;v<arguments.length;v++){const b=arguments[v];if(d(b)){const V=c.length||0,H=b.length||0;c.length=V+H;for(let st=0;st<H;st++)c[V+st]=b[st]}else c.push(b)}}class et{constructor(m,v){this.i=m,this.j=v,this.h=0,this.g=null}get(){let m;return 0<this.h?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function X(c){return/^[\s\xa0]*$/.test(c)}function Q(){var c=h.navigator;return c&&(c=c.userAgent)?c:""}function tt(c){return tt[" "](c),c}tt[" "]=function(){};var Et=Q().indexOf("Gecko")!=-1&&!(Q().toLowerCase().indexOf("webkit")!=-1&&Q().indexOf("Edge")==-1)&&!(Q().indexOf("Trident")!=-1||Q().indexOf("MSIE")!=-1)&&Q().indexOf("Edge")==-1;function kt(c,m,v){for(const b in c)m.call(v,c[b],b,c)}function k(c,m){for(const v in c)m.call(void 0,c[v],v,c)}function P(c){const m={};for(const v in c)m[v]=c[v];return m}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(c,m){let v,b;for(let V=1;V<arguments.length;V++){b=arguments[V];for(v in b)c[v]=b[v];for(let H=0;H<S.length;H++)v=S[H],Object.prototype.hasOwnProperty.call(b,v)&&(c[v]=b[v])}}function O(c){var m=1;c=c.split(":");const v=[];for(;0<m&&c.length;)v.push(c.shift()),m--;return c.length&&v.push(c.join(":")),v}function D(c){h.setTimeout(()=>{throw c},0)}function R(){var c=Qe;let m=null;return c.g&&(m=c.g,c.g=c.g.next,c.g||(c.h=null),m.next=null),m}class _e{constructor(){this.h=this.g=null}add(m,v){const b=_n.get();b.set(m,v),this.h?this.h.next=b:this.g=b,this.h=b}}var _n=new et(()=>new Jt,c=>c.reset());class Jt{constructor(){this.next=this.g=this.h=null}set(m,v){this.h=m,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let Ft,at=!1,Qe=new _e,vt=()=>{const c=h.Promise.resolve(void 0);Ft=()=>{c.then(Gt)}};var Gt=()=>{for(var c;c=R();){try{c.h.call(c.g)}catch(v){D(v)}var m=_n;m.j(c),100>m.h&&(m.h++,c.next=m.g,m.g=c)}at=!1};function Ht(){this.s=this.s,this.C=this.C}Ht.prototype.s=!1,Ht.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ht.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function $t(c,m){this.type=c,this.g=this.target=m,this.defaultPrevented=!1}$t.prototype.h=function(){this.defaultPrevented=!0};var oe=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var c=!1,m=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const v=()=>{};h.addEventListener("test",v,m),h.removeEventListener("test",v,m)}catch{}return c}();function zt(c,m){if($t.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var v=this.type=c.type,b=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=m,m=c.relatedTarget){if(Et){t:{try{tt(m.nodeName);var V=!0;break t}catch{}V=!1}V||(m=null)}}else v=="mouseover"?m=c.fromElement:v=="mouseout"&&(m=c.toElement);this.relatedTarget=m,b?(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:At[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&zt.aa.h.call(this)}}U(zt,$t);var At={2:"touch",3:"pen",4:"mouse"};zt.prototype.h=function(){zt.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var $="closure_listenable_"+(1e6*Math.random()|0),ct=0;function ut(c,m,v,b,V){this.listener=c,this.proxy=null,this.src=m,this.type=v,this.capture=!!b,this.ha=V,this.key=++ct,this.da=this.fa=!1}function mt(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Zt(c){this.src=c,this.g={},this.h=0}Zt.prototype.add=function(c,m,v,b,V){var H=c.toString();c=this.g[H],c||(c=this.g[H]=[],this.h++);var st=C(c,m,b,V);return-1<st?(m=c[st],v||(m.fa=!1)):(m=new ut(m,this.src,H,!!b,V),m.fa=v,c.push(m)),m};function A(c,m){var v=m.type;if(v in c.g){var b=c.g[v],V=Array.prototype.indexOf.call(b,m,void 0),H;(H=0<=V)&&Array.prototype.splice.call(b,V,1),H&&(mt(m),c.g[v].length==0&&(delete c.g[v],c.h--))}}function C(c,m,v,b){for(var V=0;V<c.length;++V){var H=c[V];if(!H.da&&H.listener==m&&H.capture==!!v&&H.ha==b)return V}return-1}var N="closure_lm_"+(1e6*Math.random()|0),q={};function G(c,m,v,b,V){if(Array.isArray(m)){for(var H=0;H<m.length;H++)G(c,m[H],v,b,V);return null}return v=bt(v),c&&c[$]?c.K(m,v,p(b)?!!b.capture:!1,V):W(c,m,v,!1,b,V)}function W(c,m,v,b,V,H){if(!m)throw Error("Invalid event type");var st=p(V)?!!V.capture:!!V,ae=ht(c);if(ae||(c[N]=ae=new Zt(c)),v=ae.add(m,v,b,st,H),v.proxy)return v;if(b=ot(),v.proxy=b,b.src=c,b.listener=v,c.addEventListener)oe||(V=st),V===void 0&&(V=!1),c.addEventListener(m.toString(),b,V);else if(c.attachEvent)c.attachEvent(J(m.toString()),b);else if(c.addListener&&c.removeListener)c.addListener(b);else throw Error("addEventListener and attachEvent are unavailable.");return v}function ot(){function c(v){return m.call(c.src,c.listener,v)}const m=wt;return c}function it(c,m,v,b,V){if(Array.isArray(m))for(var H=0;H<m.length;H++)it(c,m[H],v,b,V);else b=p(b)?!!b.capture:!!b,v=bt(v),c&&c[$]?(c=c.i,m=String(m).toString(),m in c.g&&(H=c.g[m],v=C(H,v,b,V),-1<v&&(mt(H[v]),Array.prototype.splice.call(H,v,1),H.length==0&&(delete c.g[m],c.h--)))):c&&(c=ht(c))&&(m=c.g[m.toString()],c=-1,m&&(c=C(m,v,b,V)),(v=-1<c?m[c]:null)&&nt(v))}function nt(c){if(typeof c!="number"&&c&&!c.da){var m=c.src;if(m&&m[$])A(m.i,c);else{var v=c.type,b=c.proxy;m.removeEventListener?m.removeEventListener(v,b,c.capture):m.detachEvent?m.detachEvent(J(v),b):m.addListener&&m.removeListener&&m.removeListener(b),(v=ht(m))?(A(v,c),v.h==0&&(v.src=null,m[N]=null)):mt(c)}}}function J(c){return c in q?q[c]:q[c]="on"+c}function wt(c,m){if(c.da)c=!0;else{m=new zt(m,this);var v=c.listener,b=c.ha||c.src;c.fa&&nt(c),c=v.call(b,m)}return c}function ht(c){return c=c[N],c instanceof Zt?c:null}var _t="__closure_events_fn_"+(1e9*Math.random()>>>0);function bt(c){return typeof c=="function"?c:(c[_t]||(c[_t]=function(m){return c.handleEvent(m)}),c[_t])}function yt(){Ht.call(this),this.i=new Zt(this),this.M=this,this.F=null}U(yt,Ht),yt.prototype[$]=!0,yt.prototype.removeEventListener=function(c,m,v,b){it(this,c,m,v,b)};function Mt(c,m){var v,b=c.F;if(b)for(v=[];b;b=b.F)v.push(b);if(c=c.M,b=m.type||m,typeof m=="string")m=new $t(m,c);else if(m instanceof $t)m.target=m.target||c;else{var V=m;m=new $t(b,c),M(m,V)}if(V=!0,v)for(var H=v.length-1;0<=H;H--){var st=m.g=v[H];V=Wt(st,b,!0,m)&&V}if(st=m.g=c,V=Wt(st,b,!0,m)&&V,V=Wt(st,b,!1,m)&&V,v)for(H=0;H<v.length;H++)st=m.g=v[H],V=Wt(st,b,!1,m)&&V}yt.prototype.N=function(){if(yt.aa.N.call(this),this.i){var c=this.i,m;for(m in c.g){for(var v=c.g[m],b=0;b<v.length;b++)mt(v[b]);delete c.g[m],c.h--}}this.F=null},yt.prototype.K=function(c,m,v,b){return this.i.add(String(c),m,!1,v,b)},yt.prototype.L=function(c,m,v,b){return this.i.add(String(c),m,!0,v,b)};function Wt(c,m,v,b){if(m=c.i.g[String(m)],!m)return!0;m=m.concat();for(var V=!0,H=0;H<m.length;++H){var st=m[H];if(st&&!st.da&&st.capture==v){var ae=st.listener,Me=st.ha||st.src;st.fa&&A(c.i,st),V=ae.call(Me,b)!==!1&&V}}return V&&!b.defaultPrevented}function Be(c,m,v){if(typeof c=="function")v&&(c=T(c,v));else if(c&&typeof c.handleEvent=="function")c=T(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(m)?-1:h.setTimeout(c,m||0)}function ke(c){c.g=Be(()=>{c.g=null,c.i&&(c.i=!1,ke(c))},c.l);const m=c.h;c.h=null,c.m.apply(null,m)}class cn extends Ht{constructor(m,v){super(),this.m=m,this.l=v,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:ke(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ze(c){Ht.call(this),this.h=c,this.g={}}U(ze,Ht);var Gn=[];function Ci(c){kt(c.g,function(m,v){this.g.hasOwnProperty(v)&&nt(m)},c),c.g={}}ze.prototype.N=function(){ze.aa.N.call(this),Ci(this)},ze.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Le=h.JSON.stringify,gn=h.JSON.parse,oi=class{stringify(c){return h.JSON.stringify(c,void 0)}parse(c){return h.JSON.parse(c,void 0)}};function Lo(){}Lo.prototype.h=null;function vl(c){return c.h||(c.h=c.i())}function Mo(){}var is={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Er(){$t.call(this,"d")}U(Er,$t);function Oo(){$t.call(this,"c")}U(Oo,$t);var Ri={},yl=null;function br(){return yl=yl||new yt}Ri.La="serverreachability";function wl(c){$t.call(this,Ri.La,c)}U(wl,$t);function qs(c){const m=br();Mt(m,new wl(m))}Ri.STAT_EVENT="statevent";function Ir(c,m){$t.call(this,Ri.STAT_EVENT,c),this.stat=m}U(Ir,$t);function We(c){const m=br();Mt(m,new Ir(m,c))}Ri.Ma="timingevent";function Tl(c,m){$t.call(this,Ri.Ma,c),this.size=m}U(Tl,$t);function Ws(c,m){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){c()},m)}function Ks(){this.g=!0}Ks.prototype.xa=function(){this.g=!1};function Dn(c,m,v,b,V,H){c.info(function(){if(c.g)if(H)for(var st="",ae=H.split("&"),Me=0;Me<ae.length;Me++){var te=ae[Me].split("=");if(1<te.length){var ce=te[0];te=te[1];var be=ce.split("_");st=2<=be.length&&be[1]=="type"?st+(ce+"="+te+"&"):st+(ce+"=redacted&")}}else st=null;else st=H;return"XMLHTTP REQ ("+b+") [attempt "+V+"]: "+m+`
`+v+`
`+st})}function gt(c,m,v,b,V,H,st){c.info(function(){return"XMLHTTP RESP ("+b+") [ attempt "+V+"]: "+m+`
`+v+`
`+H+" "+st})}function Si(c,m,v,b){c.info(function(){return"XMLHTTP TEXT ("+m+"): "+bl(c,v)+(b?" "+b:"")})}function El(c,m){c.info(function(){return"TIMEOUT: "+m})}Ks.prototype.info=function(){};function bl(c,m){if(!c.g)return m;if(!m)return null;try{var v=JSON.parse(m);if(v){for(c=0;c<v.length;c++)if(Array.isArray(v[c])){var b=v[c];if(!(2>b.length)){var V=b[1];if(Array.isArray(V)&&!(1>V.length)){var H=V[0];if(H!="noop"&&H!="stop"&&H!="close")for(var st=1;st<V.length;st++)V[st]=""}}}}return Le(v)}catch{return m}}var Gs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Pr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ar;function Zn(){}U(Zn,Lo),Zn.prototype.g=function(){return new XMLHttpRequest},Zn.prototype.i=function(){return{}},Ar=new Zn;function Qn(c,m,v,b){this.j=c,this.i=m,this.l=v,this.R=b||1,this.U=new ze(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Il}function Il(){this.i=null,this.g="",this.h=!1}var Pl={},Do={};function No(c,m,v){c.L=1,c.v=Vn(Pe(m)),c.m=v,c.P=!0,Vo(c,null)}function Vo(c,m){c.F=Date.now(),Rr(c),c.A=Pe(c.v);var v=c.A,b=c.R;Array.isArray(b)||(b=[String(b)]),Rl(v.i,"t",b),c.C=0,v=c.j.J,c.h=new Il,c.g=Dl(c.j,v?m:null,!c.m),0<c.O&&(c.M=new cn(T(c.Y,c,c.g),c.O)),m=c.U,v=c.g,b=c.ca;var V="readystatechange";Array.isArray(V)||(V&&(Gn[0]=V.toString()),V=Gn);for(var H=0;H<V.length;H++){var st=G(v,V[H],b||m.handleEvent,!1,m.h||m);if(!st)break;m.g[st.key]=st}m=c.H?P(c.H):{},c.m?(c.u||(c.u="POST"),m["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,m)):(c.u="GET",c.g.ea(c.A,c.u,null,m)),qs(),Dn(c.i,c.u,c.A,c.l,c.R,c.m)}Qn.prototype.ca=function(c){c=c.target;const m=this.M;m&&un(c)==3?m.j():this.Y(c)},Qn.prototype.Y=function(c){try{if(c==this.g)t:{const be=un(this.g);var m=this.g.Ba();const us=this.g.Z();if(!(3>be)&&(be!=3||this.g&&(this.h.h||this.g.oa()||Jo(this.g)))){this.J||be!=4||m==7||(m==8||0>=us?qs(3):qs(2)),Uo(this);var v=this.g.Z();this.X=v;e:if(Al(this)){var b=Jo(this.g);c="";var V=b.length,H=un(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){xi(this),Zs(this);var st="";break e}this.h.i=new h.TextDecoder}for(m=0;m<V;m++)this.h.h=!0,c+=this.h.i.decode(b[m],{stream:!(H&&m==V-1)});b.length=0,this.h.g+=c,this.C=0,st=this.h.g}else st=this.g.oa();if(this.o=v==200,gt(this.i,this.u,this.A,this.l,this.R,be,v),this.o){if(this.T&&!this.K){e:{if(this.g){var ae,Me=this.g;if((ae=Me.g?Me.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!X(ae)){var te=ae;break e}}te=null}if(v=te)Si(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qs(this,v);else{this.o=!1,this.s=3,We(12),xi(this),Zs(this);break t}}if(this.P){v=!0;let Se;for(;!this.J&&this.C<st.length;)if(Se=Cr(this,st),Se==Do){be==4&&(this.s=4,We(14),v=!1),Si(this.i,this.l,null,"[Incomplete Response]");break}else if(Se==Pl){this.s=4,We(15),Si(this.i,this.l,st,"[Invalid Chunk]"),v=!1;break}else Si(this.i,this.l,Se,null),Qs(this,Se);if(Al(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),be!=4||st.length!=0||this.h.h||(this.s=1,We(16),v=!1),this.o=this.o&&v,!v)Si(this.i,this.l,st,"[Invalid Chunked Response]"),xi(this),Zs(this);else if(0<st.length&&!this.W){this.W=!0;var ce=this.j;ce.g==this&&ce.ba&&!ce.M&&(ce.j.info("Great, no buffering proxy detected. Bytes received: "+st.length),Vr(ce),ce.M=!0,We(11))}}else Si(this.i,this.l,st,null),Qs(this,st);be==4&&xi(this),this.o&&!this.J&&(be==4?ea(this.j,this):(this.o=!1,Rr(this)))}else Nu(this.g),v==400&&0<st.indexOf("Unknown SID")?(this.s=3,We(12)):(this.s=0,We(13)),xi(this),Zs(this)}}}catch{}finally{}};function Al(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function Cr(c,m){var v=c.C,b=m.indexOf(`
`,v);return b==-1?Do:(v=Number(m.substring(v,b)),isNaN(v)?Pl:(b+=1,b+v>m.length?Do:(m=m.slice(b,b+v),c.C=b+v,m)))}Qn.prototype.cancel=function(){this.J=!0,xi(this)};function Rr(c){c.S=Date.now()+c.I,Cl(c,c.I)}function Cl(c,m){if(c.B!=null)throw Error("WatchDog timer not null");c.B=Ws(T(c.ba,c),m)}function Uo(c){c.B&&(h.clearTimeout(c.B),c.B=null)}Qn.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(El(this.i,this.A),this.L!=2&&(qs(),We(17)),xi(this),this.s=2,Zs(this)):Cl(this,this.S-c)};function Zs(c){c.j.G==0||c.J||ea(c.j,c)}function xi(c){Uo(c);var m=c.M;m&&typeof m.ma=="function"&&m.ma(),c.M=null,Ci(c.U),c.g&&(m=c.g,c.g=null,m.abort(),m.ma())}function Qs(c,m){try{var v=c.j;if(v.G!=0&&(v.g==c||Qt(v.h,c))){if(!c.K&&Qt(v.h,c)&&v.G==3){try{var b=v.Da.g.parse(m)}catch{b=null}if(Array.isArray(b)&&b.length==3){var V=b;if(V[0]==0){t:if(!v.u){if(v.g)if(v.g.F+3e3<c.F)Fr(v),Dr(v);else break t;Nr(v),We(18)}}else v.za=V[1],0<v.za-v.T&&37500>V[2]&&v.F&&v.v==0&&!v.C&&(v.C=Ws(T(v.Za,v),6e3));if(1>=ss(v.h)&&v.ca){try{v.ca()}catch{}v.ca=void 0}}else Di(v,11)}else if((c.K||v.g==c)&&Fr(v),!X(m))for(V=v.Da.g.parse(m),m=0;m<V.length;m++){let te=V[m];if(v.T=te[0],te=te[1],v.G==2)if(te[0]=="c"){v.K=te[1],v.ia=te[2];const ce=te[3];ce!=null&&(v.la=ce,v.j.info("VER="+v.la));const be=te[4];be!=null&&(v.Aa=be,v.j.info("SVER="+v.Aa));const us=te[5];us!=null&&typeof us=="number"&&0<us&&(b=1.5*us,v.L=b,v.j.info("backChannelRequestTimeoutMs_="+b)),b=v;const Se=c.g;if(Se){const zr=Se.g?Se.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(zr){var H=b.h;H.g||zr.indexOf("spdy")==-1&&zr.indexOf("quic")==-1&&zr.indexOf("h2")==-1||(H.j=H.l,H.g=new Set,H.h&&(ue(H,H.h),H.h=null))}if(b.D){const ci=Se.g?Se.g.getResponseHeader("X-HTTP-Session-Id"):null;ci&&(b.ya=ci,Lt(b.I,b.D,ci))}}v.G=3,v.l&&v.l.ua(),v.ba&&(v.R=Date.now()-c.F,v.j.info("Handshake RTT: "+v.R+"ms")),b=v;var st=c;if(b.qa=Br(b,b.J?b.ia:null,b.W),st.K){Xs(b.h,st);var ae=st,Me=b.L;Me&&(ae.I=Me),ae.B&&(Uo(ae),Rr(ae)),b.g=st}else Jn(b);0<v.i.length&&cs(v)}else te[0]!="stop"&&te[0]!="close"||Di(v,7);else v.G==3&&(te[0]=="stop"||te[0]=="close"?te[0]=="stop"?Di(v,7):Or(v):te[0]!="noop"&&v.l&&v.l.ta(te),v.v=0)}}qs(4)}catch{}}var Ys=class{constructor(c,m){this.g=c,this.map=m}};function Fo(c){this.l=c||10,h.PerformanceNavigationTiming?(c=h.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Bo(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function ss(c){return c.h?1:c.g?c.g.size:0}function Qt(c,m){return c.h?c.h==m:c.g?c.g.has(m):!1}function ue(c,m){c.g?c.g.add(m):c.h=m}function Xs(c,m){c.h&&c.h==m?c.h=null:c.g&&c.g.has(m)&&c.g.delete(m)}Fo.prototype.cancel=function(){if(this.i=ki(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function ki(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let m=c.i;for(const v of c.g.values())m=m.concat(v.D);return m}return B(c.i)}function rs(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(d(c)){for(var m=[],v=c.length,b=0;b<v;b++)m.push(c[b]);return m}m=[],v=0;for(b in c)m[v++]=c[b];return m}function zo(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(d(c)||typeof c=="string"){var m=[];c=c.length;for(var v=0;v<c;v++)m.push(v);return m}m=[],v=0;for(const b in c)m[v++]=b;return m}}}function Vt(c,m){if(c.forEach&&typeof c.forEach=="function")c.forEach(m,void 0);else if(d(c)||typeof c=="string")Array.prototype.forEach.call(c,m,void 0);else for(var v=zo(c),b=rs(c),V=b.length,H=0;H<V;H++)m.call(void 0,b[H],v&&v[H],c)}var ye=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function jo(c,m){if(c){c=c.split("&");for(var v=0;v<c.length;v++){var b=c[v].indexOf("="),V=null;if(0<=b){var H=c[v].substring(0,b);V=c[v].substring(b+1)}else H=c[v];m(H,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function Nn(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Nn){this.h=c.h,Sr(this,c.j),this.o=c.o,this.g=c.g,Li(this,c.s),this.l=c.l;var m=c.i,v=new Mi;v.i=m.i,m.g&&(v.g=new Map(m.g),v.h=m.h),ai(this,v),this.m=c.m}else c&&(m=String(c).match(ye))?(this.h=!1,Sr(this,m[1]||"",!0),this.o=Yn(m[2]||""),this.g=Yn(m[3]||"",!0),Li(this,m[4]),this.l=Yn(m[5]||"",!0),ai(this,m[6]||"",!0),this.m=Yn(m[7]||"")):(this.h=!1,this.i=new Mi(null,this.h))}Nn.prototype.toString=function(){var c=[],m=this.j;m&&c.push(Xn(m,os,!0),":");var v=this.g;return(v||m=="file")&&(c.push("//"),(m=this.o)&&c.push(Xn(m,os,!0),"@"),c.push(encodeURIComponent(String(v)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.s,v!=null&&c.push(":",String(v))),(v=this.l)&&(this.g&&v.charAt(0)!="/"&&c.push("/"),c.push(Xn(v,v.charAt(0)=="/"?qo:$o,!0))),(v=this.i.toString())&&c.push("?",v),(v=this.m)&&c.push("#",Xn(v,Wo)),c.join("")};function Pe(c){return new Nn(c)}function Sr(c,m,v){c.j=v?Yn(m,!0):m,c.j&&(c.j=c.j.replace(/:$/,""))}function Li(c,m){if(m){if(m=Number(m),isNaN(m)||0>m)throw Error("Bad port number "+m);c.s=m}else c.s=null}function ai(c,m,v){m instanceof Mi?(c.i=m,Un(c.i,c.h)):(v||(m=Xn(m,xr)),c.i=new Mi(m,c.h))}function Lt(c,m,v){c.i.set(m,v)}function Vn(c){return Lt(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Yn(c,m){return c?m?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Xn(c,m,v){return typeof c=="string"?(c=encodeURI(c).replace(m,Ho),v&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Ho(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var os=/[#\/\?@]/g,$o=/[#\?:]/g,qo=/[#\?]/g,xr=/[#\?@]/g,Wo=/#/g;function Mi(c,m){this.h=this.g=null,this.i=c||null,this.j=!!m}function Pn(c){c.g||(c.g=new Map,c.h=0,c.i&&jo(c.i,function(m,v){c.add(decodeURIComponent(m.replace(/\+/g," ")),v)}))}e=Mi.prototype,e.add=function(c,m){Pn(this),this.i=null,c=Ct(this,c);var v=this.g.get(c);return v||this.g.set(c,v=[]),v.push(m),this.h+=1,this};function Ko(c,m){Pn(c),m=Ct(c,m),c.g.has(m)&&(c.i=null,c.h-=c.g.get(m).length,c.g.delete(m))}function kr(c,m){return Pn(c),m=Ct(c,m),c.g.has(m)}e.forEach=function(c,m){Pn(this),this.g.forEach(function(v,b){v.forEach(function(V){c.call(m,V,b,this)},this)},this)},e.na=function(){Pn(this);const c=Array.from(this.g.values()),m=Array.from(this.g.keys()),v=[];for(let b=0;b<m.length;b++){const V=c[b];for(let H=0;H<V.length;H++)v.push(m[b])}return v},e.V=function(c){Pn(this);let m=[];if(typeof c=="string")kr(this,c)&&(m=m.concat(this.g.get(Ct(this,c))));else{c=Array.from(this.g.values());for(let v=0;v<c.length;v++)m=m.concat(c[v])}return m},e.set=function(c,m){return Pn(this),this.i=null,c=Ct(this,c),kr(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[m]),this.h+=1,this},e.get=function(c,m){return c?(c=this.V(c),0<c.length?String(c[0]):m):m};function Rl(c,m,v){Ko(c,m),0<v.length&&(c.i=null,c.g.set(Ct(c,m),B(v)),c.h+=v.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],m=Array.from(this.g.keys());for(var v=0;v<m.length;v++){var b=m[v];const H=encodeURIComponent(String(b)),st=this.V(b);for(b=0;b<st.length;b++){var V=H;st[b]!==""&&(V+="="+encodeURIComponent(String(st[b]))),c.push(V)}}return this.i=c.join("&")};function Ct(c,m){return m=String(m),c.j&&(m=m.toLowerCase()),m}function Un(c,m){m&&!c.j&&(Pn(c),c.i=null,c.g.forEach(function(v,b){var V=b.toLowerCase();b!=V&&(Ko(this,b),Rl(this,V,v))},c)),c.j=m}function le(c,m){const v=new Ks;if(h.Image){const b=new Image;b.onload=I(Fn,v,"TestLoadImage: loaded",!0,m,b),b.onerror=I(Fn,v,"TestLoadImage: error",!1,m,b),b.onabort=I(Fn,v,"TestLoadImage: abort",!1,m,b),b.ontimeout=I(Fn,v,"TestLoadImage: timeout",!1,m,b),h.setTimeout(function(){b.ontimeout&&b.ontimeout()},1e4),b.src=c}else m(!1)}function Sl(c,m){const v=new Ks,b=new AbortController,V=setTimeout(()=>{b.abort(),Fn(v,"TestPingServer: timeout",!1,m)},1e4);fetch(c,{signal:b.signal}).then(H=>{clearTimeout(V),H.ok?Fn(v,"TestPingServer: ok",!0,m):Fn(v,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(V),Fn(v,"TestPingServer: error",!1,m)})}function Fn(c,m,v,b,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),b(v)}catch{}}function Go(){this.g=new oi}function Zo(c,m,v){const b=v||"";try{Vt(c,function(V,H){let st=V;p(V)&&(st=Le(V)),m.push(b+H+"="+encodeURIComponent(st))})}catch(V){throw m.push(b+"type="+encodeURIComponent("_badmap")),V}}function Bn(c){this.l=c.Ub||null,this.j=c.eb||!1}U(Bn,Lo),Bn.prototype.g=function(){return new as(this.l,this.j)},Bn.prototype.i=function(c){return function(){return c}}({});function as(c,m){yt.call(this),this.D=c,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}U(as,yt),e=as.prototype,e.open=function(c,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=m,this.readyState=1,An(this)},e.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const m={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(m.body=c),(this.D||h).fetch(new Request(this.A,m)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ee(this)),this.readyState=0},e.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,An(this)),this.g&&(this.readyState=3,An(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ls(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function ls(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}e.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var m=c.value?c.value:new Uint8Array(0);(m=this.v.decode(m,{stream:!c.done}))&&(this.response=this.responseText+=m)}c.done?Ee(this):An(this),this.readyState==3&&ls(this)}},e.Ra=function(c){this.g&&(this.response=this.responseText=c,Ee(this))},e.Qa=function(c){this.g&&(this.response=c,Ee(this))},e.ga=function(){this.g&&Ee(this)};function Ee(c){c.readyState=4,c.l=null,c.j=null,c.v=null,An(c)}e.setRequestHeader=function(c,m){this.u.append(c,m)},e.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],m=this.h.entries();for(var v=m.next();!v.done;)v=v.value,c.push(v[0]+": "+v[1]),v=m.next();return c.join(`\r
`)};function An(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(as.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Qo(c){let m="";return kt(c,function(v,b){m+=b,m+=":",m+=v,m+=`\r
`}),m}function Lr(c,m,v){t:{for(b in v){var b=!1;break t}b=!0}b||(v=Qo(v),typeof c=="string"?v!=null&&encodeURIComponent(String(v)):Lt(c,m,v))}function we(c){yt.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}U(we,yt);var xl=/^https?$/i,Yo=["POST","PUT"];e=we.prototype,e.Ha=function(c){this.J=c},e.ea=function(c,m,v,b){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);m=m?m.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ar.g(),this.v=this.o?vl(this.o):vl(Ar),this.g.onreadystatechange=T(this.Ea,this);try{this.B=!0,this.g.open(m,String(c),!0),this.B=!1}catch(H){kl(this,H);return}if(c=v||"",v=new Map(this.headers),b)if(Object.getPrototypeOf(b)===Object.prototype)for(var V in b)v.set(V,b[V]);else if(typeof b.keys=="function"&&typeof b.get=="function")for(const H of b.keys())v.set(H,b.get(H));else throw Error("Unknown input type for opt_headers: "+String(b));b=Array.from(v.keys()).find(H=>H.toLowerCase()=="content-type"),V=h.FormData&&c instanceof h.FormData,!(0<=Array.prototype.indexOf.call(Yo,m,void 0))||b||V||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[H,st]of v)this.g.setRequestHeader(H,st);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{vn(this),this.u=!0,this.g.send(c),this.u=!1}catch(H){kl(this,H)}};function kl(c,m){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=m,c.m=5,Xo(c),Mr(c)}function Xo(c){c.A||(c.A=!0,Mt(c,"complete"),Mt(c,"error"))}e.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,Mt(this,"complete"),Mt(this,"abort"),Mr(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mr(this,!0)),we.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Kt(this):this.bb())},e.bb=function(){Kt(this)};function Kt(c){if(c.h&&typeof l<"u"&&(!c.v[1]||un(c)!=4||c.Z()!=2)){if(c.u&&un(c)==4)Be(c.Ea,0,c);else if(Mt(c,"readystatechange"),un(c)==4){c.h=!1;try{const st=c.Z();t:switch(st){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break t;default:m=!1}var v;if(!(v=m)){var b;if(b=st===0){var V=String(c.D).match(ye)[1]||null;!V&&h.self&&h.self.location&&(V=h.self.location.protocol.slice(0,-1)),b=!xl.test(V?V.toLowerCase():"")}v=b}if(v)Mt(c,"complete"),Mt(c,"success");else{c.m=6;try{var H=2<un(c)?c.g.statusText:""}catch{H=""}c.l=H+" ["+c.Z()+"]",Xo(c)}}finally{Mr(c)}}}}function Mr(c,m){if(c.g){vn(c);const v=c.g,b=c.v[0]?()=>{}:null;c.g=null,c.v=null,m||Mt(c,"ready");try{v.onreadystatechange=b}catch{}}}function vn(c){c.I&&(h.clearTimeout(c.I),c.I=null)}e.isActive=function(){return!!this.g};function un(c){return c.g?c.g.readyState:0}e.Z=function(){try{return 2<un(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(c){if(this.g){var m=this.g.responseText;return c&&m.indexOf(c)==0&&(m=m.substring(c.length)),gn(m)}};function Jo(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Nu(c){const m={};c=(c.g&&2<=un(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let b=0;b<c.length;b++){if(X(c[b]))continue;var v=O(c[b]);const V=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const H=m[V]||[];m[V]=H,H.push(v)}k(m,function(b){return b.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Oi(c,m,v){return v&&v.internalChannelParams&&v.internalChannelParams[c]||m}function Ll(c){this.Aa=0,this.i=[],this.j=new Ks,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Oi("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Oi("baseRetryDelayMs",5e3,c),this.cb=Oi("retryDelaySeedMs",1e4,c),this.Wa=Oi("forwardChannelMaxRetries",2,c),this.wa=Oi("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Fo(c&&c.concurrentRequestLimit),this.Da=new Go,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=Ll.prototype,e.la=8,e.G=1,e.connect=function(c,m,v,b){We(0),this.W=c,this.H=m||{},v&&b!==void 0&&(this.H.OSID=v,this.H.OAID=b),this.F=this.X,this.I=Br(this,null,this.W),cs(this)};function Or(c){if(Ml(c),c.G==3){var m=c.U++,v=Pe(c.I);if(Lt(v,"SID",c.K),Lt(v,"RID",m),Lt(v,"TYPE","terminate"),Js(c,v),m=new Qn(c,c.j,m),m.L=2,m.v=Vn(Pe(v)),v=!1,h.navigator&&h.navigator.sendBeacon)try{v=h.navigator.sendBeacon(m.v.toString(),"")}catch{}!v&&h.Image&&(new Image().src=m.v,v=!0),v||(m.g=Dl(m.j,null),m.g.ea(m.v)),m.F=Date.now(),Rr(m)}Ol(c)}function Dr(c){c.g&&(Vr(c),c.g.cancel(),c.g=null)}function Ml(c){Dr(c),c.u&&(h.clearTimeout(c.u),c.u=null),Fr(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&h.clearTimeout(c.s),c.s=null)}function cs(c){if(!Bo(c.h)&&!c.s){c.s=!0;var m=c.Ga;Ft||vt(),at||(Ft(),at=!0),Qe.add(m,c),c.B=0}}function Vu(c,m){return ss(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=m.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=Ws(T(c.Ga,c,m),na(c,c.B)),c.B++,!0)}e.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const V=new Qn(this,this.j,c);let H=this.o;if(this.S&&(H?(H=P(H),M(H,this.S)):H=this.S),this.m!==null||this.O||(V.H=H,H=null),this.P)t:{for(var m=0,v=0;v<this.i.length;v++){e:{var b=this.i[v];if("__data__"in b.map&&(b=b.map.__data__,typeof b=="string")){b=b.length;break e}b=void 0}if(b===void 0)break;if(m+=b,4096<m){m=v;break t}if(m===4096||v===this.i.length-1){m=v+1;break t}}m=1e3}else m=1e3;m=ta(this,V,m),v=Pe(this.I),Lt(v,"RID",c),Lt(v,"CVER",22),this.D&&Lt(v,"X-HTTP-Session-Id",this.D),Js(this,v),H&&(this.O?m="headers="+encodeURIComponent(String(Qo(H)))+"&"+m:this.m&&Lr(v,this.m,H)),ue(this.h,V),this.Ua&&Lt(v,"TYPE","init"),this.P?(Lt(v,"$req",m),Lt(v,"SID","null"),V.T=!0,No(V,v,null)):No(V,v,m),this.G=2}}else this.G==3&&(c?Cn(this,c):this.i.length==0||Bo(this.h)||Cn(this))};function Cn(c,m){var v;m?v=m.l:v=c.U++;const b=Pe(c.I);Lt(b,"SID",c.K),Lt(b,"RID",v),Lt(b,"AID",c.T),Js(c,b),c.m&&c.o&&Lr(b,c.m,c.o),v=new Qn(c,c.j,v,c.B+1),c.m===null&&(v.H=c.o),m&&(c.i=m.D.concat(c.i)),m=ta(c,v,1e3),v.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),ue(c.h,v),No(v,b,m)}function Js(c,m){c.H&&kt(c.H,function(v,b){Lt(m,b,v)}),c.l&&Vt({},function(v,b){Lt(m,b,v)})}function ta(c,m,v){v=Math.min(c.i.length,v);var b=c.l?T(c.l.Na,c.l,c):null;t:{var V=c.i;let H=-1;for(;;){const st=["count="+v];H==-1?0<v?(H=V[0].g,st.push("ofs="+H)):H=0:st.push("ofs="+H);let ae=!0;for(let Me=0;Me<v;Me++){let te=V[Me].g;const ce=V[Me].map;if(te-=H,0>te)H=Math.max(0,V[Me].g-100),ae=!1;else try{Zo(ce,st,"req"+te+"_")}catch{b&&b(ce)}}if(ae){b=st.join("&");break t}}}return c=c.i.splice(0,v),m.D=c,b}function Jn(c){if(!c.g&&!c.u){c.Y=1;var m=c.Fa;Ft||vt(),at||(Ft(),at=!0),Qe.add(m,c),c.v=0}}function Nr(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=Ws(T(c.Fa,c),na(c,c.v)),c.v++,!0)}e.Fa=function(){if(this.u=null,Ur(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=Ws(T(this.ab,this),c)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,We(10),Dr(this),Ur(this))};function Vr(c){c.A!=null&&(h.clearTimeout(c.A),c.A=null)}function Ur(c){c.g=new Qn(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var m=Pe(c.qa);Lt(m,"RID","rpc"),Lt(m,"SID",c.K),Lt(m,"AID",c.T),Lt(m,"CI",c.F?"0":"1"),!c.F&&c.ja&&Lt(m,"TO",c.ja),Lt(m,"TYPE","xmlhttp"),Js(c,m),c.m&&c.o&&Lr(m,c.m,c.o),c.L&&(c.g.I=c.L);var v=c.g;c=c.ia,v.L=1,v.v=Vn(Pe(m)),v.m=null,v.P=!0,Vo(v,c)}e.Za=function(){this.C!=null&&(this.C=null,Dr(this),Nr(this),We(19))};function Fr(c){c.C!=null&&(h.clearTimeout(c.C),c.C=null)}function ea(c,m){var v=null;if(c.g==m){Fr(c),Vr(c),c.g=null;var b=2}else if(Qt(c.h,m))v=m.D,Xs(c.h,m),b=1;else return;if(c.G!=0){if(m.o)if(b==1){v=m.m?m.m.length:0,m=Date.now()-m.F;var V=c.B;b=br(),Mt(b,new Tl(b,v)),cs(c)}else Jn(c);else if(V=m.s,V==3||V==0&&0<m.X||!(b==1&&Vu(c,m)||b==2&&Nr(c)))switch(v&&0<v.length&&(m=c.h,m.i=m.i.concat(v)),V){case 1:Di(c,5);break;case 4:Di(c,10);break;case 3:Di(c,6);break;default:Di(c,2)}}}function na(c,m){let v=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(v*=2),v*m}function Di(c,m){if(c.j.info("Error code "+m),m==2){var v=T(c.fb,c),b=c.Xa;const V=!b;b=new Nn(b||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||Sr(b,"https"),Vn(b),V?le(b.toString(),v):Sl(b.toString(),v)}else We(2);c.G=0,c.l&&c.l.sa(m),Ol(c),Ml(c)}e.fb=function(c){c?(this.j.info("Successfully pinged google.com"),We(2)):(this.j.info("Failed to ping google.com"),We(1))};function Ol(c){if(c.G=0,c.ka=[],c.l){const m=ki(c.h);(m.length!=0||c.i.length!=0)&&(j(c.ka,m),j(c.ka,c.i),c.h.i.length=0,B(c.i),c.i.length=0),c.l.ra()}}function Br(c,m,v){var b=v instanceof Nn?Pe(v):new Nn(v);if(b.g!="")m&&(b.g=m+"."+b.g),Li(b,b.s);else{var V=h.location;b=V.protocol,m=m?m+"."+V.hostname:V.hostname,V=+V.port;var H=new Nn(null);b&&Sr(H,b),m&&(H.g=m),V&&Li(H,V),v&&(H.l=v),b=H}return v=c.D,m=c.ya,v&&m&&Lt(b,v,m),Lt(b,"VER",c.la),Js(c,b),b}function Dl(c,m,v){if(m&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return m=c.Ca&&!c.pa?new we(new Bn({eb:v})):new we(c.pa),m.Ha(c.J),m}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function ia(){}e=ia.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function tr(){}tr.prototype.g=function(c,m){return new je(c,m)};function je(c,m){yt.call(this),this.g=new Ll(m),this.l=c,this.h=m&&m.messageUrlParams||null,c=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(c?c["X-WebChannel-Content-Type"]=m.messageContentType:c={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.va&&(c?c["X-WebChannel-Client-Profile"]=m.va:c={"X-WebChannel-Client-Profile":m.va}),this.g.S=c,(c=m&&m.Sb)&&!X(c)&&(this.g.m=c),this.v=m&&m.supportsCrossDomainXhr||!1,this.u=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!X(m)&&(this.g.D=m,c=this.h,c!==null&&m in c&&(c=this.h,m in c&&delete c[m])),this.j=new zn(this)}U(je,yt),je.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},je.prototype.close=function(){Or(this.g)},je.prototype.o=function(c){var m=this.g;if(typeof c=="string"){var v={};v.__data__=c,c=v}else this.u&&(v={},v.__data__=Le(c),c=v);m.i.push(new Ys(m.Ya++,c)),m.G==3&&cs(m)},je.prototype.N=function(){this.g.l=null,delete this.j,Or(this.g),delete this.g,je.aa.N.call(this)};function li(c){Er.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var m=c.__sm__;if(m){t:{for(const v in m){c=v;break t}c=void 0}(this.i=c)&&(c=this.i,m=m!==null&&c in m?m[c]:void 0),this.data=m}else this.data=c}U(li,Er);function Nl(){Oo.call(this),this.status=1}U(Nl,Oo);function zn(c){this.g=c}U(zn,ia),zn.prototype.ua=function(){Mt(this.g,"a")},zn.prototype.ta=function(c){Mt(this.g,new li(c))},zn.prototype.sa=function(c){Mt(this.g,new Nl)},zn.prototype.ra=function(){Mt(this.g,"b")},tr.prototype.createWebChannel=tr.prototype.g,je.prototype.send=je.prototype.o,je.prototype.open=je.prototype.m,je.prototype.close=je.prototype.close,_v=function(){return new tr},mv=function(){return br()},pv=Ri,Mh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Gs.NO_ERROR=0,Gs.TIMEOUT=8,Gs.HTTP_ERROR=6,uc=Gs,Pr.COMPLETE="complete",fv=Pr,Mo.EventType=is,is.OPEN="a",is.CLOSE="b",is.ERROR="c",is.MESSAGE="d",yt.prototype.listen=yt.prototype.K,ma=Mo,we.prototype.listenOnce=we.prototype.L,we.prototype.getLastError=we.prototype.Ka,we.prototype.getLastErrorCode=we.prototype.Ba,we.prototype.getStatus=we.prototype.Z,we.prototype.getResponseJson=we.prototype.Oa,we.prototype.getResponseText=we.prototype.oa,we.prototype.send=we.prototype.ea,we.prototype.setWithCredentials=we.prototype.Ha,dv=we}).apply(typeof Yl<"u"?Yl:typeof self<"u"?self:typeof window<"u"?window:{});const sm="@firebase/firestore",rm="4.7.10";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Xe.UNAUTHENTICATED=new Xe(null),Xe.GOOGLE_CREDENTIALS=new Xe("google-credentials-uid"),Xe.FIRST_PARTY=new Xe("first-party-uid"),Xe.MOCK_USER=new Xe("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Po="11.5.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pr=new Id("@firebase/firestore");function Zr(){return pr.logLevel}function ft(e,...t){if(pr.logLevel<=Yt.DEBUG){const n=t.map(Cd);pr.debug(`Firestore (${Po}): ${e}`,...n)}}function Xi(e,...t){if(pr.logLevel<=Yt.ERROR){const n=t.map(Cd);pr.error(`Firestore (${Po}): ${e}`,...n)}}function po(e,...t){if(pr.logLevel<=Yt.WARN){const n=t.map(Cd);pr.warn(`Firestore (${Po}): ${e}`,...n)}}function Cd(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(e="Unexpected state"){const t=`FIRESTORE (${Po}) INTERNAL ASSERTION FAILED: `+e;throw Xi(t),new Error(t)}function re(e,t){e||xt()}function Nt(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pt extends Ai{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class SP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(Xe.UNAUTHENTICATED))}shutdown(){}}class xP{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class kP{constructor(t){this.t=t,this.currentUser=Xe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){re(this.o===void 0);let i=this.i;const r=d=>this.i!==i?(i=this.i,n(d)):Promise.resolve();let o=new Gi;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Gi,t.enqueueRetryable(()=>r(this.currentUser))};const l=()=>{const d=o;t.enqueueRetryable(async()=>{await d.promise,await r(this.currentUser)})},h=d=>{ft("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(d=>h(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?h(d):(ft("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Gi)}},0),l()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(i=>this.i!==t?(ft("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(re(typeof i.accessToken=="string"),new gv(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return re(t===null||typeof t=="string"),new Xe(t)}}class LP{constructor(t,n,i){this.l=t,this.h=n,this.P=i,this.type="FirstParty",this.user=Xe.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.T.set("Authorization",t),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class MP{constructor(t,n,i){this.l=t,this.h=n,this.P=i}getToken(){return Promise.resolve(new LP(this.l,this.h,this.P))}start(t,n){t.enqueueRetryable(()=>n(Xe.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class om{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class OP{constructor(t,n){this.A=n,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,Tn(t)&&t.settings.appCheckToken&&(this.V=t.settings.appCheckToken)}start(t,n){re(this.o===void 0);const i=o=>{o.error!=null&&ft("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.R;return this.R=o.token,ft("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?n(o.token):Promise.resolve()};this.o=o=>{t.enqueueRetryable(()=>i(o))};const r=o=>{ft("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>r(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?r(o):ft("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new om(this.V));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(re(typeof n.token=="string"),this.R=n.token,new om(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DP(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let i=0;i<e;i++)n[i]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vv(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yv{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=DP(40);for(let o=0;o<r.length;++o)i.length<20&&r[o]<n&&(i+=t.charAt(r[o]%62))}return i}}function jt(e,t){return e<t?-1:e>t?1:0}function Oh(e,t){let n=0;for(;n<e.length&&n<t.length;){const i=e.codePointAt(n),r=t.codePointAt(n);if(i!==r){if(i<128&&r<128)return jt(i,r);{const o=vv(),l=NP(o.encode(am(e,n)),o.encode(am(t,n)));return l!==0?l:jt(i,r)}}n+=i>65535?2:1}return jt(e.length,t.length)}function am(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function NP(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return jt(e[n],t[n]);return jt(e.length,t.length)}function mo(e,t,n){return e.length===t.length&&e.every((i,r)=>n(i,t[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lm=-62135596800,cm=1e6;class Ue{static now(){return Ue.fromMillis(Date.now())}static fromDate(t){return Ue.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),i=Math.floor((t-1e3*n)*cm);return new Ue(n,i)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new pt(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new pt(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<lm)throw new pt(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new pt(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/cm}_compareTo(t){return this.seconds===t.seconds?jt(this.nanoseconds,t.nanoseconds):jt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds-lm;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{static fromTimestamp(t){return new Dt(t)}static min(){return new Dt(new Ue(0,0))}static max(){return new Dt(new Ue(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const um="__name__";class fi{constructor(t,n,i){n===void 0?n=0:n>t.length&&xt(),i===void 0?i=t.length-n:i>t.length-n&&xt(),this.segments=t,this.offset=n,this.len=i}get length(){return this.len}isEqual(t){return fi.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof fi?t.forEach(i=>{n.push(i)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,i=this.limit();n<i;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const i=Math.min(t.length,n.length);for(let r=0;r<i;r++){const o=fi.compareSegments(t.get(r),n.get(r));if(o!==0)return o}return jt(t.length,n.length)}static compareSegments(t,n){const i=fi.isNumericId(t),r=fi.isNumericId(n);return i&&!r?-1:!i&&r?1:i&&r?fi.extractNumericId(t).compare(fi.extractNumericId(n)):Oh(t,n)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Cs.fromString(t.substring(4,t.length-2))}}class ge extends fi{construct(t,n,i){return new ge(t,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const i of t){if(i.indexOf("//")>=0)throw new pt(K.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter(r=>r.length>0))}return new ge(n)}static emptyPath(){return new ge([])}}const VP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ge extends fi{construct(t,n,i){return new Ge(t,n,i)}static isValidIdentifier(t){return VP.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ge.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===um}static keyField(){return new Ge([um])}static fromServerFormat(t){const n=[];let i="",r=0;const o=()=>{if(i.length===0)throw new pt(K.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let l=!1;for(;r<t.length;){const h=t[r];if(h==="\\"){if(r+1===t.length)throw new pt(K.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const d=t[r+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new pt(K.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=d,r+=2}else h==="`"?(l=!l,r++):h!=="."||l?(i+=h,r++):(o(),r++)}if(o(),l)throw new pt(K.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ge(n)}static emptyPath(){return new Ge([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(t){this.path=t}static fromPath(t){return new Tt(ge.fromString(t))}static fromName(t){return new Tt(ge.fromString(t).popFirst(5))}static empty(){return new Tt(ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&ge.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return ge.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Tt(new ge(t.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wa=-1;function UP(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,r=Dt.fromTimestamp(i===1e9?new Ue(n+1,0):new Ue(n,i));return new xs(r,Tt.empty(),t)}function FP(e){return new xs(e.readTime,e.key,Wa)}class xs{constructor(t,n,i){this.readTime=t,this.documentKey=n,this.largestBatchId=i}static min(){return new xs(Dt.min(),Tt.empty(),Wa)}static max(){return new xs(Dt.max(),Tt.empty(),Wa)}}function BP(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=Tt.comparator(e.documentKey,t.documentKey),n!==0?n:jt(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class jP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ao(e){if(e.code!==K.FAILED_PRECONDITION||e.message!==zP)throw e;ft("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&xt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new Z((i,r)=>{this.nextCallback=o=>{this.wrapSuccess(t,o).next(i,r)},this.catchCallback=o=>{this.wrapFailure(n,o).next(i,r)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof Z?n:Z.resolve(n)}catch(n){return Z.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):Z.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):Z.reject(n)}static resolve(t){return new Z((n,i)=>{n(t)})}static reject(t){return new Z((n,i)=>{i(t)})}static waitFor(t){return new Z((n,i)=>{let r=0,o=0,l=!1;t.forEach(h=>{++r,h.next(()=>{++o,l&&o===r&&n()},d=>i(d))}),l=!0,o===r&&n()})}static or(t){let n=Z.resolve(!1);for(const i of t)n=n.next(r=>r?Z.resolve(r):i());return n}static forEach(t,n){const i=[];return t.forEach((r,o)=>{i.push(n.call(this,r,o))}),this.waitFor(i)}static mapArray(t,n){return new Z((i,r)=>{const o=t.length,l=new Array(o);let h=0;for(let d=0;d<o;d++){const p=d;n(t[p]).next(_=>{l[p]=_,++h,h===o&&i(l)},_=>r(_))}})}static doWhile(t,n){return new Z((i,r)=>{const o=()=>{t()===!0?n().next(()=>{o()},r):i()};o()})}}function HP(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Co(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.oe(i),this._e=i=>n.writeSequenceNumber(i))}oe(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this._e&&this._e(t),t}}hu.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rd=-1;function du(e){return e==null}function xc(e){return e===0&&1/e==-1/0}function $P(e){return typeof e=="number"&&Number.isInteger(e)&&!xc(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wv="";function qP(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=hm(t)),t=WP(e.get(n),t);return hm(t)}function WP(e,t){let n=t;const i=e.length;for(let r=0;r<i;r++){const o=e.charAt(r);switch(o){case"\0":n+="";break;case wv:n+="";break;default:n+=o}}return n}function hm(e){return e+wv+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dm(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Fs(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Tv(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(t,n){this.comparator=t,this.root=n||Ke.EMPTY}insert(t,n){return new Ie(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Ke.BLACK,null,null))}remove(t){return new Ie(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ke.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(t){let n=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(t,i.key);if(r===0)return n+i.left.size;r<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,i)=>(t(n,i),!1))}toString(){const t=[];return this.inorderTraversal((n,i)=>(t.push(`${n}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Xl(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Xl(this.root,t,this.comparator,!1)}getReverseIterator(){return new Xl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Xl(this.root,t,this.comparator,!0)}}class Xl{constructor(t,n,i,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!t.isEmpty();)if(o=n?i(t.key,n):1,n&&r&&(o*=-1),o<0)t=this.isReverse?t.left:t.right;else{if(o===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Ke{constructor(t,n,i,r,o){this.key=t,this.value=n,this.color=i??Ke.RED,this.left=r??Ke.EMPTY,this.right=o??Ke.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,i,r,o){return new Ke(t??this.key,n??this.value,i??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,i){let r=this;const o=i(t,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(t,n,i),null):o===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(t,n,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Ke.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let i,r=this;if(n(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(t,r.key)===0){if(r.right.isEmpty())return Ke.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Ke.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Ke.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw xt();const t=this.left.check();if(t!==this.right.check())throw xt();return t+(this.isRed()?0:1)}}Ke.EMPTY=null,Ke.RED=!0,Ke.BLACK=!1;Ke.EMPTY=new class{constructor(){this.size=0}get key(){throw xt()}get value(){throw xt()}get color(){throw xt()}get left(){throw xt()}get right(){throw xt()}copy(t,n,i,r,o){return this}insert(t,n,i){return new Ke(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(t){this.comparator=t,this.data=new Ie(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,i)=>(t(n),!1))}forEachInRange(t,n){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,t[1])>=0)return;n(r.key)}}forEachWhile(t,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new fm(this.data.getIterator())}getIteratorFrom(t){return new fm(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(i=>{n=n.add(i)}),n}isEqual(t){if(!(t instanceof Fe)||this.size!==t.size)return!1;const n=this.data.getIterator(),i=t.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,o=i.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new Fe(this.comparator);return n.data=t,n}}class fm{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(t){this.fields=t,t.sort(Ge.comparator)}static empty(){return new Mn([])}unionWith(t){let n=new Fe(Ge.comparator);for(const i of this.fields)n=n.add(i);for(const i of t)n=n.add(i);return new Mn(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return mo(this.fields,t.fields,(n,i)=>n.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Ev("Invalid base64 string: "+o):o}}(t);return new Ze(n)}static fromUint8Array(t){const n=function(r){let o="";for(let l=0;l<r.length;++l)o+=String.fromCharCode(r[l]);return o}(t);return new Ze(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return jt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Ze.EMPTY_BYTE_STRING=new Ze("");const KP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ks(e){if(re(!!e),typeof e=="string"){let t=0;const n=KP.exec(e);if(re(!!n),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:xe(e.seconds),nanos:xe(e.nanos)}}function xe(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Ls(e){return typeof e=="string"?Ze.fromBase64String(e):Ze.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bv="server_timestamp",Iv="__type__",Pv="__previous_value__",Av="__local_write_time__";function Sd(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[Iv])===null||n===void 0?void 0:n.stringValue)===bv}function fu(e){const t=e.mapValue.fields[Pv];return Sd(t)?fu(t):t}function Ka(e){const t=ks(e.mapValue.fields[Av].timestampValue);return new Ue(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GP{constructor(t,n,i,r,o,l,h,d,p){this.databaseId=t,this.appId=n,this.persistenceKey=i,this.host=r,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=h,this.longPollingOptions=d,this.useFetchStreams=p}}const kc="(default)";class Ga{constructor(t,n){this.projectId=t,this.database=n||kc}static empty(){return new Ga("","")}get isDefaultDatabase(){return this.database===kc}isEqual(t){return t instanceof Ga&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cv="__type__",ZP="__max__",Jl={mapValue:{}},Rv="__vector__",Lc="value";function Ms(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Sd(e)?4:YP(e)?9007199254740991:QP(e)?10:11:xt()}function Pi(e,t){if(e===t)return!0;const n=Ms(e);if(n!==Ms(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Ka(e).isEqual(Ka(t));case 3:return function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;const l=ks(r.timestampValue),h=ks(o.timestampValue);return l.seconds===h.seconds&&l.nanos===h.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(r,o){return Ls(r.bytesValue).isEqual(Ls(o.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(r,o){return xe(r.geoPointValue.latitude)===xe(o.geoPointValue.latitude)&&xe(r.geoPointValue.longitude)===xe(o.geoPointValue.longitude)}(e,t);case 2:return function(r,o){if("integerValue"in r&&"integerValue"in o)return xe(r.integerValue)===xe(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){const l=xe(r.doubleValue),h=xe(o.doubleValue);return l===h?xc(l)===xc(h):isNaN(l)&&isNaN(h)}return!1}(e,t);case 9:return mo(e.arrayValue.values||[],t.arrayValue.values||[],Pi);case 10:case 11:return function(r,o){const l=r.mapValue.fields||{},h=o.mapValue.fields||{};if(dm(l)!==dm(h))return!1;for(const d in l)if(l.hasOwnProperty(d)&&(h[d]===void 0||!Pi(l[d],h[d])))return!1;return!0}(e,t);default:return xt()}}function Za(e,t){return(e.values||[]).find(n=>Pi(n,t))!==void 0}function _o(e,t){if(e===t)return 0;const n=Ms(e),i=Ms(t);if(n!==i)return jt(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return jt(e.booleanValue,t.booleanValue);case 2:return function(o,l){const h=xe(o.integerValue||o.doubleValue),d=xe(l.integerValue||l.doubleValue);return h<d?-1:h>d?1:h===d?0:isNaN(h)?isNaN(d)?0:-1:1}(e,t);case 3:return pm(e.timestampValue,t.timestampValue);case 4:return pm(Ka(e),Ka(t));case 5:return Oh(e.stringValue,t.stringValue);case 6:return function(o,l){const h=Ls(o),d=Ls(l);return h.compareTo(d)}(e.bytesValue,t.bytesValue);case 7:return function(o,l){const h=o.split("/"),d=l.split("/");for(let p=0;p<h.length&&p<d.length;p++){const _=jt(h[p],d[p]);if(_!==0)return _}return jt(h.length,d.length)}(e.referenceValue,t.referenceValue);case 8:return function(o,l){const h=jt(xe(o.latitude),xe(l.latitude));return h!==0?h:jt(xe(o.longitude),xe(l.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return mm(e.arrayValue,t.arrayValue);case 10:return function(o,l){var h,d,p,_;const y=o.fields||{},T=l.fields||{},I=(h=y[Lc])===null||h===void 0?void 0:h.arrayValue,U=(d=T[Lc])===null||d===void 0?void 0:d.arrayValue,B=jt(((p=I==null?void 0:I.values)===null||p===void 0?void 0:p.length)||0,((_=U==null?void 0:U.values)===null||_===void 0?void 0:_.length)||0);return B!==0?B:mm(I,U)}(e.mapValue,t.mapValue);case 11:return function(o,l){if(o===Jl.mapValue&&l===Jl.mapValue)return 0;if(o===Jl.mapValue)return 1;if(l===Jl.mapValue)return-1;const h=o.fields||{},d=Object.keys(h),p=l.fields||{},_=Object.keys(p);d.sort(),_.sort();for(let y=0;y<d.length&&y<_.length;++y){const T=Oh(d[y],_[y]);if(T!==0)return T;const I=_o(h[d[y]],p[_[y]]);if(I!==0)return I}return jt(d.length,_.length)}(e.mapValue,t.mapValue);default:throw xt()}}function pm(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return jt(e,t);const n=ks(e),i=ks(t),r=jt(n.seconds,i.seconds);return r!==0?r:jt(n.nanos,i.nanos)}function mm(e,t){const n=e.values||[],i=t.values||[];for(let r=0;r<n.length&&r<i.length;++r){const o=_o(n[r],i[r]);if(o)return o}return jt(n.length,i.length)}function go(e){return Dh(e)}function Dh(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const i=ks(n);return`time(${i.seconds},${i.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return Ls(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return Tt.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let i="[",r=!0;for(const o of n.values||[])r?r=!1:i+=",",i+=Dh(o);return i+"]"}(e.arrayValue):"mapValue"in e?function(n){const i=Object.keys(n.fields||{}).sort();let r="{",o=!0;for(const l of i)o?o=!1:r+=",",r+=`${l}:${Dh(n.fields[l])}`;return r+"}"}(e.mapValue):xt()}function hc(e){switch(Ms(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=fu(e);return t?16+hc(t):16;case 5:return 2*e.stringValue.length;case 6:return Ls(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((r,o)=>r+hc(o),0)}(e.arrayValue);case 10:case 11:return function(i){let r=0;return Fs(i.fields,(o,l)=>{r+=o.length+hc(l)}),r}(e.mapValue);default:throw xt()}}function _m(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Nh(e){return!!e&&"integerValue"in e}function xd(e){return!!e&&"arrayValue"in e}function gm(e){return!!e&&"nullValue"in e}function vm(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function dc(e){return!!e&&"mapValue"in e}function QP(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[Cv])===null||n===void 0?void 0:n.stringValue)===Rv}function xa(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Fs(e.mapValue.fields,(n,i)=>t.mapValue.fields[n]=xa(i)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=xa(e.arrayValue.values[n]);return t}return Object.assign({},e)}function YP(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===ZP}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(t){this.value=t}static empty(){return new En({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let i=0;i<t.length-1;++i)if(n=(n.mapValue.fields||{})[t.get(i)],!dc(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=xa(n)}setAll(t){let n=Ge.emptyPath(),i={},r=[];t.forEach((l,h)=>{if(!n.isImmediateParentOf(h)){const d=this.getFieldsMap(n);this.applyChanges(d,i,r),i={},r=[],n=h.popLast()}l?i[h.lastSegment()]=xa(l):r.push(h.lastSegment())});const o=this.getFieldsMap(n);this.applyChanges(o,i,r)}delete(t){const n=this.field(t.popLast());dc(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return Pi(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<t.length;++i){let r=n.mapValue.fields[t.get(i)];dc(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[t.get(i)]=r),n=r}return n.mapValue.fields}applyChanges(t,n,i){Fs(n,(r,o)=>t[r]=o);for(const r of i)delete t[r]}clone(){return new En(xa(this.value))}}function Sv(e){const t=[];return Fs(e.fields,(n,i)=>{const r=new Ge([n]);if(dc(i)){const o=Sv(i.mapValue).fields;if(o.length===0)t.push(r);else for(const l of o)t.push(r.child(l))}else t.push(r)}),new Mn(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(t,n,i,r,o,l,h){this.key=t,this.documentType=n,this.version=i,this.readTime=r,this.createTime=o,this.data=l,this.documentState=h}static newInvalidDocument(t){return new en(t,0,Dt.min(),Dt.min(),Dt.min(),En.empty(),0)}static newFoundDocument(t,n,i,r){return new en(t,1,n,Dt.min(),i,r,0)}static newNoDocument(t,n){return new en(t,2,n,Dt.min(),Dt.min(),En.empty(),0)}static newUnknownDocument(t,n){return new en(t,3,n,Dt.min(),Dt.min(),En.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(Dt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=En.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=En.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Dt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof en&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new en(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{constructor(t,n){this.position=t,this.inclusive=n}}function ym(e,t,n){let i=0;for(let r=0;r<e.position.length;r++){const o=t[r],l=e.position[r];if(o.field.isKeyField()?i=Tt.comparator(Tt.fromName(l.referenceValue),n.key):i=_o(l,n.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function wm(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Pi(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(t,n="asc"){this.field=t,this.dir=n}}function XP(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{}class Ne extends xv{constructor(t,n,i){super(),this.field=t,this.op=n,this.value=i}static create(t,n,i){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,i):new tA(t,n,i):n==="array-contains"?new iA(t,i):n==="in"?new sA(t,i):n==="not-in"?new rA(t,i):n==="array-contains-any"?new oA(t,i):new Ne(t,n,i)}static createKeyFieldInFilter(t,n,i){return n==="in"?new eA(t,i):new nA(t,i)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(_o(n,this.value)):n!==null&&Ms(this.value)===Ms(n)&&this.matchesComparison(_o(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return xt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ri extends xv{constructor(t,n){super(),this.filters=t,this.op=n,this.ce=null}static create(t,n){return new ri(t,n)}matches(t){return kv(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function kv(e){return e.op==="and"}function Lv(e){return JP(e)&&kv(e)}function JP(e){for(const t of e.filters)if(t instanceof ri)return!1;return!0}function Vh(e){if(e instanceof Ne)return e.field.canonicalString()+e.op.toString()+go(e.value);if(Lv(e))return e.filters.map(t=>Vh(t)).join(",");{const t=e.filters.map(n=>Vh(n)).join(",");return`${e.op}(${t})`}}function Mv(e,t){return e instanceof Ne?function(i,r){return r instanceof Ne&&i.op===r.op&&i.field.isEqual(r.field)&&Pi(i.value,r.value)}(e,t):e instanceof ri?function(i,r){return r instanceof ri&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((o,l,h)=>o&&Mv(l,r.filters[h]),!0):!1}(e,t):void xt()}function Ov(e){return e instanceof Ne?function(n){return`${n.field.canonicalString()} ${n.op} ${go(n.value)}`}(e):e instanceof ri?function(n){return n.op.toString()+" {"+n.getFilters().map(Ov).join(" ,")+"}"}(e):"Filter"}class tA extends Ne{constructor(t,n,i){super(t,n,i),this.key=Tt.fromName(i.referenceValue)}matches(t){const n=Tt.comparator(t.key,this.key);return this.matchesComparison(n)}}class eA extends Ne{constructor(t,n){super(t,"in",n),this.keys=Dv("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class nA extends Ne{constructor(t,n){super(t,"not-in",n),this.keys=Dv("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function Dv(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(i=>Tt.fromName(i.referenceValue))}class iA extends Ne{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return xd(n)&&Za(n.arrayValue,this.value)}}class sA extends Ne{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&Za(this.value.arrayValue,n)}}class rA extends Ne{constructor(t,n){super(t,"not-in",n)}matches(t){if(Za(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&!Za(this.value.arrayValue,n)}}class oA extends Ne{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!xd(n)||!n.arrayValue.values)&&n.arrayValue.values.some(i=>Za(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aA{constructor(t,n=null,i=[],r=[],o=null,l=null,h=null){this.path=t,this.collectionGroup=n,this.orderBy=i,this.filters=r,this.limit=o,this.startAt=l,this.endAt=h,this.le=null}}function Tm(e,t=null,n=[],i=[],r=null,o=null,l=null){return new aA(e,t,n,i,r,o,l)}function kd(e){const t=Nt(e);if(t.le===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(i=>Vh(i)).join(","),n+="|ob:",n+=t.orderBy.map(i=>function(o){return o.field.canonicalString()+o.dir}(i)).join(","),du(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>go(i)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>go(i)).join(",")),t.le=n}return t.le}function Ld(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!XP(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Mv(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!wm(e.startAt,t.startAt)&&wm(e.endAt,t.endAt)}function Uh(e){return Tt.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(t,n=null,i=[],r=[],o=null,l="F",h=null,d=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=r,this.limit=o,this.limitType=l,this.startAt=h,this.endAt=d,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function lA(e,t,n,i,r,o,l,h){return new Ro(e,t,n,i,r,o,l,h)}function pu(e){return new Ro(e)}function Em(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function Nv(e){return e.collectionGroup!==null}function ka(e){const t=Nt(e);if(t.he===null){t.he=[];const n=new Set;for(const o of t.explicitOrderBy)t.he.push(o),n.add(o.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(l){let h=new Fe(Ge.comparator);return l.filters.forEach(d=>{d.getFlattenedFilters().forEach(p=>{p.isInequality()&&(h=h.add(p.field))})}),h})(t).forEach(o=>{n.has(o.canonicalString())||o.isKeyField()||t.he.push(new Qa(o,i))}),n.has(Ge.keyField().canonicalString())||t.he.push(new Qa(Ge.keyField(),i))}return t.he}function wi(e){const t=Nt(e);return t.Pe||(t.Pe=cA(t,ka(e))),t.Pe}function cA(e,t){if(e.limitType==="F")return Tm(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(r=>{const o=r.dir==="desc"?"asc":"desc";return new Qa(r.field,o)});const n=e.endAt?new Mc(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Mc(e.startAt.position,e.startAt.inclusive):null;return Tm(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}}function Fh(e,t){const n=e.filters.concat([t]);return new Ro(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Bh(e,t,n){return new Ro(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function mu(e,t){return Ld(wi(e),wi(t))&&e.limitType===t.limitType}function Vv(e){return`${kd(wi(e))}|lt:${e.limitType}`}function Qr(e){return`Query(target=${function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map(r=>Ov(r)).join(", ")}]`),du(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map(r=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(r)).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map(r=>go(r)).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map(r=>go(r)).join(",")),`Target(${i})`}(wi(e))}; limitType=${e.limitType})`}function _u(e,t){return t.isFoundDocument()&&function(i,r){const o=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Tt.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)}(e,t)&&function(i,r){for(const o of ka(i))if(!o.field.isKeyField()&&r.data.field(o.field)===null)return!1;return!0}(e,t)&&function(i,r){for(const o of i.filters)if(!o.matches(r))return!1;return!0}(e,t)&&function(i,r){return!(i.startAt&&!function(l,h,d){const p=ym(l,h,d);return l.inclusive?p<=0:p<0}(i.startAt,ka(i),r)||i.endAt&&!function(l,h,d){const p=ym(l,h,d);return l.inclusive?p>=0:p>0}(i.endAt,ka(i),r))}(e,t)}function uA(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Uv(e){return(t,n)=>{let i=!1;for(const r of ka(e)){const o=hA(r,t,n);if(o!==0)return o;i=i||r.field.isKeyField()}return 0}}function hA(e,t,n){const i=e.field.isKeyField()?Tt.comparator(t.key,n.key):function(o,l,h){const d=l.data.field(o),p=h.data.field(o);return d!==null&&p!==null?_o(d,p):xt()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return xt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i!==void 0){for(const[r,o]of i)if(this.equalsFn(r,t))return o}}has(t){return this.get(t)!==void 0}set(t,n){const i=this.mapKeyFn(t),r=this.inner[i];if(r===void 0)return this.inner[i]=[[t,n]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],t))return void(r[o]=[t,n]);r.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],t))return i.length===1?delete this.inner[n]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(t){Fs(this.inner,(n,i)=>{for(const[r,o]of i)t(r,o)})}isEmpty(){return Tv(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dA=new Ie(Tt.comparator);function Ji(){return dA}const Fv=new Ie(Tt.comparator);function _a(...e){let t=Fv;for(const n of e)t=t.insert(n.key,n);return t}function Bv(e){let t=Fv;return e.forEach((n,i)=>t=t.insert(n,i.overlayedDocument)),t}function rr(){return La()}function zv(){return La()}function La(){return new wr(e=>e.toString(),(e,t)=>e.isEqual(t))}const fA=new Ie(Tt.comparator),pA=new Fe(Tt.comparator);function Xt(...e){let t=pA;for(const n of e)t=t.add(n);return t}const mA=new Fe(jt);function _A(){return mA}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Md(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xc(t)?"-0":t}}function jv(e){return{integerValue:""+e}}function gA(e,t){return $P(t)?jv(t):Md(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(){this._=void 0}}function vA(e,t,n){return e instanceof Oc?function(r,o){const l={fields:{[Iv]:{stringValue:bv},[Av]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&Sd(o)&&(o=fu(o)),o&&(l.fields[Pv]=o),{mapValue:l}}(n,t):e instanceof Ya?$v(e,t):e instanceof Xa?qv(e,t):function(r,o){const l=Hv(r,o),h=bm(l)+bm(r.Ie);return Nh(l)&&Nh(r.Ie)?jv(h):Md(r.serializer,h)}(e,t)}function yA(e,t,n){return e instanceof Ya?$v(e,t):e instanceof Xa?qv(e,t):n}function Hv(e,t){return e instanceof Dc?function(i){return Nh(i)||function(o){return!!o&&"doubleValue"in o}(i)}(t)?t:{integerValue:0}:null}class Oc extends gu{}class Ya extends gu{constructor(t){super(),this.elements=t}}function $v(e,t){const n=Wv(t);for(const i of e.elements)n.some(r=>Pi(r,i))||n.push(i);return{arrayValue:{values:n}}}class Xa extends gu{constructor(t){super(),this.elements=t}}function qv(e,t){let n=Wv(t);for(const i of e.elements)n=n.filter(r=>!Pi(r,i));return{arrayValue:{values:n}}}class Dc extends gu{constructor(t,n){super(),this.serializer=t,this.Ie=n}}function bm(e){return xe(e.integerValue||e.doubleValue)}function Wv(e){return xd(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function wA(e,t){return e.field.isEqual(t.field)&&function(i,r){return i instanceof Ya&&r instanceof Ya||i instanceof Xa&&r instanceof Xa?mo(i.elements,r.elements,Pi):i instanceof Dc&&r instanceof Dc?Pi(i.Ie,r.Ie):i instanceof Oc&&r instanceof Oc}(e.transform,t.transform)}class TA{constructor(t,n){this.version=t,this.transformResults=n}}class $n{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new $n}static exists(t){return new $n(void 0,t)}static updateTime(t){return new $n(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function fc(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class vu{}function Kv(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new Od(e.key,$n.none()):new ll(e.key,e.data,$n.none());{const n=e.data,i=En.empty();let r=new Fe(Ge.comparator);for(let o of t.fields)if(!r.has(o)){let l=n.field(o);l===null&&o.length>1&&(o=o.popLast(),l=n.field(o)),l===null?i.delete(o):i.set(o,l),r=r.add(o)}return new Bs(e.key,i,new Mn(r.toArray()),$n.none())}}function EA(e,t,n){e instanceof ll?function(r,o,l){const h=r.value.clone(),d=Pm(r.fieldTransforms,o,l.transformResults);h.setAll(d),o.convertToFoundDocument(l.version,h).setHasCommittedMutations()}(e,t,n):e instanceof Bs?function(r,o,l){if(!fc(r.precondition,o))return void o.convertToUnknownDocument(l.version);const h=Pm(r.fieldTransforms,o,l.transformResults),d=o.data;d.setAll(Gv(r)),d.setAll(h),o.convertToFoundDocument(l.version,d).setHasCommittedMutations()}(e,t,n):function(r,o,l){o.convertToNoDocument(l.version).setHasCommittedMutations()}(0,t,n)}function Ma(e,t,n,i){return e instanceof ll?function(o,l,h,d){if(!fc(o.precondition,l))return h;const p=o.value.clone(),_=Am(o.fieldTransforms,d,l);return p.setAll(_),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),null}(e,t,n,i):e instanceof Bs?function(o,l,h,d){if(!fc(o.precondition,l))return h;const p=Am(o.fieldTransforms,d,l),_=l.data;return _.setAll(Gv(o)),_.setAll(p),l.convertToFoundDocument(l.version,_).setHasLocalMutations(),h===null?null:h.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(y=>y.field))}(e,t,n,i):function(o,l,h){return fc(o.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):h}(e,t,n)}function bA(e,t){let n=null;for(const i of e.fieldTransforms){const r=t.data.field(i.field),o=Hv(i.transform,r||null);o!=null&&(n===null&&(n=En.empty()),n.set(i.field,o))}return n||null}function Im(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&mo(i,r,(o,l)=>wA(o,l))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class ll extends vu{constructor(t,n,i,r=[]){super(),this.key=t,this.value=n,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Bs extends vu{constructor(t,n,i,r,o=[]){super(),this.key=t,this.data=n,this.fieldMask=i,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function Gv(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}}),t}function Pm(e,t,n){const i=new Map;re(e.length===n.length);for(let r=0;r<n.length;r++){const o=e[r],l=o.transform,h=t.data.field(o.field);i.set(o.field,yA(l,h,n[r]))}return i}function Am(e,t,n){const i=new Map;for(const r of e){const o=r.transform,l=n.data.field(r.field);i.set(r.field,vA(o,l,t))}return i}class Od extends vu{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class IA extends vu{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(t,n,i,r){this.batchId=t,this.localWriteTime=n,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(t,n){const i=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const o=this.mutations[r];o.key.isEqual(t.key)&&EA(o,t,i[r])}}applyToLocalView(t,n){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(n=Ma(i,t,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(n=Ma(i,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const i=zv();return this.mutations.forEach(r=>{const o=t.get(r.key),l=o.overlayedDocument;let h=this.applyToLocalView(l,o.mutatedFields);h=n.has(r.key)?null:h;const d=Kv(l,h);d!==null&&i.set(r.key,d),l.isValidDocument()||l.convertToNoDocument(Dt.min())}),i}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),Xt())}isEqual(t){return this.batchId===t.batchId&&mo(this.mutations,t.mutations,(n,i)=>Im(n,i))&&mo(this.baseMutations,t.baseMutations,(n,i)=>Im(n,i))}}class Dd{constructor(t,n,i,r){this.batch=t,this.commitVersion=n,this.mutationResults=i,this.docVersions=r}static from(t,n,i){re(t.mutations.length===i.length);let r=function(){return fA}();const o=t.mutations;for(let l=0;l<o.length;l++)r=r.insert(o[l].key,i[l].version);return new Dd(t,n,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var De,ee;function RA(e){switch(e){case K.OK:return xt();case K.CANCELLED:case K.UNKNOWN:case K.DEADLINE_EXCEEDED:case K.RESOURCE_EXHAUSTED:case K.INTERNAL:case K.UNAVAILABLE:case K.UNAUTHENTICATED:return!1;case K.INVALID_ARGUMENT:case K.NOT_FOUND:case K.ALREADY_EXISTS:case K.PERMISSION_DENIED:case K.FAILED_PRECONDITION:case K.ABORTED:case K.OUT_OF_RANGE:case K.UNIMPLEMENTED:case K.DATA_LOSS:return!0;default:return xt()}}function Zv(e){if(e===void 0)return Xi("GRPC error has no .code"),K.UNKNOWN;switch(e){case De.OK:return K.OK;case De.CANCELLED:return K.CANCELLED;case De.UNKNOWN:return K.UNKNOWN;case De.DEADLINE_EXCEEDED:return K.DEADLINE_EXCEEDED;case De.RESOURCE_EXHAUSTED:return K.RESOURCE_EXHAUSTED;case De.INTERNAL:return K.INTERNAL;case De.UNAVAILABLE:return K.UNAVAILABLE;case De.UNAUTHENTICATED:return K.UNAUTHENTICATED;case De.INVALID_ARGUMENT:return K.INVALID_ARGUMENT;case De.NOT_FOUND:return K.NOT_FOUND;case De.ALREADY_EXISTS:return K.ALREADY_EXISTS;case De.PERMISSION_DENIED:return K.PERMISSION_DENIED;case De.FAILED_PRECONDITION:return K.FAILED_PRECONDITION;case De.ABORTED:return K.ABORTED;case De.OUT_OF_RANGE:return K.OUT_OF_RANGE;case De.UNIMPLEMENTED:return K.UNIMPLEMENTED;case De.DATA_LOSS:return K.DATA_LOSS;default:return xt()}}(ee=De||(De={}))[ee.OK=0]="OK",ee[ee.CANCELLED=1]="CANCELLED",ee[ee.UNKNOWN=2]="UNKNOWN",ee[ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ee[ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ee[ee.NOT_FOUND=5]="NOT_FOUND",ee[ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",ee[ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",ee[ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",ee[ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ee[ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ee[ee.ABORTED=10]="ABORTED",ee[ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",ee[ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",ee[ee.INTERNAL=13]="INTERNAL",ee[ee.UNAVAILABLE=14]="UNAVAILABLE",ee[ee.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SA=new Cs([4294967295,4294967295],0);function Cm(e){const t=vv().encode(e),n=new hv;return n.update(t),new Uint8Array(n.digest())}function Rm(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),r=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new Cs([n,i],0),new Cs([r,o],0)]}class Nd{constructor(t,n,i){if(this.bitmap=t,this.padding=n,this.hashCount=i,n<0||n>=8)throw new ga(`Invalid padding: ${n}`);if(i<0)throw new ga(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new ga(`Invalid hash count: ${i}`);if(t.length===0&&n!==0)throw new ga(`Invalid padding when bitmap length is 0: ${n}`);this.Ee=8*t.length-n,this.de=Cs.fromNumber(this.Ee)}Ae(t,n,i){let r=t.add(n.multiply(Cs.fromNumber(i)));return r.compare(SA)===1&&(r=new Cs([r.getBits(0),r.getBits(1)],0)),r.modulo(this.de).toNumber()}Re(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.Ee===0)return!1;const n=Cm(t),[i,r]=Rm(n);for(let o=0;o<this.hashCount;o++){const l=this.Ae(i,r,o);if(!this.Re(l))return!1}return!0}static create(t,n,i){const r=t%8==0?0:8-t%8,o=new Uint8Array(Math.ceil(t/8)),l=new Nd(o,r,n);return i.forEach(h=>l.insert(h)),l}insert(t){if(this.Ee===0)return;const n=Cm(t),[i,r]=Rm(n);for(let o=0;o<this.hashCount;o++){const l=this.Ae(i,r,o);this.Ve(l)}}Ve(t){const n=Math.floor(t/8),i=t%8;this.bitmap[n]|=1<<i}}class ga extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(t,n,i,r,o){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(t,n,i){const r=new Map;return r.set(t,cl.createSynthesizedTargetChangeForCurrentChange(t,n,i)),new yu(Dt.min(),r,new Ie(jt),Ji(),Xt())}}class cl{constructor(t,n,i,r,o){this.resumeToken=t,this.current=n,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(t,n,i){return new cl(i,n,Xt(),Xt(),Xt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(t,n,i,r){this.me=t,this.removedTargetIds=n,this.key=i,this.fe=r}}class Qv{constructor(t,n){this.targetId=t,this.ge=n}}class Yv{constructor(t,n,i=Ze.EMPTY_BYTE_STRING,r=null){this.state=t,this.targetIds=n,this.resumeToken=i,this.cause=r}}class Sm{constructor(){this.pe=0,this.ye=xm(),this.we=Ze.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.be}Ce(t){t.approximateByteSize()>0&&(this.be=!0,this.we=t)}Fe(){let t=Xt(),n=Xt(),i=Xt();return this.ye.forEach((r,o)=>{switch(o){case 0:t=t.add(r);break;case 2:n=n.add(r);break;case 1:i=i.add(r);break;default:xt()}}),new cl(this.we,this.Se,t,n,i)}Me(){this.be=!1,this.ye=xm()}xe(t,n){this.be=!0,this.ye=this.ye.insert(t,n)}Oe(t){this.be=!0,this.ye=this.ye.remove(t)}Ne(){this.pe+=1}Be(){this.pe-=1,re(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class xA{constructor(t){this.ke=t,this.qe=new Map,this.Qe=Ji(),this.$e=tc(),this.Ue=tc(),this.Ke=new Ie(jt)}We(t){for(const n of t.me)t.fe&&t.fe.isFoundDocument()?this.Ge(n,t.fe):this.ze(n,t.key,t.fe);for(const n of t.removedTargetIds)this.ze(n,t.key,t.fe)}je(t){this.forEachTarget(t,n=>{const i=this.He(n);switch(t.state){case 0:this.Je(n)&&i.Ce(t.resumeToken);break;case 1:i.Be(),i.De||i.Me(),i.Ce(t.resumeToken);break;case 2:i.Be(),i.De||this.removeTarget(n);break;case 3:this.Je(n)&&(i.Le(),i.Ce(t.resumeToken));break;case 4:this.Je(n)&&(this.Ye(n),i.Ce(t.resumeToken));break;default:xt()}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.qe.forEach((i,r)=>{this.Je(r)&&n(r)})}Ze(t){const n=t.targetId,i=t.ge.count,r=this.Xe(n);if(r){const o=r.target;if(Uh(o))if(i===0){const l=new Tt(o.path);this.ze(n,l,en.newNoDocument(l,Dt.min()))}else re(i===1);else{const l=this.et(n);if(l!==i){const h=this.tt(t),d=h?this.nt(h,t,l):1;if(d!==0){this.Ye(n);const p=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,p)}}}}}tt(t){const n=t.ge.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:o=0}=n;let l,h;try{l=Ls(i).toUint8Array()}catch(d){if(d instanceof Ev)return po("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{h=new Nd(l,r,o)}catch(d){return po(d instanceof ga?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return h.Ee===0?null:h}nt(t,n,i){return n.ge.count===i-this.st(t,n.targetId)?0:2}st(t,n){const i=this.ke.getRemoteKeysForTarget(n);let r=0;return i.forEach(o=>{const l=this.ke.it(),h=`projects/${l.projectId}/databases/${l.database}/documents/${o.path.canonicalString()}`;t.mightContain(h)||(this.ze(n,o,null),r++)}),r}ot(t){const n=new Map;this.qe.forEach((o,l)=>{const h=this.Xe(l);if(h){if(o.current&&Uh(h.target)){const d=new Tt(h.target.path);this._t(d).has(l)||this.ut(l,d)||this.ze(l,d,en.newNoDocument(d,t))}o.ve&&(n.set(l,o.Fe()),o.Me())}});let i=Xt();this.Ue.forEach((o,l)=>{let h=!0;l.forEachWhile(d=>{const p=this.Xe(d);return!p||p.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)}),h&&(i=i.add(o))}),this.Qe.forEach((o,l)=>l.setReadTime(t));const r=new yu(t,n,this.Ke,this.Qe,i);return this.Qe=Ji(),this.$e=tc(),this.Ue=tc(),this.Ke=new Ie(jt),r}Ge(t,n){if(!this.Je(t))return;const i=this.ut(t,n.key)?2:0;this.He(t).xe(n.key,i),this.Qe=this.Qe.insert(n.key,n),this.$e=this.$e.insert(n.key,this._t(n.key).add(t)),this.Ue=this.Ue.insert(n.key,this.ct(n.key).add(t))}ze(t,n,i){if(!this.Je(t))return;const r=this.He(t);this.ut(t,n)?r.xe(n,1):r.Oe(n),this.Ue=this.Ue.insert(n,this.ct(n).delete(t)),this.Ue=this.Ue.insert(n,this.ct(n).add(t)),i&&(this.Qe=this.Qe.insert(n,i))}removeTarget(t){this.qe.delete(t)}et(t){const n=this.He(t).Fe();return this.ke.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}Ne(t){this.He(t).Ne()}He(t){let n=this.qe.get(t);return n||(n=new Sm,this.qe.set(t,n)),n}ct(t){let n=this.Ue.get(t);return n||(n=new Fe(jt),this.Ue=this.Ue.insert(t,n)),n}_t(t){let n=this.$e.get(t);return n||(n=new Fe(jt),this.$e=this.$e.insert(t,n)),n}Je(t){const n=this.Xe(t)!==null;return n||ft("WatchChangeAggregator","Detected inactive target",t),n}Xe(t){const n=this.qe.get(t);return n&&n.De?null:this.ke.lt(t)}Ye(t){this.qe.set(t,new Sm),this.ke.getRemoteKeysForTarget(t).forEach(n=>{this.ze(t,n,null)})}ut(t,n){return this.ke.getRemoteKeysForTarget(t).has(n)}}function tc(){return new Ie(Tt.comparator)}function xm(){return new Ie(Tt.comparator)}const kA={asc:"ASCENDING",desc:"DESCENDING"},LA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},MA={and:"AND",or:"OR"};class OA{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function zh(e,t){return e.useProto3Json||du(t)?t:{value:t}}function Nc(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Xv(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function DA(e,t){return Nc(e,t.toTimestamp())}function Ti(e){return re(!!e),Dt.fromTimestamp(function(n){const i=ks(n);return new Ue(i.seconds,i.nanos)}(e))}function Vd(e,t){return jh(e,t).canonicalString()}function jh(e,t){const n=function(r){return new ge(["projects",r.projectId,"databases",r.database])}(e).child("documents");return t===void 0?n:n.child(t)}function Jv(e){const t=ge.fromString(e);return re(sy(t)),t}function Hh(e,t){return Vd(e.databaseId,t.path)}function oh(e,t){const n=Jv(t);if(n.get(1)!==e.databaseId.projectId)throw new pt(K.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new pt(K.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Tt(ey(n))}function ty(e,t){return Vd(e.databaseId,t)}function NA(e){const t=Jv(e);return t.length===4?ge.emptyPath():ey(t)}function $h(e){return new ge(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function ey(e){return re(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function km(e,t,n){return{name:Hh(e,t),fields:n.value.mapValue.fields}}function VA(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:xt()}(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],o=function(p,_){return p.useProto3Json?(re(_===void 0||typeof _=="string"),Ze.fromBase64String(_||"")):(re(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array),Ze.fromUint8Array(_||new Uint8Array))}(e,t.targetChange.resumeToken),l=t.targetChange.cause,h=l&&function(p){const _=p.code===void 0?K.UNKNOWN:Zv(p.code);return new pt(_,p.message||"")}(l);n=new Yv(i,r,o,h||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const r=oh(e,i.document.name),o=Ti(i.document.updateTime),l=i.document.createTime?Ti(i.document.createTime):Dt.min(),h=new En({mapValue:{fields:i.document.fields}}),d=en.newFoundDocument(r,o,l,h),p=i.targetIds||[],_=i.removedTargetIds||[];n=new pc(p,_,d.key,d)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const r=oh(e,i.document),o=i.readTime?Ti(i.readTime):Dt.min(),l=en.newNoDocument(r,o),h=i.removedTargetIds||[];n=new pc([],h,l.key,l)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const r=oh(e,i.document),o=i.removedTargetIds||[];n=new pc([],o,r,null)}else{if(!("filter"in t))return xt();{t.filter;const i=t.filter;i.targetId;const{count:r=0,unchangedNames:o}=i,l=new CA(r,o),h=i.targetId;n=new Qv(h,l)}}return n}function UA(e,t){let n;if(t instanceof ll)n={update:km(e,t.key,t.value)};else if(t instanceof Od)n={delete:Hh(e,t.key)};else if(t instanceof Bs)n={update:km(e,t.key,t.data),updateMask:KA(t.fieldMask)};else{if(!(t instanceof IA))return xt();n={verify:Hh(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(i=>function(o,l){const h=l.transform;if(h instanceof Oc)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Ya)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Xa)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof Dc)return{fieldPath:l.field.canonicalString(),increment:h.Ie};throw xt()}(0,i))),t.precondition.isNone||(n.currentDocument=function(r,o){return o.updateTime!==void 0?{updateTime:DA(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:xt()}(e,t.precondition)),n}function FA(e,t){return e&&e.length>0?(re(t!==void 0),e.map(n=>function(r,o){let l=r.updateTime?Ti(r.updateTime):Ti(o);return l.isEqual(Dt.min())&&(l=Ti(o)),new TA(l,r.transformResults||[])}(n,t))):[]}function BA(e,t){return{documents:[ty(e,t.path)]}}function zA(e,t){const n={structuredQuery:{}},i=t.path;let r;t.collectionGroup!==null?(r=i,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=ty(e,r);const o=function(p){if(p.length!==0)return iy(ri.create(p,"and"))}(t.filters);o&&(n.structuredQuery.where=o);const l=function(p){if(p.length!==0)return p.map(_=>function(T){return{field:Yr(T.field),direction:$A(T.dir)}}(_))}(t.orderBy);l&&(n.structuredQuery.orderBy=l);const h=zh(e,t.limit);return h!==null&&(n.structuredQuery.limit=h),t.startAt&&(n.structuredQuery.startAt=function(p){return{before:p.inclusive,values:p.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(p){return{before:!p.inclusive,values:p.position}}(t.endAt)),{ht:n,parent:r}}function jA(e){let t=NA(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){re(i===1);const _=n.from[0];_.allDescendants?r=_.collectionId:t=t.child(_.collectionId)}let o=[];n.where&&(o=function(y){const T=ny(y);return T instanceof ri&&Lv(T)?T.getFilters():[T]}(n.where));let l=[];n.orderBy&&(l=function(y){return y.map(T=>function(U){return new Qa(Xr(U.field),function(j){switch(j){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(U.direction))}(T))}(n.orderBy));let h=null;n.limit&&(h=function(y){let T;return T=typeof y=="object"?y.value:y,du(T)?null:T}(n.limit));let d=null;n.startAt&&(d=function(y){const T=!!y.before,I=y.values||[];return new Mc(I,T)}(n.startAt));let p=null;return n.endAt&&(p=function(y){const T=!y.before,I=y.values||[];return new Mc(I,T)}(n.endAt)),lA(t,r,l,o,h,"F",d,p)}function HA(e,t){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return xt()}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function ny(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=Xr(n.unaryFilter.field);return Ne.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Xr(n.unaryFilter.field);return Ne.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Xr(n.unaryFilter.field);return Ne.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Xr(n.unaryFilter.field);return Ne.create(l,"!=",{nullValue:"NULL_VALUE"});default:return xt()}}(e):e.fieldFilter!==void 0?function(n){return Ne.create(Xr(n.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return xt()}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return ri.create(n.compositeFilter.filters.map(i=>ny(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return xt()}}(n.compositeFilter.op))}(e):xt()}function $A(e){return kA[e]}function qA(e){return LA[e]}function WA(e){return MA[e]}function Yr(e){return{fieldPath:e.canonicalString()}}function Xr(e){return Ge.fromServerFormat(e.fieldPath)}function iy(e){return e instanceof Ne?function(n){if(n.op==="=="){if(vm(n.value))return{unaryFilter:{field:Yr(n.field),op:"IS_NAN"}};if(gm(n.value))return{unaryFilter:{field:Yr(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(vm(n.value))return{unaryFilter:{field:Yr(n.field),op:"IS_NOT_NAN"}};if(gm(n.value))return{unaryFilter:{field:Yr(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yr(n.field),op:qA(n.op),value:n.value}}}(e):e instanceof ri?function(n){const i=n.getFilters().map(r=>iy(r));return i.length===1?i[0]:{compositeFilter:{op:WA(n.op),filters:i}}}(e):xt()}function KA(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function sy(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(t,n,i,r,o=Dt.min(),l=Dt.min(),h=Ze.EMPTY_BYTE_STRING,d=null){this.target=t,this.targetId=n,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=h,this.expectedCount=d}withSequenceNumber(t){return new Es(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new Es(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Es(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Es(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA{constructor(t){this.Tt=t}}function ZA(e){const t=jA({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Bh(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QA{constructor(){this.Tn=new YA}addToCollectionParentIndex(t,n){return this.Tn.add(n),Z.resolve()}getCollectionParents(t,n){return Z.resolve(this.Tn.getEntries(n))}addFieldIndex(t,n){return Z.resolve()}deleteFieldIndex(t,n){return Z.resolve()}deleteAllFieldIndexes(t){return Z.resolve()}createTargetIndexes(t,n){return Z.resolve()}getDocumentsMatchingTarget(t,n){return Z.resolve(null)}getIndexType(t,n){return Z.resolve(0)}getFieldIndexes(t,n){return Z.resolve([])}getNextCollectionGroupToUpdate(t){return Z.resolve(null)}getMinOffset(t,n){return Z.resolve(xs.min())}getMinOffsetFromCollectionGroup(t,n){return Z.resolve(xs.min())}updateCollectionGroup(t,n,i){return Z.resolve()}updateIndexEntries(t,n){return Z.resolve()}}class YA{constructor(){this.index={}}add(t){const n=t.lastSegment(),i=t.popLast(),r=this.index[n]||new Fe(ge.comparator),o=!r.has(i);return this.index[n]=r.add(i),o}has(t){const n=t.lastSegment(),i=t.popLast(),r=this.index[n];return r&&r.has(i)}getEntries(t){return(this.index[t]||new Fe(ge.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lm={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ry=41943040;class wn{static withCacheSize(t){return new wn(t,wn.DEFAULT_COLLECTION_PERCENTILE,wn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wn.DEFAULT_COLLECTION_PERCENTILE=10,wn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wn.DEFAULT=new wn(ry,wn.DEFAULT_COLLECTION_PERCENTILE,wn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wn.DISABLED=new wn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(t){this.$n=t}next(){return this.$n+=2,this.$n}static Un(){return new vo(0)}static Kn(){return new vo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mm="LruGarbageCollector",XA=1048576;function Om([e,t],[n,i]){const r=jt(e,n);return r===0?jt(t,i):r}class JA{constructor(t){this.Hn=t,this.buffer=new Fe(Om),this.Jn=0}Yn(){return++this.Jn}Zn(t){const n=[t,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();Om(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class tC{constructor(t,n,i){this.garbageCollector=t,this.asyncQueue=n,this.localStore=i,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(t){ft(Mm,`Garbage collection scheduled in ${t}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Co(n)?ft(Mm,"Ignoring IndexedDB error during garbage collection: ",n):await Ao(n)}await this.er(3e5)})}}class eC{constructor(t,n){this.tr=t,this.params=n}calculateTargetCount(t,n){return this.tr.nr(t).next(i=>Math.floor(n/100*i))}nthSequenceNumber(t,n){if(n===0)return Z.resolve(hu.ae);const i=new JA(n);return this.tr.forEachTarget(t,r=>i.Zn(r.sequenceNumber)).next(()=>this.tr.rr(t,r=>i.Zn(r))).next(()=>i.maxValue)}removeTargets(t,n,i){return this.tr.removeTargets(t,n,i)}removeOrphanedDocuments(t,n){return this.tr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(ft("LruGarbageCollector","Garbage collection skipped; disabled"),Z.resolve(Lm)):this.getCacheSize(t).next(i=>i<this.params.cacheSizeCollectionThreshold?(ft("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Lm):this.ir(t,n))}getCacheSize(t){return this.tr.getCacheSize(t)}ir(t,n){let i,r,o,l,h,d,p;const _=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(ft("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),r=this.params.maximumSequenceNumbersToCollect):r=y,l=Date.now(),this.nthSequenceNumber(t,r))).next(y=>(i=y,h=Date.now(),this.removeTargets(t,i,n))).next(y=>(o=y,d=Date.now(),this.removeOrphanedDocuments(t,i))).next(y=>(p=Date.now(),Zr()<=Yt.DEBUG&&ft("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-_}ms
	Determined least recently used ${r} in `+(h-l)+`ms
	Removed ${o} targets in `+(d-h)+`ms
	Removed ${y} documents in `+(p-d)+`ms
Total Duration: ${p-_}ms`),Z.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:y})))}}function nC(e,t){return new eC(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(){this.changes=new wr(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,en.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?Z.resolve(i):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(t,n,i,r){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=r}getDocument(t,n){let i=null;return this.documentOverlayCache.getOverlay(t,n).next(r=>(i=r,this.remoteDocumentCache.getEntry(t,n))).next(r=>(i!==null&&Ma(i.mutation,r,Mn.empty(),Ue.now()),r))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.getLocalViewOfDocuments(t,i,Xt()).next(()=>i))}getLocalViewOfDocuments(t,n,i=Xt()){const r=rr();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,i).next(o=>{let l=_a();return o.forEach((h,d)=>{l=l.insert(h,d.overlayedDocument)}),l}))}getOverlayedDocuments(t,n){const i=rr();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,Xt()))}populateOverlays(t,n,i){const r=[];return i.forEach(o=>{n.has(o)||r.push(o)}),this.documentOverlayCache.getOverlays(t,r).next(o=>{o.forEach((l,h)=>{n.set(l,h)})})}computeViews(t,n,i,r){let o=Ji();const l=La(),h=function(){return La()}();return n.forEach((d,p)=>{const _=i.get(p.key);r.has(p.key)&&(_===void 0||_.mutation instanceof Bs)?o=o.insert(p.key,p):_!==void 0?(l.set(p.key,_.mutation.getFieldMask()),Ma(_.mutation,p,_.mutation.getFieldMask(),Ue.now())):l.set(p.key,Mn.empty())}),this.recalculateAndSaveOverlays(t,o).next(d=>(d.forEach((p,_)=>l.set(p,_)),n.forEach((p,_)=>{var y;return h.set(p,new sC(_,(y=l.get(p))!==null&&y!==void 0?y:null))}),h))}recalculateAndSaveOverlays(t,n){const i=La();let r=new Ie((l,h)=>l-h),o=Xt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(l=>{for(const h of l)h.keys().forEach(d=>{const p=n.get(d);if(p===null)return;let _=i.get(d)||Mn.empty();_=h.applyToLocalView(p,_),i.set(d,_);const y=(r.get(h.batchId)||Xt()).add(d);r=r.insert(h.batchId,y)})}).next(()=>{const l=[],h=r.getReverseIterator();for(;h.hasNext();){const d=h.getNext(),p=d.key,_=d.value,y=zv();_.forEach(T=>{if(!o.has(T)){const I=Kv(n.get(T),i.get(T));I!==null&&y.set(T,I),o=o.add(T)}}),l.push(this.documentOverlayCache.saveOverlays(t,p,y))}return Z.waitFor(l)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,n,i,r){return function(l){return Tt.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):Nv(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,i,r):this.getDocumentsMatchingCollectionQuery(t,n,i,r)}getNextDocuments(t,n,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,i,r).next(o=>{const l=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,i.largestBatchId,r-o.size):Z.resolve(rr());let h=Wa,d=o;return l.next(p=>Z.forEach(p,(_,y)=>(h<y.largestBatchId&&(h=y.largestBatchId),o.get(_)?Z.resolve():this.remoteDocumentCache.getEntry(t,_).next(T=>{d=d.insert(_,T)}))).next(()=>this.populateOverlays(t,p,o)).next(()=>this.computeViews(t,d,p,Xt())).next(_=>({batchId:h,changes:Bv(_)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new Tt(n)).next(i=>{let r=_a();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(t,n,i,r){const o=n.collectionGroup;let l=_a();return this.indexManager.getCollectionParents(t,o).next(h=>Z.forEach(h,d=>{const p=function(y,T){return new Ro(T,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(n,d.child(o));return this.getDocumentsMatchingCollectionQuery(t,p,i,r).next(_=>{_.forEach((y,T)=>{l=l.insert(y,T)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(t,n,i,r){let o;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,i.largestBatchId).next(l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,i,o,r))).next(l=>{o.forEach((d,p)=>{const _=p.getKey();l.get(_)===null&&(l=l.insert(_,en.newInvalidDocument(_)))});let h=_a();return l.forEach((d,p)=>{const _=o.get(d);_!==void 0&&Ma(_.mutation,p,Mn.empty(),Ue.now()),_u(n,p)&&(h=h.insert(d,p))}),h})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(t){this.serializer=t,this.dr=new Map,this.Ar=new Map}getBundleMetadata(t,n){return Z.resolve(this.dr.get(n))}saveBundleMetadata(t,n){return this.dr.set(n.id,function(r){return{id:r.id,version:r.version,createTime:Ti(r.createTime)}}(n)),Z.resolve()}getNamedQuery(t,n){return Z.resolve(this.Ar.get(n))}saveNamedQuery(t,n){return this.Ar.set(n.name,function(r){return{name:r.name,query:ZA(r.bundledQuery),readTime:Ti(r.readTime)}}(n)),Z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(){this.overlays=new Ie(Tt.comparator),this.Rr=new Map}getOverlay(t,n){return Z.resolve(this.overlays.get(n))}getOverlays(t,n){const i=rr();return Z.forEach(n,r=>this.getOverlay(t,r).next(o=>{o!==null&&i.set(r,o)})).next(()=>i)}saveOverlays(t,n,i){return i.forEach((r,o)=>{this.Et(t,n,o)}),Z.resolve()}removeOverlaysForBatchId(t,n,i){const r=this.Rr.get(i);return r!==void 0&&(r.forEach(o=>this.overlays=this.overlays.remove(o)),this.Rr.delete(i)),Z.resolve()}getOverlaysForCollection(t,n,i){const r=rr(),o=n.length+1,l=new Tt(n.child("")),h=this.overlays.getIteratorFrom(l);for(;h.hasNext();){const d=h.getNext().value,p=d.getKey();if(!n.isPrefixOf(p.path))break;p.path.length===o&&d.largestBatchId>i&&r.set(d.getKey(),d)}return Z.resolve(r)}getOverlaysForCollectionGroup(t,n,i,r){let o=new Ie((p,_)=>p-_);const l=this.overlays.getIterator();for(;l.hasNext();){const p=l.getNext().value;if(p.getKey().getCollectionGroup()===n&&p.largestBatchId>i){let _=o.get(p.largestBatchId);_===null&&(_=rr(),o=o.insert(p.largestBatchId,_)),_.set(p.getKey(),p)}}const h=rr(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((p,_)=>h.set(p,_)),!(h.size()>=r)););return Z.resolve(h)}Et(t,n,i){const r=this.overlays.get(i.key);if(r!==null){const l=this.Rr.get(r.largestBatchId).delete(i.key);this.Rr.set(r.largestBatchId,l)}this.overlays=this.overlays.insert(i.key,new AA(n,i));let o=this.Rr.get(n);o===void 0&&(o=Xt(),this.Rr.set(n,o)),this.Rr.set(n,o.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(){this.sessionToken=Ze.EMPTY_BYTE_STRING}getSessionToken(t){return Z.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,Z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{constructor(){this.Vr=new Fe($e.mr),this.gr=new Fe($e.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(t,n){const i=new $e(t,n);this.Vr=this.Vr.add(i),this.gr=this.gr.add(i)}yr(t,n){t.forEach(i=>this.addReference(i,n))}removeReference(t,n){this.wr(new $e(t,n))}Sr(t,n){t.forEach(i=>this.removeReference(i,n))}br(t){const n=new Tt(new ge([])),i=new $e(n,t),r=new $e(n,t+1),o=[];return this.gr.forEachInRange([i,r],l=>{this.wr(l),o.push(l.key)}),o}Dr(){this.Vr.forEach(t=>this.wr(t))}wr(t){this.Vr=this.Vr.delete(t),this.gr=this.gr.delete(t)}vr(t){const n=new Tt(new ge([])),i=new $e(n,t),r=new $e(n,t+1);let o=Xt();return this.gr.forEachInRange([i,r],l=>{o=o.add(l.key)}),o}containsKey(t){const n=new $e(t,0),i=this.Vr.firstAfterOrEqual(n);return i!==null&&t.isEqual(i.key)}}class $e{constructor(t,n){this.key=t,this.Cr=n}static mr(t,n){return Tt.comparator(t.key,n.key)||jt(t.Cr,n.Cr)}static pr(t,n){return jt(t.Cr,n.Cr)||Tt.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.Fr=1,this.Mr=new Fe($e.mr)}checkEmpty(t){return Z.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,i,r){const o=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new PA(o,n,i,r);this.mutationQueue.push(l);for(const h of r)this.Mr=this.Mr.add(new $e(h.key,o)),this.indexManager.addToCollectionParentIndex(t,h.key.path.popLast());return Z.resolve(l)}lookupMutationBatch(t,n){return Z.resolve(this.Or(n))}getNextMutationBatchAfterBatchId(t,n){const i=n+1,r=this.Nr(i),o=r<0?0:r;return Z.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return Z.resolve(this.mutationQueue.length===0?Rd:this.Fr-1)}getAllMutationBatches(t){return Z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const i=new $e(n,0),r=new $e(n,Number.POSITIVE_INFINITY),o=[];return this.Mr.forEachInRange([i,r],l=>{const h=this.Or(l.Cr);o.push(h)}),Z.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(t,n){let i=new Fe(jt);return n.forEach(r=>{const o=new $e(r,0),l=new $e(r,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([o,l],h=>{i=i.add(h.Cr)})}),Z.resolve(this.Br(i))}getAllMutationBatchesAffectingQuery(t,n){const i=n.path,r=i.length+1;let o=i;Tt.isDocumentKey(o)||(o=o.child(""));const l=new $e(new Tt(o),0);let h=new Fe(jt);return this.Mr.forEachWhile(d=>{const p=d.key.path;return!!i.isPrefixOf(p)&&(p.length===r&&(h=h.add(d.Cr)),!0)},l),Z.resolve(this.Br(h))}Br(t){const n=[];return t.forEach(i=>{const r=this.Or(i);r!==null&&n.push(r)}),n}removeMutationBatch(t,n){re(this.Lr(n.batchId,"removed")===0),this.mutationQueue.shift();let i=this.Mr;return Z.forEach(n.mutations,r=>{const o=new $e(r.key,n.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)}).next(()=>{this.Mr=i})}qn(t){}containsKey(t,n){const i=new $e(n,0),r=this.Mr.firstAfterOrEqual(i);return Z.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(t){return this.mutationQueue.length,Z.resolve()}Lr(t,n){return this.Nr(t)}Nr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Or(t){const n=this.Nr(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(t){this.kr=t,this.docs=function(){return new Ie(Tt.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const i=n.key,r=this.docs.get(i),o=r?r.size:0,l=this.kr(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const i=this.docs.get(n);return Z.resolve(i?i.document.mutableCopy():en.newInvalidDocument(n))}getEntries(t,n){let i=Ji();return n.forEach(r=>{const o=this.docs.get(r);i=i.insert(r,o?o.document.mutableCopy():en.newInvalidDocument(r))}),Z.resolve(i)}getDocumentsMatchingQuery(t,n,i,r){let o=Ji();const l=n.path,h=new Tt(l.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(h);for(;d.hasNext();){const{key:p,value:{document:_}}=d.getNext();if(!l.isPrefixOf(p.path))break;p.path.length>l.length+1||BP(FP(_),i)<=0||(r.has(_.key)||_u(n,_))&&(o=o.insert(_.key,_.mutableCopy()))}return Z.resolve(o)}getAllFromCollectionGroup(t,n,i,r){xt()}qr(t,n){return Z.forEach(this.docs,i=>n(i))}newChangeBuffer(t){return new hC(this)}getSize(t){return Z.resolve(this.size)}}class hC extends iC{constructor(t){super(),this.Ir=t}applyChanges(t){const n=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?n.push(this.Ir.addEntry(t,r)):this.Ir.removeEntry(i)}),Z.waitFor(n)}getFromCache(t,n){return this.Ir.getEntry(t,n)}getAllFromCache(t,n){return this.Ir.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(t){this.persistence=t,this.Qr=new wr(n=>kd(n),Ld),this.lastRemoteSnapshotVersion=Dt.min(),this.highestTargetId=0,this.$r=0,this.Ur=new Ud,this.targetCount=0,this.Kr=vo.Un()}forEachTarget(t,n){return this.Qr.forEach((i,r)=>n(r)),Z.resolve()}getLastRemoteSnapshotVersion(t){return Z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Z.resolve(this.$r)}allocateTargetId(t){return this.highestTargetId=this.Kr.next(),Z.resolve(this.highestTargetId)}setTargetsMetadata(t,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.$r&&(this.$r=n),Z.resolve()}zn(t){this.Qr.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this.Kr=new vo(n),this.highestTargetId=n),t.sequenceNumber>this.$r&&(this.$r=t.sequenceNumber)}addTargetData(t,n){return this.zn(n),this.targetCount+=1,Z.resolve()}updateTargetData(t,n){return this.zn(n),Z.resolve()}removeTargetData(t,n){return this.Qr.delete(n.target),this.Ur.br(n.targetId),this.targetCount-=1,Z.resolve()}removeTargets(t,n,i){let r=0;const o=[];return this.Qr.forEach((l,h)=>{h.sequenceNumber<=n&&i.get(h.targetId)===null&&(this.Qr.delete(l),o.push(this.removeMatchingKeysForTargetId(t,h.targetId)),r++)}),Z.waitFor(o).next(()=>r)}getTargetCount(t){return Z.resolve(this.targetCount)}getTargetData(t,n){const i=this.Qr.get(n)||null;return Z.resolve(i)}addMatchingKeys(t,n,i){return this.Ur.yr(n,i),Z.resolve()}removeMatchingKeys(t,n,i){this.Ur.Sr(n,i);const r=this.persistence.referenceDelegate,o=[];return r&&n.forEach(l=>{o.push(r.markPotentiallyOrphaned(t,l))}),Z.waitFor(o)}removeMatchingKeysForTargetId(t,n){return this.Ur.br(n),Z.resolve()}getMatchingKeysForTargetId(t,n){const i=this.Ur.vr(n);return Z.resolve(i)}containsKey(t,n){return Z.resolve(this.Ur.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(t,n){this.Wr={},this.overlays={},this.Gr=new hu(0),this.zr=!1,this.zr=!0,this.jr=new lC,this.referenceDelegate=t(this),this.Hr=new dC(this),this.indexManager=new QA,this.remoteDocumentCache=function(r){return new uC(r)}(i=>this.referenceDelegate.Jr(i)),this.serializer=new GA(n),this.Yr=new oC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new aC,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let i=this.Wr[t.toKey()];return i||(i=new cC(n,this.referenceDelegate),this.Wr[t.toKey()]=i),i}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(t,n,i){ft("MemoryPersistence","Starting transaction:",t);const r=new fC(this.Gr.next());return this.referenceDelegate.Zr(),i(r).next(o=>this.referenceDelegate.Xr(r).next(()=>o)).toPromise().then(o=>(r.raiseOnCommittedEvent(),o))}ei(t,n){return Z.or(Object.values(this.Wr).map(i=>()=>i.containsKey(t,n)))}}class fC extends jP{constructor(t){super(),this.currentSequenceNumber=t}}class Fd{constructor(t){this.persistence=t,this.ti=new Ud,this.ni=null}static ri(t){return new Fd(t)}get ii(){if(this.ni)return this.ni;throw xt()}addReference(t,n,i){return this.ti.addReference(i,n),this.ii.delete(i.toString()),Z.resolve()}removeReference(t,n,i){return this.ti.removeReference(i,n),this.ii.add(i.toString()),Z.resolve()}markPotentiallyOrphaned(t,n){return this.ii.add(n.toString()),Z.resolve()}removeTarget(t,n){this.ti.br(n.targetId).forEach(r=>this.ii.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,n.targetId).next(r=>{r.forEach(o=>this.ii.add(o.toString()))}).next(()=>i.removeTargetData(t,n))}Zr(){this.ni=new Set}Xr(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Z.forEach(this.ii,i=>{const r=Tt.fromPath(i);return this.si(t,r).next(o=>{o||n.removeEntry(r,Dt.min())})}).next(()=>(this.ni=null,n.apply(t)))}updateLimboDocument(t,n){return this.si(t,n).next(i=>{i?this.ii.delete(n.toString()):this.ii.add(n.toString())})}Jr(t){return 0}si(t,n){return Z.or([()=>Z.resolve(this.ti.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.ei(t,n)])}}class Vc{constructor(t,n){this.persistence=t,this.oi=new wr(i=>qP(i.path),(i,r)=>i.isEqual(r)),this.garbageCollector=nC(this,n)}static ri(t,n){return new Vc(t,n)}Zr(){}Xr(t){return Z.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}nr(t){const n=this.sr(t);return this.persistence.getTargetCache().getTargetCount(t).next(i=>n.next(r=>i+r))}sr(t){let n=0;return this.rr(t,i=>{n++}).next(()=>n)}rr(t,n){return Z.forEach(this.oi,(i,r)=>this.ar(t,i,r).next(o=>o?Z.resolve():n(r)))}removeTargets(t,n,i){return this.persistence.getTargetCache().removeTargets(t,n,i)}removeOrphanedDocuments(t,n){let i=0;const r=this.persistence.getRemoteDocumentCache(),o=r.newChangeBuffer();return r.qr(t,l=>this.ar(t,l,n).next(h=>{h||(i++,o.removeEntry(l,Dt.min()))})).next(()=>o.apply(t)).next(()=>i)}markPotentiallyOrphaned(t,n){return this.oi.set(n,t.currentSequenceNumber),Z.resolve()}removeTarget(t,n){const i=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,i)}addReference(t,n,i){return this.oi.set(i,t.currentSequenceNumber),Z.resolve()}removeReference(t,n,i){return this.oi.set(i,t.currentSequenceNumber),Z.resolve()}updateLimboDocument(t,n){return this.oi.set(n,t.currentSequenceNumber),Z.resolve()}Jr(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=hc(t.data.value)),n}ar(t,n,i){return Z.or([()=>this.persistence.ei(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const r=this.oi.get(n);return Z.resolve(r!==void 0&&r>i)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(t,n,i,r){this.targetId=t,this.fromCache=n,this.Hi=i,this.Ji=r}static Yi(t,n){let i=Xt(),r=Xt();for(const o of n.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new Bd(t,n.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return h0()?8:HP(ln())>0?6:4}()}initialize(t,n){this.ns=t,this.indexManager=n,this.Zi=!0}getDocumentsMatchingQuery(t,n,i,r){const o={result:null};return this.rs(t,n).next(l=>{o.result=l}).next(()=>{if(!o.result)return this.ss(t,n,r,i).next(l=>{o.result=l})}).next(()=>{if(o.result)return;const l=new pC;return this._s(t,n,l).next(h=>{if(o.result=h,this.Xi)return this.us(t,n,l,h.size)})}).next(()=>o.result)}us(t,n,i,r){return i.documentReadCount<this.es?(Zr()<=Yt.DEBUG&&ft("QueryEngine","SDK will not create cache indexes for query:",Qr(n),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),Z.resolve()):(Zr()<=Yt.DEBUG&&ft("QueryEngine","Query:",Qr(n),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.ts*r?(Zr()<=Yt.DEBUG&&ft("QueryEngine","The SDK decides to create cache indexes for query:",Qr(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,wi(n))):Z.resolve())}rs(t,n){if(Em(n))return Z.resolve(null);let i=wi(n);return this.indexManager.getIndexType(t,i).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=Bh(n,null,"F"),i=wi(n)),this.indexManager.getDocumentsMatchingTarget(t,i).next(o=>{const l=Xt(...o);return this.ns.getDocuments(t,l).next(h=>this.indexManager.getMinOffset(t,i).next(d=>{const p=this.cs(n,h);return this.ls(n,p,l,d.readTime)?this.rs(t,Bh(n,null,"F")):this.hs(t,p,n,d)}))})))}ss(t,n,i,r){return Em(n)||r.isEqual(Dt.min())?Z.resolve(null):this.ns.getDocuments(t,i).next(o=>{const l=this.cs(n,o);return this.ls(n,l,i,r)?Z.resolve(null):(Zr()<=Yt.DEBUG&&ft("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Qr(n)),this.hs(t,l,n,UP(r,Wa)).next(h=>h))})}cs(t,n){let i=new Fe(Uv(t));return n.forEach((r,o)=>{_u(t,o)&&(i=i.add(o))}),i}ls(t,n,i,r){if(t.limit===null)return!1;if(i.size!==n.size)return!0;const o=t.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}_s(t,n,i){return Zr()<=Yt.DEBUG&&ft("QueryEngine","Using full collection scan to execute query:",Qr(n)),this.ns.getDocumentsMatchingQuery(t,n,xs.min(),i)}hs(t,n,i,r){return this.ns.getDocumentsMatchingQuery(t,i,r).next(o=>(n.forEach(l=>{o=o.insert(l.key,l)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zd="LocalStore",_C=3e8;class gC{constructor(t,n,i,r){this.persistence=t,this.Ps=n,this.serializer=r,this.Ts=new Ie(jt),this.Is=new wr(o=>kd(o),Ld),this.Es=new Map,this.ds=t.getRemoteDocumentCache(),this.Hr=t.getTargetCache(),this.Yr=t.getBundleCache(),this.As(i)}As(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new rC(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.Ts))}}function vC(e,t,n,i){return new gC(e,t,n,i)}async function ay(e,t){const n=Nt(e);return await n.persistence.runTransaction("Handle user change","readonly",i=>{let r;return n.mutationQueue.getAllMutationBatches(i).next(o=>(r=o,n.As(t),n.mutationQueue.getAllMutationBatches(i))).next(o=>{const l=[],h=[];let d=Xt();for(const p of r){l.push(p.batchId);for(const _ of p.mutations)d=d.add(_.key)}for(const p of o){h.push(p.batchId);for(const _ of p.mutations)d=d.add(_.key)}return n.localDocuments.getDocuments(i,d).next(p=>({Rs:p,removedBatchIds:l,addedBatchIds:h}))})})}function yC(e,t){const n=Nt(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=t.batch.keys(),o=n.ds.newChangeBuffer({trackRemovals:!0});return function(h,d,p,_){const y=p.batch,T=y.keys();let I=Z.resolve();return T.forEach(U=>{I=I.next(()=>_.getEntry(d,U)).next(B=>{const j=p.docVersions.get(U);re(j!==null),B.version.compareTo(j)<0&&(y.applyToRemoteDocument(B,p),B.isValidDocument()&&(B.setReadTime(p.commitVersion),_.addEntry(B)))})}),I.next(()=>h.mutationQueue.removeMutationBatch(d,y))}(n,i,t,o).next(()=>o.apply(i)).next(()=>n.mutationQueue.performConsistencyCheck(i)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(i,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(h){let d=Xt();for(let p=0;p<h.mutationResults.length;++p)h.mutationResults[p].transformResults.length>0&&(d=d.add(h.batch.mutations[p].key));return d}(t))).next(()=>n.localDocuments.getDocuments(i,r))})}function ly(e){const t=Nt(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.Hr.getLastRemoteSnapshotVersion(n))}function wC(e,t){const n=Nt(e),i=t.snapshotVersion;let r=n.Ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const l=n.ds.newChangeBuffer({trackRemovals:!0});r=n.Ts;const h=[];t.targetChanges.forEach((_,y)=>{const T=r.get(y);if(!T)return;h.push(n.Hr.removeMatchingKeys(o,_.removedDocuments,y).next(()=>n.Hr.addMatchingKeys(o,_.addedDocuments,y)));let I=T.withSequenceNumber(o.currentSequenceNumber);t.targetMismatches.get(y)!==null?I=I.withResumeToken(Ze.EMPTY_BYTE_STRING,Dt.min()).withLastLimboFreeSnapshotVersion(Dt.min()):_.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(_.resumeToken,i)),r=r.insert(y,I),function(B,j,et){return B.resumeToken.approximateByteSize()===0||j.snapshotVersion.toMicroseconds()-B.snapshotVersion.toMicroseconds()>=_C?!0:et.addedDocuments.size+et.modifiedDocuments.size+et.removedDocuments.size>0}(T,I,_)&&h.push(n.Hr.updateTargetData(o,I))});let d=Ji(),p=Xt();if(t.documentUpdates.forEach(_=>{t.resolvedLimboDocuments.has(_)&&h.push(n.persistence.referenceDelegate.updateLimboDocument(o,_))}),h.push(TC(o,l,t.documentUpdates).next(_=>{d=_.Vs,p=_.fs})),!i.isEqual(Dt.min())){const _=n.Hr.getLastRemoteSnapshotVersion(o).next(y=>n.Hr.setTargetsMetadata(o,o.currentSequenceNumber,i));h.push(_)}return Z.waitFor(h).next(()=>l.apply(o)).next(()=>n.localDocuments.getLocalViewOfDocuments(o,d,p)).next(()=>d)}).then(o=>(n.Ts=r,o))}function TC(e,t,n){let i=Xt(),r=Xt();return n.forEach(o=>i=i.add(o)),t.getEntries(e,i).next(o=>{let l=Ji();return n.forEach((h,d)=>{const p=o.get(h);d.isFoundDocument()!==p.isFoundDocument()&&(r=r.add(h)),d.isNoDocument()&&d.version.isEqual(Dt.min())?(t.removeEntry(h,d.readTime),l=l.insert(h,d)):!p.isValidDocument()||d.version.compareTo(p.version)>0||d.version.compareTo(p.version)===0&&p.hasPendingWrites?(t.addEntry(d),l=l.insert(h,d)):ft(zd,"Ignoring outdated watch update for ",h,". Current version:",p.version," Watch version:",d.version)}),{Vs:l,fs:r}})}function EC(e,t){const n=Nt(e);return n.persistence.runTransaction("Get next mutation batch","readonly",i=>(t===void 0&&(t=Rd),n.mutationQueue.getNextMutationBatchAfterBatchId(i,t)))}function bC(e,t){const n=Nt(e);return n.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return n.Hr.getTargetData(i,t).next(o=>o?(r=o,Z.resolve(r)):n.Hr.allocateTargetId(i).next(l=>(r=new Es(t,l,"TargetPurposeListen",i.currentSequenceNumber),n.Hr.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=n.Ts.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ts=n.Ts.insert(i.targetId,i),n.Is.set(t,i.targetId)),i})}async function qh(e,t,n){const i=Nt(e),r=i.Ts.get(t),o=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",o,l=>i.persistence.referenceDelegate.removeTarget(l,r))}catch(l){if(!Co(l))throw l;ft(zd,`Failed to update sequence numbers for target ${t}: ${l}`)}i.Ts=i.Ts.remove(t),i.Is.delete(r.target)}function Dm(e,t,n){const i=Nt(e);let r=Dt.min(),o=Xt();return i.persistence.runTransaction("Execute query","readwrite",l=>function(d,p,_){const y=Nt(d),T=y.Is.get(_);return T!==void 0?Z.resolve(y.Ts.get(T)):y.Hr.getTargetData(p,_)}(i,l,wi(t)).next(h=>{if(h)return r=h.lastLimboFreeSnapshotVersion,i.Hr.getMatchingKeysForTargetId(l,h.targetId).next(d=>{o=d})}).next(()=>i.Ps.getDocumentsMatchingQuery(l,t,n?r:Dt.min(),n?o:Xt())).next(h=>(IC(i,uA(t),h),{documents:h,gs:o})))}function IC(e,t,n){let i=e.Es.get(t)||Dt.min();n.forEach((r,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)}),e.Es.set(t,i)}class Nm{constructor(){this.activeTargetIds=_A()}Ds(t){this.activeTargetIds=this.activeTargetIds.add(t)}vs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}bs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class PC{constructor(){this.ho=new Nm,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,i){}addLocalQueryTarget(t,n=!0){return n&&this.ho.Ds(t),this.Po[t]||"not-current"}updateQueryState(t,n,i){this.Po[t]=n}removeLocalQueryTarget(t){this.ho.vs(t)}isLocalQueryTarget(t){return this.ho.activeTargetIds.has(t)}clearQueryState(t){delete this.Po[t]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(t){return this.ho.activeTargetIds.has(t)}start(){return this.ho=new Nm,Promise.resolve()}handleUserChange(t,n,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{To(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm="ConnectivityMonitor";class Um{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(t){this.Vo.push(t)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){ft(Vm,"Network connectivity changed: AVAILABLE");for(const t of this.Vo)t(0)}Ro(){ft(Vm,"Network connectivity changed: UNAVAILABLE");for(const t of this.Vo)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ec=null;function Wh(){return ec===null?ec=function(){return 268435456+Math.round(2147483648*Math.random())}():ec++,"0x"+ec.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ah="RestConnection",CC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class RC{get fo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.po=n+"://"+t.host,this.yo=`projects/${i}/databases/${r}`,this.wo=this.databaseId.database===kc?`project_id=${i}`:`project_id=${i}&database_id=${r}`}So(t,n,i,r,o){const l=Wh(),h=this.bo(t,n.toUriEncodedString());ft(ah,`Sending RPC '${t}' ${l}:`,h,i);const d={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(d,r,o),this.vo(t,h,d,i).then(p=>(ft(ah,`Received RPC '${t}' ${l}: `,p),p),p=>{throw po(ah,`RPC '${t}' ${l} failed with error: `,p,"url: ",h,"request:",i),p})}Co(t,n,i,r,o,l){return this.So(t,n,i,r,o)}Do(t,n,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Po}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,o)=>t[o]=r),i&&i.headers.forEach((r,o)=>t[o]=r)}bo(t,n){const i=CC[t];return`${this.po}/v1/${n}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(t){this.Fo=t.Fo,this.Mo=t.Mo}xo(t){this.Oo=t}No(t){this.Bo=t}Lo(t){this.ko=t}onMessage(t){this.qo=t}close(){this.Mo()}send(t){this.Fo(t)}Qo(){this.Oo()}$o(){this.Bo()}Uo(t){this.ko(t)}Ko(t){this.qo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ye="WebChannelConnection";class xC extends RC{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}vo(t,n,i,r){const o=Wh();return new Promise((l,h)=>{const d=new dv;d.setWithCredentials(!0),d.listenOnce(fv.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case uc.NO_ERROR:const _=d.getResponseJson();ft(Ye,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(_)),l(_);break;case uc.TIMEOUT:ft(Ye,`RPC '${t}' ${o} timed out`),h(new pt(K.DEADLINE_EXCEEDED,"Request time out"));break;case uc.HTTP_ERROR:const y=d.getStatus();if(ft(Ye,`RPC '${t}' ${o} failed with status:`,y,"response text:",d.getResponseText()),y>0){let T=d.getResponseJson();Array.isArray(T)&&(T=T[0]);const I=T==null?void 0:T.error;if(I&&I.status&&I.message){const U=function(j){const et=j.toLowerCase().replace(/_/g,"-");return Object.values(K).indexOf(et)>=0?et:K.UNKNOWN}(I.status);h(new pt(U,I.message))}else h(new pt(K.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new pt(K.UNAVAILABLE,"Connection failed."));break;default:xt()}}finally{ft(Ye,`RPC '${t}' ${o} completed.`)}});const p=JSON.stringify(r);ft(Ye,`RPC '${t}' ${o} sending request:`,r),d.send(n,"POST",p,i,15)})}Wo(t,n,i){const r=Wh(),o=[this.po,"/","google.firestore.v1.Firestore","/",t,"/channel"],l=_v(),h=mv(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(d.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Do(d.initMessageHeaders,n,i),d.encodeInitMessageHeaders=!0;const _=o.join("");ft(Ye,`Creating RPC '${t}' stream ${r}: ${_}`,d);const y=l.createWebChannel(_,d);let T=!1,I=!1;const U=new SC({Fo:j=>{I?ft(Ye,`Not sending because RPC '${t}' stream ${r} is closed:`,j):(T||(ft(Ye,`Opening RPC '${t}' stream ${r} transport.`),y.open(),T=!0),ft(Ye,`RPC '${t}' stream ${r} sending:`,j),y.send(j))},Mo:()=>y.close()}),B=(j,et,X)=>{j.listen(et,Q=>{try{X(Q)}catch(tt){setTimeout(()=>{throw tt},0)}})};return B(y,ma.EventType.OPEN,()=>{I||(ft(Ye,`RPC '${t}' stream ${r} transport opened.`),U.Qo())}),B(y,ma.EventType.CLOSE,()=>{I||(I=!0,ft(Ye,`RPC '${t}' stream ${r} transport closed`),U.Uo())}),B(y,ma.EventType.ERROR,j=>{I||(I=!0,po(Ye,`RPC '${t}' stream ${r} transport errored:`,j),U.Uo(new pt(K.UNAVAILABLE,"The operation could not be completed")))}),B(y,ma.EventType.MESSAGE,j=>{var et;if(!I){const X=j.data[0];re(!!X);const Q=X,tt=(Q==null?void 0:Q.error)||((et=Q[0])===null||et===void 0?void 0:et.error);if(tt){ft(Ye,`RPC '${t}' stream ${r} received error:`,tt);const Et=tt.status;let kt=function(S){const M=De[S];if(M!==void 0)return Zv(M)}(Et),k=tt.message;kt===void 0&&(kt=K.INTERNAL,k="Unknown error status: "+Et+" with message "+tt.message),I=!0,U.Uo(new pt(kt,k)),y.close()}else ft(Ye,`RPC '${t}' stream ${r} received:`,X),U.Ko(X)}}),B(h,pv.STAT_EVENT,j=>{j.stat===Mh.PROXY?ft(Ye,`RPC '${t}' stream ${r} detected buffering proxy`):j.stat===Mh.NOPROXY&&ft(Ye,`RPC '${t}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{U.$o()},0),U}}function lh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wu(e){return new OA(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{constructor(t,n,i=1e3,r=1.5,o=6e4){this.Ti=t,this.timerId=n,this.Go=i,this.zo=r,this.jo=o,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(t){this.cancel();const n=Math.floor(this.Ho+this.e_()),i=Math.max(0,Date.now()-this.Yo),r=Math.max(0,n-i);r>0&&ft("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ho} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,r,()=>(this.Yo=Date.now(),t())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm="PersistentStream";class uy{constructor(t,n,i,r,o,l,h,d){this.Ti=t,this.n_=i,this.r_=r,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=h,this.listener=d,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new cy(t,n)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(t){this.E_(),this.stream.send(t)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(t,n){this.E_(),this.d_(),this.a_.cancel(),this.i_++,t!==4?this.a_.reset():n&&n.code===K.RESOURCE_EXHAUSTED?(Xi(n.toString()),Xi("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):n&&n.code===K.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Lo(n)}A_(){}auth(){this.state=1;const t=this.R_(this.i_),n=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.i_===n&&this.V_(i,r)},i=>{t(()=>{const r=new pt(K.UNKNOWN,"Fetching auth token failed: "+i.message);return this.m_(r)})})}V_(t,n){const i=this.R_(this.i_);this.stream=this.f_(t,n),this.stream.xo(()=>{i(()=>this.listener.xo())}),this.stream.No(()=>{i(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(r=>{i(()=>this.m_(r))}),this.stream.onMessage(r=>{i(()=>++this.__==1?this.g_(r):this.onNext(r))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(t){return ft(Fm,`close with error: ${t}`),this.stream=null,this.close(4,t)}R_(t){return n=>{this.Ti.enqueueAndForget(()=>this.i_===t?n():(ft(Fm,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class kC extends uy{constructor(t,n,i,r,o,l){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,r,l),this.serializer=o}f_(t,n){return this.connection.Wo("Listen",t,n)}g_(t){return this.onNext(t)}onNext(t){this.a_.reset();const n=VA(this.serializer,t),i=function(o){if(!("targetChange"in o))return Dt.min();const l=o.targetChange;return l.targetIds&&l.targetIds.length?Dt.min():l.readTime?Ti(l.readTime):Dt.min()}(t);return this.listener.p_(n,i)}y_(t){const n={};n.database=$h(this.serializer),n.addTarget=function(o,l){let h;const d=l.target;if(h=Uh(d)?{documents:BA(o,d)}:{query:zA(o,d).ht},h.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){h.resumeToken=Xv(o,l.resumeToken);const p=zh(o,l.expectedCount);p!==null&&(h.expectedCount=p)}else if(l.snapshotVersion.compareTo(Dt.min())>0){h.readTime=Nc(o,l.snapshotVersion.toTimestamp());const p=zh(o,l.expectedCount);p!==null&&(h.expectedCount=p)}return h}(this.serializer,t);const i=HA(this.serializer,t);i&&(n.labels=i),this.I_(n)}w_(t){const n={};n.database=$h(this.serializer),n.removeTarget=t,this.I_(n)}}class LC extends uy{constructor(t,n,i,r,o,l){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,r,l),this.serializer=o}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(t,n){return this.connection.Wo("Write",t,n)}g_(t){return re(!!t.streamToken),this.lastStreamToken=t.streamToken,re(!t.writeResults||t.writeResults.length===0),this.listener.D_()}onNext(t){re(!!t.streamToken),this.lastStreamToken=t.streamToken,this.a_.reset();const n=FA(t.writeResults,t.commitTime),i=Ti(t.commitTime);return this.listener.v_(i,n)}C_(){const t={};t.database=$h(this.serializer),this.I_(t)}b_(t){const n={streamToken:this.lastStreamToken,writes:t.map(i=>UA(this.serializer,i))};this.I_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{}class OC extends MC{constructor(t,n,i,r){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=i,this.serializer=r,this.F_=!1}M_(){if(this.F_)throw new pt(K.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,n,i,r){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.So(t,jh(n,i),r,o,l)).catch(o=>{throw o.name==="FirebaseError"?(o.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new pt(K.UNKNOWN,o.toString())})}Co(t,n,i,r,o){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,h])=>this.connection.Co(t,jh(n,i),r,l,h,o)).catch(l=>{throw l.name==="FirebaseError"?(l.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new pt(K.UNKNOWN,l.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class DC{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(t){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.L_("Offline")))}set(t){this.Q_(),this.x_=0,t==="Online"&&(this.N_=!1),this.L_(t)}L_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}k_(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(Xi(n),this.N_=!1):ft("OnlineStateTracker",n)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mr="RemoteStore";class NC{constructor(t,n,i,r,o){this.localStore=t,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=o,this.z_.To(l=>{i.enqueueAndForget(async()=>{Tr(this)&&(ft(mr,"Restarting streams for network reachability change."),await async function(d){const p=Nt(d);p.W_.add(4),await ul(p),p.j_.set("Unknown"),p.W_.delete(4),await Tu(p)}(this))})}),this.j_=new DC(i,r)}}async function Tu(e){if(Tr(e))for(const t of e.G_)await t(!0)}async function ul(e){for(const t of e.G_)await t(!1)}function hy(e,t){const n=Nt(e);n.K_.has(t.targetId)||(n.K_.set(t.targetId,t),qd(n)?$d(n):So(n).c_()&&Hd(n,t))}function jd(e,t){const n=Nt(e),i=So(n);n.K_.delete(t),i.c_()&&dy(n,t),n.K_.size===0&&(i.c_()?i.P_():Tr(n)&&n.j_.set("Unknown"))}function Hd(e,t){if(e.H_.Ne(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Dt.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}So(e).y_(t)}function dy(e,t){e.H_.Ne(t),So(e).w_(t)}function $d(e){e.H_=new xA({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),lt:t=>e.K_.get(t)||null,it:()=>e.datastore.serializer.databaseId}),So(e).start(),e.j_.B_()}function qd(e){return Tr(e)&&!So(e).u_()&&e.K_.size>0}function Tr(e){return Nt(e).W_.size===0}function fy(e){e.H_=void 0}async function VC(e){e.j_.set("Online")}async function UC(e){e.K_.forEach((t,n)=>{Hd(e,t)})}async function FC(e,t){fy(e),qd(e)?(e.j_.q_(t),$d(e)):e.j_.set("Unknown")}async function BC(e,t,n){if(e.j_.set("Online"),t instanceof Yv&&t.state===2&&t.cause)try{await async function(r,o){const l=o.cause;for(const h of o.targetIds)r.K_.has(h)&&(await r.remoteSyncer.rejectListen(h,l),r.K_.delete(h),r.H_.removeTarget(h))}(e,t)}catch(i){ft(mr,"Failed to remove targets %s: %s ",t.targetIds.join(","),i),await Uc(e,i)}else if(t instanceof pc?e.H_.We(t):t instanceof Qv?e.H_.Ze(t):e.H_.je(t),!n.isEqual(Dt.min()))try{const i=await ly(e.localStore);n.compareTo(i)>=0&&await function(o,l){const h=o.H_.ot(l);return h.targetChanges.forEach((d,p)=>{if(d.resumeToken.approximateByteSize()>0){const _=o.K_.get(p);_&&o.K_.set(p,_.withResumeToken(d.resumeToken,l))}}),h.targetMismatches.forEach((d,p)=>{const _=o.K_.get(d);if(!_)return;o.K_.set(d,_.withResumeToken(Ze.EMPTY_BYTE_STRING,_.snapshotVersion)),dy(o,d);const y=new Es(_.target,d,p,_.sequenceNumber);Hd(o,y)}),o.remoteSyncer.applyRemoteEvent(h)}(e,n)}catch(i){ft(mr,"Failed to raise snapshot:",i),await Uc(e,i)}}async function Uc(e,t,n){if(!Co(t))throw t;e.W_.add(1),await ul(e),e.j_.set("Offline"),n||(n=()=>ly(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{ft(mr,"Retrying IndexedDB access"),await n(),e.W_.delete(1),await Tu(e)})}function py(e,t){return t().catch(n=>Uc(e,n,t))}async function Eu(e){const t=Nt(e),n=Os(t);let i=t.U_.length>0?t.U_[t.U_.length-1].batchId:Rd;for(;zC(t);)try{const r=await EC(t.localStore,i);if(r===null){t.U_.length===0&&n.P_();break}i=r.batchId,jC(t,r)}catch(r){await Uc(t,r)}my(t)&&_y(t)}function zC(e){return Tr(e)&&e.U_.length<10}function jC(e,t){e.U_.push(t);const n=Os(e);n.c_()&&n.S_&&n.b_(t.mutations)}function my(e){return Tr(e)&&!Os(e).u_()&&e.U_.length>0}function _y(e){Os(e).start()}async function HC(e){Os(e).C_()}async function $C(e){const t=Os(e);for(const n of e.U_)t.b_(n.mutations)}async function qC(e,t,n){const i=e.U_.shift(),r=Dd.from(i,t,n);await py(e,()=>e.remoteSyncer.applySuccessfulWrite(r)),await Eu(e)}async function WC(e,t){t&&Os(e).S_&&await async function(i,r){if(function(l){return RA(l)&&l!==K.ABORTED}(r.code)){const o=i.U_.shift();Os(i).h_(),await py(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,r)),await Eu(i)}}(e,t),my(e)&&_y(e)}async function Bm(e,t){const n=Nt(e);n.asyncQueue.verifyOperationInProgress(),ft(mr,"RemoteStore received new credentials");const i=Tr(n);n.W_.add(3),await ul(n),i&&n.j_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.W_.delete(3),await Tu(n)}async function KC(e,t){const n=Nt(e);t?(n.W_.delete(2),await Tu(n)):t||(n.W_.add(2),await ul(n),n.j_.set("Unknown"))}function So(e){return e.J_||(e.J_=function(n,i,r){const o=Nt(n);return o.M_(),new kC(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)}(e.datastore,e.asyncQueue,{xo:VC.bind(null,e),No:UC.bind(null,e),Lo:FC.bind(null,e),p_:BC.bind(null,e)}),e.G_.push(async t=>{t?(e.J_.h_(),qd(e)?$d(e):e.j_.set("Unknown")):(await e.J_.stop(),fy(e))})),e.J_}function Os(e){return e.Y_||(e.Y_=function(n,i,r){const o=Nt(n);return o.M_(),new LC(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)}(e.datastore,e.asyncQueue,{xo:()=>Promise.resolve(),No:HC.bind(null,e),Lo:WC.bind(null,e),D_:$C.bind(null,e),v_:qC.bind(null,e)}),e.G_.push(async t=>{t?(e.Y_.h_(),await Eu(e)):(await e.Y_.stop(),e.U_.length>0&&(ft(mr,`Stopping write stream with ${e.U_.length} pending writes`),e.U_=[]))})),e.Y_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(t,n,i,r,o){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=i,this.op=r,this.removalCallback=o,this.deferred=new Gi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,i,r,o){const l=Date.now()+i,h=new Wd(t,n,l,r,o);return h.start(i),h}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new pt(K.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Kd(e,t){if(Xi("AsyncQueue",`${t}: ${e}`),Co(e))return new pt(K.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{static emptySet(t){return new ro(t.comparator)}constructor(t){this.comparator=t?(n,i)=>t(n,i)||Tt.comparator(n.key,i.key):(n,i)=>Tt.comparator(n.key,i.key),this.keyedMap=_a(),this.sortedSet=new Ie(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,i)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof ro)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,o=i.getNext().key;if(!r.isEqual(o))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const i=new ro;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=n,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm{constructor(){this.Z_=new Ie(Tt.comparator)}track(t){const n=t.doc.key,i=this.Z_.get(n);i?t.type!==0&&i.type===3?this.Z_=this.Z_.insert(n,t):t.type===3&&i.type!==1?this.Z_=this.Z_.insert(n,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.Z_=this.Z_.insert(n,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.Z_=this.Z_.insert(n,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.Z_=this.Z_.remove(n):t.type===1&&i.type===2?this.Z_=this.Z_.insert(n,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.Z_=this.Z_.insert(n,{type:2,doc:t.doc}):xt():this.Z_=this.Z_.insert(n,t)}X_(){const t=[];return this.Z_.inorderTraversal((n,i)=>{t.push(i)}),t}}class yo{constructor(t,n,i,r,o,l,h,d,p){this.query=t,this.docs=n,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=o,this.fromCache=l,this.syncStateChanged=h,this.excludesMetadataChanges=d,this.hasCachedResults=p}static fromInitialDocuments(t,n,i,r,o){const l=[];return n.forEach(h=>{l.push({type:0,doc:h})}),new yo(t,n,ro.emptySet(n),l,i,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&mu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,i=t.docChanges;if(n.length!==i.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==i[r].type||!n[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(t=>t.ra())}}class ZC{constructor(){this.queries=jm(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(n,i){const r=Nt(n),o=r.queries;r.queries=jm(),o.forEach((l,h)=>{for(const d of h.ta)d.onError(i)})})(this,new pt(K.ABORTED,"Firestore shutting down"))}}function jm(){return new wr(e=>Vv(e),mu)}async function Gd(e,t){const n=Nt(e);let i=3;const r=t.query;let o=n.queries.get(r);o?!o.na()&&t.ra()&&(i=2):(o=new GC,i=t.ra()?0:1);try{switch(i){case 0:o.ea=await n.onListen(r,!0);break;case 1:o.ea=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(l){const h=Kd(l,`Initialization of query '${Qr(t.query)}' failed`);return void t.onError(h)}n.queries.set(r,o),o.ta.push(t),t.sa(n.onlineState),o.ea&&t.oa(o.ea)&&Qd(n)}async function Zd(e,t){const n=Nt(e),i=t.query;let r=3;const o=n.queries.get(i);if(o){const l=o.ta.indexOf(t);l>=0&&(o.ta.splice(l,1),o.ta.length===0?r=t.ra()?0:1:!o.na()&&t.ra()&&(r=2))}switch(r){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function QC(e,t){const n=Nt(e);let i=!1;for(const r of t){const o=r.query,l=n.queries.get(o);if(l){for(const h of l.ta)h.oa(r)&&(i=!0);l.ea=r}}i&&Qd(n)}function YC(e,t,n){const i=Nt(e),r=i.queries.get(t);if(r)for(const o of r.ta)o.onError(n);i.queries.delete(t)}function Qd(e){e.ia.forEach(t=>{t.next()})}var Kh,Hm;(Hm=Kh||(Kh={}))._a="default",Hm.Cache="cache";class Yd{constructor(t,n,i){this.query=t,this.aa=n,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=i||{}}oa(t){if(!this.options.includeMetadataChanges){const i=[];for(const r of t.docChanges)r.type!==3&&i.push(r);t=new yo(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.ua?this.la(t)&&(this.aa.next(t),n=!0):this.ha(t,this.onlineState)&&(this.Pa(t),n=!0),this.ca=t,n}onError(t){this.aa.error(t)}sa(t){this.onlineState=t;let n=!1;return this.ca&&!this.ua&&this.ha(this.ca,t)&&(this.Pa(this.ca),n=!0),n}ha(t,n){if(!t.fromCache||!this.ra())return!0;const i=n!=="Offline";return(!this.options.Ta||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}la(t){if(t.docChanges.length>0)return!0;const n=this.ca&&this.ca.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Pa(t){t=yo.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.ua=!0,this.aa.next(t)}ra(){return this.options.source!==Kh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{constructor(t){this.key=t}}class vy{constructor(t){this.key=t}}class XC{constructor(t,n){this.query=t,this.fa=n,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=Xt(),this.mutatedKeys=Xt(),this.ya=Uv(t),this.wa=new ro(this.ya)}get Sa(){return this.fa}ba(t,n){const i=n?n.Da:new zm,r=n?n.wa:this.wa;let o=n?n.mutatedKeys:this.mutatedKeys,l=r,h=!1;const d=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,p=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(t.inorderTraversal((_,y)=>{const T=r.get(_),I=_u(this.query,y)?y:null,U=!!T&&this.mutatedKeys.has(T.key),B=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let j=!1;T&&I?T.data.isEqual(I.data)?U!==B&&(i.track({type:3,doc:I}),j=!0):this.va(T,I)||(i.track({type:2,doc:I}),j=!0,(d&&this.ya(I,d)>0||p&&this.ya(I,p)<0)&&(h=!0)):!T&&I?(i.track({type:0,doc:I}),j=!0):T&&!I&&(i.track({type:1,doc:T}),j=!0,(d||p)&&(h=!0)),j&&(I?(l=l.add(I),o=B?o.add(_):o.delete(_)):(l=l.delete(_),o=o.delete(_)))}),this.query.limit!==null)for(;l.size>this.query.limit;){const _=this.query.limitType==="F"?l.last():l.first();l=l.delete(_.key),o=o.delete(_.key),i.track({type:1,doc:_})}return{wa:l,Da:i,ls:h,mutatedKeys:o}}va(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,i,r){const o=this.wa;this.wa=t.wa,this.mutatedKeys=t.mutatedKeys;const l=t.Da.X_();l.sort((_,y)=>function(I,U){const B=j=>{switch(j){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xt()}};return B(I)-B(U)}(_.type,y.type)||this.ya(_.doc,y.doc)),this.Ca(i),r=r!=null&&r;const h=n&&!r?this.Fa():[],d=this.pa.size===0&&this.current&&!r?1:0,p=d!==this.ga;return this.ga=d,l.length!==0||p?{snapshot:new yo(this.query,t.wa,o,l,t.mutatedKeys,d===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),Ma:h}:{Ma:h}}sa(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new zm,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(t){return!this.fa.has(t)&&!!this.wa.has(t)&&!this.wa.get(t).hasLocalMutations}Ca(t){t&&(t.addedDocuments.forEach(n=>this.fa=this.fa.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.fa=this.fa.delete(n)),this.current=t.current)}Fa(){if(!this.current)return[];const t=this.pa;this.pa=Xt(),this.wa.forEach(i=>{this.xa(i.key)&&(this.pa=this.pa.add(i.key))});const n=[];return t.forEach(i=>{this.pa.has(i)||n.push(new vy(i))}),this.pa.forEach(i=>{t.has(i)||n.push(new gy(i))}),n}Oa(t){this.fa=t.gs,this.pa=Xt();const n=this.ba(t.documents);return this.applyChanges(n,!0)}Na(){return yo.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const Xd="SyncEngine";class JC{constructor(t,n,i){this.query=t,this.targetId=n,this.view=i}}class tR{constructor(t){this.key=t,this.Ba=!1}}class eR{constructor(t,n,i,r,o,l){this.localStore=t,this.remoteStore=n,this.eventManager=i,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.La={},this.ka=new wr(h=>Vv(h),mu),this.qa=new Map,this.Qa=new Set,this.$a=new Ie(Tt.comparator),this.Ua=new Map,this.Ka=new Ud,this.Wa={},this.Ga=new Map,this.za=vo.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function nR(e,t,n=!0){const i=Iy(e);let r;const o=i.ka.get(t);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),r=o.view.Na()):r=await yy(i,t,n,!0),r}async function iR(e,t){const n=Iy(e);await yy(n,t,!0,!1)}async function yy(e,t,n,i){const r=await bC(e.localStore,wi(t)),o=r.targetId,l=e.sharedClientState.addLocalQueryTarget(o,n);let h;return i&&(h=await sR(e,t,o,l==="current",r.resumeToken)),e.isPrimaryClient&&n&&hy(e.remoteStore,r),h}async function sR(e,t,n,i,r){e.Ha=(y,T,I)=>async function(B,j,et,X){let Q=j.view.ba(et);Q.ls&&(Q=await Dm(B.localStore,j.query,!1).then(({documents:k})=>j.view.ba(k,Q)));const tt=X&&X.targetChanges.get(j.targetId),Et=X&&X.targetMismatches.get(j.targetId)!=null,kt=j.view.applyChanges(Q,B.isPrimaryClient,tt,Et);return qm(B,j.targetId,kt.Ma),kt.snapshot}(e,y,T,I);const o=await Dm(e.localStore,t,!0),l=new XC(t,o.gs),h=l.ba(o.documents),d=cl.createSynthesizedTargetChangeForCurrentChange(n,i&&e.onlineState!=="Offline",r),p=l.applyChanges(h,e.isPrimaryClient,d);qm(e,n,p.Ma);const _=new JC(t,n,l);return e.ka.set(t,_),e.qa.has(n)?e.qa.get(n).push(t):e.qa.set(n,[t]),p.snapshot}async function rR(e,t,n){const i=Nt(e),r=i.ka.get(t),o=i.qa.get(r.targetId);if(o.length>1)return i.qa.set(r.targetId,o.filter(l=>!mu(l,t))),void i.ka.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await qh(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),n&&jd(i.remoteStore,r.targetId),Gh(i,r.targetId)}).catch(Ao)):(Gh(i,r.targetId),await qh(i.localStore,r.targetId,!0))}async function oR(e,t){const n=Nt(e),i=n.ka.get(t),r=n.qa.get(i.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),jd(n.remoteStore,i.targetId))}async function aR(e,t,n){const i=pR(e);try{const r=await function(l,h){const d=Nt(l),p=Ue.now(),_=h.reduce((I,U)=>I.add(U.key),Xt());let y,T;return d.persistence.runTransaction("Locally write mutations","readwrite",I=>{let U=Ji(),B=Xt();return d.ds.getEntries(I,_).next(j=>{U=j,U.forEach((et,X)=>{X.isValidDocument()||(B=B.add(et))})}).next(()=>d.localDocuments.getOverlayedDocuments(I,U)).next(j=>{y=j;const et=[];for(const X of h){const Q=bA(X,y.get(X.key).overlayedDocument);Q!=null&&et.push(new Bs(X.key,Q,Sv(Q.value.mapValue),$n.exists(!0)))}return d.mutationQueue.addMutationBatch(I,p,et,h)}).next(j=>{T=j;const et=j.applyToLocalDocumentSet(y,B);return d.documentOverlayCache.saveOverlays(I,j.batchId,et)})}).then(()=>({batchId:T.batchId,changes:Bv(y)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(r.batchId),function(l,h,d){let p=l.Wa[l.currentUser.toKey()];p||(p=new Ie(jt)),p=p.insert(h,d),l.Wa[l.currentUser.toKey()]=p}(i,r.batchId,n),await hl(i,r.changes),await Eu(i.remoteStore)}catch(r){const o=Kd(r,"Failed to persist write");n.reject(o)}}async function wy(e,t){const n=Nt(e);try{const i=await wC(n.localStore,t);t.targetChanges.forEach((r,o)=>{const l=n.Ua.get(o);l&&(re(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?l.Ba=!0:r.modifiedDocuments.size>0?re(l.Ba):r.removedDocuments.size>0&&(re(l.Ba),l.Ba=!1))}),await hl(n,i,t)}catch(i){await Ao(i)}}function $m(e,t,n){const i=Nt(e);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const r=[];i.ka.forEach((o,l)=>{const h=l.view.sa(t);h.snapshot&&r.push(h.snapshot)}),function(l,h){const d=Nt(l);d.onlineState=h;let p=!1;d.queries.forEach((_,y)=>{for(const T of y.ta)T.sa(h)&&(p=!0)}),p&&Qd(d)}(i.eventManager,t),r.length&&i.La.p_(r),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function lR(e,t,n){const i=Nt(e);i.sharedClientState.updateQueryState(t,"rejected",n);const r=i.Ua.get(t),o=r&&r.key;if(o){let l=new Ie(Tt.comparator);l=l.insert(o,en.newNoDocument(o,Dt.min()));const h=Xt().add(o),d=new yu(Dt.min(),new Map,new Ie(jt),l,h);await wy(i,d),i.$a=i.$a.remove(o),i.Ua.delete(t),Jd(i)}else await qh(i.localStore,t,!1).then(()=>Gh(i,t,n)).catch(Ao)}async function cR(e,t){const n=Nt(e),i=t.batch.batchId;try{const r=await yC(n.localStore,t);Ey(n,i,null),Ty(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await hl(n,r)}catch(r){await Ao(r)}}async function uR(e,t,n){const i=Nt(e);try{const r=await function(l,h){const d=Nt(l);return d.persistence.runTransaction("Reject batch","readwrite-primary",p=>{let _;return d.mutationQueue.lookupMutationBatch(p,h).next(y=>(re(y!==null),_=y.keys(),d.mutationQueue.removeMutationBatch(p,y))).next(()=>d.mutationQueue.performConsistencyCheck(p)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(p,_,h)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,_)).next(()=>d.localDocuments.getDocuments(p,_))})}(i.localStore,t);Ey(i,t,n),Ty(i,t),i.sharedClientState.updateMutationState(t,"rejected",n),await hl(i,r)}catch(r){await Ao(r)}}function Ty(e,t){(e.Ga.get(t)||[]).forEach(n=>{n.resolve()}),e.Ga.delete(t)}function Ey(e,t,n){const i=Nt(e);let r=i.Wa[i.currentUser.toKey()];if(r){const o=r.get(t);o&&(n?o.reject(n):o.resolve(),r=r.remove(t)),i.Wa[i.currentUser.toKey()]=r}}function Gh(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.qa.get(t))e.ka.delete(i),n&&e.La.Ja(i,n);e.qa.delete(t),e.isPrimaryClient&&e.Ka.br(t).forEach(i=>{e.Ka.containsKey(i)||by(e,i)})}function by(e,t){e.Qa.delete(t.path.canonicalString());const n=e.$a.get(t);n!==null&&(jd(e.remoteStore,n),e.$a=e.$a.remove(t),e.Ua.delete(n),Jd(e))}function qm(e,t,n){for(const i of n)i instanceof gy?(e.Ka.addReference(i.key,t),hR(e,i)):i instanceof vy?(ft(Xd,"Document no longer in limbo: "+i.key),e.Ka.removeReference(i.key,t),e.Ka.containsKey(i.key)||by(e,i.key)):xt()}function hR(e,t){const n=t.key,i=n.path.canonicalString();e.$a.get(n)||e.Qa.has(i)||(ft(Xd,"New document in limbo: "+n),e.Qa.add(i),Jd(e))}function Jd(e){for(;e.Qa.size>0&&e.$a.size<e.maxConcurrentLimboResolutions;){const t=e.Qa.values().next().value;e.Qa.delete(t);const n=new Tt(ge.fromString(t)),i=e.za.next();e.Ua.set(i,new tR(n)),e.$a=e.$a.insert(n,i),hy(e.remoteStore,new Es(wi(pu(n.path)),i,"TargetPurposeLimboResolution",hu.ae))}}async function hl(e,t,n){const i=Nt(e),r=[],o=[],l=[];i.ka.isEmpty()||(i.ka.forEach((h,d)=>{l.push(i.Ha(d,t,n).then(p=>{var _;if((p||n)&&i.isPrimaryClient){const y=p?!p.fromCache:(_=n==null?void 0:n.targetChanges.get(d.targetId))===null||_===void 0?void 0:_.current;i.sharedClientState.updateQueryState(d.targetId,y?"current":"not-current")}if(p){r.push(p);const y=Bd.Yi(d.targetId,p);o.push(y)}}))}),await Promise.all(l),i.La.p_(r),await async function(d,p){const _=Nt(d);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>Z.forEach(p,T=>Z.forEach(T.Hi,I=>_.persistence.referenceDelegate.addReference(y,T.targetId,I)).next(()=>Z.forEach(T.Ji,I=>_.persistence.referenceDelegate.removeReference(y,T.targetId,I)))))}catch(y){if(!Co(y))throw y;ft(zd,"Failed to update sequence numbers: "+y)}for(const y of p){const T=y.targetId;if(!y.fromCache){const I=_.Ts.get(T),U=I.snapshotVersion,B=I.withLastLimboFreeSnapshotVersion(U);_.Ts=_.Ts.insert(T,B)}}}(i.localStore,o))}async function dR(e,t){const n=Nt(e);if(!n.currentUser.isEqual(t)){ft(Xd,"User change. New user:",t.toKey());const i=await ay(n.localStore,t);n.currentUser=t,function(o,l){o.Ga.forEach(h=>{h.forEach(d=>{d.reject(new pt(K.CANCELLED,l))})}),o.Ga.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await hl(n,i.Rs)}}function fR(e,t){const n=Nt(e),i=n.Ua.get(t);if(i&&i.Ba)return Xt().add(i.key);{let r=Xt();const o=n.qa.get(t);if(!o)return r;for(const l of o){const h=n.ka.get(l);r=r.unionWith(h.view.Sa)}return r}}function Iy(e){const t=Nt(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=wy.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=fR.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=lR.bind(null,t),t.La.p_=QC.bind(null,t.eventManager),t.La.Ja=YC.bind(null,t.eventManager),t}function pR(e){const t=Nt(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=cR.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=uR.bind(null,t),t}class Fc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=wu(t.databaseInfo.databaseId),this.sharedClientState=this.Za(t),this.persistence=this.Xa(t),await this.persistence.start(),this.localStore=this.eu(t),this.gcScheduler=this.tu(t,this.localStore),this.indexBackfillerScheduler=this.nu(t,this.localStore)}tu(t,n){return null}nu(t,n){return null}eu(t){return vC(this.persistence,new mC,t.initialUser,this.serializer)}Xa(t){return new oy(Fd.ri,this.serializer)}Za(t){return new PC}async terminate(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Fc.provider={build:()=>new Fc};class mR extends Fc{constructor(t){super(),this.cacheSizeBytes=t}tu(t,n){re(this.persistence.referenceDelegate instanceof Vc);const i=this.persistence.referenceDelegate.garbageCollector;return new tC(i,t.asyncQueue,n)}Xa(t){const n=this.cacheSizeBytes!==void 0?wn.withCacheSize(this.cacheSizeBytes):wn.DEFAULT;return new oy(i=>Vc.ri(i,n),this.serializer)}}class Zh{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>$m(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=dR.bind(null,this.syncEngine),await KC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new ZC}()}createDatastore(t){const n=wu(t.databaseInfo.databaseId),i=function(o){return new xC(o)}(t.databaseInfo);return function(o,l,h,d){return new OC(o,l,h,d)}(t.authCredentials,t.appCheckCredentials,i,n)}createRemoteStore(t){return function(i,r,o,l,h){return new NC(i,r,o,l,h)}(this.localStore,this.datastore,t.asyncQueue,n=>$m(this.syncEngine,n,0),function(){return Um.D()?new Um:new AC}())}createSyncEngine(t,n){return function(r,o,l,h,d,p,_){const y=new eR(r,o,l,h,d,p);return _&&(y.ja=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(r){const o=Nt(r);ft(mr,"RemoteStore shutting down."),o.W_.add(5),await ul(o),o.z_.shutdown(),o.j_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Zh.provider={build:()=>new Zh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.iu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.iu(this.observer.error,t):Xi("Uncaught Error in snapshot listener:",t.toString()))}su(){this.muted=!0}iu(t,n){setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ds="FirestoreClient";class _R{constructor(t,n,i,r,o){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=r,this.user=Xe.UNAUTHENTICATED,this.clientId=yv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,async l=>{ft(Ds,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l}),this.appCheckCredentials.start(i,l=>(ft(Ds,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Gi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=Kd(n,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function ch(e,t){e.asyncQueue.verifyOperationInProgress(),ft(Ds,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener(async r=>{i.isEqual(r)||(await ay(t.localStore,r),i=r)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Wm(e,t){e.asyncQueue.verifyOperationInProgress();const n=await gR(e);ft(Ds,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(i=>Bm(t.remoteStore,i)),e.setAppCheckTokenChangeListener((i,r)=>Bm(t.remoteStore,r)),e._onlineComponents=t}async function gR(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){ft(Ds,"Using user provided OfflineComponentProvider");try{await ch(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(r){return r.name==="FirebaseError"?r.code===K.FAILED_PRECONDITION||r.code===K.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(n))throw n;po("Error using user provided cache. Falling back to memory cache: "+n),await ch(e,new Fc)}}else ft(Ds,"Using default OfflineComponentProvider"),await ch(e,new mR(void 0));return e._offlineComponents}async function Py(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(ft(Ds,"Using user provided OnlineComponentProvider"),await Wm(e,e._uninitializedComponentsProvider._online)):(ft(Ds,"Using default OnlineComponentProvider"),await Wm(e,new Zh))),e._onlineComponents}function vR(e){return Py(e).then(t=>t.syncEngine)}async function Bc(e){const t=await Py(e),n=t.eventManager;return n.onListen=nR.bind(null,t.syncEngine),n.onUnlisten=rR.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=iR.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=oR.bind(null,t.syncEngine),n}function yR(e,t,n={}){const i=new Gi;return e.asyncQueue.enqueueAndForget(async()=>function(o,l,h,d,p){const _=new tf({next:T=>{_.su(),l.enqueueAndForget(()=>Zd(o,y));const I=T.docs.has(h);!I&&T.fromCache?p.reject(new pt(K.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&T.fromCache&&d&&d.source==="server"?p.reject(new pt(K.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(T)},error:T=>p.reject(T)}),y=new Yd(pu(h.path),_,{includeMetadataChanges:!0,Ta:!0});return Gd(o,y)}(await Bc(e),e.asyncQueue,t,n,i)),i.promise}function wR(e,t,n={}){const i=new Gi;return e.asyncQueue.enqueueAndForget(async()=>function(o,l,h,d,p){const _=new tf({next:T=>{_.su(),l.enqueueAndForget(()=>Zd(o,y)),T.fromCache&&d.source==="server"?p.reject(new pt(K.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(T)},error:T=>p.reject(T)}),y=new Yd(h,_,{includeMetadataChanges:!0,Ta:!0});return Gd(o,y)}(await Bc(e),e.asyncQueue,t,n,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ay(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Km=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cy(e,t,n){if(!n)throw new pt(K.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function TR(e,t,n,i){if(t===!0&&i===!0)throw new pt(K.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Gm(e){if(!Tt.isDocumentKey(e))throw new pt(K.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Zm(e){if(Tt.isDocumentKey(e))throw new pt(K.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function bu(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":xt()}function bn(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new pt(K.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=bu(e);throw new pt(K.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ry="firestore.googleapis.com",Qm=!0;class Ym{constructor(t){var n,i;if(t.host===void 0){if(t.ssl!==void 0)throw new pt(K.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ry,this.ssl=Qm}else this.host=t.host,this.ssl=(n=t.ssl)!==null&&n!==void 0?n:Qm;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=ry;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<XA)throw new pt(K.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}TR("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ay((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new pt(K.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new pt(K.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new pt(K.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Iu{constructor(t,n,i,r){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ym({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new pt(K.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new pt(K.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ym(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new SP;switch(i.type){case"firstParty":return new MP(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new pt(K.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const i=Km.get(n);i&&(ft("ComponentProvider","Removing Datastore"),Km.delete(n),i.terminate())}(this),Promise.resolve()}}function ER(e,t,n,i={}){var r;const o=(e=bn(e,Iu))._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),h=`${t}:${n}`;o.host!==Ry&&o.host!==h&&po("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=Object.assign(Object.assign({},o),{host:h,ssl:!1,emulatorOptions:i});if(!dr(d,l)&&(e._setSettings(d),i.mockUserToken)){let p,_;if(typeof i.mockUserToken=="string")p=i.mockUserToken,_=Xe.MOCK_USER;else{p=rv(i.mockUserToken,(r=e._app)===null||r===void 0?void 0:r.options.projectId);const y=i.mockUserToken.sub||i.mockUserToken.user_id;if(!y)throw new pt(K.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new Xe(y)}e._authCredentials=new xP(new gv(p,_))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(t,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new zs(this.firestore,t,this._query)}}class on{constructor(t,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rs(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new on(this.firestore,t,this._key)}}class Rs extends zs{constructor(t,n,i){super(t,n,pu(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new on(this.firestore,null,new Tt(t))}withConverter(t){return new Rs(this.firestore,t,this._path)}}function Wn(e,t,...n){if(e=Te(e),Cy("collection","path",t),e instanceof Iu){const i=ge.fromString(t,...n);return Zm(i),new Rs(e,null,i)}{if(!(e instanceof on||e instanceof Rs))throw new pt(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(ge.fromString(t,...n));return Zm(i),new Rs(e.firestore,null,i)}}function mn(e,t,...n){if(e=Te(e),arguments.length===1&&(t=yv.newId()),Cy("doc","path",t),e instanceof Iu){const i=ge.fromString(t,...n);return Gm(i),new on(e,null,new Tt(i))}{if(!(e instanceof on||e instanceof Rs))throw new pt(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(ge.fromString(t,...n));return Gm(i),new on(e.firestore,e instanceof Rs?e.converter:null,new Tt(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xm="AsyncQueue";class Jm{constructor(t=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new cy(this,"async_queue_retry"),this.Su=()=>{const i=lh();i&&ft(Xm,"Visibility state changed to "+i.visibilityState),this.a_.t_()},this.bu=t;const n=lh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Du(),this.vu(t)}enterRestrictedMode(t){if(!this.mu){this.mu=!0,this.yu=t||!1;const n=lh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Su)}}enqueue(t){if(this.Du(),this.mu)return new Promise(()=>{});const n=new Gi;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Vu.push(t),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(t){if(!Co(t))throw t;ft(Xm,"Operation failed with retryable error: "+t)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(t){const n=this.bu.then(()=>(this.pu=!0,t().catch(i=>{this.gu=i,this.pu=!1;const r=function(l){let h=l.message||"";return l.stack&&(h=l.stack.includes(l.message)?l.stack:l.message+`
`+l.stack),h}(i);throw Xi("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.pu=!1,i))));return this.bu=n,n}enqueueAfterDelay(t,n,i){this.Du(),this.wu.indexOf(t)>-1&&(n=0);const r=Wd.createAndSchedule(this,t,n,i,o=>this.Fu(o));return this.fu.push(r),r}Du(){this.gu&&xt()}verifyOperationInProgress(){}async Mu(){let t;do t=this.bu,await t;while(t!==this.bu)}xu(t){for(const n of this.fu)if(n.timerId===t)return!0;return!1}Ou(t){return this.Mu().then(()=>{this.fu.sort((n,i)=>n.targetTimeMs-i.targetTimeMs);for(const n of this.fu)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.Mu()})}Nu(t){this.wu.push(t)}Fu(t){const n=this.fu.indexOf(t);this.fu.splice(n,1)}}function t_(e){return function(n,i){if(typeof n!="object"||n===null)return!1;const r=n;for(const o of i)if(o in r&&typeof r[o]=="function")return!0;return!1}(e,["next","error","complete"])}class ts extends Iu{constructor(t,n,i,r){super(t,n,i,r),this.type="firestore",this._queue=new Jm,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new Jm(t),this._firestoreClient=void 0,await t}}}function bR(e,t){const n=typeof e=="object"?e:Ad(),i=typeof e=="string"?e:kc,r=uu(n,"firestore").getImmediate({identifier:i});if(!r._initialized){const o=nv("firestore");o&&ER(r,...o)}return r}function Pu(e){if(e._terminated)throw new pt(K.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||IR(e),e._firestoreClient}function IR(e){var t,n,i;const r=e._freezeSettings(),o=function(h,d,p,_){return new GP(h,d,p,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,Ay(_.experimentalLongPollingOptions),_.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,r);e._componentsProvider||!((n=r.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(e._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),e._firestoreClient=new _R(e._authCredentials,e._appCheckCredentials,e._queue,o,e._componentsProvider&&function(h){const d=h==null?void 0:h._online.build();return{_offline:h==null?void 0:h._offline.build(d),_online:d}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(t){this._byteString=t}static fromBase64String(t){try{return new wo(Ze.fromBase64String(t))}catch(n){throw new pt(K.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new wo(Ze.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new pt(K.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ge(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new pt(K.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new pt(K.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return jt(this._lat,t._lat)||jt(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(i,r){if(i.length!==r.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PR=/^__.*__$/;class AR{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return this.fieldMask!==null?new Bs(t,this.data,this.fieldMask,n,this.fieldTransforms):new ll(t,this.data,n,this.fieldTransforms)}}class Sy{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return new Bs(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function xy(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xt()}}class rf{constructor(t,n,i,r,o,l){this.settings=t,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=r,o===void 0&&this.Bu(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(t){return new rf(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(t){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(t),r=this.ku({path:i,Qu:!1});return r.$u(t),r}Uu(t){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(t),r=this.ku({path:i,Qu:!1});return r.Bu(),r}Ku(t){return this.ku({path:void 0,Qu:!0})}Wu(t){return zc(t,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Bu(){if(this.path)for(let t=0;t<this.path.length;t++)this.$u(this.path.get(t))}$u(t){if(t.length===0)throw this.Wu("Document fields must not be empty");if(xy(this.Lu)&&PR.test(t))throw this.Wu('Document fields cannot begin and end with "__"')}}class CR{constructor(t,n,i){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=i||wu(t)}ju(t,n,i,r=!1){return new rf({Lu:t,methodName:n,zu:i,path:Ge.emptyPath(),Qu:!1,Gu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Cu(e){const t=e._freezeSettings(),n=wu(e._databaseId);return new CR(e._databaseId,!!t.ignoreUndefinedProperties,n)}function ky(e,t,n,i,r,o={}){const l=e.ju(o.merge||o.mergeFields?2:0,t,n,r);of("Data must be an object, but it was:",l,i);const h=Ly(i,l);let d,p;if(o.merge)d=new Mn(l.fieldMask),p=l.fieldTransforms;else if(o.mergeFields){const _=[];for(const y of o.mergeFields){const T=Qh(t,y,n);if(!l.contains(T))throw new pt(K.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);Oy(_,T)||_.push(T)}d=new Mn(_),p=l.fieldTransforms.filter(y=>d.covers(y.field))}else d=null,p=l.fieldTransforms;return new AR(new En(h),d,p)}class Ru extends ef{_toFieldTransform(t){if(t.Lu!==2)throw t.Lu===1?t.Wu(`${this._methodName}() can only appear at the top level of your update data`):t.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Ru}}function RR(e,t,n,i){const r=e.ju(1,t,n);of("Data must be an object, but it was:",r,i);const o=[],l=En.empty();Fs(i,(d,p)=>{const _=af(t,d,n);p=Te(p);const y=r.Uu(_);if(p instanceof Ru)o.push(_);else{const T=dl(p,y);T!=null&&(o.push(_),l.set(_,T))}});const h=new Mn(o);return new Sy(l,h,r.fieldTransforms)}function SR(e,t,n,i,r,o){const l=e.ju(1,t,n),h=[Qh(t,i,n)],d=[r];if(o.length%2!=0)throw new pt(K.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<o.length;T+=2)h.push(Qh(t,o[T])),d.push(o[T+1]);const p=[],_=En.empty();for(let T=h.length-1;T>=0;--T)if(!Oy(p,h[T])){const I=h[T];let U=d[T];U=Te(U);const B=l.Uu(I);if(U instanceof Ru)p.push(I);else{const j=dl(U,B);j!=null&&(p.push(I),_.set(I,j))}}const y=new Mn(p);return new Sy(_,y,l.fieldTransforms)}function xR(e,t,n,i=!1){return dl(n,e.ju(i?4:3,t))}function dl(e,t){if(My(e=Te(e)))return of("Unsupported field value:",t,e),Ly(e,t);if(e instanceof ef)return function(i,r){if(!xy(r.Lu))throw r.Wu(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Wu(`${i._methodName}() is not currently supported inside arrays`);const o=i._toFieldTransform(r);o&&r.fieldTransforms.push(o)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Qu&&t.Lu!==4)throw t.Wu("Nested arrays are not supported");return function(i,r){const o=[];let l=0;for(const h of i){let d=dl(h,r.Ku(l));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),l++}return{arrayValue:{values:o}}}(e,t)}return function(i,r){if((i=Te(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return gA(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const o=Ue.fromDate(i);return{timestampValue:Nc(r.serializer,o)}}if(i instanceof Ue){const o=new Ue(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Nc(r.serializer,o)}}if(i instanceof nf)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof wo)return{bytesValue:Xv(r.serializer,i._byteString)};if(i instanceof on){const o=r.databaseId,l=i.firestore._databaseId;if(!l.isEqual(o))throw r.Wu(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Vd(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof sf)return function(l,h){return{mapValue:{fields:{[Cv]:{stringValue:Rv},[Lc]:{arrayValue:{values:l.toArray().map(p=>{if(typeof p!="number")throw h.Wu("VectorValues must only contain numeric values.");return Md(h.serializer,p)})}}}}}}(i,r);throw r.Wu(`Unsupported field value: ${bu(i)}`)}(e,t)}function Ly(e,t){const n={};return Tv(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Fs(e,(i,r)=>{const o=dl(r,t.qu(i));o!=null&&(n[i]=o)}),{mapValue:{fields:n}}}function My(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof Ue||e instanceof nf||e instanceof wo||e instanceof on||e instanceof ef||e instanceof sf)}function of(e,t,n){if(!My(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const i=bu(n);throw i==="an object"?t.Wu(e+" a custom object"):t.Wu(e+" "+i)}}function Qh(e,t,n){if((t=Te(t))instanceof Au)return t._internalPath;if(typeof t=="string")return af(e,t);throw zc("Field path arguments must be of type string or ",e,!1,void 0,n)}const kR=new RegExp("[~\\*/\\[\\]]");function af(e,t,n){if(t.search(kR)>=0)throw zc(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Au(...t.split("."))._internalPath}catch{throw zc(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function zc(e,t,n,i,r){const o=i&&!i.isEmpty(),l=r!==void 0;let h=`Function ${t}() called with invalid data`;n&&(h+=" (via `toFirestore()`)"),h+=". ";let d="";return(o||l)&&(d+=" (found",o&&(d+=` in field ${i}`),l&&(d+=` in document ${r}`),d+=")"),new pt(K.INVALID_ARGUMENT,h+e+d)}function Oy(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dy{constructor(t,n,i,r,o){this._firestore=t,this._userDataWriter=n,this._key=i,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new on(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new LR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(Su("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class LR extends Dy{data(){return super.data()}}function Su(e,t){return typeof t=="string"?af(e,t):t instanceof Au?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ny(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new pt(K.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class lf{}class Vy extends lf{}function Uy(e,t,...n){let i=[];t instanceof lf&&i.push(t),i=i.concat(n),function(o){const l=o.filter(d=>d instanceof cf).length,h=o.filter(d=>d instanceof xu).length;if(l>1||l>0&&h>0)throw new pt(K.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)e=r._apply(e);return e}class xu extends Vy{constructor(t,n,i){super(),this._field=t,this._op=n,this._value=i,this.type="where"}static _create(t,n,i){return new xu(t,n,i)}_apply(t){const n=this._parse(t);return Fy(t._query,n),new zs(t.firestore,t.converter,Fh(t._query,n))}_parse(t){const n=Cu(t.firestore);return function(o,l,h,d,p,_,y){let T;if(p.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new pt(K.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){n_(y,_);const U=[];for(const B of y)U.push(e_(d,o,B));T={arrayValue:{values:U}}}else T=e_(d,o,y)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||n_(y,_),T=xR(h,l,y,_==="in"||_==="not-in");return Ne.create(p,_,T)}(t._query,"where",n,t.firestore._databaseId,this._field,this._op,this._value)}}function MR(e,t,n){const i=t,r=Su("where",e);return xu._create(r,i,n)}class cf extends lf{constructor(t,n){super(),this.type=t,this._queryConstraints=n}static _create(t,n){return new cf(t,n)}_parse(t){const n=this._queryConstraints.map(i=>i._parse(t)).filter(i=>i.getFilters().length>0);return n.length===1?n[0]:ri.create(n,this._getOperator())}_apply(t){const n=this._parse(t);return n.getFilters().length===0?t:(function(r,o){let l=r;const h=o.getFlattenedFilters();for(const d of h)Fy(l,d),l=Fh(l,d)}(t._query,n),new zs(t.firestore,t.converter,Fh(t._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class uf extends Vy{constructor(t,n){super(),this._field=t,this._direction=n,this.type="orderBy"}static _create(t,n){return new uf(t,n)}_apply(t){const n=function(r,o,l){if(r.startAt!==null)throw new pt(K.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new pt(K.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Qa(o,l)}(t._query,this._field,this._direction);return new zs(t.firestore,t.converter,function(r,o){const l=r.explicitOrderBy.concat([o]);return new Ro(r.path,r.collectionGroup,l,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(t._query,n))}}function OR(e,t="asc"){const n=t,i=Su("orderBy",e);return uf._create(i,n)}function e_(e,t,n){if(typeof(n=Te(n))=="string"){if(n==="")throw new pt(K.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Nv(t)&&n.indexOf("/")!==-1)throw new pt(K.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=t.path.child(ge.fromString(n));if(!Tt.isDocumentKey(i))throw new pt(K.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return _m(e,new Tt(i))}if(n instanceof on)return _m(e,n._key);throw new pt(K.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bu(n)}.`)}function n_(e,t){if(!Array.isArray(e)||e.length===0)throw new pt(K.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Fy(e,t){const n=function(r,o){for(const l of r)for(const h of l.getFlattenedFilters())if(o.indexOf(h.op)>=0)return h.op;return null}(e.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(n!==null)throw n===t.op?new pt(K.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new pt(K.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class DR{convertValue(t,n="none"){switch(Ms(t)){case 0:return null;case 1:return t.booleanValue;case 2:return xe(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(Ls(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 11:return this.convertObject(t.mapValue,n);case 10:return this.convertVectorValue(t.mapValue);default:throw xt()}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const i={};return Fs(t,(r,o)=>{i[r]=this.convertValue(o,n)}),i}convertVectorValue(t){var n,i,r;const o=(r=(i=(n=t.fields)===null||n===void 0?void 0:n[Lc].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map(l=>xe(l.doubleValue));return new sf(o)}convertGeoPoint(t){return new nf(xe(t.latitude),xe(t.longitude))}convertArray(t,n){return(t.values||[]).map(i=>this.convertValue(i,n))}convertServerTimestamp(t,n){switch(n){case"previous":const i=fu(t);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Ka(t));default:return null}}convertTimestamp(t){const n=ks(t);return new Ue(n.seconds,n.nanos)}convertDocumentKey(t,n){const i=ge.fromString(t);re(sy(i));const r=new Ga(i.get(1),i.get(3)),o=new Tt(i.popFirst(5));return r.isEqual(n)||Xi(`Document ${o} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function By(e,t,n){let i;return i=e?e.toFirestore(t):t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class zy extends Dy{constructor(t,n,i,r,o,l){super(t,n,i,r,l),this._firestore=t,this._firestoreImpl=t,this.metadata=o}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new mc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const i=this._document.data.field(Su("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}}class mc extends zy{data(t={}){return super.data(t)}}class jy{constructor(t,n,i,r){this._firestore=t,this._userDataWriter=n,this._snapshot=r,this.metadata=new va(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(i=>{t.call(n,new mc(this._firestore,this._userDataWriter,i.key,i,new va(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new pt(K.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,o){if(r._snapshot.oldDocs.isEmpty()){let l=0;return r._snapshot.docChanges.map(h=>{const d=new mc(r._firestore,r._userDataWriter,h.doc.key,h.doc,new va(r._snapshot.mutatedKeys.has(h.doc.key),r._snapshot.fromCache),r.query.converter);return h.doc,{type:"added",doc:d,oldIndex:-1,newIndex:l++}})}{let l=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(h=>o||h.type!==3).map(h=>{const d=new mc(r._firestore,r._userDataWriter,h.doc.key,h.doc,new va(r._snapshot.mutatedKeys.has(h.doc.key),r._snapshot.fromCache),r.query.converter);let p=-1,_=-1;return h.type!==0&&(p=l.indexOf(h.doc.key),l=l.delete(h.doc.key)),h.type!==1&&(l=l.add(h.doc),_=l.indexOf(h.doc.key)),{type:NR(h.type),doc:d,oldIndex:p,newIndex:_}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function NR(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VR(e){e=bn(e,on);const t=bn(e.firestore,ts);return yR(Pu(t),e._key).then(n=>Hy(t,e,n))}class hf extends DR{constructor(t){super(),this.firestore=t}convertBytes(t){return new wo(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new on(this.firestore,null,n)}}function UR(e){e=bn(e,zs);const t=bn(e.firestore,ts),n=Pu(t),i=new hf(t);return Ny(e._query),wR(n,e._query).then(r=>new jy(t,i,e,r))}function FR(e,t,n){e=bn(e,on);const i=bn(e.firestore,ts),r=By(e.converter,t);return ku(i,[ky(Cu(i),"setDoc",e._key,r,e.converter!==null,n).toMutation(e._key,$n.none())])}function Oa(e,t,n,...i){e=bn(e,on);const r=bn(e.firestore,ts),o=Cu(r);let l;return l=typeof(t=Te(t))=="string"||t instanceof Au?SR(o,"updateDoc",e._key,t,n,i):RR(o,"updateDoc",e._key,t),ku(r,[l.toMutation(e._key,$n.exists(!0))])}function xo(e){return ku(bn(e.firestore,ts),[new Od(e._key,$n.none())])}function fl(e,t){const n=bn(e.firestore,ts),i=mn(e),r=By(e.converter,t);return ku(n,[ky(Cu(e.firestore),"addDoc",i._key,r,e.converter!==null,{}).toMutation(i._key,$n.exists(!1))]).then(()=>i)}function To(e,...t){var n,i,r;e=Te(e);let o={includeMetadataChanges:!1,source:"default"},l=0;typeof t[l]!="object"||t_(t[l])||(o=t[l],l++);const h={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(t_(t[l])){const y=t[l];t[l]=(n=y.next)===null||n===void 0?void 0:n.bind(y),t[l+1]=(i=y.error)===null||i===void 0?void 0:i.bind(y),t[l+2]=(r=y.complete)===null||r===void 0?void 0:r.bind(y)}let d,p,_;if(e instanceof on)p=bn(e.firestore,ts),_=pu(e._key.path),d={next:y=>{t[l]&&t[l](Hy(p,e,y))},error:t[l+1],complete:t[l+2]};else{const y=bn(e,zs);p=bn(y.firestore,ts),_=y._query;const T=new hf(p);d={next:I=>{t[l]&&t[l](new jy(p,T,y,I))},error:t[l+1],complete:t[l+2]},Ny(e._query)}return function(T,I,U,B){const j=new tf(B),et=new Yd(I,j,U);return T.asyncQueue.enqueueAndForget(async()=>Gd(await Bc(T),et)),()=>{j.su(),T.asyncQueue.enqueueAndForget(async()=>Zd(await Bc(T),et))}}(Pu(p),_,h,d)}function ku(e,t){return function(i,r){const o=new Gi;return i.asyncQueue.enqueueAndForget(async()=>aR(await vR(i),r,o)),o.promise}(Pu(e),t)}function Hy(e,t,n){const i=n.docs.get(t._key),r=new hf(e);return new zy(e,r,t._key,i,new va(n.hasPendingWrites,n.fromCache),t.converter)}(function(t,n=!0){(function(r){Po=r})(yr),fr(new Ss("firestore",(i,{instanceIdentifier:r,options:o})=>{const l=i.getProvider("app").getImmediate(),h=new ts(new kP(i.getProvider("auth-internal")),new OP(l,i.getProvider("app-check-internal")),function(p,_){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new pt(K.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ga(p.options.projectId,_)}(l,r),l);return o=Object.assign({useFetchStreams:n},o),h._setSettings(o),h},"PUBLIC").setMultipleInstances(!0)),yi(sm,rm,t),yi(sm,rm,"esm2017")})();var BR="firebase",zR="11.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yi(BR,zR,"app");function df(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n}function $y(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const jR=$y,qy=new ol("auth","Firebase",$y());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jc=new Id("@firebase/auth");function HR(e,...t){jc.logLevel<=Yt.WARN&&jc.warn(`Auth (${yr}): ${e}`,...t)}function _c(e,...t){jc.logLevel<=Yt.ERROR&&jc.error(`Auth (${yr}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kn(e,...t){throw pf(e,...t)}function ii(e,...t){return pf(e,...t)}function ff(e,t,n){const i=Object.assign(Object.assign({},jR()),{[t]:n});return new ol("auth","Firebase",i).create(t,{appName:e.name})}function Zi(e){return ff(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $R(e,t,n){const i=n;if(!(t instanceof i))throw i.name!==t.constructor.name&&Kn(e,"argument-error"),ff(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function pf(e,...t){if(typeof e!="string"){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return qy.create(e,...t)}function St(e,t,...n){if(!e)throw pf(t,...n)}function qi(e){const t="INTERNAL ASSERTION FAILED: "+e;throw _c(t),new Error(t)}function es(e,t){e||qi(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yh(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.href)||""}function qR(){return i_()==="http:"||i_()==="https:"}function i_(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WR(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(qR()||l0()||"connection"in navigator)?navigator.onLine:!0}function KR(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(t,n){this.shortDelay=t,this.longDelay=n,es(n>t,"Short delay should be less than long delay!"),this.isMobile=r0()||c0()}get(){return WR()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mf(e,t){es(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{static initialize(t,n,i){this.fetchImpl=t,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;qi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;qi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;qi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],QR=new pl(3e4,6e4);function js(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Hs(e,t,n,i,r={}){return Ky(e,r,async()=>{let o={},l={};i&&(t==="GET"?l=i:o={body:JSON.stringify(i)});const h=al(Object.assign({key:e.config.apiKey},l)).slice(1),d=await e._getAdditionalHeaders();d["Content-Type"]="application/json",e.languageCode&&(d["X-Firebase-Locale"]=e.languageCode);const p=Object.assign({method:t,headers:d},o);return a0()||(p.referrerPolicy="no-referrer"),Wy.fetch()(await Gy(e,e.config.apiHost,n,h),p)})}async function Ky(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},GR),t);try{const r=new XR(e),o=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw nc(e,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const h=o.ok?l.errorMessage:l.error.message,[d,p]=h.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw nc(e,"credential-already-in-use",l);if(d==="EMAIL_EXISTS")throw nc(e,"email-already-in-use",l);if(d==="USER_DISABLED")throw nc(e,"user-disabled",l);const _=i[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw ff(e,_,p);Kn(e,_)}}catch(r){if(r instanceof Ai)throw r;Kn(e,"network-request-failed",{message:String(r)})}}async function ml(e,t,n,i,r={}){const o=await Hs(e,t,n,i,r);return"mfaPendingCredential"in o&&Kn(e,"multi-factor-auth-required",{_serverResponse:o}),o}async function Gy(e,t,n,i){const r=`${t}${n}?${i}`,o=e,l=o.config.emulator?mf(e.config,r):`${e.config.apiScheme}://${r}`;return ZR.includes(n)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}function YR(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class XR{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(ii(this.auth,"network-request-failed")),QR.get())})}}function nc(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=ii(e,t,i);return r.customData._tokenResponse=n,r}function s_(e){return e!==void 0&&e.enterprise!==void 0}class JR{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],t.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===t)return YR(n.enforcementState);return null}isProviderEnabled(t){return this.getProviderEnforcementState(t)==="ENFORCE"||this.getProviderEnforcementState(t)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function tS(e,t){return Hs(e,"GET","/v2/recaptchaConfig",js(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eS(e,t){return Hs(e,"POST","/v1/accounts:delete",t)}async function Hc(e,t){return Hs(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Da(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function nS(e,t=!1){const n=Te(e),i=await n.getIdToken(t),r=_f(i);St(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const o=typeof r.firebase=="object"?r.firebase:void 0,l=o==null?void 0:o.sign_in_provider;return{claims:r,token:i,authTime:Da(uh(r.auth_time)),issuedAtTime:Da(uh(r.iat)),expirationTime:Da(uh(r.exp)),signInProvider:l||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function uh(e){return Number(e)*1e3}function _f(e){const[t,n,i]=e.split(".");if(t===void 0||n===void 0||i===void 0)return _c("JWT malformed, contained fewer than 3 sections"),null;try{const r=tv(n);return r?JSON.parse(r):(_c("Failed to decode base64 JWT payload"),null)}catch(r){return _c("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function r_(e){const t=_f(e);return St(t,"internal-error"),St(typeof t.exp<"u","internal-error"),St(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ja(e,t,n=!1){if(n)return t;try{return await t}catch(i){throw i instanceof Ai&&iS(i)&&e.auth.currentUser===e&&await e.auth.signOut(),i}}function iS({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var n;if(t){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const r=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(t=!1){if(!this.isRunning)return;const n=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(t,n){this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Da(this.lastLoginAt),this.creationTime=Da(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $c(e){var t;const n=e.auth,i=await e.getIdToken(),r=await Ja(e,Hc(n,{idToken:i}));St(r==null?void 0:r.users.length,n,"internal-error");const o=r.users[0];e._notifyReloadListener(o);const l=!((t=o.providerUserInfo)===null||t===void 0)&&t.length?Zy(o.providerUserInfo):[],h=oS(e.providerData,l),d=e.isAnonymous,p=!(e.email&&o.passwordHash)&&!(h!=null&&h.length),_=d?p:!1,y={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:h,metadata:new Xh(o.createdAt,o.lastLoginAt),isAnonymous:_};Object.assign(e,y)}async function rS(e){const t=Te(e);await $c(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function oS(e,t){return[...e.filter(i=>!t.some(r=>r.providerId===i.providerId)),...t]}function Zy(e){return e.map(t=>{var{providerId:n}=t,i=df(t,["providerId"]);return{providerId:n,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aS(e,t){const n=await Ky(e,{},async()=>{const i=al({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:o}=e.config,l=await Gy(e,r,"/v1/token",`key=${o}`),h=await e._getAdditionalHeaders();return h["Content-Type"]="application/x-www-form-urlencoded",Wy.fetch()(l,{method:"POST",headers:h,body:i})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function lS(e,t){return Hs(e,"POST","/v2/accounts:revokeToken",js(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){St(t.idToken,"internal-error"),St(typeof t.idToken<"u","internal-error"),St(typeof t.refreshToken<"u","internal-error");const n="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):r_(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,n)}updateFromIdToken(t){St(t.length!==0,"internal-error");const n=r_(t);this.updateTokensAndExpiration(t,null,n)}async getToken(t,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(St(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,n){const{accessToken:i,refreshToken:r,expiresIn:o}=await aS(t,n);this.updateTokensAndExpiration(i,r,Number(o))}updateTokensAndExpiration(t,n,i){this.refreshToken=n||null,this.accessToken=t||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(t,n){const{refreshToken:i,accessToken:r,expirationTime:o}=n,l=new oo;return i&&(St(typeof i=="string","internal-error",{appName:t}),l.refreshToken=i),r&&(St(typeof r=="string","internal-error",{appName:t}),l.accessToken=r),o&&(St(typeof o=="number","internal-error",{appName:t}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new oo,this.toJSON())}_performRefresh(){return qi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fs(e,t){St(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class ei{constructor(t){var{uid:n,auth:i,stsTokenManager:r}=t,o=df(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new sS(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Xh(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(t){const n=await Ja(this,this.stsTokenManager.getToken(this.auth,t));return St(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(t){return nS(this,t)}reload(){return rS(this)}_assign(t){this!==t&&(St(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(n=>Object.assign({},n)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const n=new ei(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(t){St(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,n=!1){let i=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),i=!0),n&&await $c(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Tn(this.auth.app))return Promise.reject(Zi(this.auth));const t=await this.getIdToken();return await Ja(this,eS(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,n){var i,r,o,l,h,d,p,_;const y=(i=n.displayName)!==null&&i!==void 0?i:void 0,T=(r=n.email)!==null&&r!==void 0?r:void 0,I=(o=n.phoneNumber)!==null&&o!==void 0?o:void 0,U=(l=n.photoURL)!==null&&l!==void 0?l:void 0,B=(h=n.tenantId)!==null&&h!==void 0?h:void 0,j=(d=n._redirectEventId)!==null&&d!==void 0?d:void 0,et=(p=n.createdAt)!==null&&p!==void 0?p:void 0,X=(_=n.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:Q,emailVerified:tt,isAnonymous:Et,providerData:kt,stsTokenManager:k}=n;St(Q&&k,t,"internal-error");const P=oo.fromJSON(this.name,k);St(typeof Q=="string",t,"internal-error"),fs(y,t.name),fs(T,t.name),St(typeof tt=="boolean",t,"internal-error"),St(typeof Et=="boolean",t,"internal-error"),fs(I,t.name),fs(U,t.name),fs(B,t.name),fs(j,t.name),fs(et,t.name),fs(X,t.name);const S=new ei({uid:Q,auth:t,email:T,emailVerified:tt,displayName:y,isAnonymous:Et,photoURL:U,phoneNumber:I,tenantId:B,stsTokenManager:P,createdAt:et,lastLoginAt:X});return kt&&Array.isArray(kt)&&(S.providerData=kt.map(M=>Object.assign({},M))),j&&(S._redirectEventId=j),S}static async _fromIdTokenResponse(t,n,i=!1){const r=new oo;r.updateFromServerResponse(n);const o=new ei({uid:n.localId,auth:t,stsTokenManager:r,isAnonymous:i});return await $c(o),o}static async _fromGetAccountInfoResponse(t,n,i){const r=n.users[0];St(r.localId!==void 0,"internal-error");const o=r.providerUserInfo!==void 0?Zy(r.providerUserInfo):[],l=!(r.email&&r.passwordHash)&&!(o!=null&&o.length),h=new oo;h.updateFromIdToken(i);const d=new ei({uid:r.localId,auth:t,stsTokenManager:h,isAnonymous:l}),p={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Xh(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(o!=null&&o.length)};return Object.assign(d,p),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o_=new Map;function Wi(e){es(e instanceof Function,"Expected a class definition");let t=o_.get(e);return t?(es(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,o_.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,n){this.storage[t]=n}async _get(t){const n=this.storage[t];return n===void 0?null:n}async _remove(t){delete this.storage[t]}_addListener(t,n){}_removeListener(t,n){}}Qy.type="NONE";const a_=Qy;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gc(e,t,n){return`firebase:${e}:${t}:${n}`}class ao{constructor(t,n,i){this.persistence=t,this.auth=n,this.userKey=i;const{config:r,name:o}=this.auth;this.fullUserKey=gc(this.userKey,r.apiKey,o),this.fullPersistenceKey=gc("persistence",r.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const n=await Hc(this.auth,{idToken:t}).catch(()=>{});return n?ei._fromGetAccountInfoResponse(this.auth,n,t):null}return ei._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,n,i="authUser"){if(!n.length)return new ao(Wi(a_),t,i);const r=(await Promise.all(n.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let o=r[0]||Wi(a_);const l=gc(i,t.config.apiKey,t.name);let h=null;for(const p of n)try{const _=await p._get(l);if(_){let y;if(typeof _=="string"){const T=await Hc(t,{idToken:_}).catch(()=>{});if(!T)break;y=await ei._fromGetAccountInfoResponse(t,T,_)}else y=ei._fromJSON(t,_);p!==o&&(h=y),o=p;break}}catch{}const d=r.filter(p=>p._shouldAllowMigration);return!o._shouldAllowMigration||!d.length?new ao(o,t,i):(o=d[0],h&&await o._set(l,h.toJSON()),await Promise.all(n.map(async p=>{if(p!==o)try{await p._remove(l)}catch{}})),new ao(o,t,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l_(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(tw(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Yy(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(nw(t))return"Blackberry";if(iw(t))return"Webos";if(Xy(t))return"Safari";if((t.includes("chrome/")||Jy(t))&&!t.includes("edge/"))return"Chrome";if(ew(t))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=e.match(n);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function Yy(e=ln()){return/firefox\//i.test(e)}function Xy(e=ln()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Jy(e=ln()){return/crios\//i.test(e)}function tw(e=ln()){return/iemobile/i.test(e)}function ew(e=ln()){return/android/i.test(e)}function nw(e=ln()){return/blackberry/i.test(e)}function iw(e=ln()){return/webos/i.test(e)}function gf(e=ln()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function cS(e=ln()){var t;return gf(e)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function uS(){return u0()&&document.documentMode===10}function sw(e=ln()){return gf(e)||ew(e)||iw(e)||nw(e)||/windows phone/i.test(e)||tw(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rw(e,t=[]){let n;switch(e){case"Browser":n=l_(ln());break;case"Worker":n=`${l_(ln())}-${e}`;break;default:n=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${yr}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,n){const i=o=>new Promise((l,h)=>{try{const d=t(o);l(d)}catch(d){h(d)}});i.onAbort=n,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const n=[];try{for(const i of this.queue)await i(t),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dS(e,t={}){return Hs(e,"GET","/v2/passwordPolicy",js(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fS=6;class pS{constructor(t){var n,i,r,o;const l=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=l.minPasswordLength)!==null&&n!==void 0?n:fS,l.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=l.maxPasswordLength),l.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=l.containsLowercaseCharacter),l.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=l.containsUppercaseCharacter),l.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=l.containsNumericCharacter),l.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=l.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=t.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(o=t.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var n,i,r,o,l,h;const d={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,d),this.validatePasswordCharacterOptions(t,d),d.isValid&&(d.isValid=(n=d.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),d.isValid&&(d.isValid=(i=d.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),d.isValid&&(d.isValid=(r=d.containsLowercaseLetter)!==null&&r!==void 0?r:!0),d.isValid&&(d.isValid=(o=d.containsUppercaseLetter)!==null&&o!==void 0?o:!0),d.isValid&&(d.isValid=(l=d.containsNumericCharacter)!==null&&l!==void 0?l:!0),d.isValid&&(d.isValid=(h=d.containsNonAlphanumericCharacter)!==null&&h!==void 0?h:!0),d}validatePasswordLengthOptions(t,n){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=t.length>=i),r&&(n.meetsMaxPasswordLength=t.length<=r)}validatePasswordCharacterOptions(t,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let r=0;r<t.length;r++)i=t.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(t,n,i,r,o){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(t,n,i,r){this.app=t,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new c_(this),this.idTokenSubscription=new c_(this),this.beforeStateQueue=new hS(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=qy,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(t,n){return n&&(this._popupRedirectResolver=Wi(n)),this._initializationPromise=this.queue(async()=>{var i,r,o;if(!this._deleted&&(this.persistenceManager=await ao.create(this,t),(i=this._resolvePersistenceManagerAvailable)===null||i===void 0||i.call(this),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const n=await Hc(this,{idToken:t}),i=await ei._fromGetAccountInfoResponse(this,n,t);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var n;if(Tn(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(h,h))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let r=i,o=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,h=r==null?void 0:r._redirectEventId,d=await this.tryRedirectSignIn(t);(!l||l===h)&&(d!=null&&d.user)&&(r=d.user,o=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(r)}catch(l){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return St(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(t){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(t){try{await $c(t)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=KR()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(Tn(this.app))return Promise.reject(Zi(this));const n=t?Te(t):null;return n&&St(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(t,n=!1){if(!this._deleted)return t&&St(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return Tn(this.app)?Promise.reject(Zi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return Tn(this.app)?Promise.reject(Zi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Wi(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await dS(this),n=new pS(t);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new ol("auth","Firebase",t())}onAuthStateChanged(t,n,i){return this.registerStateListener(this.authStateSubscription,t,n,i)}beforeAuthStateChanged(t,n){return this.beforeStateQueue.pushCallback(t,n)}onIdTokenChanged(t,n,i){return this.registerStateListener(this.idTokenSubscription,t,n,i)}authStateReady(){return new Promise((t,n)=>{if(this.currentUser)t();else{const i=this.onAuthStateChanged(()=>{i(),t()},n)}})}async revokeAccessToken(t){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await lS(this,i)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,n){const i=await this.getOrInitRedirectPersistenceManager(n);return t===null?i.removeCurrentUser():i.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const n=t&&Wi(t)||this._popupRedirectResolver;St(n,this,"argument-error"),this.redirectPersistenceManager=await ao.create(this,[Wi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var n,i;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===t?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(n=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,n,i,r){if(this._deleted)return()=>{};const o=typeof n=="function"?n:n.next.bind(n);let l=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(St(h,this,"internal-error"),h.then(()=>{l||o(this.currentUser)}),typeof n=="function"){const d=t.addObserver(n,i,r);return()=>{l=!0,d()}}else{const d=t.addObserver(n);return()=>{l=!0,d()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return St(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=rw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const i=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());i&&(n["X-Firebase-Client"]=i);const r=await this._getAppCheckToken();return r&&(n["X-Firebase-AppCheck"]=r),n}async _getAppCheckToken(){var t;if(Tn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return n!=null&&n.error&&HR(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function $s(e){return Te(e)}class c_{constructor(t){this.auth=t,this.observer=null,this.addObserver=v0(n=>this.observer=n)}get next(){return St(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _S(e){Lu=e}function ow(e){return Lu.loadJS(e)}function gS(){return Lu.recaptchaEnterpriseScript}function vS(){return Lu.gapiScript}function yS(e){return`__${e}${Math.floor(Math.random()*1e6)}`}class wS{constructor(){this.enterprise=new TS}ready(t){t()}execute(t,n){return Promise.resolve("token")}render(t,n){return""}}class TS{ready(t){t()}execute(t,n){return Promise.resolve("token")}render(t,n){return""}}const ES="recaptcha-enterprise",aw="NO_RECAPTCHA";class bS{constructor(t){this.type=ES,this.auth=$s(t)}async verify(t="verify",n=!1){async function i(o){if(!n){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(l,h)=>{tS(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const p=new JR(d);return o.tenantId==null?o._agentRecaptchaConfig=p:o._tenantRecaptchaConfigs[o.tenantId]=p,l(p.siteKey)}}).catch(d=>{h(d)})})}function r(o,l,h){const d=window.grecaptcha;s_(d)?d.enterprise.ready(()=>{d.enterprise.execute(o,{action:t}).then(p=>{l(p)}).catch(()=>{l(aw)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new wS().execute("siteKey",{action:"verify"}):new Promise((o,l)=>{i(this.auth).then(h=>{if(!n&&s_(window.grecaptcha))r(h,o,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let d=gS();d.length!==0&&(d+=h),ow(d).then(()=>{r(h,o,l)}).catch(p=>{l(p)})}}).catch(h=>{l(h)})})}}async function u_(e,t,n,i=!1,r=!1){const o=new bS(e);let l;if(r)l=aw;else try{l=await o.verify(n)}catch{l=await o.verify(n,!0)}const h=Object.assign({},t);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in h){const d=h.phoneEnrollmentInfo.phoneNumber,p=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:d,recaptchaToken:p,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){const d=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return i?Object.assign(h,{captchaResp:l}):Object.assign(h,{captchaResponse:l}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function Jh(e,t,n,i,r){var o;if(!((o=e._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await u_(e,t,n,n==="getOobCode");return i(e,l)}else return i(e,t).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const h=await u_(e,t,n,n==="getOobCode");return i(e,h)}else return Promise.reject(l)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(e,t){const n=uu(e,"auth");if(n.isInitialized()){const r=n.getImmediate(),o=n.getOptions();if(dr(o,t??{}))return r;Kn(r,"already-initialized")}return n.initialize({options:t})}function PS(e,t){const n=(t==null?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Wi);t!=null&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,t==null?void 0:t.popupRedirectResolver)}function AS(e,t,n){const i=$s(e);St(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!1,o=lw(t),{host:l,port:h}=CS(t),d=h===null?"":`:${h}`,p={url:`${o}//${l}${d}/`},_=Object.freeze({host:l,port:h,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){St(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),St(dr(p,i.config.emulator)&&dr(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,RS()}function lw(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function CS(e){const t=lw(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const o=r[1];return{host:o,port:h_(i.substr(o.length+1))}}else{const[o,l]=i.split(":");return{host:o,port:h_(l)}}}function h_(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function RS(){function e(){const t=document.createElement("p"),n=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(t,n){this.providerId=t,this.signInMethod=n}toJSON(){return qi("not implemented")}_getIdTokenResponse(t){return qi("not implemented")}_linkToIdToken(t,n){return qi("not implemented")}_getReauthenticationResolver(t){return qi("not implemented")}}async function SS(e,t){return Hs(e,"POST","/v1/accounts:signUp",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xS(e,t){return ml(e,"POST","/v1/accounts:signInWithPassword",js(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kS(e,t){return ml(e,"POST","/v1/accounts:signInWithEmailLink",js(e,t))}async function LS(e,t){return ml(e,"POST","/v1/accounts:signInWithEmailLink",js(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl extends vf{constructor(t,n,i,r=null){super("password",i),this._email=t,this._password=n,this._tenantId=r}static _fromEmailAndPassword(t,n){return new tl(t,n,"password")}static _fromEmailAndCode(t,n,i=null){return new tl(t,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const n=typeof t=="string"?JSON.parse(t):t;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jh(t,n,"signInWithPassword",xS);case"emailLink":return kS(t,{email:this._email,oobCode:this._password});default:Kn(t,"internal-error")}}async _linkToIdToken(t,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jh(t,i,"signUpPassword",SS);case"emailLink":return LS(t,{idToken:n,email:this._email,oobCode:this._password});default:Kn(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lo(e,t){return ml(e,"POST","/v1/accounts:signInWithIdp",js(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MS="http://localhost";class _r extends vf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const n=new _r(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(n.idToken=t.idToken),t.accessToken&&(n.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(n.nonce=t.nonce),t.pendingToken&&(n.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(n.accessToken=t.oauthToken,n.secret=t.oauthTokenSecret):Kn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const n=typeof t=="string"?JSON.parse(t):t,{providerId:i,signInMethod:r}=n,o=df(n,["providerId","signInMethod"]);if(!i||!r)return null;const l=new _r(i,r);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(t){const n=this.buildRequest();return lo(t,n)}_linkToIdToken(t,n){const i=this.buildRequest();return i.idToken=n,lo(t,i)}_getReauthenticationResolver(t){const n=this.buildRequest();return n.autoCreate=!1,lo(t,n)}buildRequest(){const t={requestUri:MS,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),t.postBody=al(n)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function DS(e){const t=fa(pa(e)).link,n=t?fa(pa(t)).deep_link_id:null,i=fa(pa(e)).deep_link_id;return(i?fa(pa(i)).link:null)||i||n||t||e}class yf{constructor(t){var n,i,r,o,l,h;const d=fa(pa(t)),p=(n=d.apiKey)!==null&&n!==void 0?n:null,_=(i=d.oobCode)!==null&&i!==void 0?i:null,y=OS((r=d.mode)!==null&&r!==void 0?r:null);St(p&&_&&y,"argument-error"),this.apiKey=p,this.operation=y,this.code=_,this.continueUrl=(o=d.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(l=d.languageCode)!==null&&l!==void 0?l:null,this.tenantId=(h=d.tenantId)!==null&&h!==void 0?h:null}static parseLink(t){const n=DS(t);try{return new yf(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(){this.providerId=ko.PROVIDER_ID}static credential(t,n){return tl._fromEmailAndPassword(t,n)}static credentialWithLink(t,n){const i=yf.parseLink(n);return St(i,"argument-error"),tl._fromEmailAndCode(t,i.code,i.tenantId)}}ko.PROVIDER_ID="password";ko.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ko.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l extends wf{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs extends _l{constructor(){super("facebook.com")}static credential(t){return _r._fromParams({providerId:vs.PROVIDER_ID,signInMethod:vs.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return vs.credentialFromTaggedObject(t)}static credentialFromError(t){return vs.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return vs.credential(t.oauthAccessToken)}catch{return null}}}vs.FACEBOOK_SIGN_IN_METHOD="facebook.com";vs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i extends _l{constructor(){super("google.com"),this.addScope("profile")}static credential(t,n){return _r._fromParams({providerId:$i.PROVIDER_ID,signInMethod:$i.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})}static credentialFromResult(t){return $i.credentialFromTaggedObject(t)}static credentialFromError(t){return $i.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return $i.credential(n,i)}catch{return null}}}$i.GOOGLE_SIGN_IN_METHOD="google.com";$i.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys extends _l{constructor(){super("github.com")}static credential(t){return _r._fromParams({providerId:ys.PROVIDER_ID,signInMethod:ys.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return ys.credentialFromTaggedObject(t)}static credentialFromError(t){return ys.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return ys.credential(t.oauthAccessToken)}catch{return null}}}ys.GITHUB_SIGN_IN_METHOD="github.com";ys.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws extends _l{constructor(){super("twitter.com")}static credential(t,n){return _r._fromParams({providerId:ws.PROVIDER_ID,signInMethod:ws.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:n})}static credentialFromResult(t){return ws.credentialFromTaggedObject(t)}static credentialFromError(t){return ws.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=t;if(!n||!i)return null;try{return ws.credential(n,i)}catch{return null}}}ws.TWITTER_SIGN_IN_METHOD="twitter.com";ws.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NS(e,t){return ml(e,"POST","/v1/accounts:signUp",js(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,n,i,r=!1){const o=await ei._fromIdTokenResponse(t,i,r),l=d_(i);return new gr({user:o,providerId:l,_tokenResponse:i,operationType:n})}static async _forOperation(t,n,i){await t._updateTokensIfNecessary(i,!0);const r=d_(i);return new gr({user:t,providerId:r,_tokenResponse:i,operationType:n})}}function d_(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc extends Ai{constructor(t,n,i,r){var o;super(n.code,n.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,qc.prototype),this.customData={appName:t.name,tenantId:(o=t.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(t,n,i,r){return new qc(t,n,i,r)}}function cw(e,t,n,i){return(t==="reauthenticate"?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?qc._fromErrorAndOperation(e,o,t,i):o})}async function VS(e,t,n=!1){const i=await Ja(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return gr._forOperation(e,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function US(e,t,n=!1){const{auth:i}=e;if(Tn(i.app))return Promise.reject(Zi(i));const r="reauthenticate";try{const o=await Ja(e,cw(i,r,t,e),n);St(o.idToken,i,"internal-error");const l=_f(o.idToken);St(l,i,"internal-error");const{sub:h}=l;return St(e.uid===h,i,"user-mismatch"),gr._forOperation(e,r,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&Kn(i,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uw(e,t,n=!1){if(Tn(e.app))return Promise.reject(Zi(e));const i="signIn",r=await cw(e,i,t),o=await gr._fromIdTokenResponse(e,i,r);return n||await e._updateCurrentUser(o.user),o}async function FS(e,t){return uw($s(e),t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hw(e){const t=$s(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function BS(e,t,n){if(Tn(e.app))return Promise.reject(Zi(e));const i=$s(e),l=await Jh(i,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",NS).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&hw(e),d}),h=await gr._fromIdTokenResponse(i,"signIn",l);return await i._updateCurrentUser(h.user),h}function zS(e,t,n){return Tn(e.app)?Promise.reject(Zi(e)):FS(Te(e),ko.credential(t,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&hw(e),i})}function jS(e,t,n,i){return Te(e).onIdTokenChanged(t,n,i)}function HS(e,t,n){return Te(e).beforeAuthStateChanged(t,n)}function $S(e,t,n,i){return Te(e).onAuthStateChanged(t,n,i)}function qS(e){return Te(e).signOut()}const Wc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw{constructor(t,n){this.storageRetriever=t,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Wc,"1"),this.storage.removeItem(Wc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,n){return this.storage.setItem(t,JSON.stringify(n)),Promise.resolve()}_get(t){const n=this.storage.getItem(t);return Promise.resolve(n?JSON.parse(n):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WS=1e3,KS=10;class fw extends dw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,n)=>this.onStorageEvent(t,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=sw(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),r=this.localCache[n];i!==r&&t(n,r,i)}}onStorageEvent(t,n=!1){if(!t.key){this.forAllChangedKeys((l,h,d)=>{this.notifyListeners(l,d)});return}const i=t.key;n?this.detachListener():this.stopPolling();const r=()=>{const l=this.storage.getItem(i);!n&&this.localCache[i]===l||this.notifyListeners(i,l)},o=this.storage.getItem(i);uS()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(r,KS):r()}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const r of Array.from(i))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:i}),!0)})},WS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,n){await super._set(t,n),this.localCache[t]=JSON.stringify(n)}async _get(t){const n=await super._get(t);return this.localCache[t]=JSON.stringify(n),n}async _remove(t){await super._remove(t),delete this.localCache[t]}}fw.type="LOCAL";const GS=fw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw extends dw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,n){}_removeListener(t,n){}}pw.type="SESSION";const mw=pw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZS(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const n=this.receivers.find(r=>r.isListeningto(t));if(n)return n;const i=new Mu(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const n=t,{eventId:i,eventType:r,data:o}=n.data,l=this.handlersMap[r];if(!(l!=null&&l.size))return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const h=Array.from(l).map(async p=>p(n.origin,o)),d=await ZS(h);n.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:d})}_subscribe(t,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(n)}_unsubscribe(t,n){this.handlersMap[t]&&n&&this.handlersMap[t].delete(n),(!n||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Mu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tf(e="",t=10){let n="";for(let i=0;i<t;i++)n+=Math.floor(Math.random()*10);return e+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,n,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let o,l;return new Promise((h,d)=>{const p=Tf("",20);r.port1.start();const _=setTimeout(()=>{d(new Error("unsupported_event"))},i);l={messageChannel:r,onMessage(y){const T=y;if(T.data.eventId===p)switch(T.data.status){case"ack":clearTimeout(_),o=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),h(T.data.response);break;default:clearTimeout(_),clearTimeout(o),d(new Error("invalid_response"));break}}},this.handlers.add(l),r.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:t,eventId:p,data:n},[r.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ei(){return window}function YS(e){Ei().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _w(){return typeof Ei().WorkerGlobalScope<"u"&&typeof Ei().importScripts=="function"}async function XS(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function JS(){var e;return((e=navigator==null?void 0:navigator.serviceWorker)===null||e===void 0?void 0:e.controller)||null}function tx(){return _w()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gw="firebaseLocalStorageDb",ex=1,Kc="firebaseLocalStorage",vw="fbase_key";class gl{constructor(t){this.request=t}toPromise(){return new Promise((t,n)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Ou(e,t){return e.transaction([Kc],t?"readwrite":"readonly").objectStore(Kc)}function nx(){const e=indexedDB.deleteDatabase(gw);return new gl(e).toPromise()}function td(){const e=indexedDB.open(gw,ex);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const i=e.result;try{i.createObjectStore(Kc,{keyPath:vw})}catch(r){n(r)}}),e.addEventListener("success",async()=>{const i=e.result;i.objectStoreNames.contains(Kc)?t(i):(i.close(),await nx(),t(await td()))})})}async function f_(e,t,n){const i=Ou(e,!0).put({[vw]:t,value:n});return new gl(i).toPromise()}async function ix(e,t){const n=Ou(e,!1).get(t),i=await new gl(n).toPromise();return i===void 0?null:i.value}function p_(e,t){const n=Ou(e,!0).delete(t);return new gl(n).toPromise()}const sx=800,rx=3;class yw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await td(),this.db)}async _withRetries(t){let n=0;for(;;)try{const i=await this._openDb();return await t(i)}catch(i){if(n++>rx)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _w()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Mu._getInstance(tx()),this.receiver._subscribe("keyChanged",async(t,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(t,n)=>["keyChanged"])}async initializeSender(){var t,n;if(this.activeServiceWorker=await XS(),!this.activeServiceWorker)return;this.sender=new QS(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((n=i[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||JS()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await td();return await f_(t,Wc,"1"),await p_(t,Wc),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>f_(i,t,n)),this.localCache[t]=n,this.notifyServiceWorker(t)))}async _get(t){const n=await this._withRetries(i=>ix(i,t));return this.localCache[t]=n,n}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(n=>p_(n,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(r=>{const o=Ou(r,!1).getAll();return new gl(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(t.length!==0)for(const{fbase_key:r,value:o}of t)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(o)&&(this.notifyListeners(r,o),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const r of Array.from(i))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),sx)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}yw.type="LOCAL";const ox=yw;new pl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ww(e,t){return t?Wi(t):(St(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef extends vf{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return lo(t,this._buildIdpRequest())}_linkToIdToken(t,n){return lo(t,this._buildIdpRequest(n))}_getReauthenticationResolver(t){return lo(t,this._buildIdpRequest())}_buildIdpRequest(t){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(n.idToken=t),n}}function ax(e){return uw(e.auth,new Ef(e),e.bypassAuthState)}function lx(e){const{auth:t,user:n}=e;return St(n,t,"internal-error"),US(n,new Ef(e),e.bypassAuthState)}async function cx(e){const{auth:t,user:n}=e;return St(n,t,"internal-error"),VS(n,new Ef(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tw{constructor(t,n,i,r,o=!1){this.auth=t,this.resolver=i,this.user=r,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(t,n)=>{this.pendingPromise={resolve:t,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(t){const{urlResponse:n,sessionId:i,postBody:r,tenantId:o,error:l,type:h}=t;if(l){this.reject(l);return}const d={auth:this.auth,requestUri:n,sessionId:i,tenantId:o||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(d))}catch(p){this.reject(p)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return ax;case"linkViaPopup":case"linkViaRedirect":return cx;case"reauthViaPopup":case"reauthViaRedirect":return lx;default:Kn(this.auth,"internal-error")}}resolve(t){es(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){es(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ux=new pl(2e3,1e4);async function hx(e,t,n){if(Tn(e.app))return Promise.reject(ii(e,"operation-not-supported-in-this-environment"));const i=$s(e);$R(e,t,wf);const r=ww(i,n);return new or(i,"signInViaPopup",t,r).executeNotNull()}class or extends Tw{constructor(t,n,i,r,o){super(t,n,r,o),this.provider=i,this.authWindow=null,this.pollId=null,or.currentPopupAction&&or.currentPopupAction.cancel(),or.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return St(t,this.auth,"internal-error"),t}async onExecution(){es(this.filter.length===1,"Popup operations only handle one event");const t=Tf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(ii(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(ii(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,or.currentPopupAction=null}pollUserCancellation(){const t=()=>{var n,i;if(!((i=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ii(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,ux.get())};t()}}or.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dx="pendingRedirect",vc=new Map;class fx extends Tw{constructor(t,n,i=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let t=vc.get(this.auth._key());if(!t){try{const i=await px(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(i)}catch(n){t=()=>Promise.reject(n)}vc.set(this.auth._key(),t)}return this.bypassAuthState||vc.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const n=await this.auth._redirectUserForId(t.eventId);if(n)return this.user=n,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function px(e,t){const n=gx(t),i=_x(e);if(!await i._isAvailable())return!1;const r=await i._get(n)==="true";return await i._remove(n),r}function mx(e,t){vc.set(e._key(),t)}function _x(e){return Wi(e._redirectPersistence)}function gx(e){return gc(dx,e.config.apiKey,e.name)}async function vx(e,t,n=!1){if(Tn(e.app))return Promise.reject(Zi(e));const i=$s(e),r=ww(i,t),l=await new fx(i,r,n).execute();return l&&!n&&(delete l.user._redirectEventId,await i._persistUserIfCurrent(l.user),await i._setRedirectUser(null,t)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yx=10*60*1e3;class wx{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(t,i)&&(n=!0,this.sendToConsumer(t,i),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!Tx(t)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=t,n=!0)),n}sendToConsumer(t,n){var i;if(t.error&&!Ew(t)){const r=((i=t.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";n.onError(ii(this.auth,r))}else n.onAuthEvent(t)}isEventForConsumer(t,n){const i=n.eventId===null||!!t.eventId&&t.eventId===n.eventId;return n.filter.includes(t.type)&&i}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=yx&&this.cachedEventUids.clear(),this.cachedEventUids.has(m_(t))}saveEventToCache(t){this.cachedEventUids.add(m_(t)),this.lastProcessedEventTime=Date.now()}}function m_(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function Ew({type:e,error:t}){return e==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function Tx(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ew(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ex(e,t={}){return Hs(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ix=/^https?/;async function Px(e){if(e.config.emulator)return;const{authorizedDomains:t}=await Ex(e);for(const n of t)try{if(Ax(n))return}catch{}Kn(e,"unauthorized-domain")}function Ax(e){const t=Yh(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const l=new URL(e);return l.hostname===""&&i===""?n==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):n==="chrome-extension:"&&l.hostname===i}if(!Ix.test(n))return!1;if(bx.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx=new pl(3e4,6e4);function __(){const e=Ei().___jsl;if(e!=null&&e.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}}function Rx(e){return new Promise((t,n)=>{var i,r,o;function l(){__(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{__(),n(ii(e,"network-request-failed"))},timeout:Cx.get()})}if(!((r=(i=Ei().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)t(gapi.iframes.getContext());else if(!((o=Ei().gapi)===null||o===void 0)&&o.load)l();else{const h=yS("iframefcb");return Ei()[h]=()=>{gapi.load?l():n(ii(e,"network-request-failed"))},ow(`${vS()}?onload=${h}`).catch(d=>n(d))}}).catch(t=>{throw yc=null,t})}let yc=null;function Sx(e){return yc=yc||Rx(e),yc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xx=new pl(5e3,15e3),kx="__/auth/iframe",Lx="emulator/auth/iframe",Mx={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ox=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Dx(e){const t=e.config;St(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?mf(t,Lx):`https://${e.config.authDomain}/${kx}`,i={apiKey:t.apiKey,appName:e.name,v:yr},r=Ox.get(e.config.apiHost);r&&(i.eid=r);const o=e._getFrameworks();return o.length&&(i.fw=o.join(",")),`${n}?${al(i).slice(1)}`}async function Nx(e){const t=await Sx(e),n=Ei().gapi;return St(n,e,"internal-error"),t.open({where:document.body,url:Dx(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Mx,dontclear:!0},i=>new Promise(async(r,o)=>{await i.restyle({setHideOnLeave:!1});const l=ii(e,"network-request-failed"),h=Ei().setTimeout(()=>{o(l)},xx.get());function d(){Ei().clearTimeout(h),r(i)}i.ping(d).then(d,()=>{o(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Ux=500,Fx=600,Bx="_blank",zx="http://localhost";class g_{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function jx(e,t,n,i=Ux,r=Fx){const o=Math.max((window.screen.availHeight-r)/2,0).toString(),l=Math.max((window.screen.availWidth-i)/2,0).toString();let h="";const d=Object.assign(Object.assign({},Vx),{width:i.toString(),height:r.toString(),top:o,left:l}),p=ln().toLowerCase();n&&(h=Jy(p)?Bx:n),Yy(p)&&(t=t||zx,d.scrollbars="yes");const _=Object.entries(d).reduce((T,[I,U])=>`${T}${I}=${U},`,"");if(cS(p)&&h!=="_self")return Hx(t||"",h),new g_(null);const y=window.open(t||"",h,_);St(y,e,"popup-blocked");try{y.focus()}catch{}return new g_(y)}function Hx(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $x="__/auth/handler",qx="emulator/auth/handler",Wx=encodeURIComponent("fac");async function v_(e,t,n,i,r,o){St(e.config.authDomain,e,"auth-domain-config-required"),St(e.config.apiKey,e,"invalid-api-key");const l={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:yr,eventId:r};if(t instanceof wf){t.setDefaultLanguage(e.languageCode),l.providerId=t.providerId||"",g0(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters()));for(const[_,y]of Object.entries({}))l[_]=y}if(t instanceof _l){const _=t.getScopes().filter(y=>y!=="");_.length>0&&(l.scopes=_.join(","))}e.tenantId&&(l.tid=e.tenantId);const h=l;for(const _ of Object.keys(h))h[_]===void 0&&delete h[_];const d=await e._getAppCheckToken(),p=d?`#${Wx}=${encodeURIComponent(d)}`:"";return`${Kx(e)}?${al(h).slice(1)}${p}`}function Kx({config:e}){return e.emulator?mf(e,qx):`https://${e.authDomain}/${$x}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hh="webStorageSupport";class Gx{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=mw,this._completeRedirectFn=vx,this._overrideRedirectResult=mx}async _openPopup(t,n,i,r){var o;es((o=this.eventManagers[t._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const l=await v_(t,n,i,Yh(),r);return jx(t,l,Tf())}async _openRedirect(t,n,i,r){await this._originValidation(t);const o=await v_(t,n,i,Yh(),r);return YS(o),new Promise(()=>{})}_initialize(t){const n=t._key();if(this.eventManagers[n]){const{manager:r,promise:o}=this.eventManagers[n];return r?Promise.resolve(r):(es(o,"If manager is not set, promise should be"),o)}const i=this.initAndGetManager(t);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(t){const n=await Nx(t),i=new wx(t);return n.register("authEvent",r=>(St(r==null?void 0:r.authEvent,t,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:i},this.iframes[t._key()]=n,i}_isIframeWebStorageSupported(t,n){this.iframes[t._key()].send(hh,{type:hh},r=>{var o;const l=(o=r==null?void 0:r[0])===null||o===void 0?void 0:o[hh];l!==void 0&&n(!!l),Kn(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const n=t._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Px(t)),this.originValidationPromises[n]}get _shouldInitProactively(){return sw()||Xy()||gf()}}const Zx=Gx;var y_="@firebase/auth",w_="1.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const n=this.auth.onIdTokenChanged(i=>{t((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,n),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const n=this.internalListeners.get(t);n&&(this.internalListeners.delete(t),n(),this.updateProactiveRefresh())}assertAuthConfigured(){St(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yx(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Xx(e){fr(new Ss("auth",(t,{options:n})=>{const i=t.getProvider("app").getImmediate(),r=t.getProvider("heartbeat"),o=t.getProvider("app-check-internal"),{apiKey:l,authDomain:h}=i.options;St(l&&!l.includes(":"),"invalid-api-key",{appName:i.name});const d={apiKey:l,authDomain:h,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:rw(e)},p=new mS(i,r,o,d);return PS(p,n),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,n,i)=>{t.getProvider("auth-internal").initialize()})),fr(new Ss("auth-internal",t=>{const n=$s(t.getProvider("auth").getImmediate());return(i=>new Qx(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),yi(y_,w_,Yx(e)),yi(y_,w_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jx=5*60,tk=sv("authIdTokenMaxAge")||Jx;let T_=null;const ek=e=>async t=>{const n=t&&await t.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>tk)return;const r=n==null?void 0:n.token;T_!==r&&(T_=r,await fetch(e,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function bw(e=Ad()){const t=uu(e,"auth");if(t.isInitialized())return t.getImmediate();const n=IS(e,{popupRedirectResolver:Zx,persistence:[ox,GS,mw]}),i=sv("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(i,location.origin);if(location.origin===o.origin){const l=ek(o.toString());HS(n,l,()=>l(n.currentUser)),jS(n,h=>l(h))}}const r=ev("auth");return r&&AS(n,`http://${r}`),n}function nk(){var e,t;return(t=(e=document.getElementsByTagName("head"))===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:document}_S({loadJS(e){return new Promise((t,n)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=r=>{const o=ii("internal-error");o.customData=r,n(o)},i.type="text/javascript",i.charset="UTF-8",nk().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Xx("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iw="firebasestorage.googleapis.com",Pw="storageBucket",ik=2*60*1e3,sk=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re extends Ai{constructor(t,n,i=0){super(dh(t),`Firebase Storage: ${n} (${dh(t)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Re.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return dh(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ce;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ce||(Ce={}));function dh(e){return"storage/"+e}function bf(){const e="An unknown error occurred, please check the error payload for server response.";return new Re(Ce.UNKNOWN,e)}function rk(e){return new Re(Ce.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")}function ok(e){return new Re(Ce.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function ak(){const e="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Re(Ce.UNAUTHENTICATED,e)}function lk(){return new Re(Ce.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function ck(e){return new Re(Ce.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function uk(){return new Re(Ce.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function hk(){return new Re(Ce.CANCELED,"User canceled the upload/download.")}function dk(e){return new Re(Ce.INVALID_URL,"Invalid URL '"+e+"'.")}function fk(e){return new Re(Ce.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function pk(){return new Re(Ce.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Pw+"' property when initializing the app?")}function mk(){return new Re(Ce.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function _k(){return new Re(Ce.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function gk(e){return new Re(Ce.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ed(e){return new Re(Ce.INVALID_ARGUMENT,e)}function Aw(){return new Re(Ce.APP_DELETED,"The Firebase app was deleted.")}function vk(e){return new Re(Ce.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Na(e,t){return new Re(Ce.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function ha(e){throw new Re(Ce.INTERNAL_ERROR,"Internal error: "+e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(t,n){this.bucket=t,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,n){let i;try{i=On.makeFromUrl(t,n)}catch{return new On(t,"")}if(i.path==="")return i;throw fk(t)}static makeFromUrl(t,n){let i=null;const r="([A-Za-z0-9.\\-_]+)";function o(tt){tt.path.charAt(tt.path.length-1)==="/"&&(tt.path_=tt.path_.slice(0,-1))}const l="(/(.*))?$",h=new RegExp("^gs://"+r+l,"i"),d={bucket:1,path:3};function p(tt){tt.path_=decodeURIComponent(tt.path)}const _="v[A-Za-z0-9_]+",y=n.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",I=new RegExp(`^https?://${y}/${_}/b/${r}/o${T}`,"i"),U={bucket:1,path:3},B=n===Iw?"(?:storage.googleapis.com|storage.cloud.google.com)":n,j="([^?#]*)",et=new RegExp(`^https?://${B}/${r}/${j}`,"i"),Q=[{regex:h,indices:d,postModify:o},{regex:I,indices:U,postModify:p},{regex:et,indices:{bucket:1,path:2},postModify:p}];for(let tt=0;tt<Q.length;tt++){const Et=Q[tt],kt=Et.regex.exec(t);if(kt){const k=kt[Et.indices.bucket];let P=kt[Et.indices.path];P||(P=""),i=new On(k,P),Et.postModify(i);break}}if(i==null)throw dk(t);return i}}class yk{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wk(e,t,n){let i=1,r=null,o=null,l=!1,h=0;function d(){return h===2}let p=!1;function _(...j){p||(p=!0,t.apply(null,j))}function y(j){r=setTimeout(()=>{r=null,e(I,d())},j)}function T(){o&&clearTimeout(o)}function I(j,...et){if(p){T();return}if(j){T(),_.call(null,j,...et);return}if(d()||l){T(),_.call(null,j,...et);return}i<64&&(i*=2);let Q;h===1?(h=2,Q=0):Q=(i+Math.random())*1e3,y(Q)}let U=!1;function B(j){U||(U=!0,T(),!p&&(r!==null?(j||(h=2),clearTimeout(r),y(0)):j||(h=1)))}return y(0),o=setTimeout(()=>{l=!0,B(!0)},n),B}function Tk(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ek(e){return e!==void 0}function bk(e){return typeof e=="object"&&!Array.isArray(e)}function If(e){return typeof e=="string"||e instanceof String}function E_(e){return Pf()&&e instanceof Blob}function Pf(){return typeof Blob<"u"}function b_(e,t,n,i){if(i<t)throw ed(`Invalid value for '${e}'. Expected ${t} or greater.`);if(i>n)throw ed(`Invalid value for '${e}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Du(e,t,n){let i=t;return n==null&&(i=`https://${t}`),`${n}://${i}/v0${e}`}function Cw(e){const t=encodeURIComponent;let n="?";for(const i in e)if(e.hasOwnProperty(i)){const r=t(i)+"="+t(e[i]);n=n+r+"&"}return n=n.slice(0,-1),n}var lr;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(lr||(lr={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ik(e,t){const n=e>=500&&e<600,r=[408,429].indexOf(e)!==-1,o=t.indexOf(e)!==-1;return n||r||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(t,n,i,r,o,l,h,d,p,_,y,T=!0){this.url_=t,this.method_=n,this.headers_=i,this.body_=r,this.successCodes_=o,this.additionalRetryCodes_=l,this.callback_=h,this.errorCallback_=d,this.timeout_=p,this.progressCallback_=_,this.connectionFactory_=y,this.retry=T,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((I,U)=>{this.resolve_=I,this.reject_=U,this.start_()})}start_(){const t=(i,r)=>{if(r){i(!1,new ic(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const l=h=>{const d=h.loaded,p=h.lengthComputable?h.total:-1;this.progressCallback_!==null&&this.progressCallback_(d,p)};this.progressCallback_!==null&&o.addUploadProgressListener(l),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(l),this.pendingConnection_=null;const h=o.getErrorCode()===lr.NO_ERROR,d=o.getStatus();if(!h||Ik(d,this.additionalRetryCodes_)&&this.retry){const _=o.getErrorCode()===lr.ABORT;i(!1,new ic(!1,null,_));return}const p=this.successCodes_.indexOf(d)!==-1;i(!0,new ic(p,o))})},n=(i,r)=>{const o=this.resolve_,l=this.reject_,h=r.connection;if(r.wasSuccessCode)try{const d=this.callback_(h,h.getResponse());Ek(d)?o(d):o()}catch(d){l(d)}else if(h!==null){const d=bf();d.serverResponse=h.getErrorText(),this.errorCallback_?l(this.errorCallback_(h,d)):l(d)}else if(r.canceled){const d=this.appDelete_?Aw():hk();l(d)}else{const d=uk();l(d)}};this.canceled_?n(!1,new ic(!1,null,!0)):this.backoffId_=wk(t,n,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&Tk(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ic{constructor(t,n,i){this.wasSuccessCode=t,this.connection=n,this.canceled=!!i}}function Ak(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function Ck(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function Rk(e,t){t&&(e["X-Firebase-GMPID"]=t)}function Sk(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function xk(e,t,n,i,r,o,l=!0){const h=Cw(e.urlParams),d=e.url+h,p=Object.assign({},e.headers);return Rk(p,t),Ak(p,n),Ck(p,o),Sk(p,i),new Pk(d,e.method,p,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,r,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kk(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Lk(...e){const t=kk();if(t!==void 0){const n=new t;for(let i=0;i<e.length;i++)n.append(e[i]);return n.getBlob()}else{if(Pf())return new Blob(e);throw new Re(Ce.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Mk(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ok(e){if(typeof atob>"u")throw gk("base-64");return atob(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _i={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class fh{constructor(t,n){this.data=t,this.contentType=n||null}}function Dk(e,t){switch(e){case _i.RAW:return new fh(Rw(t));case _i.BASE64:case _i.BASE64URL:return new fh(Sw(e,t));case _i.DATA_URL:return new fh(Vk(t),Uk(t))}throw bf()}function Rw(e){const t=[];for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);if(i<=127)t.push(i);else if(i<=2047)t.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(n<e.length-1&&(e.charCodeAt(n+1)&64512)===56320))t.push(239,191,189);else{const o=i,l=e.charCodeAt(++n);i=65536|(o&1023)<<10|l&1023,t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?t.push(239,191,189):t.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(t)}function Nk(e){let t;try{t=decodeURIComponent(e)}catch{throw Na(_i.DATA_URL,"Malformed data URL.")}return Rw(t)}function Sw(e,t){switch(e){case _i.BASE64:{const r=t.indexOf("-")!==-1,o=t.indexOf("_")!==-1;if(r||o)throw Na(e,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case _i.BASE64URL:{const r=t.indexOf("+")!==-1,o=t.indexOf("/")!==-1;if(r||o)throw Na(e,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=Ok(t)}catch(r){throw r.message.includes("polyfill")?r:Na(e,"Invalid character found")}const i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}class xw{constructor(t){this.base64=!1,this.contentType=null;const n=t.match(/^data:([^,]+)?,/);if(n===null)throw Na(_i.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=n[1]||null;i!=null&&(this.base64=Fk(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=t.substring(t.indexOf(",")+1)}}function Vk(e){const t=new xw(e);return t.base64?Sw(_i.BASE64,t.rest):Nk(t.rest)}function Uk(e){return new xw(e).contentType}function Fk(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(t,n){let i=0,r="";E_(t)?(this.data_=t,i=t.size,r=t.type):t instanceof ArrayBuffer?(n?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),i=this.data_.length):t instanceof Uint8Array&&(n?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),i=t.length),this.size_=i,this.type_=r}size(){return this.size_}type(){return this.type_}slice(t,n){if(E_(this.data_)){const i=this.data_,r=Mk(i,t,n);return r===null?null:new Ts(r)}else{const i=new Uint8Array(this.data_.buffer,t,n-t);return new Ts(i,!0)}}static getBlob(...t){if(Pf()){const n=t.map(i=>i instanceof Ts?i.data_:i);return new Ts(Lk.apply(null,n))}else{const n=t.map(l=>If(l)?Dk(_i.RAW,l).data:l.data_);let i=0;n.forEach(l=>{i+=l.byteLength});const r=new Uint8Array(i);let o=0;return n.forEach(l=>{for(let h=0;h<l.length;h++)r[o++]=l[h]}),new Ts(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kw(e){let t;try{t=JSON.parse(e)}catch{return null}return bk(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bk(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function zk(e,t){const n=t.split("/").filter(i=>i.length>0).join("/");return e.length===0?n:e+"/"+n}function Lw(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jk(e,t){return t}class dn{constructor(t,n,i,r){this.server=t,this.local=n||t,this.writable=!!i,this.xform=r||jk}}let sc=null;function Hk(e){return!If(e)||e.length<2?e:Lw(e)}function Mw(){if(sc)return sc;const e=[];e.push(new dn("bucket")),e.push(new dn("generation")),e.push(new dn("metageneration")),e.push(new dn("name","fullPath",!0));function t(o,l){return Hk(l)}const n=new dn("name");n.xform=t,e.push(n);function i(o,l){return l!==void 0?Number(l):l}const r=new dn("size");return r.xform=i,e.push(r),e.push(new dn("timeCreated")),e.push(new dn("updated")),e.push(new dn("md5Hash",null,!0)),e.push(new dn("cacheControl",null,!0)),e.push(new dn("contentDisposition",null,!0)),e.push(new dn("contentEncoding",null,!0)),e.push(new dn("contentLanguage",null,!0)),e.push(new dn("contentType",null,!0)),e.push(new dn("metadata","customMetadata",!0)),sc=e,sc}function $k(e,t){function n(){const i=e.bucket,r=e.fullPath,o=new On(i,r);return t._makeStorageReference(o)}Object.defineProperty(e,"ref",{get:n})}function qk(e,t,n){const i={};i.type="file";const r=n.length;for(let o=0;o<r;o++){const l=n[o];i[l.local]=l.xform(i,t[l.server])}return $k(i,e),i}function Ow(e,t,n){const i=kw(t);return i===null?null:qk(e,i,n)}function Wk(e,t,n,i){const r=kw(t);if(r===null||!If(r.downloadTokens))return null;const o=r.downloadTokens;if(o.length===0)return null;const l=encodeURIComponent;return o.split(",").map(p=>{const _=e.bucket,y=e.fullPath,T="/b/"+l(_)+"/o/"+l(y),I=Du(T,n,i),U=Cw({alt:"media",token:p});return I+U})[0]}function Kk(e,t){const n={},i=t.length;for(let r=0;r<i;r++){const o=t[r];o.writable&&(n[o.server]=e[o.local])}return JSON.stringify(n)}class Af{constructor(t,n,i,r){this.url=t,this.method=n,this.handler=i,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dw(e){if(!e)throw bf()}function Gk(e,t){function n(i,r){const o=Ow(e,r,t);return Dw(o!==null),o}return n}function Zk(e,t){function n(i,r){const o=Ow(e,r,t);return Dw(o!==null),Wk(o,r,e.host,e._protocol)}return n}function Nw(e){function t(n,i){let r;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?r=lk():r=ak():n.getStatus()===402?r=ok(e.bucket):n.getStatus()===403?r=ck(e.path):r=i,r.status=n.getStatus(),r.serverResponse=i.serverResponse,r}return t}function Vw(e){const t=Nw(e);function n(i,r){let o=t(i,r);return i.getStatus()===404&&(o=rk(e.path)),o.serverResponse=r.serverResponse,o}return n}function Qk(e,t,n){const i=t.fullServerUrl(),r=Du(i,e.host,e._protocol),o="GET",l=e.maxOperationRetryTime,h=new Af(r,o,Zk(e,n),l);return h.errorHandler=Vw(t),h}function Yk(e,t){const n=t.fullServerUrl(),i=Du(n,e.host,e._protocol),r="DELETE",o=e.maxOperationRetryTime;function l(d,p){}const h=new Af(i,r,l,o);return h.successCodes=[200,204],h.errorHandler=Vw(t),h}function Xk(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function Jk(e,t,n){const i=Object.assign({},n);return i.fullPath=e.path,i.size=t.size(),i.contentType||(i.contentType=Xk(null,t)),i}function t1(e,t,n,i,r){const o=t.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function h(){let Q="";for(let tt=0;tt<2;tt++)Q=Q+Math.random().toString().slice(2);return Q}const d=h();l["Content-Type"]="multipart/related; boundary="+d;const p=Jk(t,i,r),_=Kk(p,n),y="--"+d+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+_+`\r
--`+d+`\r
Content-Type: `+p.contentType+`\r
\r
`,T=`\r
--`+d+"--",I=Ts.getBlob(y,i,T);if(I===null)throw mk();const U={name:p.fullPath},B=Du(o,e.host,e._protocol),j="POST",et=e.maxUploadRetryTime,X=new Af(B,j,Gk(e,n),et);return X.urlParams=U,X.headers=l,X.body=I.uploadData(),X.errorHandler=Nw(t),X}class e1{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=lr.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=lr.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=lr.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,n,i,r){if(this.sent_)throw ha("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,t,!0),r!==void 0)for(const o in r)r.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,r[o].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ha("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ha("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ha("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ha("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class n1 extends e1{initXhr(){this.xhr_.responseType="text"}}function Cf(){return new n1}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(t,n){this._service=t,n instanceof On?this._location=n:this._location=On.makeFromUrl(n,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,n){return new vr(t,n)}get root(){const t=new On(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Lw(this._location.path)}get storage(){return this._service}get parent(){const t=Bk(this._location.path);if(t===null)return null;const n=new On(this._location.bucket,t);return new vr(this._service,n)}_throwIfRoot(t){if(this._location.path==="")throw vk(t)}}function i1(e,t,n){e._throwIfRoot("uploadBytes");const i=t1(e.storage,e._location,Mw(),new Ts(t,!0),n);return e.storage.makeRequestWithTokens(i,Cf).then(r=>({metadata:r,ref:e}))}function s1(e){e._throwIfRoot("getDownloadURL");const t=Qk(e.storage,e._location,Mw());return e.storage.makeRequestWithTokens(t,Cf).then(n=>{if(n===null)throw _k();return n})}function r1(e){e._throwIfRoot("deleteObject");const t=Yk(e.storage,e._location);return e.storage.makeRequestWithTokens(t,Cf)}function o1(e,t){const n=zk(e._location.path,t),i=new On(e._location.bucket,n);return new vr(e.storage,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a1(e){return/^[A-Za-z]+:\/\//.test(e)}function l1(e,t){return new vr(e,t)}function Uw(e,t){if(e instanceof Rf){const n=e;if(n._bucket==null)throw pk();const i=new vr(n,n._bucket);return t!=null?Uw(i,t):i}else return t!==void 0?o1(e,t):e}function c1(e,t){if(t&&a1(t)){if(e instanceof Rf)return l1(e,t);throw ed("To use ref(service, url), the first argument must be a Storage instance.")}else return Uw(e,t)}function I_(e,t){const n=t==null?void 0:t[Pw];return n==null?null:On.makeFromBucketSpec(n,e)}function u1(e,t,n,i={}){e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:r}=i;r&&(e._overrideAuthToken=typeof r=="string"?r:rv(r,e.app.options.projectId))}class Rf{constructor(t,n,i,r,o){this.app=t,this._authProvider=n,this._appCheckProvider=i,this._url=r,this._firebaseVersion=o,this._bucket=null,this._host=Iw,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=ik,this._maxUploadRetryTime=sk,this._requests=new Set,r!=null?this._bucket=On.makeFromBucketSpec(r,this._host):this._bucket=I_(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=On.makeFromBucketSpec(this._url,t):this._bucket=I_(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){b_("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){b_("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const n=await t.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Tn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new vr(this,t)}_makeRequest(t,n,i,r,o=!0){if(this._deleted)return new yk(Aw());{const l=xk(t,this._appId,i,r,n,this._firebaseVersion,o);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(t,n){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,n,i,r).getPromise()}}const P_="@firebase/storage",A_="0.13.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw="storage";function Bw(e,t,n){return e=Te(e),i1(e,t,n)}function zw(e){return e=Te(e),s1(e)}function h1(e){return e=Te(e),r1(e)}function nd(e,t){return e=Te(e),c1(e,t)}function d1(e=Ad(),t){e=Te(e);const i=uu(e,Fw).getImmediate({identifier:t}),r=nv("storage");return r&&f1(i,...r),i}function f1(e,t,n,i={}){u1(e,t,n,i)}function p1(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return new Rf(n,i,r,t,yr)}function m1(){fr(new Ss(Fw,p1,"PUBLIC").setMultipleInstances(!0)),yi(P_,A_,""),yi(P_,A_,"esm2017")}m1();const _1={apiKey:void 0,authDomain:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0,measurementId:void 0},Sf=lv(_1),ve=bR(Sf),id=d1(Sf),Eo=bw(Sf),g1={name:"TripCard",props:{trip:{type:Object,required:!0}},emits:["delete-trip"],methods:{deleteTrip(){confirm("Are you sure you want to delete this trip?")&&this.$emit("delete-trip",this.trip.id)},formatDate(e){if(!e)return"";const t={year:"numeric",month:"short",day:"numeric"};return new Date(e).toLocaleDateString(void 0,t)}}},v1={class:"trip-card-wrapper"},y1={class:"card shadow-sm h-100"},w1={class:"card-body d-flex flex-column"},T1={class:"card-content"},E1={class:"card-title text-truncate"},b1={class:"card-text text-muted mb-3"},I1={key:0,class:"card-text small text-muted"},P1={class:"card-actions mt-auto"};function A1(e,t,n,i,r,o){const l=xn("router-link");return rt(),lt("div",v1,[E("div",y1,[E("div",w1,[E("div",T1,[E("h5",E1,It(n.trip.name),1),E("p",b1,[t[1]||(t[1]=E("i",{class:"fas fa-map-marker-alt me-2"},null,-1)),Ot(It(n.trip.country),1)]),n.trip.startDate?(rt(),lt("p",I1,[t[2]||(t[2]=E("i",{class:"far fa-calendar-alt me-2"},null,-1)),Ot(" "+It(o.formatDate(n.trip.startDate))+" - "+It(o.formatDate(n.trip.endDate)),1)])):Bt("",!0)]),E("div",P1,[pe(l,{to:`/trip/${n.trip.id}`,class:"btn btn-success w-100 mb-2"},{default:Io(()=>t[3]||(t[3]=[E("i",{class:"fas fa-eye me-2"},null,-1),Ot("View Details ")])),_:1},8,["to"]),E("button",{class:"btn btn-outline-danger w-100",onClick:t[0]||(t[0]=Is((...h)=>o.deleteTrip&&o.deleteTrip(...h),["stop"]))},t[4]||(t[4]=[E("i",{class:"fas fa-trash-alt me-2"},null,-1),Ot("Delete ")]))])])])])}const C1=In(g1,[["render",A1],["__scopeId","data-v-3a7bd8f9"]]),R1={name:"AddTripModal",setup(e,{emit:t}){const n=sn({country:"",name:"",departureDate:"",arrivalDate:""}),i=sn([]),r=sn(null);$S(Eo,d=>{r.value=d==null?void 0:d.uid});const o=async()=>{try{const p=await(await fetch("https://restcountries.com/v3.1/all")).json();i.value=p.map(_=>_.name.common).sort()}catch(d){console.error("Error loading countries:",d)}},l=async()=>{if(r.value)try{const d=await fl(Wn(ve,"trips"),{...n.value,userId:r.value,createdAt:new Date});t("add-trip",{id:d.id,...n.value}),h()}catch(d){console.error("Error saving trip:",d)}},h=()=>{t("close")};return nu(o),{newTrip:n,countries:i,submitForm:l,closeModal:h}}},S1={class:"modal-overlay"},x1={class:"modal-container"},k1={class:"modal-header"},L1={class:"modal-body"},M1={class:"form-group"},O1=["value"],D1={class:"form-group"},N1={class:"date-row"},V1={class:"form-group"},U1={class:"form-group"},F1={class:"modal-footer"};function B1(e,t,n,i,r,o){return rt(),lt("div",S1,[E("div",x1,[E("div",k1,[t[8]||(t[8]=E("h3",null,"Add New Trip",-1)),E("button",{onClick:t[0]||(t[0]=(...l)=>i.closeModal&&i.closeModal(...l)),class:"close-btn"},t[7]||(t[7]=[E("i",{class:"fas fa-times"},null,-1)]))]),E("div",L1,[E("form",{onSubmit:t[6]||(t[6]=Is((...l)=>i.submitForm&&i.submitForm(...l),["prevent"]))},[E("div",M1,[t[10]||(t[10]=E("label",null,"Country",-1)),fe(E("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>i.newTrip.country=l),required:"",class:"form-control"},[t[9]||(t[9]=E("option",{value:"",disabled:""},"Select country",-1)),(rt(!0),lt(qe,null,Qi(i.countries,l=>(rt(),lt("option",{key:l,value:l},It(l),9,O1))),128))],512),[[Vg,i.newTrip.country]])]),E("div",D1,[t[11]||(t[11]=E("label",null,"Trip Name",-1)),fe(E("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>i.newTrip.name=l),type:"text",required:"",class:"form-control",placeholder:"My Awesome Trip"},null,512),[[Ae,i.newTrip.name]])]),E("div",N1,[E("div",V1,[t[12]||(t[12]=E("label",null,"Departure Date",-1)),fe(E("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>i.newTrip.departureDate=l),type:"date",class:"form-control"},null,512),[[Ae,i.newTrip.departureDate]])]),E("div",U1,[t[13]||(t[13]=E("label",null,"Return Date",-1)),fe(E("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>i.newTrip.arrivalDate=l),type:"date",class:"form-control"},null,512),[[Ae,i.newTrip.arrivalDate]])])]),E("div",F1,[E("button",{type:"button",onClick:t[5]||(t[5]=(...l)=>i.closeModal&&i.closeModal(...l)),class:"btn btn-cancel"}," Cancel "),t[14]||(t[14]=E("button",{type:"submit",class:"btn btn-submit"}," Add Trip ",-1))])],32)])])])}const z1=In(R1,[["render",B1],["__scopeId","data-v-ffdc9522"]]),j1={name:"HomeView",components:{TripCard:C1,AddTripModal:z1},setup(){const e=sn([]),t=sn(!1),n=sn(null),i=lu(),r=async()=>{if(n.value)try{const _=Uy(Wn(ve,"trips"),MR("userId","==",n.value)),y=await UR(_);e.value=y.docs.map(T=>({id:T.id,...T.data()}))}catch(_){console.error("Error loading trips:",_)}},o=async _=>{try{await xo(mn(ve,"trips",_)),e.value=e.value.filter(y=>y.id!==_)}catch(y){console.error("Error deleting trip:",y)}},l=_=>{e.value.push(_),p()},h=async()=>{try{await qS(Eo),i.push("/")}catch(_){console.error("Error logging out:",_)}},d=()=>{t.value=!0},p=()=>{t.value=!1};return Eo.onAuthStateChanged(_=>{_?(n.value=_.uid,r()):(n.value=null,e.value=[])}),nu(r),{trips:e,isModalVisible:t,showAddTripModal:d,closeModal:p,addTrip:l,deleteTrip:o,logout:h}}},H1={class:"container-fluid py-4 py-md-5 px-3 px-md-5"},$1={class:"d-flex justify-content-end mb-4"},q1={key:0,class:"text-center text-muted mt-5"},W1={key:1,class:"row g-3 g-md-4 justify-content-center"},K1={key:2,class:"d-flex justify-content-center mt-4"};function G1(e,t,n,i,r,o){const l=xn("TripCard"),h=xn("AddTripModal");return rt(),lt("div",H1,[E("div",$1,[E("button",{class:"btn btn-outline-danger",onClick:t[0]||(t[0]=(...d)=>i.logout&&i.logout(...d))}," Log out ")]),t[4]||(t[4]=E("h1",{class:"text-center mb-4 display-4 fw-bold text-success"},"Trip Master",-1)),i.trips.length===0?(rt(),lt("div",q1,[t[3]||(t[3]=E("p",{class:"fs-5"},"You don't have any trips yet 😢",-1)),E("button",{class:"btn btn-success px-4 py-2",onClick:t[1]||(t[1]=(...d)=>i.showAddTripModal&&i.showAddTripModal(...d))},"Add your first trip")])):(rt(),lt("div",W1,[(rt(!0),lt(qe,null,Qi(i.trips,d=>(rt(),lt("div",{class:"col-12 col-sm-6 col-lg-4 col-xl-3",key:d.id},[pe(l,{trip:d,onDeleteTrip:i.deleteTrip,class:"h-100"},null,8,["trip","onDeleteTrip"])]))),128))])),i.trips.length>0?(rt(),lt("div",K1,[E("button",{class:"btn btn-success px-4 py-2",onClick:t[2]||(t[2]=(...d)=>i.showAddTripModal&&i.showAddTripModal(...d))}," Add new trip ")])):Bt("",!0),i.isModalVisible?(rt(),xg(h,{key:3,onClose:i.closeModal,onAddTrip:i.addTrip},null,8,["onClose","onAddTrip"])):Bt("",!0)])}const C_=In(j1,[["render",G1],["__scopeId","data-v-d361cf33"]]);function Z1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ya={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var Q1=ya.exports,R_;function Y1(){return R_||(R_=1,function(e,t){(function(n,i){i(t)})(Q1,function(n){var i="1.9.4";function r(s){var a,u,f,g;for(u=1,f=arguments.length;u<f;u++){g=arguments[u];for(a in g)s[a]=g[a]}return s}var o=Object.create||function(){function s(){}return function(a){return s.prototype=a,new s}}();function l(s,a){var u=Array.prototype.slice;if(s.bind)return s.bind.apply(s,u.call(arguments,1));var f=u.call(arguments,2);return function(){return s.apply(a,f.length?f.concat(u.call(arguments)):arguments)}}var h=0;function d(s){return"_leaflet_id"in s||(s._leaflet_id=++h),s._leaflet_id}function p(s,a,u){var f,g,w,x;return x=function(){f=!1,g&&(w.apply(u,g),g=!1)},w=function(){f?g=arguments:(s.apply(u,arguments),setTimeout(x,a),f=!0)},w}function _(s,a,u){var f=a[1],g=a[0],w=f-g;return s===f&&u?s:((s-g)%w+w)%w+g}function y(){return!1}function T(s,a){if(a===!1)return s;var u=Math.pow(10,a===void 0?6:a);return Math.round(s*u)/u}function I(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function U(s){return I(s).split(/\s+/)}function B(s,a){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?o(s.options):{});for(var u in a)s.options[u]=a[u];return s.options}function j(s,a,u){var f=[];for(var g in s)f.push(encodeURIComponent(u?g.toUpperCase():g)+"="+encodeURIComponent(s[g]));return(!a||a.indexOf("?")===-1?"?":"&")+f.join("&")}var et=/\{ *([\w_ -]+) *\}/g;function X(s,a){return s.replace(et,function(u,f){var g=a[f];if(g===void 0)throw new Error("No value provided for variable "+u);return typeof g=="function"&&(g=g(a)),g})}var Q=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function tt(s,a){for(var u=0;u<s.length;u++)if(s[u]===a)return u;return-1}var Et="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function kt(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var k=0;function P(s){var a=+new Date,u=Math.max(0,16-(a-k));return k=a+u,window.setTimeout(s,u)}var S=window.requestAnimationFrame||kt("RequestAnimationFrame")||P,M=window.cancelAnimationFrame||kt("CancelAnimationFrame")||kt("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function O(s,a,u){if(u&&S===P)s.call(a);else return S.call(window,l(s,a))}function D(s){s&&M.call(window,s)}var R={__proto__:null,extend:r,create:o,bind:l,get lastId(){return h},stamp:d,throttle:p,wrapNum:_,falseFn:y,formatNum:T,trim:I,splitWords:U,setOptions:B,getParamString:j,template:X,isArray:Q,indexOf:tt,emptyImageUrl:Et,requestFn:S,cancelFn:M,requestAnimFrame:O,cancelAnimFrame:D};function _e(){}_e.extend=function(s){var a=function(){B(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},u=a.__super__=this.prototype,f=o(u);f.constructor=a,a.prototype=f;for(var g in this)Object.prototype.hasOwnProperty.call(this,g)&&g!=="prototype"&&g!=="__super__"&&(a[g]=this[g]);return s.statics&&r(a,s.statics),s.includes&&(_n(s.includes),r.apply(null,[f].concat(s.includes))),r(f,s),delete f.statics,delete f.includes,f.options&&(f.options=u.options?o(u.options):{},r(f.options,s.options)),f._initHooks=[],f.callInitHooks=function(){if(!this._initHooksCalled){u.callInitHooks&&u.callInitHooks.call(this),this._initHooksCalled=!0;for(var w=0,x=f._initHooks.length;w<x;w++)f._initHooks[w].call(this)}},a},_e.include=function(s){var a=this.prototype.options;return r(this.prototype,s),s.options&&(this.prototype.options=a,this.mergeOptions(s.options)),this},_e.mergeOptions=function(s){return r(this.prototype.options,s),this},_e.addInitHook=function(s){var a=Array.prototype.slice.call(arguments,1),u=typeof s=="function"?s:function(){this[s].apply(this,a)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(u),this};function _n(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=Q(s)?s:[s];for(var a=0;a<s.length;a++)s[a]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Jt={on:function(s,a,u){if(typeof s=="object")for(var f in s)this._on(f,s[f],a);else{s=U(s);for(var g=0,w=s.length;g<w;g++)this._on(s[g],a,u)}return this},off:function(s,a,u){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var f in s)this._off(f,s[f],a);else{s=U(s);for(var g=arguments.length===1,w=0,x=s.length;w<x;w++)g?this._off(s[w]):this._off(s[w],a,u)}return this},_on:function(s,a,u,f){if(typeof a!="function"){console.warn("wrong listener type: "+typeof a);return}if(this._listens(s,a,u)===!1){u===this&&(u=void 0);var g={fn:a,ctx:u};f&&(g.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(g)}},_off:function(s,a,u){var f,g,w;if(this._events&&(f=this._events[s],!!f)){if(arguments.length===1){if(this._firingCount)for(g=0,w=f.length;g<w;g++)f[g].fn=y;delete this._events[s];return}if(typeof a!="function"){console.warn("wrong listener type: "+typeof a);return}var x=this._listens(s,a,u);if(x!==!1){var F=f[x];this._firingCount&&(F.fn=y,this._events[s]=f=f.slice()),f.splice(x,1)}}},fire:function(s,a,u){if(!this.listens(s,u))return this;var f=r({},a,{type:s,target:this,sourceTarget:a&&a.sourceTarget||this});if(this._events){var g=this._events[s];if(g){this._firingCount=this._firingCount+1||1;for(var w=0,x=g.length;w<x;w++){var F=g[w],z=F.fn;F.once&&this.off(s,z,F.ctx),z.call(F.ctx||this,f)}this._firingCount--}}return u&&this._propagateEvent(f),this},listens:function(s,a,u,f){typeof s!="string"&&console.warn('"string" type argument expected');var g=a;typeof a!="function"&&(f=!!a,g=void 0,u=void 0);var w=this._events&&this._events[s];if(w&&w.length&&this._listens(s,g,u)!==!1)return!0;if(f){for(var x in this._eventParents)if(this._eventParents[x].listens(s,a,u,f))return!0}return!1},_listens:function(s,a,u){if(!this._events)return!1;var f=this._events[s]||[];if(!a)return!!f.length;u===this&&(u=void 0);for(var g=0,w=f.length;g<w;g++)if(f[g].fn===a&&f[g].ctx===u)return g;return!1},once:function(s,a,u){if(typeof s=="object")for(var f in s)this._on(f,s[f],a,!0);else{s=U(s);for(var g=0,w=s.length;g<w;g++)this._on(s[g],a,u,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[d(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[d(s)],this},_propagateEvent:function(s){for(var a in this._eventParents)this._eventParents[a].fire(s.type,r({layer:s.target,propagatedFrom:s.target},s),!0)}};Jt.addEventListener=Jt.on,Jt.removeEventListener=Jt.clearAllEventListeners=Jt.off,Jt.addOneTimeEventListener=Jt.once,Jt.fireEvent=Jt.fire,Jt.hasEventListeners=Jt.listens;var Ft=_e.extend(Jt);function at(s,a,u){this.x=u?Math.round(s):s,this.y=u?Math.round(a):a}var Qe=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};at.prototype={clone:function(){return new at(this.x,this.y)},add:function(s){return this.clone()._add(vt(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(vt(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new at(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new at(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Qe(this.x),this.y=Qe(this.y),this},distanceTo:function(s){s=vt(s);var a=s.x-this.x,u=s.y-this.y;return Math.sqrt(a*a+u*u)},equals:function(s){return s=vt(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=vt(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+T(this.x)+", "+T(this.y)+")"}};function vt(s,a,u){return s instanceof at?s:Q(s)?new at(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new at(s.x,s.y):new at(s,a,u)}function Gt(s,a){if(s)for(var u=a?[s,a]:s,f=0,g=u.length;f<g;f++)this.extend(u[f])}Gt.prototype={extend:function(s){var a,u;if(!s)return this;if(s instanceof at||typeof s[0]=="number"||"x"in s)a=u=vt(s);else if(s=Ht(s),a=s.min,u=s.max,!a||!u)return this;return!this.min&&!this.max?(this.min=a.clone(),this.max=u.clone()):(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(u.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(u.y,this.max.y)),this},getCenter:function(s){return vt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return vt(this.min.x,this.max.y)},getTopRight:function(){return vt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var a,u;return typeof s[0]=="number"||s instanceof at?s=vt(s):s=Ht(s),s instanceof Gt?(a=s.min,u=s.max):a=u=s,a.x>=this.min.x&&u.x<=this.max.x&&a.y>=this.min.y&&u.y<=this.max.y},intersects:function(s){s=Ht(s);var a=this.min,u=this.max,f=s.min,g=s.max,w=g.x>=a.x&&f.x<=u.x,x=g.y>=a.y&&f.y<=u.y;return w&&x},overlaps:function(s){s=Ht(s);var a=this.min,u=this.max,f=s.min,g=s.max,w=g.x>a.x&&f.x<u.x,x=g.y>a.y&&f.y<u.y;return w&&x},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var a=this.min,u=this.max,f=Math.abs(a.x-u.x)*s,g=Math.abs(a.y-u.y)*s;return Ht(vt(a.x-f,a.y-g),vt(u.x+f,u.y+g))},equals:function(s){return s?(s=Ht(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function Ht(s,a){return!s||s instanceof Gt?s:new Gt(s,a)}function $t(s,a){if(s)for(var u=a?[s,a]:s,f=0,g=u.length;f<g;f++)this.extend(u[f])}$t.prototype={extend:function(s){var a=this._southWest,u=this._northEast,f,g;if(s instanceof zt)f=s,g=s;else if(s instanceof $t){if(f=s._southWest,g=s._northEast,!f||!g)return this}else return s?this.extend(At(s)||oe(s)):this;return!a&&!u?(this._southWest=new zt(f.lat,f.lng),this._northEast=new zt(g.lat,g.lng)):(a.lat=Math.min(f.lat,a.lat),a.lng=Math.min(f.lng,a.lng),u.lat=Math.max(g.lat,u.lat),u.lng=Math.max(g.lng,u.lng)),this},pad:function(s){var a=this._southWest,u=this._northEast,f=Math.abs(a.lat-u.lat)*s,g=Math.abs(a.lng-u.lng)*s;return new $t(new zt(a.lat-f,a.lng-g),new zt(u.lat+f,u.lng+g))},getCenter:function(){return new zt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new zt(this.getNorth(),this.getWest())},getSouthEast:function(){return new zt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof zt||"lat"in s?s=At(s):s=oe(s);var a=this._southWest,u=this._northEast,f,g;return s instanceof $t?(f=s.getSouthWest(),g=s.getNorthEast()):f=g=s,f.lat>=a.lat&&g.lat<=u.lat&&f.lng>=a.lng&&g.lng<=u.lng},intersects:function(s){s=oe(s);var a=this._southWest,u=this._northEast,f=s.getSouthWest(),g=s.getNorthEast(),w=g.lat>=a.lat&&f.lat<=u.lat,x=g.lng>=a.lng&&f.lng<=u.lng;return w&&x},overlaps:function(s){s=oe(s);var a=this._southWest,u=this._northEast,f=s.getSouthWest(),g=s.getNorthEast(),w=g.lat>a.lat&&f.lat<u.lat,x=g.lng>a.lng&&f.lng<u.lng;return w&&x},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,a){return s?(s=oe(s),this._southWest.equals(s.getSouthWest(),a)&&this._northEast.equals(s.getNorthEast(),a)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function oe(s,a){return s instanceof $t?s:new $t(s,a)}function zt(s,a,u){if(isNaN(s)||isNaN(a))throw new Error("Invalid LatLng object: ("+s+", "+a+")");this.lat=+s,this.lng=+a,u!==void 0&&(this.alt=+u)}zt.prototype={equals:function(s,a){if(!s)return!1;s=At(s);var u=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return u<=(a===void 0?1e-9:a)},toString:function(s){return"LatLng("+T(this.lat,s)+", "+T(this.lng,s)+")"},distanceTo:function(s){return ct.distance(this,At(s))},wrap:function(){return ct.wrapLatLng(this)},toBounds:function(s){var a=180*s/40075017,u=a/Math.cos(Math.PI/180*this.lat);return oe([this.lat-a,this.lng-u],[this.lat+a,this.lng+u])},clone:function(){return new zt(this.lat,this.lng,this.alt)}};function At(s,a,u){return s instanceof zt?s:Q(s)&&typeof s[0]!="object"?s.length===3?new zt(s[0],s[1],s[2]):s.length===2?new zt(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new zt(s.lat,"lng"in s?s.lng:s.lon,s.alt):a===void 0?null:new zt(s,a,u)}var $={latLngToPoint:function(s,a){var u=this.projection.project(s),f=this.scale(a);return this.transformation._transform(u,f)},pointToLatLng:function(s,a){var u=this.scale(a),f=this.transformation.untransform(s,u);return this.projection.unproject(f)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var a=this.projection.bounds,u=this.scale(s),f=this.transformation.transform(a.min,u),g=this.transformation.transform(a.max,u);return new Gt(f,g)},infinite:!1,wrapLatLng:function(s){var a=this.wrapLng?_(s.lng,this.wrapLng,!0):s.lng,u=this.wrapLat?_(s.lat,this.wrapLat,!0):s.lat,f=s.alt;return new zt(u,a,f)},wrapLatLngBounds:function(s){var a=s.getCenter(),u=this.wrapLatLng(a),f=a.lat-u.lat,g=a.lng-u.lng;if(f===0&&g===0)return s;var w=s.getSouthWest(),x=s.getNorthEast(),F=new zt(w.lat-f,w.lng-g),z=new zt(x.lat-f,x.lng-g);return new $t(F,z)}},ct=r({},$,{wrapLng:[-180,180],R:6371e3,distance:function(s,a){var u=Math.PI/180,f=s.lat*u,g=a.lat*u,w=Math.sin((a.lat-s.lat)*u/2),x=Math.sin((a.lng-s.lng)*u/2),F=w*w+Math.cos(f)*Math.cos(g)*x*x,z=2*Math.atan2(Math.sqrt(F),Math.sqrt(1-F));return this.R*z}}),ut=6378137,mt={R:ut,MAX_LATITUDE:85.0511287798,project:function(s){var a=Math.PI/180,u=this.MAX_LATITUDE,f=Math.max(Math.min(u,s.lat),-u),g=Math.sin(f*a);return new at(this.R*s.lng*a,this.R*Math.log((1+g)/(1-g))/2)},unproject:function(s){var a=180/Math.PI;return new zt((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*a,s.x*a/this.R)},bounds:function(){var s=ut*Math.PI;return new Gt([-s,-s],[s,s])}()};function Zt(s,a,u,f){if(Q(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=a,this._c=u,this._d=f}Zt.prototype={transform:function(s,a){return this._transform(s.clone(),a)},_transform:function(s,a){return a=a||1,s.x=a*(this._a*s.x+this._b),s.y=a*(this._c*s.y+this._d),s},untransform:function(s,a){return a=a||1,new at((s.x/a-this._b)/this._a,(s.y/a-this._d)/this._c)}};function A(s,a,u,f){return new Zt(s,a,u,f)}var C=r({},ct,{code:"EPSG:3857",projection:mt,transformation:function(){var s=.5/(Math.PI*mt.R);return A(s,.5,-s,.5)}()}),N=r({},C,{code:"EPSG:900913"});function q(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function G(s,a){var u="",f,g,w,x,F,z;for(f=0,w=s.length;f<w;f++){for(F=s[f],g=0,x=F.length;g<x;g++)z=F[g],u+=(g?"L":"M")+z.x+" "+z.y;u+=a?gt.svg?"z":"x":""}return u||"M0 0"}var W=document.documentElement.style,ot="ActiveXObject"in window,it=ot&&!document.addEventListener,nt="msLaunchUri"in navigator&&!("documentMode"in document),J=Dn("webkit"),wt=Dn("android"),ht=Dn("android 2")||Dn("android 3"),_t=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),bt=wt&&Dn("Google")&&_t<537&&!("AudioNode"in window),yt=!!window.opera,Mt=!nt&&Dn("chrome"),Wt=Dn("gecko")&&!J&&!yt&&!ot,Be=!Mt&&Dn("safari"),ke=Dn("phantom"),cn="OTransition"in W,ze=navigator.platform.indexOf("Win")===0,Gn=ot&&"transition"in W,Ci="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ht,Le="MozPerspective"in W,gn=!window.L_DISABLE_3D&&(Gn||Ci||Le)&&!cn&&!ke,oi=typeof orientation<"u"||Dn("mobile"),Lo=oi&&J,vl=oi&&Ci,Mo=!window.PointerEvent&&window.MSPointerEvent,is=!!(window.PointerEvent||Mo),Er="ontouchstart"in window||!!window.TouchEvent,Oo=!window.L_NO_TOUCH&&(Er||is),Ri=oi&&yt,yl=oi&&Wt,br=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,wl=function(){var s=!1;try{var a=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",y,a),window.removeEventListener("testPassiveEventSupport",y,a)}catch{}return s}(),qs=function(){return!!document.createElement("canvas").getContext}(),Ir=!!(document.createElementNS&&q("svg").createSVGRect),We=!!Ir&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Tl=!Ir&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var a=s.firstChild;return a.style.behavior="url(#default#VML)",a&&typeof a.adj=="object"}catch{return!1}}(),Ws=navigator.platform.indexOf("Mac")===0,Ks=navigator.platform.indexOf("Linux")===0;function Dn(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var gt={ie:ot,ielt9:it,edge:nt,webkit:J,android:wt,android23:ht,androidStock:bt,opera:yt,chrome:Mt,gecko:Wt,safari:Be,phantom:ke,opera12:cn,win:ze,ie3d:Gn,webkit3d:Ci,gecko3d:Le,any3d:gn,mobile:oi,mobileWebkit:Lo,mobileWebkit3d:vl,msPointer:Mo,pointer:is,touch:Oo,touchNative:Er,mobileOpera:Ri,mobileGecko:yl,retina:br,passiveEvents:wl,canvas:qs,svg:Ir,vml:Tl,inlineSvg:We,mac:Ws,linux:Ks},Si=gt.msPointer?"MSPointerDown":"pointerdown",El=gt.msPointer?"MSPointerMove":"pointermove",bl=gt.msPointer?"MSPointerUp":"pointerup",Gs=gt.msPointer?"MSPointerCancel":"pointercancel",Pr={touchstart:Si,touchmove:El,touchend:bl,touchcancel:Gs},Ar={touchstart:Rr,touchmove:Cr,touchend:Cr,touchcancel:Cr},Zn={},Qn=!1;function Il(s,a,u){return a==="touchstart"&&Al(),Ar[a]?(u=Ar[a].bind(this,u),s.addEventListener(Pr[a],u,!1),u):(console.warn("wrong event specified:",a),y)}function Pl(s,a,u){if(!Pr[a]){console.warn("wrong event specified:",a);return}s.removeEventListener(Pr[a],u,!1)}function Do(s){Zn[s.pointerId]=s}function No(s){Zn[s.pointerId]&&(Zn[s.pointerId]=s)}function Vo(s){delete Zn[s.pointerId]}function Al(){Qn||(document.addEventListener(Si,Do,!0),document.addEventListener(El,No,!0),document.addEventListener(bl,Vo,!0),document.addEventListener(Gs,Vo,!0),Qn=!0)}function Cr(s,a){if(a.pointerType!==(a.MSPOINTER_TYPE_MOUSE||"mouse")){a.touches=[];for(var u in Zn)a.touches.push(Zn[u]);a.changedTouches=[a],s(a)}}function Rr(s,a){a.MSPOINTER_TYPE_TOUCH&&a.pointerType===a.MSPOINTER_TYPE_TOUCH&&Ee(a),Cr(s,a)}function Cl(s){var a={},u,f;for(f in s)u=s[f],a[f]=u&&u.bind?u.bind(s):u;return s=a,a.type="dblclick",a.detail=2,a.isTrusted=!1,a._simulated=!0,a}var Uo=200;function Zs(s,a){s.addEventListener("dblclick",a);var u=0,f;function g(w){if(w.detail!==1){f=w.detail;return}if(!(w.pointerType==="mouse"||w.sourceCapabilities&&!w.sourceCapabilities.firesTouchEvents)){var x=Qo(w);if(!(x.some(function(z){return z instanceof HTMLLabelElement&&z.attributes.for})&&!x.some(function(z){return z instanceof HTMLInputElement||z instanceof HTMLSelectElement}))){var F=Date.now();F-u<=Uo?(f++,f===2&&a(Cl(w))):f=1,u=F}}}return s.addEventListener("click",g),{dblclick:a,simDblclick:g}}function xi(s,a){s.removeEventListener("dblclick",a.dblclick),s.removeEventListener("click",a.simDblclick)}var Qs=Li(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ys=Li(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Fo=Ys==="webkitTransition"||Ys==="OTransition"?Ys+"End":"transitionend";function Bo(s){return typeof s=="string"?document.getElementById(s):s}function ss(s,a){var u=s.style[a]||s.currentStyle&&s.currentStyle[a];if((!u||u==="auto")&&document.defaultView){var f=document.defaultView.getComputedStyle(s,null);u=f?f[a]:null}return u==="auto"?null:u}function Qt(s,a,u){var f=document.createElement(s);return f.className=a||"",u&&u.appendChild(f),f}function ue(s){var a=s.parentNode;a&&a.removeChild(s)}function Xs(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function ki(s){var a=s.parentNode;a&&a.lastChild!==s&&a.appendChild(s)}function rs(s){var a=s.parentNode;a&&a.firstChild!==s&&a.insertBefore(s,a.firstChild)}function zo(s,a){if(s.classList!==void 0)return s.classList.contains(a);var u=Nn(s);return u.length>0&&new RegExp("(^|\\s)"+a+"(\\s|$)").test(u)}function Vt(s,a){if(s.classList!==void 0)for(var u=U(a),f=0,g=u.length;f<g;f++)s.classList.add(u[f]);else if(!zo(s,a)){var w=Nn(s);jo(s,(w?w+" ":"")+a)}}function ye(s,a){s.classList!==void 0?s.classList.remove(a):jo(s,I((" "+Nn(s)+" ").replace(" "+a+" "," ")))}function jo(s,a){s.className.baseVal===void 0?s.className=a:s.className.baseVal=a}function Nn(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function Pe(s,a){"opacity"in s.style?s.style.opacity=a:"filter"in s.style&&Sr(s,a)}function Sr(s,a){var u=!1,f="DXImageTransform.Microsoft.Alpha";try{u=s.filters.item(f)}catch{if(a===1)return}a=Math.round(a*100),u?(u.Enabled=a!==100,u.Opacity=a):s.style.filter+=" progid:"+f+"(opacity="+a+")"}function Li(s){for(var a=document.documentElement.style,u=0;u<s.length;u++)if(s[u]in a)return s[u];return!1}function ai(s,a,u){var f=a||new at(0,0);s.style[Qs]=(gt.ie3d?"translate("+f.x+"px,"+f.y+"px)":"translate3d("+f.x+"px,"+f.y+"px,0)")+(u?" scale("+u+")":"")}function Lt(s,a){s._leaflet_pos=a,gt.any3d?ai(s,a):(s.style.left=a.x+"px",s.style.top=a.y+"px")}function Vn(s){return s._leaflet_pos||new at(0,0)}var Yn,Xn,Ho;if("onselectstart"in document)Yn=function(){Ct(window,"selectstart",Ee)},Xn=function(){le(window,"selectstart",Ee)};else{var os=Li(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Yn=function(){if(os){var s=document.documentElement.style;Ho=s[os],s[os]="none"}},Xn=function(){os&&(document.documentElement.style[os]=Ho,Ho=void 0)}}function $o(){Ct(window,"dragstart",Ee)}function qo(){le(window,"dragstart",Ee)}var xr,Wo;function Mi(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(Pn(),xr=s,Wo=s.style.outlineStyle,s.style.outlineStyle="none",Ct(window,"keydown",Pn))}function Pn(){xr&&(xr.style.outlineStyle=Wo,xr=void 0,Wo=void 0,le(window,"keydown",Pn))}function Ko(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function kr(s){var a=s.getBoundingClientRect();return{x:a.width/s.offsetWidth||1,y:a.height/s.offsetHeight||1,boundingClientRect:a}}var Rl={__proto__:null,TRANSFORM:Qs,TRANSITION:Ys,TRANSITION_END:Fo,get:Bo,getStyle:ss,create:Qt,remove:ue,empty:Xs,toFront:ki,toBack:rs,hasClass:zo,addClass:Vt,removeClass:ye,setClass:jo,getClass:Nn,setOpacity:Pe,testProp:Li,setTransform:ai,setPosition:Lt,getPosition:Vn,get disableTextSelection(){return Yn},get enableTextSelection(){return Xn},disableImageDrag:$o,enableImageDrag:qo,preventOutline:Mi,restoreOutline:Pn,getSizedParentNode:Ko,getScale:kr};function Ct(s,a,u,f){if(a&&typeof a=="object")for(var g in a)Go(s,g,a[g],u);else{a=U(a);for(var w=0,x=a.length;w<x;w++)Go(s,a[w],u,f)}return this}var Un="_leaflet_events";function le(s,a,u,f){if(arguments.length===1)Sl(s),delete s[Un];else if(a&&typeof a=="object")for(var g in a)Zo(s,g,a[g],u);else if(a=U(a),arguments.length===2)Sl(s,function(F){return tt(a,F)!==-1});else for(var w=0,x=a.length;w<x;w++)Zo(s,a[w],u,f);return this}function Sl(s,a){for(var u in s[Un]){var f=u.split(/\d/)[0];(!a||a(f))&&Zo(s,f,null,null,u)}}var Fn={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Go(s,a,u,f){var g=a+d(u)+(f?"_"+d(f):"");if(s[Un]&&s[Un][g])return this;var w=function(F){return u.call(f||s,F||window.event)},x=w;!gt.touchNative&&gt.pointer&&a.indexOf("touch")===0?w=Il(s,a,w):gt.touch&&a==="dblclick"?w=Zs(s,w):"addEventListener"in s?a==="touchstart"||a==="touchmove"||a==="wheel"||a==="mousewheel"?s.addEventListener(Fn[a]||a,w,gt.passiveEvents?{passive:!1}:!1):a==="mouseenter"||a==="mouseleave"?(w=function(F){F=F||window.event,Yo(s,F)&&x(F)},s.addEventListener(Fn[a],w,!1)):s.addEventListener(a,x,!1):s.attachEvent("on"+a,w),s[Un]=s[Un]||{},s[Un][g]=w}function Zo(s,a,u,f,g){g=g||a+d(u)+(f?"_"+d(f):"");var w=s[Un]&&s[Un][g];if(!w)return this;!gt.touchNative&&gt.pointer&&a.indexOf("touch")===0?Pl(s,a,w):gt.touch&&a==="dblclick"?xi(s,w):"removeEventListener"in s?s.removeEventListener(Fn[a]||a,w,!1):s.detachEvent("on"+a,w),s[Un][g]=null}function Bn(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function as(s){return Go(s,"wheel",Bn),this}function ls(s){return Ct(s,"mousedown touchstart dblclick contextmenu",Bn),s._leaflet_disable_click=!0,this}function Ee(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function An(s){return Ee(s),Bn(s),this}function Qo(s){if(s.composedPath)return s.composedPath();for(var a=[],u=s.target;u;)a.push(u),u=u.parentNode;return a}function Lr(s,a){if(!a)return new at(s.clientX,s.clientY);var u=kr(a),f=u.boundingClientRect;return new at((s.clientX-f.left)/u.x-a.clientLeft,(s.clientY-f.top)/u.y-a.clientTop)}var we=gt.linux&&gt.chrome?window.devicePixelRatio:gt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function xl(s){return gt.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/we:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function Yo(s,a){var u=a.relatedTarget;if(!u)return!0;try{for(;u&&u!==s;)u=u.parentNode}catch{return!1}return u!==s}var kl={__proto__:null,on:Ct,off:le,stopPropagation:Bn,disableScrollPropagation:as,disableClickPropagation:ls,preventDefault:Ee,stop:An,getPropagationPath:Qo,getMousePosition:Lr,getWheelDelta:xl,isExternalTarget:Yo,addListener:Ct,removeListener:le},Xo=Ft.extend({run:function(s,a,u,f){this.stop(),this._el=s,this._inProgress=!0,this._duration=u||.25,this._easeOutPower=1/Math.max(f||.5,.2),this._startPos=Vn(s),this._offset=a.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=O(this._animate,this),this._step()},_step:function(s){var a=+new Date-this._startTime,u=this._duration*1e3;a<u?this._runFrame(this._easeOut(a/u),s):(this._runFrame(1),this._complete())},_runFrame:function(s,a){var u=this._startPos.add(this._offset.multiplyBy(s));a&&u._round(),Lt(this._el,u),this.fire("step")},_complete:function(){D(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),Kt=Ft.extend({options:{crs:C,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,a){a=B(this,a),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),a.maxBounds&&this.setMaxBounds(a.maxBounds),a.zoom!==void 0&&(this._zoom=this._limitZoom(a.zoom)),a.center&&a.zoom!==void 0&&this.setView(At(a.center),a.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ys&&gt.any3d&&!gt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ct(this._proxy,Fo,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,a,u){if(a=a===void 0?this._zoom:this._limitZoom(a),s=this._limitCenter(At(s),a,this.options.maxBounds),u=u||{},this._stop(),this._loaded&&!u.reset&&u!==!0){u.animate!==void 0&&(u.zoom=r({animate:u.animate},u.zoom),u.pan=r({animate:u.animate,duration:u.duration},u.pan));var f=this._zoom!==a?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,a,u.zoom):this._tryAnimatedPan(s,u.pan);if(f)return clearTimeout(this._sizeTimer),this}return this._resetView(s,a,u.pan&&u.pan.noMoveStart),this},setZoom:function(s,a){return this._loaded?this.setView(this.getCenter(),s,{zoom:a}):(this._zoom=s,this)},zoomIn:function(s,a){return s=s||(gt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,a)},zoomOut:function(s,a){return s=s||(gt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,a)},setZoomAround:function(s,a,u){var f=this.getZoomScale(a),g=this.getSize().divideBy(2),w=s instanceof at?s:this.latLngToContainerPoint(s),x=w.subtract(g).multiplyBy(1-1/f),F=this.containerPointToLatLng(g.add(x));return this.setView(F,a,{zoom:u})},_getBoundsCenterZoom:function(s,a){a=a||{},s=s.getBounds?s.getBounds():oe(s);var u=vt(a.paddingTopLeft||a.padding||[0,0]),f=vt(a.paddingBottomRight||a.padding||[0,0]),g=this.getBoundsZoom(s,!1,u.add(f));if(g=typeof a.maxZoom=="number"?Math.min(a.maxZoom,g):g,g===1/0)return{center:s.getCenter(),zoom:g};var w=f.subtract(u).divideBy(2),x=this.project(s.getSouthWest(),g),F=this.project(s.getNorthEast(),g),z=this.unproject(x.add(F).divideBy(2).add(w),g);return{center:z,zoom:g}},fitBounds:function(s,a){if(s=oe(s),!s.isValid())throw new Error("Bounds are not valid.");var u=this._getBoundsCenterZoom(s,a);return this.setView(u.center,u.zoom,a)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,a){return this.setView(s,this._zoom,{pan:a})},panBy:function(s,a){if(s=vt(s).round(),a=a||{},!s.x&&!s.y)return this.fire("moveend");if(a.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Xo,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),a.noMoveStart||this.fire("movestart"),a.animate!==!1){Vt(this._mapPane,"leaflet-pan-anim");var u=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,u,a.duration||.25,a.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,a,u){if(u=u||{},u.animate===!1||!gt.any3d)return this.setView(s,a,u);this._stop();var f=this.project(this.getCenter()),g=this.project(s),w=this.getSize(),x=this._zoom;s=At(s),a=a===void 0?x:a;var F=Math.max(w.x,w.y),z=F*this.getZoomScale(x,a),Y=g.distanceTo(f)||1,dt=1.42,Rt=dt*dt;function qt(Oe){var Kl=Oe?-1:1,dT=Oe?z:F,fT=z*z-F*F+Kl*Rt*Rt*Y*Y,pT=2*dT*Rt*Y,ju=fT/pT,Yf=Math.sqrt(ju*ju+1)-ju,mT=Yf<1e-9?-18:Math.log(Yf);return mT}function hn(Oe){return(Math.exp(Oe)-Math.exp(-Oe))/2}function He(Oe){return(Math.exp(Oe)+Math.exp(-Oe))/2}function jn(Oe){return hn(Oe)/He(Oe)}var yn=qt(0);function qr(Oe){return F*(He(yn)/He(yn+dt*Oe))}function lT(Oe){return F*(He(yn)*jn(yn+dt*Oe)-hn(yn))/Rt}function cT(Oe){return 1-Math.pow(1-Oe,1.5)}var uT=Date.now(),Zf=(qt(1)-yn)/dt,hT=u.duration?1e3*u.duration:1e3*Zf*.8;function Qf(){var Oe=(Date.now()-uT)/hT,Kl=cT(Oe)*Zf;Oe<=1?(this._flyToFrame=O(Qf,this),this._move(this.unproject(f.add(g.subtract(f).multiplyBy(lT(Kl)/Y)),x),this.getScaleZoom(F/qr(Kl),x),{flyTo:!0})):this._move(s,a)._moveEnd(!0)}return this._moveStart(!0,u.noMoveStart),Qf.call(this),this},flyToBounds:function(s,a){var u=this._getBoundsCenterZoom(s,a);return this.flyTo(u.center,u.zoom,a)},setMaxBounds:function(s){return s=oe(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var a=this.options.minZoom;return this.options.minZoom=s,this._loaded&&a!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var a=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&a!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,a){this._enforcingBounds=!0;var u=this.getCenter(),f=this._limitCenter(u,this._zoom,oe(s));return u.equals(f)||this.panTo(f,a),this._enforcingBounds=!1,this},panInside:function(s,a){a=a||{};var u=vt(a.paddingTopLeft||a.padding||[0,0]),f=vt(a.paddingBottomRight||a.padding||[0,0]),g=this.project(this.getCenter()),w=this.project(s),x=this.getPixelBounds(),F=Ht([x.min.add(u),x.max.subtract(f)]),z=F.getSize();if(!F.contains(w)){this._enforcingBounds=!0;var Y=w.subtract(F.getCenter()),dt=F.extend(w).getSize().subtract(z);g.x+=Y.x<0?-dt.x:dt.x,g.y+=Y.y<0?-dt.y:dt.y,this.panTo(this.unproject(g),a),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=r({animate:!1,pan:!0},s===!0?{animate:!0}:s);var a=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var u=this.getSize(),f=a.divideBy(2).round(),g=u.divideBy(2).round(),w=f.subtract(g);return!w.x&&!w.y?this:(s.animate&&s.pan?this.panBy(w):(s.pan&&this._rawPanBy(w),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:a,newSize:u}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=r({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var a=l(this._handleGeolocationResponse,this),u=l(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(a,u,s):navigator.geolocation.getCurrentPosition(a,u,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var a=s.code,u=s.message||(a===1?"permission denied":a===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:a,message:"Geolocation error: "+u+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var a=s.coords.latitude,u=s.coords.longitude,f=new zt(a,u),g=f.toBounds(s.coords.accuracy*2),w=this._locateOptions;if(w.setView){var x=this.getBoundsZoom(g);this.setView(f,w.maxZoom?Math.min(x,w.maxZoom):x)}var F={latlng:f,bounds:g,timestamp:s.timestamp};for(var z in s.coords)typeof s.coords[z]=="number"&&(F[z]=s.coords[z]);this.fire("locationfound",F)}},addHandler:function(s,a){if(!a)return this;var u=this[s]=new a(this);return this._handlers.push(u),this.options[s]&&u.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ue(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(D(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)ue(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,a){var u="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),f=Qt("div",u,a||this._mapPane);return s&&(this._panes[s]=f),f},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),a=this.unproject(s.getBottomLeft()),u=this.unproject(s.getTopRight());return new $t(a,u)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,a,u){s=oe(s),u=vt(u||[0,0]);var f=this.getZoom()||0,g=this.getMinZoom(),w=this.getMaxZoom(),x=s.getNorthWest(),F=s.getSouthEast(),z=this.getSize().subtract(u),Y=Ht(this.project(F,f),this.project(x,f)).getSize(),dt=gt.any3d?this.options.zoomSnap:1,Rt=z.x/Y.x,qt=z.y/Y.y,hn=a?Math.max(Rt,qt):Math.min(Rt,qt);return f=this.getScaleZoom(hn,f),dt&&(f=Math.round(f/(dt/100))*(dt/100),f=a?Math.ceil(f/dt)*dt:Math.floor(f/dt)*dt),Math.max(g,Math.min(w,f))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new at(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,a){var u=this._getTopLeftPoint(s,a);return new Gt(u,u.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,a){var u=this.options.crs;return a=a===void 0?this._zoom:a,u.scale(s)/u.scale(a)},getScaleZoom:function(s,a){var u=this.options.crs;a=a===void 0?this._zoom:a;var f=u.zoom(s*u.scale(a));return isNaN(f)?1/0:f},project:function(s,a){return a=a===void 0?this._zoom:a,this.options.crs.latLngToPoint(At(s),a)},unproject:function(s,a){return a=a===void 0?this._zoom:a,this.options.crs.pointToLatLng(vt(s),a)},layerPointToLatLng:function(s){var a=vt(s).add(this.getPixelOrigin());return this.unproject(a)},latLngToLayerPoint:function(s){var a=this.project(At(s))._round();return a._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(At(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(oe(s))},distance:function(s,a){return this.options.crs.distance(At(s),At(a))},containerPointToLayerPoint:function(s){return vt(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return vt(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var a=this.containerPointToLayerPoint(vt(s));return this.layerPointToLatLng(a)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(At(s)))},mouseEventToContainerPoint:function(s){return Lr(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var a=this._container=Bo(s);if(a){if(a._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ct(a,"scroll",this._onScroll,this),this._containerId=d(a)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&gt.any3d,Vt(s,"leaflet-container"+(gt.touch?" leaflet-touch":"")+(gt.retina?" leaflet-retina":"")+(gt.ielt9?" leaflet-oldie":"")+(gt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var a=ss(s,"position");a!=="absolute"&&a!=="relative"&&a!=="fixed"&&a!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Lt(this._mapPane,new at(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Vt(s.markerPane,"leaflet-zoom-hide"),Vt(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,a,u){Lt(this._mapPane,new at(0,0));var f=!this._loaded;this._loaded=!0,a=this._limitZoom(a),this.fire("viewprereset");var g=this._zoom!==a;this._moveStart(g,u)._move(s,a)._moveEnd(g),this.fire("viewreset"),f&&this.fire("load")},_moveStart:function(s,a){return s&&this.fire("zoomstart"),a||this.fire("movestart"),this},_move:function(s,a,u,f){a===void 0&&(a=this._zoom);var g=this._zoom!==a;return this._zoom=a,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),f?u&&u.pinch&&this.fire("zoom",u):((g||u&&u.pinch)&&this.fire("zoom",u),this.fire("move",u)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return D(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){Lt(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[d(this._container)]=this;var a=s?le:Ct;a(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&a(window,"resize",this._onResize,this),gt.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){D(this._resizeRequest),this._resizeRequest=O(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,a){for(var u=[],f,g=a==="mouseout"||a==="mouseover",w=s.target||s.srcElement,x=!1;w;){if(f=this._targets[d(w)],f&&(a==="click"||a==="preclick")&&this._draggableMoved(f)){x=!0;break}if(f&&f.listens(a,!0)&&(g&&!Yo(w,s)||(u.push(f),g))||w===this._container)break;w=w.parentNode}return!u.length&&!x&&!g&&this.listens(a,!0)&&(u=[this]),u},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var a=s.target||s.srcElement;if(!(!this._loaded||a._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(a))){var u=s.type;u==="mousedown"&&Mi(a),this._fireDOMEvent(s,u)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,a,u){if(s.type==="click"){var f=r({},s);f.type="preclick",this._fireDOMEvent(f,f.type,u)}var g=this._findEventTargets(s,a);if(u){for(var w=[],x=0;x<u.length;x++)u[x].listens(a,!0)&&w.push(u[x]);g=w.concat(g)}if(g.length){a==="contextmenu"&&Ee(s);var F=g[0],z={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var Y=F.getLatLng&&(!F._radius||F._radius<=10);z.containerPoint=Y?this.latLngToContainerPoint(F.getLatLng()):this.mouseEventToContainerPoint(s),z.layerPoint=this.containerPointToLayerPoint(z.containerPoint),z.latlng=Y?F.getLatLng():this.layerPointToLatLng(z.layerPoint)}for(x=0;x<g.length;x++)if(g[x].fire(a,z,!0),z.originalEvent._stopped||g[x].options.bubblingMouseEvents===!1&&tt(this._mouseEvents,a)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,a=this._handlers.length;s<a;s++)this._handlers[s].disable()},whenReady:function(s,a){return this._loaded?s.call(a||this,{target:this}):this.on("load",s,a),this},_getMapPanePos:function(){return Vn(this._mapPane)||new at(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,a){var u=s&&a!==void 0?this._getNewPixelOrigin(s,a):this.getPixelOrigin();return u.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,a){var u=this.getSize()._divideBy(2);return this.project(s,a)._subtract(u)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,a,u){var f=this._getNewPixelOrigin(u,a);return this.project(s,a)._subtract(f)},_latLngBoundsToNewLayerBounds:function(s,a,u){var f=this._getNewPixelOrigin(u,a);return Ht([this.project(s.getSouthWest(),a)._subtract(f),this.project(s.getNorthWest(),a)._subtract(f),this.project(s.getSouthEast(),a)._subtract(f),this.project(s.getNorthEast(),a)._subtract(f)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,a,u){if(!u)return s;var f=this.project(s,a),g=this.getSize().divideBy(2),w=new Gt(f.subtract(g),f.add(g)),x=this._getBoundsOffset(w,u,a);return Math.abs(x.x)<=1&&Math.abs(x.y)<=1?s:this.unproject(f.add(x),a)},_limitOffset:function(s,a){if(!a)return s;var u=this.getPixelBounds(),f=new Gt(u.min.add(s),u.max.add(s));return s.add(this._getBoundsOffset(f,a))},_getBoundsOffset:function(s,a,u){var f=Ht(this.project(a.getNorthEast(),u),this.project(a.getSouthWest(),u)),g=f.min.subtract(s.min),w=f.max.subtract(s.max),x=this._rebound(g.x,-w.x),F=this._rebound(g.y,-w.y);return new at(x,F)},_rebound:function(s,a){return s+a>0?Math.round(s-a)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(a))},_limitZoom:function(s){var a=this.getMinZoom(),u=this.getMaxZoom(),f=gt.any3d?this.options.zoomSnap:1;return f&&(s=Math.round(s/f)*f),Math.max(a,Math.min(u,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ye(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,a){var u=this._getCenterOffset(s)._trunc();return(a&&a.animate)!==!0&&!this.getSize().contains(u)?!1:(this.panBy(u,a),!0)},_createAnimProxy:function(){var s=this._proxy=Qt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(a){var u=Qs,f=this._proxy.style[u];ai(this._proxy,this.project(a.center,a.zoom),this.getZoomScale(a.zoom,1)),f===this._proxy.style[u]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ue(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),a=this.getZoom();ai(this._proxy,this.project(s,a),this.getZoomScale(a,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,a,u){if(this._animatingZoom)return!0;if(u=u||{},!this._zoomAnimated||u.animate===!1||this._nothingToAnimate()||Math.abs(a-this._zoom)>this.options.zoomAnimationThreshold)return!1;var f=this.getZoomScale(a),g=this._getCenterOffset(s)._divideBy(1-1/f);return u.animate!==!0&&!this.getSize().contains(g)?!1:(O(function(){this._moveStart(!0,u.noMoveStart||!1)._animateZoom(s,a,!0)},this),!0)},_animateZoom:function(s,a,u,f){this._mapPane&&(u&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=a,Vt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:a,noUpdate:f}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ye(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Mr(s,a){return new Kt(s,a)}var vn=_e.extend({options:{position:"topright"},initialize:function(s){B(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var a=this._map;return a&&a.removeControl(this),this.options.position=s,a&&a.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var a=this._container=this.onAdd(s),u=this.getPosition(),f=s._controlCorners[u];return Vt(a,"leaflet-control"),u.indexOf("bottom")!==-1?f.insertBefore(a,f.firstChild):f.appendChild(a),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ue(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),un=function(s){return new vn(s)};Kt.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},a="leaflet-",u=this._controlContainer=Qt("div",a+"control-container",this._container);function f(g,w){var x=a+g+" "+a+w;s[g+w]=Qt("div",x,u)}f("top","left"),f("top","right"),f("bottom","left"),f("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)ue(this._controlCorners[s]);ue(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Jo=vn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,a,u,f){return u<f?-1:f<u?1:0}},initialize:function(s,a,u){B(this,u),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var f in s)this._addLayer(s[f],f);for(f in a)this._addLayer(a[f],f,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return vn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,a){return this._addLayer(s,a),this._map?this._update():this},addOverlay:function(s,a){return this._addLayer(s,a,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var a=this._getLayer(d(s));return a&&this._layers.splice(this._layers.indexOf(a),1),this._map?this._update():this},expand:function(){Vt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(Vt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):ye(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ye(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",a=this._container=Qt("div",s),u=this.options.collapsed;a.setAttribute("aria-haspopup",!0),ls(a),as(a);var f=this._section=Qt("section",s+"-list");u&&(this._map.on("click",this.collapse,this),Ct(a,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var g=this._layersLink=Qt("a",s+"-toggle",a);g.href="#",g.title="Layers",g.setAttribute("role","button"),Ct(g,{keydown:function(w){w.keyCode===13&&this._expandSafely()},click:function(w){Ee(w),this._expandSafely()}},this),u||this.expand(),this._baseLayersList=Qt("div",s+"-base",f),this._separator=Qt("div",s+"-separator",f),this._overlaysList=Qt("div",s+"-overlays",f),a.appendChild(f)},_getLayer:function(s){for(var a=0;a<this._layers.length;a++)if(this._layers[a]&&d(this._layers[a].layer)===s)return this._layers[a]},_addLayer:function(s,a,u){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:a,overlay:u}),this.options.sortLayers&&this._layers.sort(l(function(f,g){return this.options.sortFunction(f.layer,g.layer,f.name,g.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Xs(this._baseLayersList),Xs(this._overlaysList),this._layerControlInputs=[];var s,a,u,f,g=0;for(u=0;u<this._layers.length;u++)f=this._layers[u],this._addItem(f),a=a||f.overlay,s=s||!f.overlay,g+=f.overlay?0:1;return this.options.hideSingleBase&&(s=s&&g>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=a&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var a=this._getLayer(d(s.target)),u=a.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;u&&this._map.fire(u,a)},_createRadioElement:function(s,a){var u='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(a?' checked="checked"':"")+"/>",f=document.createElement("div");return f.innerHTML=u,f.firstChild},_addItem:function(s){var a=document.createElement("label"),u=this._map.hasLayer(s.layer),f;s.overlay?(f=document.createElement("input"),f.type="checkbox",f.className="leaflet-control-layers-selector",f.defaultChecked=u):f=this._createRadioElement("leaflet-base-layers_"+d(this),u),this._layerControlInputs.push(f),f.layerId=d(s.layer),Ct(f,"click",this._onInputClick,this);var g=document.createElement("span");g.innerHTML=" "+s.name;var w=document.createElement("span");a.appendChild(w),w.appendChild(f),w.appendChild(g);var x=s.overlay?this._overlaysList:this._baseLayersList;return x.appendChild(a),this._checkDisabledLayers(),a},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,a,u,f=[],g=[];this._handlingClick=!0;for(var w=s.length-1;w>=0;w--)a=s[w],u=this._getLayer(a.layerId).layer,a.checked?f.push(u):a.checked||g.push(u);for(w=0;w<g.length;w++)this._map.hasLayer(g[w])&&this._map.removeLayer(g[w]);for(w=0;w<f.length;w++)this._map.hasLayer(f[w])||this._map.addLayer(f[w]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,a,u,f=this._map.getZoom(),g=s.length-1;g>=0;g--)a=s[g],u=this._getLayer(a.layerId).layer,a.disabled=u.options.minZoom!==void 0&&f<u.options.minZoom||u.options.maxZoom!==void 0&&f>u.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,Ct(s,"click",Ee),this.expand();var a=this;setTimeout(function(){le(s,"click",Ee),a._preventClick=!1})}}),Nu=function(s,a,u){return new Jo(s,a,u)},Oi=vn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var a="leaflet-control-zoom",u=Qt("div",a+" leaflet-bar"),f=this.options;return this._zoomInButton=this._createButton(f.zoomInText,f.zoomInTitle,a+"-in",u,this._zoomIn),this._zoomOutButton=this._createButton(f.zoomOutText,f.zoomOutTitle,a+"-out",u,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),u},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,a,u,f,g){var w=Qt("a",u,f);return w.innerHTML=s,w.href="#",w.title=a,w.setAttribute("role","button"),w.setAttribute("aria-label",a),ls(w),Ct(w,"click",An),Ct(w,"click",g,this),Ct(w,"click",this._refocusOnMap,this),w},_updateDisabled:function(){var s=this._map,a="leaflet-disabled";ye(this._zoomInButton,a),ye(this._zoomOutButton,a),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(Vt(this._zoomOutButton,a),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(Vt(this._zoomInButton,a),this._zoomInButton.setAttribute("aria-disabled","true"))}});Kt.mergeOptions({zoomControl:!0}),Kt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Oi,this.addControl(this.zoomControl))});var Ll=function(s){return new Oi(s)},Or=vn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var a="leaflet-control-scale",u=Qt("div",a),f=this.options;return this._addScales(f,a+"-line",u),s.on(f.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),u},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,a,u){s.metric&&(this._mScale=Qt("div",a,u)),s.imperial&&(this._iScale=Qt("div",a,u))},_update:function(){var s=this._map,a=s.getSize().y/2,u=s.distance(s.containerPointToLatLng([0,a]),s.containerPointToLatLng([this.options.maxWidth,a]));this._updateScales(u)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var a=this._getRoundNum(s),u=a<1e3?a+" m":a/1e3+" km";this._updateScale(this._mScale,u,a/s)},_updateImperial:function(s){var a=s*3.2808399,u,f,g;a>5280?(u=a/5280,f=this._getRoundNum(u),this._updateScale(this._iScale,f+" mi",f/u)):(g=this._getRoundNum(a),this._updateScale(this._iScale,g+" ft",g/a))},_updateScale:function(s,a,u){s.style.width=Math.round(this.options.maxWidth*u)+"px",s.innerHTML=a},_getRoundNum:function(s){var a=Math.pow(10,(Math.floor(s)+"").length-1),u=s/a;return u=u>=10?10:u>=5?5:u>=3?3:u>=2?2:1,a*u}}),Dr=function(s){return new Or(s)},Ml='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',cs=vn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(gt.inlineSvg?Ml+" ":"")+"Leaflet</a>"},initialize:function(s){B(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=Qt("div","leaflet-control-attribution"),ls(this._container);for(var a in s._layers)s._layers[a].getAttribution&&this.addAttribution(s._layers[a].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var a in this._attributions)this._attributions[a]&&s.push(a);var u=[];this.options.prefix&&u.push(this.options.prefix),s.length&&u.push(s.join(", ")),this._container.innerHTML=u.join(' <span aria-hidden="true">|</span> ')}}});Kt.mergeOptions({attributionControl:!0}),Kt.addInitHook(function(){this.options.attributionControl&&new cs().addTo(this)});var Vu=function(s){return new cs(s)};vn.Layers=Jo,vn.Zoom=Oi,vn.Scale=Or,vn.Attribution=cs,un.layers=Nu,un.zoom=Ll,un.scale=Dr,un.attribution=Vu;var Cn=_e.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Cn.addTo=function(s,a){return s.addHandler(a,this),this};var Js={Events:Jt},ta=gt.touch?"touchstart mousedown":"mousedown",Jn=Ft.extend({options:{clickTolerance:3},initialize:function(s,a,u,f){B(this,f),this._element=s,this._dragStartTarget=a||s,this._preventOutline=u},enable:function(){this._enabled||(Ct(this._dragStartTarget,ta,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Jn._dragging===this&&this.finishDrag(!0),le(this._dragStartTarget,ta,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!zo(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){Jn._dragging===this&&this.finishDrag();return}if(!(Jn._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(Jn._dragging=this,this._preventOutline&&Mi(this._element),$o(),Yn(),!this._moving)){this.fire("down");var a=s.touches?s.touches[0]:s,u=Ko(this._element);this._startPoint=new at(a.clientX,a.clientY),this._startPos=Vn(this._element),this._parentScale=kr(u);var f=s.type==="mousedown";Ct(document,f?"mousemove":"touchmove",this._onMove,this),Ct(document,f?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var a=s.touches&&s.touches.length===1?s.touches[0]:s,u=new at(a.clientX,a.clientY)._subtract(this._startPoint);!u.x&&!u.y||Math.abs(u.x)+Math.abs(u.y)<this.options.clickTolerance||(u.x/=this._parentScale.x,u.y/=this._parentScale.y,Ee(s),this._moved||(this.fire("dragstart"),this._moved=!0,Vt(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Vt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(u),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),Lt(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){ye(document.body,"leaflet-dragging"),this._lastTarget&&(ye(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),le(document,"mousemove touchmove",this._onMove,this),le(document,"mouseup touchend touchcancel",this._onUp,this),qo(),Xn();var a=this._moved&&this._moving;this._moving=!1,Jn._dragging=!1,a&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function Nr(s,a,u){var f,g=[1,4,2,8],w,x,F,z,Y,dt,Rt,qt;for(w=0,dt=s.length;w<dt;w++)s[w]._code=li(s[w],a);for(F=0;F<4;F++){for(Rt=g[F],f=[],w=0,dt=s.length,x=dt-1;w<dt;x=w++)z=s[w],Y=s[x],z._code&Rt?Y._code&Rt||(qt=je(Y,z,Rt,a,u),qt._code=li(qt,a),f.push(qt)):(Y._code&Rt&&(qt=je(Y,z,Rt,a,u),qt._code=li(qt,a),f.push(qt)),f.push(z));s=f}return s}function Vr(s,a){var u,f,g,w,x,F,z,Y,dt;if(!s||s.length===0)throw new Error("latlngs not passed");c(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Rt=At([0,0]),qt=oe(s),hn=qt.getNorthWest().distanceTo(qt.getSouthWest())*qt.getNorthEast().distanceTo(qt.getNorthWest());hn<1700&&(Rt=Ur(s));var He=s.length,jn=[];for(u=0;u<He;u++){var yn=At(s[u]);jn.push(a.project(At([yn.lat-Rt.lat,yn.lng-Rt.lng])))}for(F=z=Y=0,u=0,f=He-1;u<He;f=u++)g=jn[u],w=jn[f],x=g.y*w.x-w.y*g.x,z+=(g.x+w.x)*x,Y+=(g.y+w.y)*x,F+=x*3;F===0?dt=jn[0]:dt=[z/F,Y/F];var qr=a.unproject(vt(dt));return At([qr.lat+Rt.lat,qr.lng+Rt.lng])}function Ur(s){for(var a=0,u=0,f=0,g=0;g<s.length;g++){var w=At(s[g]);a+=w.lat,u+=w.lng,f++}return At([a/f,u/f])}var Fr={__proto__:null,clipPolygon:Nr,polygonCenter:Vr,centroid:Ur};function ea(s,a){if(!a||!s.length)return s.slice();var u=a*a;return s=Dl(s,u),s=Ol(s,u),s}function na(s,a,u){return Math.sqrt(zn(s,a,u,!0))}function Di(s,a,u){return zn(s,a,u)}function Ol(s,a){var u=s.length,f=typeof Uint8Array<"u"?Uint8Array:Array,g=new f(u);g[0]=g[u-1]=1,Br(s,g,a,0,u-1);var w,x=[];for(w=0;w<u;w++)g[w]&&x.push(s[w]);return x}function Br(s,a,u,f,g){var w=0,x,F,z;for(F=f+1;F<=g-1;F++)z=zn(s[F],s[f],s[g],!0),z>w&&(x=F,w=z);w>u&&(a[x]=1,Br(s,a,u,f,x),Br(s,a,u,x,g))}function Dl(s,a){for(var u=[s[0]],f=1,g=0,w=s.length;f<w;f++)Nl(s[f],s[g])>a&&(u.push(s[f]),g=f);return g<w-1&&u.push(s[w-1]),u}var ia;function tr(s,a,u,f,g){var w=f?ia:li(s,u),x=li(a,u),F,z,Y;for(ia=x;;){if(!(w|x))return[s,a];if(w&x)return!1;F=w||x,z=je(s,a,F,u,g),Y=li(z,u),F===w?(s=z,w=Y):(a=z,x=Y)}}function je(s,a,u,f,g){var w=a.x-s.x,x=a.y-s.y,F=f.min,z=f.max,Y,dt;return u&8?(Y=s.x+w*(z.y-s.y)/x,dt=z.y):u&4?(Y=s.x+w*(F.y-s.y)/x,dt=F.y):u&2?(Y=z.x,dt=s.y+x*(z.x-s.x)/w):u&1&&(Y=F.x,dt=s.y+x*(F.x-s.x)/w),new at(Y,dt,g)}function li(s,a){var u=0;return s.x<a.min.x?u|=1:s.x>a.max.x&&(u|=2),s.y<a.min.y?u|=4:s.y>a.max.y&&(u|=8),u}function Nl(s,a){var u=a.x-s.x,f=a.y-s.y;return u*u+f*f}function zn(s,a,u,f){var g=a.x,w=a.y,x=u.x-g,F=u.y-w,z=x*x+F*F,Y;return z>0&&(Y=((s.x-g)*x+(s.y-w)*F)/z,Y>1?(g=u.x,w=u.y):Y>0&&(g+=x*Y,w+=F*Y)),x=s.x-g,F=s.y-w,f?x*x+F*F:new at(g,w)}function c(s){return!Q(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function m(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),c(s)}function v(s,a){var u,f,g,w,x,F,z,Y;if(!s||s.length===0)throw new Error("latlngs not passed");c(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var dt=At([0,0]),Rt=oe(s),qt=Rt.getNorthWest().distanceTo(Rt.getSouthWest())*Rt.getNorthEast().distanceTo(Rt.getNorthWest());qt<1700&&(dt=Ur(s));var hn=s.length,He=[];for(u=0;u<hn;u++){var jn=At(s[u]);He.push(a.project(At([jn.lat-dt.lat,jn.lng-dt.lng])))}for(u=0,f=0;u<hn-1;u++)f+=He[u].distanceTo(He[u+1])/2;if(f===0)Y=He[0];else for(u=0,w=0;u<hn-1;u++)if(x=He[u],F=He[u+1],g=x.distanceTo(F),w+=g,w>f){z=(w-f)/g,Y=[F.x-z*(F.x-x.x),F.y-z*(F.y-x.y)];break}var yn=a.unproject(vt(Y));return At([yn.lat+dt.lat,yn.lng+dt.lng])}var b={__proto__:null,simplify:ea,pointToSegmentDistance:na,closestPointOnSegment:Di,clipSegment:tr,_getEdgeIntersection:je,_getBitCode:li,_sqClosestPointOnSegment:zn,isFlat:c,_flat:m,polylineCenter:v},V={project:function(s){return new at(s.lng,s.lat)},unproject:function(s){return new zt(s.y,s.x)},bounds:new Gt([-180,-90],[180,90])},H={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Gt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var a=Math.PI/180,u=this.R,f=s.lat*a,g=this.R_MINOR/u,w=Math.sqrt(1-g*g),x=w*Math.sin(f),F=Math.tan(Math.PI/4-f/2)/Math.pow((1-x)/(1+x),w/2);return f=-u*Math.log(Math.max(F,1e-10)),new at(s.lng*a*u,f)},unproject:function(s){for(var a=180/Math.PI,u=this.R,f=this.R_MINOR/u,g=Math.sqrt(1-f*f),w=Math.exp(-s.y/u),x=Math.PI/2-2*Math.atan(w),F=0,z=.1,Y;F<15&&Math.abs(z)>1e-7;F++)Y=g*Math.sin(x),Y=Math.pow((1-Y)/(1+Y),g/2),z=Math.PI/2-2*Math.atan(w*Y)-x,x+=z;return new zt(x*a,s.x*a/u)}},st={__proto__:null,LonLat:V,Mercator:H,SphericalMercator:mt},ae=r({},ct,{code:"EPSG:3395",projection:H,transformation:function(){var s=.5/(Math.PI*H.R);return A(s,.5,-s,.5)}()}),Me=r({},ct,{code:"EPSG:4326",projection:V,transformation:A(1/180,1,-1/180,.5)}),te=r({},$,{projection:V,transformation:A(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,a){var u=a.lng-s.lng,f=a.lat-s.lat;return Math.sqrt(u*u+f*f)},infinite:!0});$.Earth=ct,$.EPSG3395=ae,$.EPSG3857=C,$.EPSG900913=N,$.EPSG4326=Me,$.Simple=te;var ce=Ft.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[d(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[d(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var a=s.target;if(a.hasLayer(this)){if(this._map=a,this._zoomAnimated=a._zoomAnimated,this.getEvents){var u=this.getEvents();a.on(u,this),this.once("remove",function(){a.off(u,this)},this)}this.onAdd(a),this.fire("add"),a.fire("layeradd",{layer:this})}}});Kt.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var a=d(s);return this._layers[a]?this:(this._layers[a]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var a=d(s);return this._layers[a]?(this._loaded&&s.onRemove(this),delete this._layers[a],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return d(s)in this._layers},eachLayer:function(s,a){for(var u in this._layers)s.call(a,this._layers[u]);return this},_addLayers:function(s){s=s?Q(s)?s:[s]:[];for(var a=0,u=s.length;a<u;a++)this.addLayer(s[a])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[d(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var a=d(s);this._zoomBoundLayers[a]&&(delete this._zoomBoundLayers[a],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,a=-1/0,u=this._getZoomSpan();for(var f in this._zoomBoundLayers){var g=this._zoomBoundLayers[f].options;s=g.minZoom===void 0?s:Math.min(s,g.minZoom),a=g.maxZoom===void 0?a:Math.max(a,g.maxZoom)}this._layersMaxZoom=a===-1/0?void 0:a,this._layersMinZoom=s===1/0?void 0:s,u!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var be=ce.extend({initialize:function(s,a){B(this,a),this._layers={};var u,f;if(s)for(u=0,f=s.length;u<f;u++)this.addLayer(s[u])},addLayer:function(s){var a=this.getLayerId(s);return this._layers[a]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var a=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[a]&&this._map.removeLayer(this._layers[a]),delete this._layers[a],this},hasLayer:function(s){var a=typeof s=="number"?s:this.getLayerId(s);return a in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var a=Array.prototype.slice.call(arguments,1),u,f;for(u in this._layers)f=this._layers[u],f[s]&&f[s].apply(f,a);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,a){for(var u in this._layers)s.call(a,this._layers[u]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return d(s)}}),us=function(s,a){return new be(s,a)},Se=be.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),be.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),be.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new $t;for(var a in this._layers){var u=this._layers[a];s.extend(u.getBounds?u.getBounds():u.getLatLng())}return s}}),zr=function(s,a){return new Se(s,a)},ci=_e.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){B(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,a){var u=this._getIconUrl(s);if(!u){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var f=this._createImg(u,a&&a.tagName==="IMG"?a:null);return this._setIconStyles(f,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),f},_setIconStyles:function(s,a){var u=this.options,f=u[a+"Size"];typeof f=="number"&&(f=[f,f]);var g=vt(f),w=vt(a==="shadow"&&u.shadowAnchor||u.iconAnchor||g&&g.divideBy(2,!0));s.className="leaflet-marker-"+a+" "+(u.className||""),w&&(s.style.marginLeft=-w.x+"px",s.style.marginTop=-w.y+"px"),g&&(s.style.width=g.x+"px",s.style.height=g.y+"px")},_createImg:function(s,a){return a=a||document.createElement("img"),a.src=s,a},_getIconUrl:function(s){return gt.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function Hw(s){return new ci(s)}var sa=ci.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof sa.imagePath!="string"&&(sa.imagePath=this._detectIconPath()),(this.options.imagePath||sa.imagePath)+ci.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var a=function(u,f,g){var w=f.exec(u);return w&&w[g]};return s=a(s,/^url\((['"])?(.+)\1\)$/,2),s&&a(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=Qt("div","leaflet-default-icon-path",document.body),a=ss(s,"background-image")||ss(s,"backgroundImage");if(document.body.removeChild(s),a=this._stripUrl(a),a)return a;var u=document.querySelector('link[href$="leaflet.css"]');return u?u.href.substring(0,u.href.length-11-1):""}}),xf=Cn.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new Jn(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Vt(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ye(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var a=this._marker,u=a._map,f=this._marker.options.autoPanSpeed,g=this._marker.options.autoPanPadding,w=Vn(a._icon),x=u.getPixelBounds(),F=u.getPixelOrigin(),z=Ht(x.min._subtract(F).add(g),x.max._subtract(F).subtract(g));if(!z.contains(w)){var Y=vt((Math.max(z.max.x,w.x)-z.max.x)/(x.max.x-z.max.x)-(Math.min(z.min.x,w.x)-z.min.x)/(x.min.x-z.min.x),(Math.max(z.max.y,w.y)-z.max.y)/(x.max.y-z.max.y)-(Math.min(z.min.y,w.y)-z.min.y)/(x.min.y-z.min.y)).multiplyBy(f);u.panBy(Y,{animate:!1}),this._draggable._newPos._add(Y),this._draggable._startPos._add(Y),Lt(a._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=O(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(D(this._panRequest),this._panRequest=O(this._adjustPan.bind(this,s)))},_onDrag:function(s){var a=this._marker,u=a._shadow,f=Vn(a._icon),g=a._map.layerPointToLatLng(f);u&&Lt(u,f),a._latlng=g,s.latlng=g,s.oldLatLng=this._oldLatLng,a.fire("move",s).fire("drag",s)},_onDragEnd:function(s){D(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Vl=ce.extend({options:{icon:new sa,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,a){B(this,a),this._latlng=At(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var a=this._latlng;return this._latlng=At(s),this.update(),this.fire("move",{oldLatLng:a,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,a="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),u=s.icon.createIcon(this._icon),f=!1;u!==this._icon&&(this._icon&&this._removeIcon(),f=!0,s.title&&(u.title=s.title),u.tagName==="IMG"&&(u.alt=s.alt||"")),Vt(u,a),s.keyboard&&(u.tabIndex="0",u.setAttribute("role","button")),this._icon=u,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ct(u,"focus",this._panOnFocus,this);var g=s.icon.createShadow(this._shadow),w=!1;g!==this._shadow&&(this._removeShadow(),w=!0),g&&(Vt(g,a),g.alt=""),this._shadow=g,s.opacity<1&&this._updateOpacity(),f&&this.getPane().appendChild(this._icon),this._initInteraction(),g&&w&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&le(this._icon,"focus",this._panOnFocus,this),ue(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ue(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&Lt(this._icon,s),this._shadow&&Lt(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var a=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(a)},_initInteraction:function(){if(this.options.interactive&&(Vt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),xf)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new xf(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&Pe(this._icon,s),this._shadow&&Pe(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var a=this.options.icon.options,u=a.iconSize?vt(a.iconSize):vt(0,0),f=a.iconAnchor?vt(a.iconAnchor):vt(0,0);s.panInside(this._latlng,{paddingTopLeft:f,paddingBottomRight:u.subtract(f)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function $w(s,a){return new Vl(s,a)}var hs=ce.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return B(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ul=hs.extend({options:{fill:!0,radius:10},initialize:function(s,a){B(this,a),this._latlng=At(s),this._radius=this.options.radius},setLatLng:function(s){var a=this._latlng;return this._latlng=At(s),this.redraw(),this.fire("move",{oldLatLng:a,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var a=s&&s.radius||this._radius;return hs.prototype.setStyle.call(this,s),this.setRadius(a),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,a=this._radiusY||s,u=this._clickTolerance(),f=[s+u,a+u];this._pxBounds=new Gt(this._point.subtract(f),this._point.add(f))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function qw(s,a){return new Ul(s,a)}var Uu=Ul.extend({initialize:function(s,a,u){if(typeof a=="number"&&(a=r({},u,{radius:a})),B(this,a),this._latlng=At(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new $t(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:hs.prototype.setStyle,_project:function(){var s=this._latlng.lng,a=this._latlng.lat,u=this._map,f=u.options.crs;if(f.distance===ct.distance){var g=Math.PI/180,w=this._mRadius/ct.R/g,x=u.project([a+w,s]),F=u.project([a-w,s]),z=x.add(F).divideBy(2),Y=u.unproject(z).lat,dt=Math.acos((Math.cos(w*g)-Math.sin(a*g)*Math.sin(Y*g))/(Math.cos(a*g)*Math.cos(Y*g)))/g;(isNaN(dt)||dt===0)&&(dt=w/Math.cos(Math.PI/180*a)),this._point=z.subtract(u.getPixelOrigin()),this._radius=isNaN(dt)?0:z.x-u.project([Y,s-dt]).x,this._radiusY=z.y-x.y}else{var Rt=f.unproject(f.project(this._latlng).subtract([this._mRadius,0]));this._point=u.latLngToLayerPoint(this._latlng),this._radius=this._point.x-u.latLngToLayerPoint(Rt).x}this._updateBounds()}});function Ww(s,a,u){return new Uu(s,a,u)}var Ni=hs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,a){B(this,a),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var a=1/0,u=null,f=zn,g,w,x=0,F=this._parts.length;x<F;x++)for(var z=this._parts[x],Y=1,dt=z.length;Y<dt;Y++){g=z[Y-1],w=z[Y];var Rt=f(s,g,w,!0);Rt<a&&(a=Rt,u=f(s,g,w))}return u&&(u.distance=Math.sqrt(a)),u},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return v(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,a){return a=a||this._defaultShape(),s=At(s),a.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new $t,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return c(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var a=[],u=c(s),f=0,g=s.length;f<g;f++)u?(a[f]=At(s[f]),this._bounds.extend(a[f])):a[f]=this._convertLatLngs(s[f]);return a},_project:function(){var s=new Gt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),a=new at(s,s);this._rawPxBounds&&(this._pxBounds=new Gt([this._rawPxBounds.min.subtract(a),this._rawPxBounds.max.add(a)]))},_projectLatlngs:function(s,a,u){var f=s[0]instanceof zt,g=s.length,w,x;if(f){for(x=[],w=0;w<g;w++)x[w]=this._map.latLngToLayerPoint(s[w]),u.extend(x[w]);a.push(x)}else for(w=0;w<g;w++)this._projectLatlngs(s[w],a,u)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var a=this._parts,u,f,g,w,x,F,z;for(u=0,g=0,w=this._rings.length;u<w;u++)for(z=this._rings[u],f=0,x=z.length;f<x-1;f++)F=tr(z[f],z[f+1],s,f,!0),F&&(a[g]=a[g]||[],a[g].push(F[0]),(F[1]!==z[f+1]||f===x-2)&&(a[g].push(F[1]),g++))}},_simplifyPoints:function(){for(var s=this._parts,a=this.options.smoothFactor,u=0,f=s.length;u<f;u++)s[u]=ea(s[u],a)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,a){var u,f,g,w,x,F,z=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(u=0,w=this._parts.length;u<w;u++)for(F=this._parts[u],f=0,x=F.length,g=x-1;f<x;g=f++)if(!(!a&&f===0)&&na(s,F[g],F[f])<=z)return!0;return!1}});function Kw(s,a){return new Ni(s,a)}Ni._flat=m;var jr=Ni.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Vr(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var a=Ni.prototype._convertLatLngs.call(this,s),u=a.length;return u>=2&&a[0]instanceof zt&&a[0].equals(a[u-1])&&a.pop(),a},_setLatLngs:function(s){Ni.prototype._setLatLngs.call(this,s),c(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return c(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,a=this.options.weight,u=new at(a,a);if(s=new Gt(s.min.subtract(u),s.max.add(u)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var f=0,g=this._rings.length,w;f<g;f++)w=Nr(this._rings[f],s,!0),w.length&&this._parts.push(w)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var a=!1,u,f,g,w,x,F,z,Y;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(w=0,z=this._parts.length;w<z;w++)for(u=this._parts[w],x=0,Y=u.length,F=Y-1;x<Y;F=x++)f=u[x],g=u[F],f.y>s.y!=g.y>s.y&&s.x<(g.x-f.x)*(s.y-f.y)/(g.y-f.y)+f.x&&(a=!a);return a||Ni.prototype._containsPoint.call(this,s,!0)}});function Gw(s,a){return new jr(s,a)}var Vi=Se.extend({initialize:function(s,a){B(this,a),this._layers={},s&&this.addData(s)},addData:function(s){var a=Q(s)?s:s.features,u,f,g;if(a){for(u=0,f=a.length;u<f;u++)g=a[u],(g.geometries||g.geometry||g.features||g.coordinates)&&this.addData(g);return this}var w=this.options;if(w.filter&&!w.filter(s))return this;var x=Fl(s,w);return x?(x.feature=jl(s),x.defaultOptions=x.options,this.resetStyle(x),w.onEachFeature&&w.onEachFeature(s,x),this.addLayer(x)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=r({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(a){this._setLayerStyle(a,s)},this)},_setLayerStyle:function(s,a){s.setStyle&&(typeof a=="function"&&(a=a(s.feature)),s.setStyle(a))}});function Fl(s,a){var u=s.type==="Feature"?s.geometry:s,f=u?u.coordinates:null,g=[],w=a&&a.pointToLayer,x=a&&a.coordsToLatLng||Fu,F,z,Y,dt;if(!f&&!u)return null;switch(u.type){case"Point":return F=x(f),kf(w,s,F,a);case"MultiPoint":for(Y=0,dt=f.length;Y<dt;Y++)F=x(f[Y]),g.push(kf(w,s,F,a));return new Se(g);case"LineString":case"MultiLineString":return z=Bl(f,u.type==="LineString"?0:1,x),new Ni(z,a);case"Polygon":case"MultiPolygon":return z=Bl(f,u.type==="Polygon"?1:2,x),new jr(z,a);case"GeometryCollection":for(Y=0,dt=u.geometries.length;Y<dt;Y++){var Rt=Fl({geometry:u.geometries[Y],type:"Feature",properties:s.properties},a);Rt&&g.push(Rt)}return new Se(g);case"FeatureCollection":for(Y=0,dt=u.features.length;Y<dt;Y++){var qt=Fl(u.features[Y],a);qt&&g.push(qt)}return new Se(g);default:throw new Error("Invalid GeoJSON object.")}}function kf(s,a,u,f){return s?s(a,u):new Vl(u,f&&f.markersInheritOptions&&f)}function Fu(s){return new zt(s[1],s[0],s[2])}function Bl(s,a,u){for(var f=[],g=0,w=s.length,x;g<w;g++)x=a?Bl(s[g],a-1,u):(u||Fu)(s[g]),f.push(x);return f}function Bu(s,a){return s=At(s),s.alt!==void 0?[T(s.lng,a),T(s.lat,a),T(s.alt,a)]:[T(s.lng,a),T(s.lat,a)]}function zl(s,a,u,f){for(var g=[],w=0,x=s.length;w<x;w++)g.push(a?zl(s[w],c(s[w])?0:a-1,u,f):Bu(s[w],f));return!a&&u&&g.length>0&&g.push(g[0].slice()),g}function Hr(s,a){return s.feature?r({},s.feature,{geometry:a}):jl(a)}function jl(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var zu={toGeoJSON:function(s){return Hr(this,{type:"Point",coordinates:Bu(this.getLatLng(),s)})}};Vl.include(zu),Uu.include(zu),Ul.include(zu),Ni.include({toGeoJSON:function(s){var a=!c(this._latlngs),u=zl(this._latlngs,a?1:0,!1,s);return Hr(this,{type:(a?"Multi":"")+"LineString",coordinates:u})}}),jr.include({toGeoJSON:function(s){var a=!c(this._latlngs),u=a&&!c(this._latlngs[0]),f=zl(this._latlngs,u?2:a?1:0,!0,s);return a||(f=[f]),Hr(this,{type:(u?"Multi":"")+"Polygon",coordinates:f})}}),be.include({toMultiPoint:function(s){var a=[];return this.eachLayer(function(u){a.push(u.toGeoJSON(s).geometry.coordinates)}),Hr(this,{type:"MultiPoint",coordinates:a})},toGeoJSON:function(s){var a=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(a==="MultiPoint")return this.toMultiPoint(s);var u=a==="GeometryCollection",f=[];return this.eachLayer(function(g){if(g.toGeoJSON){var w=g.toGeoJSON(s);if(u)f.push(w.geometry);else{var x=jl(w);x.type==="FeatureCollection"?f.push.apply(f,x.features):f.push(x)}}}),u?Hr(this,{geometries:f,type:"GeometryCollection"}):{type:"FeatureCollection",features:f}}});function Lf(s,a){return new Vi(s,a)}var Zw=Lf,Hl=ce.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,a,u){this._url=s,this._bounds=oe(a),B(this,u)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Vt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ue(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&ki(this._image),this},bringToBack:function(){return this._map&&rs(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=oe(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",a=this._image=s?this._url:Qt("img");if(Vt(a,"leaflet-image-layer"),this._zoomAnimated&&Vt(a,"leaflet-zoom-animated"),this.options.className&&Vt(a,this.options.className),a.onselectstart=y,a.onmousemove=y,a.onload=l(this.fire,this,"load"),a.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(a.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=a.src;return}a.src=this._url,a.alt=this.options.alt},_animateZoom:function(s){var a=this._map.getZoomScale(s.zoom),u=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;ai(this._image,u,a)},_reset:function(){var s=this._image,a=new Gt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),u=a.getSize();Lt(s,a.min),s.style.width=u.x+"px",s.style.height=u.y+"px"},_updateOpacity:function(){Pe(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),Qw=function(s,a,u){return new Hl(s,a,u)},Mf=Hl.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",a=this._image=s?this._url:Qt("video");if(Vt(a,"leaflet-image-layer"),this._zoomAnimated&&Vt(a,"leaflet-zoom-animated"),this.options.className&&Vt(a,this.options.className),a.onselectstart=y,a.onmousemove=y,a.onloadeddata=l(this.fire,this,"load"),s){for(var u=a.getElementsByTagName("source"),f=[],g=0;g<u.length;g++)f.push(u[g].src);this._url=u.length>0?f:[a.src];return}Q(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(a.style,"objectFit")&&(a.style.objectFit="fill"),a.autoplay=!!this.options.autoplay,a.loop=!!this.options.loop,a.muted=!!this.options.muted,a.playsInline=!!this.options.playsInline;for(var w=0;w<this._url.length;w++){var x=Qt("source");x.src=this._url[w],a.appendChild(x)}}});function Yw(s,a,u){return new Mf(s,a,u)}var Of=Hl.extend({_initImage:function(){var s=this._image=this._url;Vt(s,"leaflet-image-layer"),this._zoomAnimated&&Vt(s,"leaflet-zoom-animated"),this.options.className&&Vt(s,this.options.className),s.onselectstart=y,s.onmousemove=y}});function Xw(s,a,u){return new Of(s,a,u)}var ui=ce.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,a){s&&(s instanceof zt||Q(s))?(this._latlng=At(s),B(this,a)):(B(this,s),this._source=a),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&Pe(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&Pe(this._container,1),this.bringToFront(),this.options.interactive&&(Vt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(Pe(this._container,0),this._removeTimeout=setTimeout(l(ue,void 0,this._container),200)):ue(this._container),this.options.interactive&&(ye(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=At(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ki(this._container),this},bringToBack:function(){return this._map&&rs(this._container),this},_prepareOpen:function(s){var a=this._source;if(!a._map)return!1;if(a instanceof Se){a=null;var u=this._source._layers;for(var f in u)if(u[f]._map){a=u[f];break}if(!a)return!1;this._source=a}if(!s)if(a.getCenter)s=a.getCenter();else if(a.getLatLng)s=a.getLatLng();else if(a.getBounds)s=a.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,a=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof a=="string")s.innerHTML=a;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(a)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),a=vt(this.options.offset),u=this._getAnchor();this._zoomAnimated?Lt(this._container,s.add(u)):a=a.add(s).add(u);var f=this._containerBottom=-a.y,g=this._containerLeft=-Math.round(this._containerWidth/2)+a.x;this._container.style.bottom=f+"px",this._container.style.left=g+"px"}},_getAnchor:function(){return[0,0]}});Kt.include({_initOverlay:function(s,a,u,f){var g=a;return g instanceof s||(g=new s(f).setContent(a)),u&&g.setLatLng(u),g}}),ce.include({_initOverlay:function(s,a,u,f){var g=u;return g instanceof s?(B(g,f),g._source=this):(g=a&&!f?a:new s(f,this),g.setContent(u)),g}});var $l=ui.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,ui.prototype.openOn.call(this,s)},onAdd:function(s){ui.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof hs||this._source.on("preclick",Bn))},onRemove:function(s){ui.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof hs||this._source.off("preclick",Bn))},getEvents:function(){var s=ui.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",a=this._container=Qt("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),u=this._wrapper=Qt("div",s+"-content-wrapper",a);if(this._contentNode=Qt("div",s+"-content",u),ls(a),as(this._contentNode),Ct(a,"contextmenu",Bn),this._tipContainer=Qt("div",s+"-tip-container",a),this._tip=Qt("div",s+"-tip",this._tipContainer),this.options.closeButton){var f=this._closeButton=Qt("a",s+"-close-button",a);f.setAttribute("role","button"),f.setAttribute("aria-label","Close popup"),f.href="#close",f.innerHTML='<span aria-hidden="true">&#215;</span>',Ct(f,"click",function(g){Ee(g),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,a=s.style;a.width="",a.whiteSpace="nowrap";var u=s.offsetWidth;u=Math.min(u,this.options.maxWidth),u=Math.max(u,this.options.minWidth),a.width=u+1+"px",a.whiteSpace="",a.height="";var f=s.offsetHeight,g=this.options.maxHeight,w="leaflet-popup-scrolled";g&&f>g?(a.height=g+"px",Vt(s,w)):ye(s,w),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var a=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),u=this._getAnchor();Lt(this._container,a.add(u))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,a=parseInt(ss(this._container,"marginBottom"),10)||0,u=this._container.offsetHeight+a,f=this._containerWidth,g=new at(this._containerLeft,-u-this._containerBottom);g._add(Vn(this._container));var w=s.layerPointToContainerPoint(g),x=vt(this.options.autoPanPadding),F=vt(this.options.autoPanPaddingTopLeft||x),z=vt(this.options.autoPanPaddingBottomRight||x),Y=s.getSize(),dt=0,Rt=0;w.x+f+z.x>Y.x&&(dt=w.x+f-Y.x+z.x),w.x-dt-F.x<0&&(dt=w.x-F.x),w.y+u+z.y>Y.y&&(Rt=w.y+u-Y.y+z.y),w.y-Rt-F.y<0&&(Rt=w.y-F.y),(dt||Rt)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([dt,Rt]))}},_getAnchor:function(){return vt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Jw=function(s,a){return new $l(s,a)};Kt.mergeOptions({closePopupOnClick:!0}),Kt.include({openPopup:function(s,a,u){return this._initOverlay($l,s,a,u).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),ce.include({bindPopup:function(s,a){return this._popup=this._initOverlay($l,this._popup,s,a),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof Se||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){An(s);var a=s.layer||s.target;if(this._popup._source===a&&!(a instanceof hs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=a,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var ql=ui.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){ui.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){ui.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=ui.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",a=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Qt("div",a),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var a,u,f=this._map,g=this._container,w=f.latLngToContainerPoint(f.getCenter()),x=f.layerPointToContainerPoint(s),F=this.options.direction,z=g.offsetWidth,Y=g.offsetHeight,dt=vt(this.options.offset),Rt=this._getAnchor();F==="top"?(a=z/2,u=Y):F==="bottom"?(a=z/2,u=0):F==="center"?(a=z/2,u=Y/2):F==="right"?(a=0,u=Y/2):F==="left"?(a=z,u=Y/2):x.x<w.x?(F="right",a=0,u=Y/2):(F="left",a=z+(dt.x+Rt.x)*2,u=Y/2),s=s.subtract(vt(a,u,!0)).add(dt).add(Rt),ye(g,"leaflet-tooltip-right"),ye(g,"leaflet-tooltip-left"),ye(g,"leaflet-tooltip-top"),ye(g,"leaflet-tooltip-bottom"),Vt(g,"leaflet-tooltip-"+F),Lt(g,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&Pe(this._container,s)},_animateZoom:function(s){var a=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(a)},_getAnchor:function(){return vt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),tT=function(s,a){return new ql(s,a)};Kt.include({openTooltip:function(s,a,u){return this._initOverlay(ql,s,a,u).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),ce.include({bindTooltip:function(s,a){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(ql,this._tooltip,s,a),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var a=s?"off":"on",u={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?u.add=this._openTooltip:(u.mouseover=this._openTooltip,u.mouseout=this.closeTooltip,u.click=this._openTooltip,this._map?this._addFocusListeners():u.add=this._addFocusListeners),this._tooltip.options.sticky&&(u.mousemove=this._moveTooltip),this[a](u),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof Se||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var a=typeof s.getElement=="function"&&s.getElement();a&&(Ct(a,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),Ct(a,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var a=typeof s.getElement=="function"&&s.getElement();a&&a.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var a=this;this._map.once("moveend",function(){a._openOnceFlag=!1,a._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var a=s.latlng,u,f;this._tooltip.options.sticky&&s.originalEvent&&(u=this._map.mouseEventToContainerPoint(s.originalEvent),f=this._map.containerPointToLayerPoint(u),a=this._map.layerPointToLatLng(f)),this._tooltip.setLatLng(a)}});var Df=ci.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var a=s&&s.tagName==="DIV"?s:document.createElement("div"),u=this.options;if(u.html instanceof Element?(Xs(a),a.appendChild(u.html)):a.innerHTML=u.html!==!1?u.html:"",u.bgPos){var f=vt(u.bgPos);a.style.backgroundPosition=-f.x+"px "+-f.y+"px"}return this._setIconStyles(a,"icon"),a},createShadow:function(){return null}});function eT(s){return new Df(s)}ci.Default=sa;var ra=ce.extend({options:{tileSize:256,opacity:1,updateWhenIdle:gt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){B(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),ue(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ki(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(rs(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof at?s:new at(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var a=this.getPane().children,u=-s(-1/0,1/0),f=0,g=a.length,w;f<g;f++)w=a[f].style.zIndex,a[f]!==this._container&&w&&(u=s(u,+w));isFinite(u)&&(this.options.zIndex=u+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!gt.ielt9){Pe(this._container,this.options.opacity);var s=+new Date,a=!1,u=!1;for(var f in this._tiles){var g=this._tiles[f];if(!(!g.current||!g.loaded)){var w=Math.min(1,(s-g.loaded)/200);Pe(g.el,w),w<1?a=!0:(g.active?u=!0:this._onOpaqueTile(g),g.active=!0)}}u&&!this._noPrune&&this._pruneTiles(),a&&(D(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this))}},_onOpaqueTile:y,_initContainer:function(){this._container||(this._container=Qt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,a=this.options.maxZoom;if(s!==void 0){for(var u in this._levels)u=Number(u),this._levels[u].el.children.length||u===s?(this._levels[u].el.style.zIndex=a-Math.abs(s-u),this._onUpdateLevel(u)):(ue(this._levels[u].el),this._removeTilesAtZoom(u),this._onRemoveLevel(u),delete this._levels[u]);var f=this._levels[s],g=this._map;return f||(f=this._levels[s]={},f.el=Qt("div","leaflet-tile-container leaflet-zoom-animated",this._container),f.el.style.zIndex=a,f.origin=g.project(g.unproject(g.getPixelOrigin()),s).round(),f.zoom=s,this._setZoomTransform(f,g.getCenter(),g.getZoom()),y(f.el.offsetWidth),this._onCreateLevel(f)),this._level=f,f}},_onUpdateLevel:y,_onRemoveLevel:y,_onCreateLevel:y,_pruneTiles:function(){if(this._map){var s,a,u=this._map.getZoom();if(u>this.options.maxZoom||u<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)a=this._tiles[s],a.retain=a.current;for(s in this._tiles)if(a=this._tiles[s],a.current&&!a.active){var f=a.coords;this._retainParent(f.x,f.y,f.z,f.z-5)||this._retainChildren(f.x,f.y,f.z,f.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var a in this._tiles)this._tiles[a].coords.z===s&&this._removeTile(a)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)ue(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,a,u,f){var g=Math.floor(s/2),w=Math.floor(a/2),x=u-1,F=new at(+g,+w);F.z=+x;var z=this._tileCoordsToKey(F),Y=this._tiles[z];return Y&&Y.active?(Y.retain=!0,!0):(Y&&Y.loaded&&(Y.retain=!0),x>f?this._retainParent(g,w,x,f):!1)},_retainChildren:function(s,a,u,f){for(var g=2*s;g<2*s+2;g++)for(var w=2*a;w<2*a+2;w++){var x=new at(g,w);x.z=u+1;var F=this._tileCoordsToKey(x),z=this._tiles[F];if(z&&z.active){z.retain=!0;continue}else z&&z.loaded&&(z.retain=!0);u+1<f&&this._retainChildren(g,w,u+1,f)}},_resetView:function(s){var a=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),a,a)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var a=this.options;return a.minNativeZoom!==void 0&&s<a.minNativeZoom?a.minNativeZoom:a.maxNativeZoom!==void 0&&a.maxNativeZoom<s?a.maxNativeZoom:s},_setView:function(s,a,u,f){var g=Math.round(a);this.options.maxZoom!==void 0&&g>this.options.maxZoom||this.options.minZoom!==void 0&&g<this.options.minZoom?g=void 0:g=this._clampZoom(g);var w=this.options.updateWhenZooming&&g!==this._tileZoom;(!f||w)&&(this._tileZoom=g,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),g!==void 0&&this._update(s),u||this._pruneTiles(),this._noPrune=!!u),this._setZoomTransforms(s,a)},_setZoomTransforms:function(s,a){for(var u in this._levels)this._setZoomTransform(this._levels[u],s,a)},_setZoomTransform:function(s,a,u){var f=this._map.getZoomScale(u,s.zoom),g=s.origin.multiplyBy(f).subtract(this._map._getNewPixelOrigin(a,u)).round();gt.any3d?ai(s.el,g,f):Lt(s.el,g)},_resetGrid:function(){var s=this._map,a=s.options.crs,u=this._tileSize=this.getTileSize(),f=this._tileZoom,g=this._map.getPixelWorldBounds(this._tileZoom);g&&(this._globalTileRange=this._pxBoundsToTileRange(g)),this._wrapX=a.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,a.wrapLng[0]],f).x/u.x),Math.ceil(s.project([0,a.wrapLng[1]],f).x/u.y)],this._wrapY=a.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([a.wrapLat[0],0],f).y/u.x),Math.ceil(s.project([a.wrapLat[1],0],f).y/u.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var a=this._map,u=a._animatingZoom?Math.max(a._animateToZoom,a.getZoom()):a.getZoom(),f=a.getZoomScale(u,this._tileZoom),g=a.project(s,this._tileZoom).floor(),w=a.getSize().divideBy(f*2);return new Gt(g.subtract(w),g.add(w))},_update:function(s){var a=this._map;if(a){var u=this._clampZoom(a.getZoom());if(s===void 0&&(s=a.getCenter()),this._tileZoom!==void 0){var f=this._getTiledPixelBounds(s),g=this._pxBoundsToTileRange(f),w=g.getCenter(),x=[],F=this.options.keepBuffer,z=new Gt(g.getBottomLeft().subtract([F,-F]),g.getTopRight().add([F,-F]));if(!(isFinite(g.min.x)&&isFinite(g.min.y)&&isFinite(g.max.x)&&isFinite(g.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Y in this._tiles){var dt=this._tiles[Y].coords;(dt.z!==this._tileZoom||!z.contains(new at(dt.x,dt.y)))&&(this._tiles[Y].current=!1)}if(Math.abs(u-this._tileZoom)>1){this._setView(s,u);return}for(var Rt=g.min.y;Rt<=g.max.y;Rt++)for(var qt=g.min.x;qt<=g.max.x;qt++){var hn=new at(qt,Rt);if(hn.z=this._tileZoom,!!this._isValidTile(hn)){var He=this._tiles[this._tileCoordsToKey(hn)];He?He.current=!0:x.push(hn)}}if(x.sort(function(yn,qr){return yn.distanceTo(w)-qr.distanceTo(w)}),x.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var jn=document.createDocumentFragment();for(qt=0;qt<x.length;qt++)this._addTile(x[qt],jn);this._level.el.appendChild(jn)}}}},_isValidTile:function(s){var a=this._map.options.crs;if(!a.infinite){var u=this._globalTileRange;if(!a.wrapLng&&(s.x<u.min.x||s.x>u.max.x)||!a.wrapLat&&(s.y<u.min.y||s.y>u.max.y))return!1}if(!this.options.bounds)return!0;var f=this._tileCoordsToBounds(s);return oe(this.options.bounds).overlaps(f)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var a=this._map,u=this.getTileSize(),f=s.scaleBy(u),g=f.add(u),w=a.unproject(f,s.z),x=a.unproject(g,s.z);return[w,x]},_tileCoordsToBounds:function(s){var a=this._tileCoordsToNwSe(s),u=new $t(a[0],a[1]);return this.options.noWrap||(u=this._map.wrapLatLngBounds(u)),u},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var a=s.split(":"),u=new at(+a[0],+a[1]);return u.z=+a[2],u},_removeTile:function(s){var a=this._tiles[s];a&&(ue(a.el),delete this._tiles[s],this.fire("tileunload",{tile:a.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){Vt(s,"leaflet-tile");var a=this.getTileSize();s.style.width=a.x+"px",s.style.height=a.y+"px",s.onselectstart=y,s.onmousemove=y,gt.ielt9&&this.options.opacity<1&&Pe(s,this.options.opacity)},_addTile:function(s,a){var u=this._getTilePos(s),f=this._tileCoordsToKey(s),g=this.createTile(this._wrapCoords(s),l(this._tileReady,this,s));this._initTile(g),this.createTile.length<2&&O(l(this._tileReady,this,s,null,g)),Lt(g,u),this._tiles[f]={el:g,coords:s,current:!0},a.appendChild(g),this.fire("tileloadstart",{tile:g,coords:s})},_tileReady:function(s,a,u){a&&this.fire("tileerror",{error:a,tile:u,coords:s});var f=this._tileCoordsToKey(s);u=this._tiles[f],u&&(u.loaded=+new Date,this._map._fadeAnimated?(Pe(u.el,0),D(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this)):(u.active=!0,this._pruneTiles()),a||(Vt(u.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:u.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),gt.ielt9||!this._map._fadeAnimated?O(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var a=new at(this._wrapX?_(s.x,this._wrapX):s.x,this._wrapY?_(s.y,this._wrapY):s.y);return a.z=s.z,a},_pxBoundsToTileRange:function(s){var a=this.getTileSize();return new Gt(s.min.unscaleBy(a).floor(),s.max.unscaleBy(a).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function nT(s){return new ra(s)}var $r=ra.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,a){this._url=s,a=B(this,a),a.detectRetina&&gt.retina&&a.maxZoom>0?(a.tileSize=Math.floor(a.tileSize/2),a.zoomReverse?(a.zoomOffset--,a.minZoom=Math.min(a.maxZoom,a.minZoom+1)):(a.zoomOffset++,a.maxZoom=Math.max(a.minZoom,a.maxZoom-1)),a.minZoom=Math.max(0,a.minZoom)):a.zoomReverse?a.minZoom=Math.min(a.maxZoom,a.minZoom):a.maxZoom=Math.max(a.minZoom,a.maxZoom),typeof a.subdomains=="string"&&(a.subdomains=a.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,a){return this._url===s&&a===void 0&&(a=!0),this._url=s,a||this.redraw(),this},createTile:function(s,a){var u=document.createElement("img");return Ct(u,"load",l(this._tileOnLoad,this,a,u)),Ct(u,"error",l(this._tileOnError,this,a,u)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(u.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(u.referrerPolicy=this.options.referrerPolicy),u.alt="",u.src=this.getTileUrl(s),u},getTileUrl:function(s){var a={r:gt.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var u=this._globalTileRange.max.y-s.y;this.options.tms&&(a.y=u),a["-y"]=u}return X(this._url,r(a,this.options))},_tileOnLoad:function(s,a){gt.ielt9?setTimeout(l(s,this,null,a),0):s(null,a)},_tileOnError:function(s,a,u){var f=this.options.errorTileUrl;f&&a.getAttribute("src")!==f&&(a.src=f),s(u,a)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,a=this.options.maxZoom,u=this.options.zoomReverse,f=this.options.zoomOffset;return u&&(s=a-s),s+f},_getSubdomain:function(s){var a=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[a]},_abortLoading:function(){var s,a;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(a=this._tiles[s].el,a.onload=y,a.onerror=y,!a.complete)){a.src=Et;var u=this._tiles[s].coords;ue(a),delete this._tiles[s],this.fire("tileabort",{tile:a,coords:u})}},_removeTile:function(s){var a=this._tiles[s];if(a)return a.el.setAttribute("src",Et),ra.prototype._removeTile.call(this,s)},_tileReady:function(s,a,u){if(!(!this._map||u&&u.getAttribute("src")===Et))return ra.prototype._tileReady.call(this,s,a,u)}});function Nf(s,a){return new $r(s,a)}var Vf=$r.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,a){this._url=s;var u=r({},this.defaultWmsParams);for(var f in a)f in this.options||(u[f]=a[f]);a=B(this,a);var g=a.detectRetina&&gt.retina?2:1,w=this.getTileSize();u.width=w.x*g,u.height=w.y*g,this.wmsParams=u},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var a=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[a]=this._crs.code,$r.prototype.onAdd.call(this,s)},getTileUrl:function(s){var a=this._tileCoordsToNwSe(s),u=this._crs,f=Ht(u.project(a[0]),u.project(a[1])),g=f.min,w=f.max,x=(this._wmsVersion>=1.3&&this._crs===Me?[g.y,g.x,w.y,w.x]:[g.x,g.y,w.x,w.y]).join(","),F=$r.prototype.getTileUrl.call(this,s);return F+j(this.wmsParams,F,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+x},setParams:function(s,a){return r(this.wmsParams,s),a||this.redraw(),this}});function iT(s,a){return new Vf(s,a)}$r.WMS=Vf,Nf.wms=iT;var Ui=ce.extend({options:{padding:.1},initialize:function(s){B(this,s),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Vt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,a){var u=this._map.getZoomScale(a,this._zoom),f=this._map.getSize().multiplyBy(.5+this.options.padding),g=this._map.project(this._center,a),w=f.multiplyBy(-u).add(g).subtract(this._map._getNewPixelOrigin(s,a));gt.any3d?ai(this._container,w,u):Lt(this._container,w)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,a=this._map.getSize(),u=this._map.containerPointToLayerPoint(a.multiplyBy(-s)).round();this._bounds=new Gt(u,u.add(a.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Uf=Ui.extend({options:{tolerance:0},getEvents:function(){var s=Ui.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ui.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");Ct(s,"mousemove",this._onMouseMove,this),Ct(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ct(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){D(this._redrawRequest),delete this._ctx,ue(this._container),le(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var a in this._layers)s=this._layers[a],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ui.prototype._update.call(this);var s=this._bounds,a=this._container,u=s.getSize(),f=gt.retina?2:1;Lt(a,s.min),a.width=f*u.x,a.height=f*u.y,a.style.width=u.x+"px",a.style.height=u.y+"px",gt.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){Ui.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[d(s)]=s;var a=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=a),this._drawLast=a,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var a=s._order,u=a.next,f=a.prev;u?u.prev=f:this._drawLast=f,f?f.next=u:this._drawFirst=u,delete s._order,delete this._layers[d(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var a=s.options.dashArray.split(/[, ]+/),u=[],f,g;for(g=0;g<a.length;g++){if(f=Number(a[g]),isNaN(f))return;u.push(f)}s.options._dashArray=u}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||O(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var a=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Gt,this._redrawBounds.extend(s._pxBounds.min.subtract([a,a])),this._redrawBounds.extend(s._pxBounds.max.add([a,a]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var a=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,a.x,a.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,a=this._redrawBounds;if(this._ctx.save(),a){var u=a.getSize();this._ctx.beginPath(),this._ctx.rect(a.min.x,a.min.y,u.x,u.y),this._ctx.clip()}this._drawing=!0;for(var f=this._drawFirst;f;f=f.next)s=f.layer,(!a||s._pxBounds&&s._pxBounds.intersects(a))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,a){if(this._drawing){var u,f,g,w,x=s._parts,F=x.length,z=this._ctx;if(F){for(z.beginPath(),u=0;u<F;u++){for(f=0,g=x[u].length;f<g;f++)w=x[u][f],z[f?"lineTo":"moveTo"](w.x,w.y);a&&z.closePath()}this._fillStroke(z,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var a=s._point,u=this._ctx,f=Math.max(Math.round(s._radius),1),g=(Math.max(Math.round(s._radiusY),1)||f)/f;g!==1&&(u.save(),u.scale(1,g)),u.beginPath(),u.arc(a.x,a.y/g,f,0,Math.PI*2,!1),g!==1&&u.restore(),this._fillStroke(u,s)}},_fillStroke:function(s,a){var u=a.options;u.fill&&(s.globalAlpha=u.fillOpacity,s.fillStyle=u.fillColor||u.color,s.fill(u.fillRule||"evenodd")),u.stroke&&u.weight!==0&&(s.setLineDash&&s.setLineDash(a.options&&a.options._dashArray||[]),s.globalAlpha=u.opacity,s.lineWidth=u.weight,s.strokeStyle=u.color,s.lineCap=u.lineCap,s.lineJoin=u.lineJoin,s.stroke())},_onClick:function(s){for(var a=this._map.mouseEventToLayerPoint(s),u,f,g=this._drawFirst;g;g=g.next)u=g.layer,u.options.interactive&&u._containsPoint(a)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(u))&&(f=u);this._fireEvent(f?[f]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var a=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,a)}},_handleMouseOut:function(s){var a=this._hoveredLayer;a&&(ye(this._container,"leaflet-interactive"),this._fireEvent([a],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,a){if(!this._mouseHoverThrottled){for(var u,f,g=this._drawFirst;g;g=g.next)u=g.layer,u.options.interactive&&u._containsPoint(a)&&(f=u);f!==this._hoveredLayer&&(this._handleMouseOut(s),f&&(Vt(this._container,"leaflet-interactive"),this._fireEvent([f],s,"mouseover"),this._hoveredLayer=f)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,a,u){this._map._fireDOMEvent(a,u||a.type,s)},_bringToFront:function(s){var a=s._order;if(a){var u=a.next,f=a.prev;if(u)u.prev=f;else return;f?f.next=u:u&&(this._drawFirst=u),a.prev=this._drawLast,this._drawLast.next=a,a.next=null,this._drawLast=a,this._requestRedraw(s)}},_bringToBack:function(s){var a=s._order;if(a){var u=a.next,f=a.prev;if(f)f.next=u;else return;u?u.prev=f:f&&(this._drawLast=f),a.prev=null,a.next=this._drawFirst,this._drawFirst.prev=a,this._drawFirst=a,this._requestRedraw(s)}}});function Ff(s){return gt.canvas?new Uf(s):null}var oa=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),sT={_initContainer:function(){this._container=Qt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ui.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var a=s._container=oa("shape");Vt(a,"leaflet-vml-shape "+(this.options.className||"")),a.coordsize="1 1",s._path=oa("path"),a.appendChild(s._path),this._updateStyle(s),this._layers[d(s)]=s},_addPath:function(s){var a=s._container;this._container.appendChild(a),s.options.interactive&&s.addInteractiveTarget(a)},_removePath:function(s){var a=s._container;ue(a),s.removeInteractiveTarget(a),delete this._layers[d(s)]},_updateStyle:function(s){var a=s._stroke,u=s._fill,f=s.options,g=s._container;g.stroked=!!f.stroke,g.filled=!!f.fill,f.stroke?(a||(a=s._stroke=oa("stroke")),g.appendChild(a),a.weight=f.weight+"px",a.color=f.color,a.opacity=f.opacity,f.dashArray?a.dashStyle=Q(f.dashArray)?f.dashArray.join(" "):f.dashArray.replace(/( *, *)/g," "):a.dashStyle="",a.endcap=f.lineCap.replace("butt","flat"),a.joinstyle=f.lineJoin):a&&(g.removeChild(a),s._stroke=null),f.fill?(u||(u=s._fill=oa("fill")),g.appendChild(u),u.color=f.fillColor||f.color,u.opacity=f.fillOpacity):u&&(g.removeChild(u),s._fill=null)},_updateCircle:function(s){var a=s._point.round(),u=Math.round(s._radius),f=Math.round(s._radiusY||u);this._setPath(s,s._empty()?"M0 0":"AL "+a.x+","+a.y+" "+u+","+f+" 0,"+65535*360)},_setPath:function(s,a){s._path.v=a},_bringToFront:function(s){ki(s._container)},_bringToBack:function(s){rs(s._container)}},Wl=gt.vml?oa:q,aa=Ui.extend({_initContainer:function(){this._container=Wl("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Wl("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ue(this._container),le(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ui.prototype._update.call(this);var s=this._bounds,a=s.getSize(),u=this._container;(!this._svgSize||!this._svgSize.equals(a))&&(this._svgSize=a,u.setAttribute("width",a.x),u.setAttribute("height",a.y)),Lt(u,s.min),u.setAttribute("viewBox",[s.min.x,s.min.y,a.x,a.y].join(" ")),this.fire("update")}},_initPath:function(s){var a=s._path=Wl("path");s.options.className&&Vt(a,s.options.className),s.options.interactive&&Vt(a,"leaflet-interactive"),this._updateStyle(s),this._layers[d(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){ue(s._path),s.removeInteractiveTarget(s._path),delete this._layers[d(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var a=s._path,u=s.options;a&&(u.stroke?(a.setAttribute("stroke",u.color),a.setAttribute("stroke-opacity",u.opacity),a.setAttribute("stroke-width",u.weight),a.setAttribute("stroke-linecap",u.lineCap),a.setAttribute("stroke-linejoin",u.lineJoin),u.dashArray?a.setAttribute("stroke-dasharray",u.dashArray):a.removeAttribute("stroke-dasharray"),u.dashOffset?a.setAttribute("stroke-dashoffset",u.dashOffset):a.removeAttribute("stroke-dashoffset")):a.setAttribute("stroke","none"),u.fill?(a.setAttribute("fill",u.fillColor||u.color),a.setAttribute("fill-opacity",u.fillOpacity),a.setAttribute("fill-rule",u.fillRule||"evenodd")):a.setAttribute("fill","none"))},_updatePoly:function(s,a){this._setPath(s,G(s._parts,a))},_updateCircle:function(s){var a=s._point,u=Math.max(Math.round(s._radius),1),f=Math.max(Math.round(s._radiusY),1)||u,g="a"+u+","+f+" 0 1,0 ",w=s._empty()?"M0 0":"M"+(a.x-u)+","+a.y+g+u*2+",0 "+g+-u*2+",0 ";this._setPath(s,w)},_setPath:function(s,a){s._path.setAttribute("d",a)},_bringToFront:function(s){ki(s._path)},_bringToBack:function(s){rs(s._path)}});gt.vml&&aa.include(sT);function Bf(s){return gt.svg||gt.vml?new aa(s):null}Kt.include({getRenderer:function(s){var a=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return a||(a=this._renderer=this._createRenderer()),this.hasLayer(a)||this.addLayer(a),a},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var a=this._paneRenderers[s];return a===void 0&&(a=this._createRenderer({pane:s}),this._paneRenderers[s]=a),a},_createRenderer:function(s){return this.options.preferCanvas&&Ff(s)||Bf(s)}});var zf=jr.extend({initialize:function(s,a){jr.prototype.initialize.call(this,this._boundsToLatLngs(s),a)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=oe(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function rT(s,a){return new zf(s,a)}aa.create=Wl,aa.pointsToPath=G,Vi.geometryToLayer=Fl,Vi.coordsToLatLng=Fu,Vi.coordsToLatLngs=Bl,Vi.latLngToCoords=Bu,Vi.latLngsToCoords=zl,Vi.getFeature=Hr,Vi.asFeature=jl,Kt.mergeOptions({boxZoom:!0});var jf=Cn.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){Ct(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){le(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ue(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Yn(),$o(),this._startPoint=this._map.mouseEventToContainerPoint(s),Ct(document,{contextmenu:An,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=Qt("div","leaflet-zoom-box",this._container),Vt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var a=new Gt(this._point,this._startPoint),u=a.getSize();Lt(this._box,a.min),this._box.style.width=u.x+"px",this._box.style.height=u.y+"px"},_finish:function(){this._moved&&(ue(this._box),ye(this._container,"leaflet-crosshair")),Xn(),qo(),le(document,{contextmenu:An,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var a=new $t(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(a).fire("boxzoomend",{boxZoomBounds:a})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Kt.addInitHook("addHandler","boxZoom",jf),Kt.mergeOptions({doubleClickZoom:!0});var Hf=Cn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var a=this._map,u=a.getZoom(),f=a.options.zoomDelta,g=s.originalEvent.shiftKey?u-f:u+f;a.options.doubleClickZoom==="center"?a.setZoom(g):a.setZoomAround(s.containerPoint,g)}});Kt.addInitHook("addHandler","doubleClickZoom",Hf),Kt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var $f=Cn.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new Jn(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}Vt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ye(this._map._container,"leaflet-grab"),ye(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var a=oe(this._map.options.maxBounds);this._offsetLimit=Ht(this._map.latLngToContainerPoint(a.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(a.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var a=this._lastTime=+new Date,u=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(u),this._times.push(a),this._prunePositions(a)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),a=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=a.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,a){return s-(s-a)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),a=this._offsetLimit;s.x<a.min.x&&(s.x=this._viscousLimit(s.x,a.min.x)),s.y<a.min.y&&(s.y=this._viscousLimit(s.y,a.min.y)),s.x>a.max.x&&(s.x=this._viscousLimit(s.x,a.max.x)),s.y>a.max.y&&(s.y=this._viscousLimit(s.y,a.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,a=Math.round(s/2),u=this._initialWorldOffset,f=this._draggable._newPos.x,g=(f-a+u)%s+a-u,w=(f+a+u)%s-a-u,x=Math.abs(g+u)<Math.abs(w+u)?g:w;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=x},_onDragEnd:function(s){var a=this._map,u=a.options,f=!u.inertia||s.noInertia||this._times.length<2;if(a.fire("dragend",s),f)a.fire("moveend");else{this._prunePositions(+new Date);var g=this._lastPos.subtract(this._positions[0]),w=(this._lastTime-this._times[0])/1e3,x=u.easeLinearity,F=g.multiplyBy(x/w),z=F.distanceTo([0,0]),Y=Math.min(u.inertiaMaxSpeed,z),dt=F.multiplyBy(Y/z),Rt=Y/(u.inertiaDeceleration*x),qt=dt.multiplyBy(-Rt/2).round();!qt.x&&!qt.y?a.fire("moveend"):(qt=a._limitOffset(qt,a.options.maxBounds),O(function(){a.panBy(qt,{duration:Rt,easeLinearity:x,noMoveStart:!0,animate:!0})}))}}});Kt.addInitHook("addHandler","dragging",$f),Kt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var qf=Cn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),Ct(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),le(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,a=document.documentElement,u=s.scrollTop||a.scrollTop,f=s.scrollLeft||a.scrollLeft;this._map._container.focus(),window.scrollTo(f,u)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var a=this._panKeys={},u=this.keyCodes,f,g;for(f=0,g=u.left.length;f<g;f++)a[u.left[f]]=[-1*s,0];for(f=0,g=u.right.length;f<g;f++)a[u.right[f]]=[s,0];for(f=0,g=u.down.length;f<g;f++)a[u.down[f]]=[0,s];for(f=0,g=u.up.length;f<g;f++)a[u.up[f]]=[0,-1*s]},_setZoomDelta:function(s){var a=this._zoomKeys={},u=this.keyCodes,f,g;for(f=0,g=u.zoomIn.length;f<g;f++)a[u.zoomIn[f]]=s;for(f=0,g=u.zoomOut.length;f<g;f++)a[u.zoomOut[f]]=-s},_addHooks:function(){Ct(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){le(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var a=s.keyCode,u=this._map,f;if(a in this._panKeys){if(!u._panAnim||!u._panAnim._inProgress)if(f=this._panKeys[a],s.shiftKey&&(f=vt(f).multiplyBy(3)),u.options.maxBounds&&(f=u._limitOffset(vt(f),u.options.maxBounds)),u.options.worldCopyJump){var g=u.wrapLatLng(u.unproject(u.project(u.getCenter()).add(f)));u.panTo(g)}else u.panBy(f)}else if(a in this._zoomKeys)u.setZoom(u.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[a]);else if(a===27&&u._popup&&u._popup.options.closeOnEscapeKey)u.closePopup();else return;An(s)}}});Kt.addInitHook("addHandler","keyboard",qf),Kt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Wf=Cn.extend({addHooks:function(){Ct(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){le(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var a=xl(s),u=this._map.options.wheelDebounceTime;this._delta+=a,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var f=Math.max(u-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),f),An(s)},_performZoom:function(){var s=this._map,a=s.getZoom(),u=this._map.options.zoomSnap||0;s._stop();var f=this._delta/(this._map.options.wheelPxPerZoomLevel*4),g=4*Math.log(2/(1+Math.exp(-Math.abs(f))))/Math.LN2,w=u?Math.ceil(g/u)*u:g,x=s._limitZoom(a+(this._delta>0?w:-w))-a;this._delta=0,this._startTime=null,x&&(s.options.scrollWheelZoom==="center"?s.setZoom(a+x):s.setZoomAround(this._lastMousePos,a+x))}});Kt.addInitHook("addHandler","scrollWheelZoom",Wf);var oT=600;Kt.mergeOptions({tapHold:gt.touchNative&&gt.safari&&gt.mobile,tapTolerance:15});var Kf=Cn.extend({addHooks:function(){Ct(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){le(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var a=s.touches[0];this._startPos=this._newPos=new at(a.clientX,a.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(Ct(document,"touchend",Ee),Ct(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",a))},this),oT),Ct(document,"touchend touchcancel contextmenu",this._cancel,this),Ct(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){le(document,"touchend",Ee),le(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),le(document,"touchend touchcancel contextmenu",this._cancel,this),le(document,"touchmove",this._onMove,this)},_onMove:function(s){var a=s.touches[0];this._newPos=new at(a.clientX,a.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,a){var u=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY});u._simulated=!0,a.target.dispatchEvent(u)}});Kt.addInitHook("addHandler","tapHold",Kf),Kt.mergeOptions({touchZoom:gt.touch,bounceAtZoomLimits:!0});var Gf=Cn.extend({addHooks:function(){Vt(this._map._container,"leaflet-touch-zoom"),Ct(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ye(this._map._container,"leaflet-touch-zoom"),le(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var a=this._map;if(!(!s.touches||s.touches.length!==2||a._animatingZoom||this._zooming)){var u=a.mouseEventToContainerPoint(s.touches[0]),f=a.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=a.getSize()._divideBy(2),this._startLatLng=a.containerPointToLatLng(this._centerPoint),a.options.touchZoom!=="center"&&(this._pinchStartLatLng=a.containerPointToLatLng(u.add(f)._divideBy(2))),this._startDist=u.distanceTo(f),this._startZoom=a.getZoom(),this._moved=!1,this._zooming=!0,a._stop(),Ct(document,"touchmove",this._onTouchMove,this),Ct(document,"touchend touchcancel",this._onTouchEnd,this),Ee(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var a=this._map,u=a.mouseEventToContainerPoint(s.touches[0]),f=a.mouseEventToContainerPoint(s.touches[1]),g=u.distanceTo(f)/this._startDist;if(this._zoom=a.getScaleZoom(g,this._startZoom),!a.options.bounceAtZoomLimits&&(this._zoom<a.getMinZoom()&&g<1||this._zoom>a.getMaxZoom()&&g>1)&&(this._zoom=a._limitZoom(this._zoom)),a.options.touchZoom==="center"){if(this._center=this._startLatLng,g===1)return}else{var w=u._add(f)._divideBy(2)._subtract(this._centerPoint);if(g===1&&w.x===0&&w.y===0)return;this._center=a.unproject(a.project(this._pinchStartLatLng,this._zoom).subtract(w),this._zoom)}this._moved||(a._moveStart(!0,!1),this._moved=!0),D(this._animRequest);var x=l(a._move,a,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=O(x,this,!0),Ee(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,D(this._animRequest),le(document,"touchmove",this._onTouchMove,this),le(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Kt.addInitHook("addHandler","touchZoom",Gf),Kt.BoxZoom=jf,Kt.DoubleClickZoom=Hf,Kt.Drag=$f,Kt.Keyboard=qf,Kt.ScrollWheelZoom=Wf,Kt.TapHold=Kf,Kt.TouchZoom=Gf,n.Bounds=Gt,n.Browser=gt,n.CRS=$,n.Canvas=Uf,n.Circle=Uu,n.CircleMarker=Ul,n.Class=_e,n.Control=vn,n.DivIcon=Df,n.DivOverlay=ui,n.DomEvent=kl,n.DomUtil=Rl,n.Draggable=Jn,n.Evented=Ft,n.FeatureGroup=Se,n.GeoJSON=Vi,n.GridLayer=ra,n.Handler=Cn,n.Icon=ci,n.ImageOverlay=Hl,n.LatLng=zt,n.LatLngBounds=$t,n.Layer=ce,n.LayerGroup=be,n.LineUtil=b,n.Map=Kt,n.Marker=Vl,n.Mixin=Js,n.Path=hs,n.Point=at,n.PolyUtil=Fr,n.Polygon=jr,n.Polyline=Ni,n.Popup=$l,n.PosAnimation=Xo,n.Projection=st,n.Rectangle=zf,n.Renderer=Ui,n.SVG=aa,n.SVGOverlay=Of,n.TileLayer=$r,n.Tooltip=ql,n.Transformation=Zt,n.Util=R,n.VideoOverlay=Mf,n.bind=l,n.bounds=Ht,n.canvas=Ff,n.circle=Ww,n.circleMarker=qw,n.control=un,n.divIcon=eT,n.extend=r,n.featureGroup=zr,n.geoJSON=Lf,n.geoJson=Zw,n.gridLayer=nT,n.icon=Hw,n.imageOverlay=Qw,n.latLng=At,n.latLngBounds=oe,n.layerGroup=us,n.map=Mr,n.marker=$w,n.point=vt,n.polygon=Gw,n.polyline=Kw,n.popup=Jw,n.rectangle=rT,n.setOptions=B,n.stamp=d,n.svg=Bf,n.svgOverlay=Xw,n.tileLayer=Nf,n.tooltip=tT,n.transformation=A,n.version=i,n.videoOverlay=Yw;var aT=window.L;n.noConflict=function(){return window.L=aT,this},window.L=n})}(ya,ya.exports)),ya.exports}var X1=Y1();const pi=Z1(X1),J1=new pi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),tL=new pi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),eL=new pi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),nL={name:"TravelPoints",props:{tripId:{type:String,required:!0},countryCoords:{type:Array,default:()=>[52.237049,21.017532]},initialZoom:{type:Number,default:6}},data(){return{map:null,markerGroup:null,userLocationMarker:null,tempMarker:null,searchQuery:"",selectedCategory:"",suggestions:[],highlightedIndex:-1,points:[],unsubscribe:null,errorMessage:"",successMessage:"",userCoords:null,isAddingFromMap:!1}},mounted(){this.initMap(),this.loadPoints(),this.setupMapClickHandler()},beforeUnmount(){this.unsubscribe&&this.unsubscribe(),this.map&&this.map.remove()},methods:{initMap(){this.map=pi.map("map").setView(this.countryCoords,this.initialZoom),pi.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(this.map),this.markerGroup=pi.layerGroup().addTo(this.map)},setupMapClickHandler(){this.map.on("click",e=>{if(!this.selectedCategory){this.errorMessage="Please select a category first";return}this.tempMarker&&this.map.removeLayer(this.tempMarker),this.tempMarker=pi.marker(e.latlng,{icon:eL,draggable:!0}).addTo(this.map).bindPopup("New point - "+this.selectedCategory).openPopup(),this.isAddingFromMap=!0,this.userCoords=[e.latlng.lat,e.latlng.lng],this.reverseGeocode([e.latlng.lat,e.latlng.lng])})},handleMapClick(e){},async centerToCurrentLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{this.userCoords=[e.coords.latitude,e.coords.longitude],this.map.setView(this.userCoords,13),this.userLocationMarker?this.userLocationMarker.setLatLng(this.userCoords):this.userLocationMarker=pi.marker(this.userCoords,{icon:J1,title:"Your Current Location"}).addTo(this.map),this.reverseGeocode(this.userCoords)},e=>{console.error("Geolocation error:",e),this.errorMessage="Unable to retrieve your location: "+e.message},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0}):this.errorMessage="Geolocation is not supported by your browser"},async reverseGeocode(e){try{const n=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${e[0]}&lon=${e[1]}`)).json();n.display_name?this.searchQuery=n.display_name:this.searchQuery=`Point at ${e[0].toFixed(4)}, ${e[1].toFixed(4)}`}catch(t){console.error("Reverse geocoding failed:",t),this.searchQuery=`Point at ${e[0].toFixed(4)}, ${e[1].toFixed(4)}`}},async addPoint(){if(!this.selectedCategory){this.errorMessage="Please select a category first";return}try{let e,t=this.searchQuery;if(this.isAddingFromMap&&this.userCoords)e=this.userCoords,t=this.searchQuery||`Point at ${e[0].toFixed(4)}, ${e[1].toFixed(4)}`,this.tempMarker&&(this.map.removeLayer(this.tempMarker),this.tempMarker=null);else if(this.searchQuery){const r=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${this.searchQuery}`)).json();if(!r.length){this.errorMessage="Location not found.";return}e=[parseFloat(r[0].lat),parseFloat(r[0].lon)],t=r[0].display_name}else{this.errorMessage="Please provide a location or click on the map";return}const n={name:t,category:this.selectedCategory,coords:e,createdAt:new Date};await fl(Wn(ve,"trips",this.tripId,"points"),n),this.searchQuery="",this.selectedCategory="",this.errorMessage="",this.isAddingFromMap=!1,this.successMessage="Point added successfully!",setTimeout(()=>this.successMessage="",3e3)}catch(e){console.error("Error adding point:",e),this.errorMessage="Failed to add point: "+e.message}},loadPoints(){this.unsubscribe=To(Wn(ve,"trips",this.tripId,"points"),e=>{if(this.markerGroup.clearLayers(),this.points=[],e.forEach(t=>{const n=t.data(),i=pi.marker(n.coords,{draggable:!1,icon:tL}).addTo(this.markerGroup).bindPopup(`<b>${n.name}</b><br>${n.category}`);this.points.push({id:t.id,...n,marker:i})}),this.points.length>0){const t=new pi.featureGroup(this.points.map(n=>n.marker));this.map.fitBounds(t.getBounds().pad(.2))}else this.map.setView(this.countryCoords,this.initialZoom)},e=>{console.error("Error loading points:",e),this.errorMessage="Failed to load points"})},async deletePoint(e){const t=this.points[e];try{await xo(mn(ve,"trips",this.tripId,"points",t.id)),this.markerGroup.removeLayer(t.marker),this.points.splice(e,1),this.successMessage="Point deleted successfully!",setTimeout(()=>this.successMessage="",3e3)}catch(n){console.error("Error deleting point:",n),this.errorMessage="Failed to delete point"}},async fetchSuggestions(){if(this.searchQuery.length<3){this.suggestions=[];return}try{const e=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${this.searchQuery}&limit=5`);this.suggestions=await e.json(),this.highlightedIndex=-1}catch(e){console.error("Error fetching suggestions:",e),this.errorMessage="Failed to load suggestions"}},highlightNext(){this.highlightedIndex<this.suggestions.length-1&&this.highlightedIndex++},highlightPrev(){this.highlightedIndex>0&&this.highlightedIndex--},selectHighlighted(){this.highlightedIndex>=0&&this.selectSuggestion(this.suggestions[this.highlightedIndex])},selectSuggestion(e){if(this.searchQuery=e.display_name,this.suggestions=[],this.highlightedIndex=-1,e.lat&&e.lon){const t=[parseFloat(e.lat),parseFloat(e.lon)];this.map.setView(t,13)}}}},iL={class:"container-fluid py-4 px-3 px-md-5"},sL={class:"row"},rL={class:"col-12"},oL={key:0,class:"alert alert-danger"},aL={key:1,class:"alert alert-success"},lL={class:"card shadow-sm mb-4"},cL={class:"card-body"},uL={class:"row g-3"},hL={class:"col-md-6"},dL={class:"position-relative"},fL={key:0,class:"list-group position-absolute w-100 z-3 mt-1"},pL=["onClick"],mL={class:"col-md-6"},_L={class:"d-flex flex-wrap gap-2 mt-3"},gL={class:"card shadow-sm mb-4"},vL={class:"card-body"},yL={class:"table-responsive"},wL={class:"table table-hover"},TL={class:"text-muted small"},EL={class:"text-muted small"},bL={class:"text-end"},IL=["onClick"],PL={class:"card shadow-sm"},AL={class:"card-body p-0"};function CL(e,t,n,i,r,o){return rt(),lt("div",iL,[E("div",sL,[E("div",rL,[t[14]||(t[14]=E("h2",{class:"mb-4 text-success"},"Your Travel Points",-1)),r.errorMessage?(rt(),lt("div",oL,It(r.errorMessage),1)):Bt("",!0),r.successMessage?(rt(),lt("div",aL,It(r.successMessage),1)):Bt("",!0),E("div",lL,[E("div",cL,[E("div",uL,[E("div",hL,[E("div",dL,[fe(E("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>r.searchQuery=l),onInput:t[1]||(t[1]=(...l)=>o.fetchSuggestions&&o.fetchSuggestions(...l)),onKeydown:[t[2]||(t[2]=Ca(Is((...l)=>o.highlightNext&&o.highlightNext(...l),["prevent"]),["down"])),t[3]||(t[3]=Ca(Is((...l)=>o.highlightPrev&&o.highlightPrev(...l),["prevent"]),["up"])),t[4]||(t[4]=Ca(Is((...l)=>o.selectHighlighted&&o.selectHighlighted(...l),["prevent"]),["enter"]))],type:"text",class:"form-control form-control-lg",placeholder:"Enter location name"},null,544),[[Ae,r.searchQuery]]),r.suggestions.length?(rt(),lt("ul",fL,[(rt(!0),lt(qe,null,Qi(r.suggestions,(l,h)=>(rt(),lt("li",{key:h,class:cr([["list-group-item",{"bg-success text-white":h===r.highlightedIndex}],"cursor-pointer"]),onClick:d=>o.selectSuggestion(l)},It(l.display_name),11,pL))),128))])):Bt("",!0)])]),E("div",mL,[fe(E("select",{"onUpdate:modelValue":t[5]||(t[5]=l=>r.selectedCategory=l),class:"form-select form-select-lg"},t[9]||(t[9]=[wd('<option value="" disabled data-v-e05c4d40>Select Category</option><option value="Attraction" data-v-e05c4d40>Attraction</option><option value="Accommodation" data-v-e05c4d40>Accommodation</option><option value="Restaurant" data-v-e05c4d40>Restaurant</option><option value="Other" data-v-e05c4d40>Other</option>',5)]),512),[[Vg,r.selectedCategory]])])]),E("div",_L,[E("button",{class:"btn btn-success px-4 py-2",onClick:t[6]||(t[6]=(...l)=>o.addPoint&&o.addPoint(...l))},t[10]||(t[10]=[E("i",{class:"bi bi-plus-circle"},null,-1),Ot(" Add Point ")])),E("button",{class:"btn btn-outline-success px-4 py-2",onClick:t[7]||(t[7]=(...l)=>o.centerToCurrentLocation&&o.centerToCurrentLocation(...l))},t[11]||(t[11]=[E("i",{class:"bi bi-geo-alt"},null,-1),Ot(" Use My Current Location ")]))])])]),E("div",gL,[E("div",vL,[t[13]||(t[13]=E("h4",{class:"text-success mb-3"},"Your Added Points:",-1)),E("div",yL,[E("table",wL,[E("tbody",null,[(rt(!0),lt(qe,null,Qi(r.points,(l,h)=>(rt(),lt("tr",{key:h},[E("td",null,[E("strong",null,It(l.name),1),E("div",TL,It(l.category),1),E("div",EL,"("+It(l.coords[0].toFixed(4))+", "+It(l.coords[1].toFixed(4))+")",1)]),E("td",bL,[E("button",{class:"btn btn-outline-danger btn-sm",onClick:d=>o.deletePoint(h)},t[12]||(t[12]=[E("i",{class:"bi bi-trash"},null,-1),Ot(" Delete ")]),8,IL)])]))),128))])])])])]),E("div",PL,[E("div",AL,[E("div",{id:"map",style:{height:"500px","min-height":"300px"},onClick:t[8]||(t[8]=(...l)=>o.handleMapClick&&o.handleMapClick(...l))})])])])])])}const RL=In(nL,[["render",CL],["__scopeId","data-v-e05c4d40"]]),SL={name:"BudgetPlanner",props:["trip"],data(){return{totalBudget:null,expenses:[],newExpense:{name:"",amount:null,persons:null,description:"",date:"",paid:!1},errorMessage:"",unsubscribeBudget:null,unsubscribeExpenses:null,budgetExceeded:!1,tooltip:{visible:!1,x:0,y:0,data:{date:"",description:""}}}},computed:{totalSpent(){return this.expenses.reduce((e,t)=>e+Number(t.amount),0)},remainingBudget(){return this.totalBudget===null?"0.00":(this.totalBudget-this.totalSpent).toFixed(2)},isBudgetExceeded(){return this.totalBudget!==null&&this.totalSpent>this.totalBudget}},watch:{isBudgetExceeded(e){e&&!this.budgetExceeded&&this.showSOS(),this.budgetExceeded=e}},created(){this.registerServiceWorker(),this.loadBudget(),this.loadExpenses()},beforeUnmount(){this.unsubscribeBudget&&this.unsubscribeBudget(),this.unsubscribeExpenses&&this.unsubscribeExpenses()},methods:{positionTooltip(e){this.tooltip.visible&&(this.tooltip.x=e.clientX,this.tooltip.y=e.clientY)},showTooltip(e){this.tooltip={visible:!0,x:0,y:0,data:{date:e.date||"",description:e.description||""}}},hideTooltip(){this.tooltip.visible=!1},registerServiceWorker(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js").then(function(e){console.log("Service Worker registered with scope:",e.scope)}).catch(function(e){console.error("Service Worker registration failed:",e)})},showSOS(){"vibrate"in navigator?(navigator.vibrate([300,50,300,50,300,50,600,50,600,50,600,50,300,50,300,50,300]),alert("Budget exceeded! Vibration alert sent!")):alert("Budget exceeded! Your device doesn't support vibration.")},async loadBudget(){this.unsubscribeBudget=To(mn(ve,"trips",this.trip.id),e=>{if(e.exists()){const t=e.data();this.totalBudget=t.budget||null}},e=>{console.error("Error loading budget:",e),this.errorMessage="Failed to load budget"})},async updateBudget(){try{await Oa(mn(ve,"trips",this.trip.id),{budget:this.totalBudget})}catch(e){console.error("Error updating budget:",e),this.errorMessage="Failed to update budget"}},loadExpenses(){this.unsubscribeExpenses=To(Wn(ve,"trips",this.trip.id,"expenses"),e=>{this.expenses=[],e.forEach(t=>{this.expenses.push({id:t.id,...t.data()})})},e=>{console.error("Error loading expenses:",e),this.errorMessage="Failed to load expenses"})},async addExpense(){if(!this.newExpense.name.trim()||this.newExpense.amount===null||this.newExpense.amount<=0){this.errorMessage="Please enter the expense name and a valid amount greater than 0!";return}try{await fl(Wn(ve,"trips",this.trip.id,"expenses"),{name:this.newExpense.name,amount:Number(this.newExpense.amount),persons:Number(this.newExpense.persons)||0,description:this.newExpense.description||"",date:this.newExpense.date||"",paid:!1,createdAt:new Date}),this.newExpense={name:"",amount:null,persons:null,description:"",date:"",paid:!1},this.errorMessage=""}catch(e){console.error("Error adding expense:",e),this.errorMessage="Failed to add expense"}},async updateExpense(e){try{await Oa(mn(ve,"trips",this.trip.id,"expenses",e.id),{paid:e.paid})}catch(t){console.error("Error updating expense:",t),this.errorMessage="Failed to update expense"}},async deleteExpense(e){try{await xo(mn(ve,"trips",this.trip.id,"expenses",e))}catch(t){console.error("Error deleting expense:",t),this.errorMessage="Failed to delete expense"}}}},xL={class:"container py-4"},kL={class:"text-center mb-4"},LL={class:"text-success"},ML={class:"row mb-4 g-3"},OL={class:"col-md-4"},DL={class:"card text-white h-100 budget-card"},NL={class:"card-body text-center"},VL={class:"card-text display-6"},UL={class:"col-md-4"},FL={class:"card text-white h-100 budget-card"},BL={class:"card-body text-center"},zL={class:"card-text display-6"},jL={class:"col-md-4"},HL={class:"card text-white h-100 budget-card"},$L={class:"card-body text-center"},qL={class:"d-flex align-items-center justify-content-center"},WL={class:"card mb-4 border-success"},KL={class:"card-body"},GL={class:"row g-3"},ZL={class:"col-md-6"},QL={class:"col-md-6"},YL={class:"col-md-6"},XL={key:0,class:"text-muted"},JL={class:"col-md-6"},tM={class:"col-12"},eM={class:"col-12"},nM={key:0,class:"text-danger mt-2"},iM={key:0,class:"card border-success"},sM={class:"card-body"},rM={class:"list-group"},oM=["onMouseenter"],aM={class:"d-flex flex-column flex-md-row justify-content-between align-items-md-center"},lM={class:"mb-2 mb-md-0"},cM={class:"text-muted small"},uM={key:0},hM={key:1,class:"text-success"},dM={key:2,class:"text-danger"},fM={class:"d-flex align-items-center mt-2 mt-md-0"},pM={class:"form-check me-3"},mM=["onUpdate:modelValue","id","onChange"],_M=["for"],gM=["onClick"],vM={class:"tooltip-content"},yM={key:0},wM={key:1},TM={key:2};function EM(e,t,n,i,r,o){return rt(),lt("div",xL,[E("div",kL,[E("h3",LL,"Travel Budget - "+It(n.trip.name),1)]),E("div",ML,[E("div",OL,[E("div",DL,[E("div",NL,[t[10]||(t[10]=E("h5",{class:"card-title"},"Remaining",-1)),E("p",VL,It(o.remainingBudget)+" PLN ",1)])])]),E("div",UL,[E("div",FL,[E("div",BL,[t[11]||(t[11]=E("h5",{class:"card-title"},"Spent",-1)),E("p",zL,It(o.totalSpent)+" PLN ",1)])])]),E("div",jL,[E("div",HL,[E("div",$L,[t[13]||(t[13]=E("h5",{class:"card-title"},"Total Budget",-1)),E("div",qL,[fe(E("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>r.totalBudget=l),type:"number",class:"form-control w-75",onChange:t[1]||(t[1]=(...l)=>o.updateBudget&&o.updateBudget(...l)),placeholder:"Enter amount",min:"0"},null,544),[[Ae,r.totalBudget,void 0,{number:!0}]]),t[12]||(t[12]=E("span",{class:"ms-2"},"PLN",-1))])])])])]),E("div",WL,[E("div",KL,[t[14]||(t[14]=E("h4",{class:"card-title text-success mb-3"},"Add New Expense",-1)),E("div",GL,[E("div",ZL,[fe(E("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>r.newExpense.name=l),placeholder:"Expense Name (required)",class:"form-control",required:""},null,512),[[Ae,r.newExpense.name]])]),E("div",QL,[fe(E("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>r.newExpense.amount=l),placeholder:"Expense Amount (PLN, required)",type:"number",class:"form-control",required:"",min:"0",step:"0.01"},null,512),[[Ae,r.newExpense.amount,void 0,{number:!0}]])]),E("div",YL,[fe(E("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>r.newExpense.persons=l),placeholder:"Number of persons to split (optional)",type:"number",class:"form-control",min:"0"},null,512),[[Ae,r.newExpense.persons,void 0,{number:!0}]]),r.newExpense.persons>0?(rt(),lt("small",XL," Even split: "+It((r.newExpense.amount/r.newExpense.persons).toFixed(2))+" PLN per person ",1)):Bt("",!0)]),E("div",JL,[fe(E("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>r.newExpense.date=l),type:"date",class:"form-control",placeholder:"Expense Date (optional)"},null,512),[[Ae,r.newExpense.date]])]),E("div",tM,[fe(E("textarea",{"onUpdate:modelValue":t[6]||(t[6]=l=>r.newExpense.description=l),placeholder:"Expense Description (optional)",class:"form-control",rows:"2"},null,512),[[Ae,r.newExpense.description]])]),E("div",eM,[E("button",{class:"btn btn-success px-4",onClick:t[7]||(t[7]=(...l)=>o.addExpense&&o.addExpense(...l))},"Add Expense"),r.errorMessage?(rt(),lt("p",nM,It(r.errorMessage),1)):Bt("",!0)])])])]),r.expenses.length?(rt(),lt("div",iM,[E("div",sM,[t[15]||(t[15]=E("h4",{class:"card-title text-success mb-3"},"Expenses",-1)),E("div",rM,[(rt(!0),lt(qe,null,Qi(r.expenses,(l,h)=>(rt(),lt("div",{key:l.id,class:"list-group-item expense-item",onMousemove:t[8]||(t[8]=d=>o.positionTooltip(d)),onMouseenter:d=>o.showTooltip(l),onMouseleave:t[9]||(t[9]=(...d)=>o.hideTooltip&&o.hideTooltip(...d))},[E("div",aM,[E("div",lM,[E("strong",null,It(l.name),1),Ot(" - "+It(l.amount)+" PLN ",1),E("div",cM,[l.persons?(rt(),lt("span",uM," Split: "+It(l.persons)+" persons ("+It((l.amount/l.persons).toFixed(2))+" PLN/person) | ",1)):Bt("",!0),l.paid?(rt(),lt("span",hM,"Paid")):(rt(),lt("span",dM,"Unpaid"))])]),E("div",fM,[E("div",pM,[fe(E("input",{type:"checkbox","onUpdate:modelValue":d=>l.paid=d,class:"form-check-input",id:"paid-"+h,onChange:d=>o.updateExpense(l)},null,40,mM),[[Ng,l.paid]]),E("label",{for:"paid-"+h,class:"form-check-label"},"Paid",8,_M)]),E("button",{class:"btn btn-outline-danger btn-sm",onClick:d=>o.deleteExpense(l.id)},"Delete",8,gM)])])],40,oM))),128))])])])):Bt("",!0),r.tooltip.visible?(rt(),lt("div",{key:1,class:"custom-tooltip",style:nl({top:r.tooltip.y-10+"px",left:r.tooltip.x-100+"px",transform:"translateY(-100%)"})},[E("div",vM,[r.tooltip.data.date?(rt(),lt("div",yM,[t[16]||(t[16]=E("strong",null,"Date:",-1)),Ot(" "+It(r.tooltip.data.date),1)])):Bt("",!0),r.tooltip.data.description?(rt(),lt("div",wM,[t[17]||(t[17]=E("strong",null,"Description:",-1)),Ot(" "+It(r.tooltip.data.description),1)])):Bt("",!0),!r.tooltip.data.date&&!r.tooltip.data.description?(rt(),lt("div",TM,"No additional information")):Bt("",!0)]),t[18]||(t[18]=E("div",{class:"tooltip-arrow-bottom"},null,-1))],4)):Bt("",!0)])}const bM=In(SL,[["render",EM],["__scopeId","data-v-8d937fe5"]]),IM={name:"PackingList",props:["trip"],data(){return{categories:[],selectedCategory:null,showAddCategory:!1,showAddItem:!1,newCategory:"",newItem:"",unsubscribe:null,errorMessage:"",successMessage:"",showDeleteModal:!1,categoryToDeleteId:null,categoryToDeleteName:""}},created(){this.loadPackingList()},beforeUnmount(){this.unsubscribe&&this.unsubscribe()},methods:{async loadPackingList(){try{const e=Wn(ve,"trips",this.trip.id,"packingList");this.unsubscribe=To(e,t=>{this.categories=t.docs.map(n=>({id:n.id,...n.data()}))})}catch(e){console.error("Error loading packing list:",e),this.errorMessage="Failed to load packing list"}},selectCategory(e){this.selectedCategory=this.selectedCategory===e?null:e,this.showAddCategory=!1,this.showAddItem=!1},async addCategory(){if(!this.newCategory.trim()){this.errorMessage="Please enter a category name";return}try{await FR(mn(Wn(ve,"trips",this.trip.id,"packingList")),{name:this.newCategory.trim(),items:[]}),this.newCategory="",this.showAddCategory=!1,this.errorMessage="",this.successMessage="Category added successfully!",setTimeout(()=>this.successMessage="",3e3)}catch(e){console.error("Error adding category:",e),this.errorMessage="Failed to add category"}},async addItem(){if(!this.selectedCategory){this.errorMessage="Please select a category first";return}if(!this.newItem.trim()){this.errorMessage="Please enter an item name";return}try{const e=this.categories.find(i=>i.name===this.selectedCategory);if(!e)return;const t=mn(ve,"trips",this.trip.id,"packingList",e.id),n={id:Date.now().toString(),name:this.newItem.trim(),checked:!1};await Oa(t,{items:[...e.items,n]}),this.newItem="",this.showAddItem=!1,this.errorMessage="",this.successMessage="Item added successfully!",setTimeout(()=>this.successMessage="",3e3)}catch(e){console.error("Error adding item:",e),this.errorMessage="Failed to add item"}},async updateItem(e){try{const t=this.categories.find(i=>i.items.some(r=>r.id===e.id));if(!t)return;const n=mn(ve,"trips",this.trip.id,"packingList",t.id);await Oa(n,{items:t.items})}catch(t){console.error("Error updating item:",t),this.errorMessage="Failed to update item"}},async deleteItem(e){try{const t=this.categories.find(i=>i.items.some(r=>r.id===e));if(!t)return;const n=mn(ve,"trips",this.trip.id,"packingList",t.id);await Oa(n,{items:t.items.filter(i=>i.id!==e)}),this.successMessage="Item deleted successfully!",setTimeout(()=>this.successMessage="",3e3)}catch(t){console.error("Error deleting item:",t),this.errorMessage="Failed to delete item"}},confirmDeleteCategory(e,t){this.categoryToDeleteId=e,this.categoryToDeleteName=t,this.showDeleteModal=!0},async deleteCategory(){try{const e=mn(ve,"trips",this.trip.id,"packingList",this.categoryToDeleteId);await xo(e),this.selectedCategory===this.categoryToDeleteName&&(this.selectedCategory=null),this.showDeleteModal=!1,this.categoryToDeleteId=null,this.categoryToDeleteName="",this.successMessage="Category deleted successfully!",setTimeout(()=>this.successMessage="",3e3)}catch(e){console.error("Error deleting category:",e),this.errorMessage="Failed to delete category"}},getCurrentItems(){if(!this.selectedCategory)return[];const e=this.categories.find(t=>t.name===this.selectedCategory);return e?e.items:[]},getCheckedCount(e){return e.items.filter(t=>t.checked).length},getProgress(e){return e.items.length===0?0:Math.round(this.getCheckedCount(e)/e.items.length*100)}}},PM={class:"container-fluid py-4 px-3 px-md-5"},AM={class:"row"},CM={class:"col-12"},RM={class:"mb-4 text-success"},SM={key:0,class:"alert alert-danger"},xM={key:1,class:"alert alert-success"},kM={class:"card shadow-sm mb-4"},LM={class:"card-body"},MM={class:"categories"},OM=["onClick"],DM={class:"d-flex justify-content-between align-items-center"},NM={class:"mb-2"},VM=["onClick"],UM={class:"progress-container"},FM={class:"progress-text"},BM={class:"card shadow-sm mb-4"},zM={class:"card-body"},jM={class:"d-flex flex-wrap gap-2 mb-3"},HM=["disabled"],$M={key:0,class:"add-form mb-3"},qM={class:"d-flex gap-2"},WM={key:1,class:"add-form mb-3"},KM=["placeholder"],GM={class:"d-flex gap-2"},ZM={key:2,class:"card shadow-sm"},QM={class:"card-body"},YM={class:"text-success mb-3"},XM={class:"items-list"},JM={class:"item-checkbox"},tO=["onUpdate:modelValue","onChange"],eO=["onClick"],nO={key:0,class:"modal-overlay"},iO={class:"modal-content"},sO={class:"d-flex gap-2"};function rO(e,t,n,i,r,o){return rt(),lt("div",PM,[E("div",AM,[E("div",CM,[E("h2",RM,"Packing List - "+It(n.trip.name),1),r.errorMessage?(rt(),lt("div",SM,It(r.errorMessage),1)):Bt("",!0),r.successMessage?(rt(),lt("div",xM,It(r.successMessage),1)):Bt("",!0),E("div",kM,[E("div",LM,[E("div",MM,[(rt(!0),lt(qe,null,Qi(r.categories,l=>(rt(),lt("div",{key:l.id,class:cr(["category-card",{active:r.selectedCategory===l.name}])},[E("div",{class:"category-content",onClick:h=>o.selectCategory(l.name)},[E("div",DM,[E("h3",NM,It(l.name),1),E("button",{onClick:Is(h=>o.confirmDeleteCategory(l.id,l.name),["stop"]),class:"btn btn-outline-danger btn-sm"},t[12]||(t[12]=[E("i",{class:"bi bi-trash"},null,-1)]),8,VM)]),E("div",UM,[E("div",{class:"progress-bar",style:nl({width:o.getProgress(l)+"%"})},null,4)]),E("span",FM,It(o.getCheckedCount(l))+"/"+It(l.items.length)+" items ",1)],8,OM)],2))),128))])])]),E("div",BM,[E("div",zM,[E("div",jM,[E("button",{onClick:t[0]||(t[0]=l=>r.showAddCategory=!0),class:"btn btn-success px-4 py-2"},t[13]||(t[13]=[E("i",{class:"bi bi-plus-circle"},null,-1),Ot(" Add New Category ")])),E("button",{onClick:t[1]||(t[1]=l=>r.showAddItem=!0),class:"btn btn-outline-success px-4 py-2",disabled:!r.selectedCategory},[t[14]||(t[14]=E("i",{class:"bi bi-plus-circle"},null,-1)),Ot(" Add Item to "+It(r.selectedCategory||"Category"),1)],8,HM)]),r.showAddCategory?(rt(),lt("div",$M,[fe(E("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>r.newCategory=l),placeholder:"Enter category name",class:"form-control form-control-lg mb-2",onKeyup:t[3]||(t[3]=Ca((...l)=>o.addCategory&&o.addCategory(...l),["enter"]))},null,544),[[Ae,r.newCategory]]),E("div",qM,[E("button",{onClick:t[4]||(t[4]=(...l)=>o.addCategory&&o.addCategory(...l)),class:"btn btn-success flex-grow-1"},t[15]||(t[15]=[E("i",{class:"bi bi-check-circle"},null,-1),Ot(" Add ")])),E("button",{onClick:t[5]||(t[5]=l=>r.showAddCategory=!1),class:"btn btn-outline-secondary flex-grow-1"},t[16]||(t[16]=[E("i",{class:"bi bi-x-circle"},null,-1),Ot(" Cancel ")]))])])):Bt("",!0),r.showAddItem?(rt(),lt("div",WM,[fe(E("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>r.newItem=l),placeholder:"Add item to "+r.selectedCategory,class:"form-control form-control-lg mb-2",onKeyup:t[7]||(t[7]=Ca((...l)=>o.addItem&&o.addItem(...l),["enter"]))},null,40,KM),[[Ae,r.newItem]]),E("div",GM,[E("button",{onClick:t[8]||(t[8]=(...l)=>o.addItem&&o.addItem(...l)),class:"btn btn-success flex-grow-1"},t[17]||(t[17]=[E("i",{class:"bi bi-check-circle"},null,-1),Ot(" Add ")])),E("button",{onClick:t[9]||(t[9]=l=>r.showAddItem=!1),class:"btn btn-outline-secondary flex-grow-1"},t[18]||(t[18]=[E("i",{class:"bi bi-x-circle"},null,-1),Ot(" Cancel ")]))])])):Bt("",!0)])]),r.selectedCategory?(rt(),lt("div",ZM,[E("div",QM,[E("h4",YM,It(r.selectedCategory),1),E("div",XM,[(rt(!0),lt(qe,null,Qi(o.getCurrentItems(),l=>(rt(),lt("div",{key:l.id,class:"item"},[E("label",JM,[fe(E("input",{type:"checkbox","onUpdate:modelValue":h=>l.checked=h,onChange:h=>o.updateItem(l)},null,40,tO),[[Ng,l.checked]]),t[19]||(t[19]=E("span",{class:"checkmark"},null,-1)),E("span",{class:cr(["item-name",{checked:l.checked}])},It(l.name),3)]),E("button",{onClick:h=>o.deleteItem(l.id),class:"btn btn-outline-danger btn-sm"},t[20]||(t[20]=[E("i",{class:"bi bi-trash"},null,-1)]),8,eO)]))),128))])])])):Bt("",!0)])]),r.showDeleteModal?(rt(),lt("div",nO,[E("div",iO,[t[23]||(t[23]=E("h5",null,"Delete Category",-1)),E("p",null,'Are you sure you want to delete the category "'+It(r.categoryToDeleteName)+'"?',1),E("div",sO,[E("button",{onClick:t[10]||(t[10]=(...l)=>o.deleteCategory&&o.deleteCategory(...l)),class:"btn btn-danger flex-grow-1"},t[21]||(t[21]=[E("i",{class:"bi bi-trash"},null,-1),Ot(" Delete ")])),E("button",{onClick:t[11]||(t[11]=l=>r.showDeleteModal=!1),class:"btn btn-outline-secondary flex-grow-1"},t[22]||(t[22]=[E("i",{class:"bi bi-x-circle"},null,-1),Ot(" Cancel ")]))])])])):Bt("",!0)])}const oO=In(IM,[["render",rO],["__scopeId","data-v-31a607ff"]]),aO={name:"Reservations",props:["trip"],data(){return{newReservation:{name:"",link:"",file:null},reservations:[],loading:!1,errorMessage:"",unsubscribe:null}},created(){this.loadReservations()},beforeUnmount(){this.unsubscribe&&this.unsubscribe()},methods:{async loadReservations(){this.loading=!0;try{this.unsubscribe=To(Wn(ve,"trips",this.trip.id,"reservations"),e=>{this.reservations=e.docs.map(t=>({id:t.id,...t.data()})),this.loading=!1},e=>{console.error("Error loading reservations:",e),this.errorMessage="Failed to load reservations",this.loading=!1})}catch(e){console.error("Error:",e),this.errorMessage="Failed to load reservations",this.loading=!1}},handleFileUpload(e){this.newReservation.file=e.target.files[0]},removeFile(){this.newReservation.file=null},formatDate(e){return e?e.toDate().toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):""},async addReservation(){if(!this.newReservation.name.trim()){this.errorMessage="Please enter a reservation name";return}this.loading=!0,this.errorMessage="";try{let e="";if(this.newReservation.file){const t=nd(id,`reservations/${this.trip.id}/${Date.now()}_${this.newReservation.file.name}`);await Bw(t,this.newReservation.file),e=await zw(t)}await fl(Wn(ve,"trips",this.trip.id,"reservations"),{name:this.newReservation.name.trim(),link:this.newReservation.link.trim()||null,fileUrl:e||null,createdAt:new Date}),this.newReservation={name:"",link:"",file:null}}catch(e){console.error("Error adding reservation:",e),this.errorMessage="Failed to add reservation"}finally{this.loading=!1}},async deleteReservation(e){if(confirm("Are you sure you want to delete this reservation?")){this.loading=!0;try{await xo(mn(ve,"trips",this.trip.id,"reservations",e))}catch(t){console.error("Error deleting reservation:",t),this.errorMessage="Failed to delete reservation"}finally{this.loading=!1}}}}},lO={class:"container-fluid p-3 p-md-5 reservations-container"},cO={class:"header d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-4"},uO={class:"text-success mb-3 mb-md-0"},hO={class:"card shadow-sm mb-4"},dO={class:"card-body"},fO={class:"mb-3"},pO={class:"mb-3"},mO={class:"mb-3"},_O={class:"btn btn-outline-success w-100"},gO={key:0,class:"d-flex align-items-center mt-2"},vO={class:"text-truncate me-2"},yO=["disabled"],wO={key:0},TO={key:1,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},EO={key:0,class:"alert alert-danger mt-3 mb-0"},bO={key:0,class:"text-center py-4"},IO={key:1,class:"card shadow-sm"},PO={class:"card-body"},AO={class:"card-body d-flex justify-content-between"},CO={class:"flex-grow-1"},RO={class:"text-success"},SO={key:0,class:"mb-2"},xO=["href"],kO={key:1,class:"mb-2"},LO=["href"],MO={class:"text-muted small"},OO=["onClick"],DO={key:2,class:"card shadow-sm text-center py-5"};function NO(e,t,n,i,r,o){return rt(),lt("div",lO,[E("div",cO,[E("h2",uO,"Reservations - "+It(n.trip.name),1),E("button",{onClick:t[0]||(t[0]=l=>e.$emit("close")),class:"btn btn-outline-success"},t[6]||(t[6]=[E("i",{class:"fas fa-arrow-left me-2"},null,-1),Ot("Back ")]))]),E("div",hO,[E("div",dO,[t[10]||(t[10]=E("h3",{class:"card-title text-success mb-4"},"Add New Reservation",-1)),E("div",fO,[fe(E("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>r.newReservation.name=l),placeholder:"Reservation name (e.g. Flight to Paris)",class:"form-control",required:""},null,512),[[Ae,r.newReservation.name]])]),E("div",pO,[fe(E("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>r.newReservation.link=l),placeholder:"Reservation link (optional)",class:"form-control",type:"url"},null,512),[[Ae,r.newReservation.link]])]),E("div",mO,[E("label",_O,[t[7]||(t[7]=E("i",{class:"fas fa-paperclip me-2"},null,-1)),t[8]||(t[8]=Ot("Attach File ")),E("input",{type:"file",onChange:t[3]||(t[3]=(...l)=>o.handleFileUpload&&o.handleFileUpload(...l)),class:"d-none"},null,32)]),r.newReservation.file?(rt(),lt("div",gO,[E("span",vO,It(r.newReservation.file.name),1),E("button",{onClick:t[4]||(t[4]=(...l)=>o.removeFile&&o.removeFile(...l)),class:"btn btn-sm btn-outline-danger"},t[9]||(t[9]=[E("i",{class:"fas fa-times"},null,-1)]))])):Bt("",!0)]),E("button",{onClick:t[5]||(t[5]=(...l)=>o.addReservation&&o.addReservation(...l)),class:"btn btn-success w-100",disabled:!r.newReservation.name.trim()||r.loading},[r.loading?(rt(),lt("span",TO)):(rt(),lt("span",wO,"Add Reservation"))],8,yO),r.errorMessage?(rt(),lt("div",EO,It(r.errorMessage),1)):Bt("",!0)])]),r.loading&&!r.reservations.length?(rt(),lt("div",bO,t[11]||(t[11]=[E("div",{class:"spinner-border text-success",role:"status"},[E("span",{class:"visually-hidden"},"Loading...")],-1)]))):Bt("",!0),r.reservations.length?(rt(),lt("div",IO,[E("div",PO,[t[15]||(t[15]=E("h3",{class:"card-title text-success mb-4"},"Your Reservations",-1)),(rt(!0),lt(qe,null,Qi(r.reservations,l=>(rt(),lt("div",{class:"card mb-3",key:l.id},[E("div",AO,[E("div",CO,[E("h4",RO,It(l.name),1),l.link?(rt(),lt("div",SO,[E("a",{href:l.link,target:"_blank",class:"btn btn-sm btn-outline-success"},t[12]||(t[12]=[E("i",{class:"fas fa-external-link-alt me-2"},null,-1),Ot("Open Link ")]),8,xO)])):Bt("",!0),l.fileUrl?(rt(),lt("div",kO,[E("a",{href:l.fileUrl,target:"_blank",class:"btn btn-sm btn-outline-success"},t[13]||(t[13]=[E("i",{class:"fas fa-file-download me-2"},null,-1),Ot("Download Attachment ")]),8,LO)])):Bt("",!0),E("div",MO," Added on "+It(o.formatDate(l.createdAt)),1)]),E("button",{onClick:h=>o.deleteReservation(l.id),class:"btn btn-outline-danger ms-3 align-self-start"},t[14]||(t[14]=[E("i",{class:"fas fa-trash"},null,-1)]),8,OO)])]))),128))])])):Bt("",!0),!r.loading&&!r.reservations.length?(rt(),lt("div",DO,t[16]||(t[16]=[E("i",{class:"fas fa-calendar-check text-muted mb-3",style:{"font-size":"3rem"}},null,-1),E("p",{class:"text-muted"},"No reservations yet",-1)]))):Bt("",!0)])}const VO=In(aO,[["render",NO],["__scopeId","data-v-c0471350"]]),UO={name:"TravelDiary",props:["trip"],data(){return{diaryTitle:"",diaryContent:"",diaryEntries:[],imageFile:null,imagePreview:null,searchQuery:"",loading:!1,loadingEntries:!1,errorMessage:"",cameraActive:!1,cameraPreview:null,fileInput:null,cameraStream:null,unsubscribe:null}},created(){this.loadDiaryEntries()},beforeUnmount(){this.unsubscribe&&this.unsubscribe(),this.cameraActive&&this.stopCamera()},computed:{filteredDiaryEntries(){return this.diaryEntries.filter(e=>e.title.toLowerCase().includes(this.searchQuery.toLowerCase())||e.content.toLowerCase().includes(this.searchQuery.toLowerCase()))}},methods:{async loadDiaryEntries(){this.loadingEntries=!0;const e=Uy(Wn(ve,"trips",this.trip.id,"diaryEntries"),OR("createdAt","desc"));this.unsubscribe=To(e,t=>{this.diaryEntries=t.docs.map(n=>({id:n.id,...n.data()})),this.loadingEntries=!1},t=>{console.error("Error loading entries:",t),this.errorMessage="Failed to load diary entries",this.loadingEntries=!1})},triggerFileInput(){this.cameraActive&&this.stopCamera(),this.$refs.fileInput.click()},handleImageUpload(e){const t=e.target.files[0];if(t&&t.size<=5*1024*1024){this.imageFile=t;const n=new FileReader;n.onload=i=>{this.imagePreview=i.target.result},n.readAsDataURL(t)}},async toggleCamera(){this.cameraActive?this.stopCamera():await this.startCamera()},async startCamera(){try{this.cameraActive=!0,this.cameraStream=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1}),this.$refs.cameraPreview.srcObject=this.cameraStream}catch(e){console.error("Error accessing camera:",e),this.errorMessage="Could not access camera",this.cameraActive=!1}},stopCamera(){this.cameraStream&&(this.cameraStream.getTracks().forEach(e=>e.stop()),this.cameraStream=null),this.cameraActive=!1},capturePhoto(){const e=document.createElement("canvas");e.width=this.$refs.cameraPreview.videoWidth,e.height=this.$refs.cameraPreview.videoHeight,e.getContext("2d").drawImage(this.$refs.cameraPreview,0,0,e.width,e.height),e.toBlob(n=>{this.imageFile=new File([n],"capture.jpg",{type:"image/jpeg"}),this.imagePreview=e.toDataURL("image/jpeg"),this.stopCamera()},"image/jpeg",.9)},removeImage(){this.imageFile=null,this.imagePreview=null},async uploadImage(){if(!this.imageFile)return null;try{const e=`diaryEntries/${this.trip.id}/${Date.now()}_${this.imageFile.name}`,t=nd(id,e);return await Bw(t,this.imageFile),await zw(t)}catch(e){throw console.error("Error uploading image:",e),e}},async saveDiaryEntry(){if(!(!this.diaryTitle.trim()||!this.diaryContent.trim())){this.loading=!0,this.errorMessage="";try{let e=null;this.imageFile&&(e=await this.uploadImage()),await fl(Wn(ve,"trips",this.trip.id,"diaryEntries"),{title:this.diaryTitle.trim(),content:this.diaryContent.trim(),imageUrl:e,createdAt:new Date}),this.resetForm()}catch(e){console.error("Error saving entry:",e),this.errorMessage="Failed to save diary entry"}finally{this.loading=!1}}},async deleteEntry(e,t){if(confirm("Are you sure you want to delete this entry?")){this.loading=!0;try{if(t){const n=nd(id,t);await h1(n)}await xo(mn(ve,"trips",this.trip.id,"diaryEntries",e))}catch(n){console.error("Error deleting entry:",n),this.errorMessage="Failed to delete diary entry"}finally{this.loading=!1}}},resetForm(){this.diaryTitle="",this.diaryContent="",this.imageFile=null,this.imagePreview=null,this.errorMessage="",this.cameraActive&&this.stopCamera()},formatDate(e){return e?e.toDate().toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):""}}},FO={class:"container-fluid p-3 p-md-5 travel-diary-container"},BO={class:"header d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-4"},zO={class:"text-success mb-3 mb-md-0"},jO={class:"card shadow-sm mb-4"},HO={class:"card-body"},$O={class:"mb-3"},qO={class:"mb-3"},WO={class:"mb-3"},KO={class:"d-flex flex-column flex-sm-row gap-2 mb-3"},GO={key:0,class:"camera-preview mb-3 position-relative"},ZO={ref:"cameraPreview",autoplay:"",playsinline:"",class:"w-100 rounded"},QO={key:1,class:"image-preview mb-3 position-relative"},YO=["src"],XO={class:"d-flex gap-2"},JO=["disabled"],tD={key:0},eD={key:1,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},nD={class:"mb-4 position-relative"},iD={key:0,class:"text-center py-4"},sD={key:1,class:"card shadow-sm"},rD={class:"card-body"},oD={class:"card-body d-flex justify-content-between"},aD={class:"flex-grow-1"},lD={class:"text-success"},cD={class:"text-muted small mb-2"},uD={class:"card-text"},hD={key:0,class:"mt-3"},dD=["src"],fD=["onClick","disabled"],pD={key:2,class:"card shadow-sm text-center py-5"};function mD(e,t,n,i,r,o){return rt(),lt("div",FO,[E("div",BO,[E("h2",zO,"Travel Diary - "+It(n.trip.name),1),E("button",{onClick:t[0]||(t[0]=l=>e.$emit("close")),class:"btn btn-outline-success"},t[11]||(t[11]=[E("i",{class:"fas fa-arrow-left me-2"},null,-1),Ot("Back ")]))]),E("div",jO,[E("div",HO,[t[16]||(t[16]=E("h3",{class:"card-title text-success mb-4"},"New Entry",-1)),E("div",$O,[fe(E("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>r.diaryTitle=l),placeholder:"Entry title",class:"form-control",required:""},null,512),[[Ae,r.diaryTitle]])]),E("div",qO,[fe(E("textarea",{"onUpdate:modelValue":t[2]||(t[2]=l=>r.diaryContent=l),placeholder:"Write your thoughts...",class:"form-control",rows:"5",required:""},null,512),[[Ae,r.diaryContent]])]),E("div",WO,[E("div",KO,[E("button",{onClick:t[3]||(t[3]=(...l)=>o.triggerFileInput&&o.triggerFileInput(...l)),class:"btn btn-outline-success flex-grow-1"},t[12]||(t[12]=[E("i",{class:"fas fa-upload me-2"},null,-1),Ot("Upload Photo ")])),E("button",{onClick:t[4]||(t[4]=(...l)=>o.toggleCamera&&o.toggleCamera(...l)),class:cr(["btn btn-outline-success flex-grow-1",{"btn-danger":r.cameraActive}])},[t[13]||(t[13]=E("i",{class:"fas fa-camera me-2"},null,-1)),Ot(It(r.cameraActive?"Cancel":"Take Photo"),1)],2)]),E("input",{ref:"fileInput",type:"file",onChange:t[5]||(t[5]=(...l)=>o.handleImageUpload&&o.handleImageUpload(...l)),class:"d-none",accept:"image/*"},null,544)]),r.cameraActive?(rt(),lt("div",GO,[E("video",ZO,null,512),E("button",{onClick:t[6]||(t[6]=(...l)=>o.capturePhoto&&o.capturePhoto(...l)),class:"btn btn-success position-absolute bottom-0 start-50 translate-middle-x mb-3"},t[14]||(t[14]=[E("i",{class:"fas fa-camera me-2"},null,-1),Ot("Capture ")]))])):Bt("",!0),r.imagePreview?(rt(),lt("div",QO,[E("img",{src:r.imagePreview,alt:"Preview",class:"img-fluid rounded border border-success"},null,8,YO),E("button",{onClick:t[7]||(t[7]=(...l)=>o.removeImage&&o.removeImage(...l)),class:"btn btn-danger position-absolute top-0 end-0 m-2 rounded-circle"},t[15]||(t[15]=[E("i",{class:"fas fa-times"},null,-1)]))])):Bt("",!0),E("div",XO,[E("button",{onClick:t[8]||(t[8]=(...l)=>o.saveDiaryEntry&&o.saveDiaryEntry(...l)),class:"btn btn-success flex-grow-1",disabled:!r.diaryTitle.trim()||!r.diaryContent.trim()||r.loading},[r.loading?(rt(),lt("span",eD)):(rt(),lt("span",tD,"Save Entry"))],8,JO),E("button",{onClick:t[9]||(t[9]=(...l)=>o.resetForm&&o.resetForm(...l)),class:"btn btn-outline-secondary flex-grow-1"}," Clear ")])])]),E("div",nD,[fe(E("input",{"onUpdate:modelValue":t[10]||(t[10]=l=>r.searchQuery=l),placeholder:"Search entries...",class:"form-control ps-4"},null,512),[[Ae,r.searchQuery]]),t[17]||(t[17]=E("i",{class:"fas fa-search position-absolute top-50 start-0 translate-middle-y ms-3 text-muted"},null,-1))]),r.loadingEntries?(rt(),lt("div",iD,t[18]||(t[18]=[E("div",{class:"spinner-border text-success",role:"status"},[E("span",{class:"visually-hidden"},"Loading...")],-1)]))):Bt("",!0),!r.loadingEntries&&o.filteredDiaryEntries.length?(rt(),lt("div",sD,[E("div",rD,[t[20]||(t[20]=E("h3",{class:"card-title text-success mb-4"},"Your Entries",-1)),(rt(!0),lt(qe,null,Qi(o.filteredDiaryEntries,l=>(rt(),lt("div",{key:l.id,class:"card mb-3"},[E("div",oD,[E("div",aD,[E("h4",lD,It(l.title),1),E("div",cD,It(o.formatDate(l.createdAt)),1),E("p",uD,It(l.content),1),l.imageUrl?(rt(),lt("div",hD,[E("img",{src:l.imageUrl,alt:"Entry image",class:"img-fluid rounded border border-success"},null,8,dD)])):Bt("",!0)]),E("button",{onClick:h=>o.deleteEntry(l.id,l.imageUrl),class:"btn btn-outline-danger ms-3 align-self-start",disabled:r.loading},t[19]||(t[19]=[E("i",{class:"fas fa-trash"},null,-1)]),8,fD)])]))),128))])])):Bt("",!0),!r.loadingEntries&&!o.filteredDiaryEntries.length?(rt(),lt("div",pD,t[21]||(t[21]=[E("i",{class:"fas fa-book-open text-muted mb-3",style:{"font-size":"3rem"}},null,-1),E("p",{class:"text-muted"},"No diary entries yet",-1)]))):Bt("",!0)])}const _D=In(UO,[["render",mD],["__scopeId","data-v-196e8d7d"]]),gD={name:"TripDetails",components:{TravelPoints:RL,Budget:bM,PackingList:oO,Reservations:VO,TravelDiary:_D},props:{id:{type:String,required:!0}},setup(e){const t=sn(null),n=sn(null),i=h=>{if(!h)return"No data";const d={year:"numeric",month:"short",day:"numeric"};return new Date(h).toLocaleDateString(void 0,d)},r=async()=>{try{const h=mn(ve,"trips",e.id),d=await VR(h);d.exists()&&(t.value={id:d.id,...d.data()})}catch(h){console.error("Error loading trip:",h)}},o=h=>{n.value=n.value===h?null:h},l=()=>{n.value=null};return nu(r),Pa(()=>e.id,r),{trip:t,activeSection:n,formatDate:i,activateSection:o,closeSection:l}}},vD={class:"trip-details container-fluid py-4 py-md-5 px-3 px-md-5"},yD={class:"d-flex justify-content-between align-items-center mb-4"},wD={class:"card shadow-sm mb-5"},TD={class:"card-body p-4 p-md-5"},ED={class:"text-success mb-4"},bD={class:"trip-info row"},ID={class:"col-md-6"},PD={class:"trip-actions d-flex flex-wrap gap-2 mt-4"},AD={key:0,class:"card shadow-sm mb-5"},CD={key:1,class:"card shadow-sm mb-5"},RD={key:2,class:"card shadow-sm mb-5"},SD={key:3,class:"card shadow-sm mb-5"},xD={key:4,class:"card shadow-sm mb-5"};function kD(e,t,n,i,r,o){var T,I,U,B;const l=xn("router-link"),h=xn("TravelPoints"),d=xn("Budget"),p=xn("PackingList"),_=xn("Reservations"),y=xn("TravelDiary");return rt(),lt("div",vD,[E("div",yD,[pe(l,{to:"/home",class:"btn btn-outline-success"},{default:Io(()=>t[5]||(t[5]=[E("i",{class:"fas fa-arrow-left me-2"},null,-1),Ot("Back to Trips ")])),_:1})]),E("div",wD,[E("div",TD,[E("h2",ED,It(i.trip?i.trip.name:"Loading..."),1),E("div",bD,[E("div",ID,[E("p",null,[t[6]||(t[6]=E("strong",null,[E("i",{class:"fas fa-map-marker-alt text-success me-2"}),Ot("Country:")],-1)),Ot(" "+It(((T=i.trip)==null?void 0:T.country)||"No data"),1)]),E("p",null,[t[7]||(t[7]=E("strong",null,[E("i",{class:"far fa-calendar-alt text-success me-2"}),Ot("Departure:")],-1)),Ot(" "+It(i.formatDate((I=i.trip)==null?void 0:I.departureDate)),1)]),E("p",null,[t[8]||(t[8]=E("strong",null,[E("i",{class:"far fa-calendar-alt text-success me-2"}),Ot("Arrival:")],-1)),Ot(" "+It(i.formatDate((U=i.trip)==null?void 0:U.arrivalDate)),1)])])]),E("div",PD,[E("button",{onClick:t[0]||(t[0]=j=>i.activateSection("travelPoints")),class:"btn btn-success"},t[9]||(t[9]=[E("i",{class:"fas fa-map-marked-alt me-2"},null,-1),Ot("Travel Points ")])),E("button",{onClick:t[1]||(t[1]=j=>i.activateSection("budget")),class:"btn btn-success"},t[10]||(t[10]=[E("i",{class:"fas fa-wallet me-2"},null,-1),Ot("Budget ")])),E("button",{onClick:t[2]||(t[2]=j=>i.activateSection("packingList")),class:"btn btn-success"},t[11]||(t[11]=[E("i",{class:"fas fa-suitcase me-2"},null,-1),Ot("Packing List ")])),E("button",{onClick:t[3]||(t[3]=j=>i.activateSection("reservations")),class:"btn btn-success"},t[12]||(t[12]=[E("i",{class:"fas fa-hotel me-2"},null,-1),Ot("Reservations ")])),E("button",{onClick:t[4]||(t[4]=j=>i.activateSection("travelDiary")),class:"btn btn-success"},t[13]||(t[13]=[E("i",{class:"fas fa-book me-2"},null,-1),Ot("Travel Diary ")]))])])]),i.activeSection==="travelPoints"?(rt(),lt("div",AD,[pe(h,{tripId:(B=i.trip)==null?void 0:B.id,onClose:i.closeSection},null,8,["tripId","onClose"])])):Bt("",!0),i.activeSection==="budget"?(rt(),lt("div",CD,[pe(d,{trip:i.trip,onClose:i.closeSection},null,8,["trip","onClose"])])):Bt("",!0),i.activeSection==="packingList"?(rt(),lt("div",RD,[pe(p,{trip:i.trip,onClose:i.closeSection},null,8,["trip","onClose"])])):Bt("",!0),i.activeSection==="reservations"?(rt(),lt("div",SD,[pe(_,{trip:i.trip,onClose:i.closeSection},null,8,["trip","onClose"])])):Bt("",!0),i.activeSection==="travelDiary"?(rt(),lt("div",xD,[pe(y,{trip:i.trip,onClose:i.closeSection},null,8,["trip","onClose"])])):Bt("",!0)])}const LD=In(gD,[["render",kD],["__scopeId","data-v-8d89845c"]]),MD={name:"Login",setup(){const e=sn(""),t=sn(""),n=sn(""),i=lu();return{email:e,password:t,loginWithEmail:async()=>{try{await zS(Eo,e.value,t.value),i.push("/home")}catch(l){n.value="Login failed. Please check your credentials and try again.",console.error("Error during login",l)}},loginWithGoogle:async()=>{try{const l=new $i;await hx(Eo,l),i.push("/home")}catch(l){n.value="Google login failed. Please try again.",console.error("Error during Google login",l)}},errorMessage:n}}},OD={class:"login-page vh-100 d-flex justify-content-center align-items-center p-3",style:{"background-color":"#f8f9fa"}},DD={class:"login-card card shadow-sm p-4 p-md-5 w-100",style:{"max-width":"500px"}},ND={key:0,class:"alert alert-danger mb-4"},VD={class:"mb-3"},UD={class:"mb-4"},FD={class:"text-center mt-4"};function BD(e,t,n,i,r,o){const l=xn("router-link");return rt(),lt("div",OD,[E("div",DD,[t[9]||(t[9]=E("div",{class:"text-center mb-4"},[E("img",{src:bd,alt:"TripMaster Logo",class:"mb-3",style:{width:"80px"}}),E("h1",{class:"text-success mb-3"},"Welcome Back"),E("p",{class:"text-muted"},"Sign in to continue to TripMaster")],-1)),i.errorMessage?(rt(),lt("div",ND,It(i.errorMessage),1)):Bt("",!0),E("form",{onSubmit:t[2]||(t[2]=Is((...h)=>i.loginWithEmail&&i.loginWithEmail(...h),["prevent"])),class:"mb-4"},[E("div",VD,[t[4]||(t[4]=E("label",{for:"email",class:"form-label"},"Email",-1)),fe(E("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":t[0]||(t[0]=h=>i.email=h),required:"",placeholder:"Enter your email"},null,512),[[Ae,i.email]])]),E("div",UD,[t[5]||(t[5]=E("label",{for:"password",class:"form-label"},"Password",-1)),fe(E("input",{type:"password",class:"form-control",id:"password","onUpdate:modelValue":t[1]||(t[1]=h=>i.password=h),required:"",placeholder:"Enter your password"},null,512),[[Ae,i.password]])]),t[6]||(t[6]=E("button",{type:"submit",class:"btn btn-success w-100 py-2 mb-3"},[E("i",{class:"fas fa-sign-in-alt me-2"}),Ot("Login ")],-1))],32),t[10]||(t[10]=E("div",{class:"text-center mb-4 position-relative"},[E("hr",{class:"my-4"}),E("span",{class:"px-2 bg-white position-absolute top-50 start-50 translate-middle text-muted"},"OR")],-1)),E("button",{onClick:t[3]||(t[3]=(...h)=>i.loginWithGoogle&&i.loginWithGoogle(...h)),class:"btn btn-outline-secondary w-100 py-2 mb-3"},t[7]||(t[7]=[E("i",{class:"fab fa-google me-2"},null,-1),Ot("Continue with Google ")])),E("div",FD,[pe(l,{to:"/",class:"text-decoration-none text-muted"},{default:Io(()=>t[8]||(t[8]=[E("i",{class:"fas fa-arrow-left me-2"},null,-1),Ot("Back to Home ")])),_:1})])])])}const zD=In(MD,[["render",BD],["__scopeId","data-v-f93184cc"]]),jD={name:"Register",setup(){const e=sn(""),t=sn(""),n=sn(""),i=sn(""),r=lu();return{email:e,password:t,confirmPassword:n,errorMessage:i,registerUser:async()=>{if(t.value!==n.value){i.value="Passwords do not match.";return}try{await BS(Eo,e.value,t.value),r.push("/home")}catch(l){i.value=l.message.includes("email-already-in-use")?"Email already in use. Please login instead.":"Registration failed. Please try again."}}}}},HD={class:"register-page vh-100 d-flex justify-content-center align-items-center p-3",style:{"background-color":"#f8f9fa"}},$D={class:"register-card card shadow-sm p-4 p-md-5 w-100",style:{"max-width":"500px"}},qD={key:0,class:"alert alert-danger mb-4"},WD={class:"mb-3"},KD={class:"mb-3"},GD={class:"mb-4"},ZD={class:"text-center"};function QD(e,t,n,i,r,o){const l=xn("router-link");return rt(),lt("div",HD,[E("div",$D,[t[10]||(t[10]=E("div",{class:"text-center mb-4"},[E("img",{src:bd,alt:"TripMaster Logo",class:"mb-3",style:{width:"80px"}}),E("h2",{class:"text-success mb-3"},"Create Account"),E("p",{class:"text-muted"},"Join TripMaster to start planning your adventures")],-1)),i.errorMessage?(rt(),lt("div",qD,It(i.errorMessage),1)):Bt("",!0),E("form",{onSubmit:t[3]||(t[3]=Is((...h)=>i.registerUser&&i.registerUser(...h),["prevent"])),class:"mb-4"},[E("div",WD,[t[4]||(t[4]=E("label",{for:"email",class:"form-label"},"Email",-1)),fe(E("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":t[0]||(t[0]=h=>i.email=h),required:"",placeholder:"Enter your email"},null,512),[[Ae,i.email]])]),E("div",KD,[t[5]||(t[5]=E("label",{for:"password",class:"form-label"},"Password",-1)),fe(E("input",{type:"password",class:"form-control",id:"password","onUpdate:modelValue":t[1]||(t[1]=h=>i.password=h),required:"",placeholder:"Create a password"},null,512),[[Ae,i.password]])]),E("div",GD,[t[6]||(t[6]=E("label",{for:"confirmPassword",class:"form-label"},"Confirm Password",-1)),fe(E("input",{type:"password",class:"form-control",id:"confirmPassword","onUpdate:modelValue":t[2]||(t[2]=h=>i.confirmPassword=h),required:"",placeholder:"Confirm your password"},null,512),[[Ae,i.confirmPassword]])]),t[7]||(t[7]=E("button",{type:"submit",class:"btn btn-success w-100 py-2 mb-3"},[E("i",{class:"fas fa-user-plus me-2"}),Ot("Register ")],-1))],32),E("div",ZD,[t[9]||(t[9]=E("p",{class:"text-muted mb-0"},"Already have an account?",-1)),pe(l,{to:"/login",class:"text-decoration-none text-success"},{default:Io(()=>t[8]||(t[8]=[Ot(" Sign in instead ")])),_:1})])])])}const YD=In(jD,[["render",QD],["__scopeId","data-v-be7f05b9"]]),XD={},JD={class:"info-page container py-5 text-center"},tN={class:"text-center mb-4"};function eN(e,t){const n=xn("router-link");return rt(),lt("div",JD,[E("div",tN,[pe(n,{to:"/",class:"btn btn-outline-success"},{default:Io(()=>t[0]||(t[0]=[E("i",{class:"fas fa-arrow-left me-2"},null,-1),Ot("Back to Home ")])),_:1})]),t[1]||(t[1]=wd('<div class="card shadow-sm mb-5 mx-auto" style="max-width:800px;" data-v-c22d1b3c><div class="card-body p-4 p-md-5" data-v-c22d1b3c><h2 class="text-success mb-4" data-v-c22d1b3c>About TripMaster</h2><div class="app-description mx-auto" style="max-width:700px;" data-v-c22d1b3c><p class="lead" data-v-c22d1b3c> Planning a trip can be overwhelming, but with TripMaster, organizing your adventures has never been easier. TripMaster is a comprehensive travel planning app designed to simplify every step of your journey—from choosing a destination to packing your bags. Whether you&#39;re a spontaneous explorer or a meticulous planner, this app ensures that you can focus on the excitement of travel rather than the hassle of logistics. </p></div></div></div><div class="card shadow-sm mx-auto" style="max-width:800px;" data-v-c22d1b3c><div class="card-body p-4 p-md-5" data-v-c22d1b3c><h2 class="text-success mb-4" data-v-c22d1b3c>Our Team</h2><ul class="list-unstyled authors-list mx-auto" style="max-width:300px;" data-v-c22d1b3c><li class="mb-3" data-v-c22d1b3c><i class="fas fa-user text-success me-2" data-v-c22d1b3c></i>Amanda Miśkiewicz </li><li class="mb-3" data-v-c22d1b3c><i class="fas fa-user text-success me-2" data-v-c22d1b3c></i>Julia Mieszaniec </li><li class="mb-3" data-v-c22d1b3c><i class="fas fa-user text-success me-2" data-v-c22d1b3c></i>Jan Paluch </li></ul></div></div>',2))])}const nN=In(XD,[["render",eN],["__scopeId","data-v-c22d1b3c"]]),iN=[{path:"/",name:"Home",component:ZI,meta:{transition:"fade"}},{path:"/info",name:"Info",component:nN},{path:"/login",name:"Login",component:zD},{path:"/register",name:"Register",component:YD},{path:"/home",name:"HomeView",component:C_,meta:{requiresAuth:!0}},{path:"/trips",name:"Trips",component:C_,meta:{requiresAuth:!0}},{path:"/trip/:id",name:"TripDetails",component:LD,props:!0,meta:{requiresAuth:!0}},{path:"/:pathMatch(.*)*",redirect:"/"}],jw=jI({history:gI("/TripMaster/"),routes:iN,scrollBehavior(e,t,n){return n||{top:0}}});jw.beforeEach((e,t,n)=>{const i=bw(),r=e.matched.some(l=>l.meta.requiresAuth),o=i.currentUser;r&&!o?n("/login"):n()});const sN="modulepreload",rN=function(e){return"/TripMaster/"+e},S_={},oN=function(t,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),h=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));r=Promise.allSettled(n.map(d=>{if(d=rN(d),d in S_)return;S_[d]=!0;const p=d.endsWith(".css"),_=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${_}`))return;const y=document.createElement("link");if(y.rel=p?"stylesheet":sN,p||(y.as="script"),y.crossOrigin="",y.href=d,h&&y.setAttribute("nonce",h),document.head.appendChild(y),p)return new Promise((T,I)=>{y.addEventListener("load",T),y.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(l){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=l,window.dispatchEvent(h),!h.defaultPrevented)throw l}return r.then(l=>{for(const h of l||[])h.status==="rejected"&&o(h.reason);return t().catch(o)})};function aN(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:i,onRegistered:r,onRegisteredSW:o,onRegisterError:l}=e;let h,d;const p=async(y=!0)=>{await d};async function _(){if("serviceWorker"in navigator){if(h=await oN(async()=>{const{Workbox:y}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:y}},[]).then(({Workbox:y})=>new y("/TripMaster/sw.js",{scope:"/TripMaster/",type:"classic"})).catch(y=>{l==null||l(y)}),!h)return;h.addEventListener("activated",y=>{(y.isUpdate||y.isExternal)&&window.location.reload()}),h.addEventListener("installed",y=>{y.isUpdate||i==null||i()}),h.register({immediate:t}).then(y=>{o?o("/TripMaster/sw.js",y):r==null||r(y)}).catch(y=>{l==null||l(y)})}}return d=_(),p}Ob(Fb).use(jw).mount("#app");aN({onNeedRefresh(){console.log("Nowa wersja dostępna. Odśwież stronę!")},onOfflineReady(){console.log("Aplikacja jest teraz dostępna offline!")}});
