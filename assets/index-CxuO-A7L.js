(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function sd(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const de={},Ys=[],gi=()=>{},mT=()=>!1,Gc=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),od=e=>e.startsWith("onUpdate:"),ln=Object.assign,ad=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},_T=Object.prototype.hasOwnProperty,se=(e,t)=>_T.call(e,t),It=Array.isArray,Xs=e=>Xa(e)==="[object Map]",Eo=e=>Xa(e)==="[object Set]",Jf=e=>Xa(e)==="[object Date]",Vt=e=>typeof e=="function",Ve=e=>typeof e=="string",bi=e=>typeof e=="symbol",_e=e=>e!==null&&typeof e=="object",k_=e=>(_e(e)||Vt(e))&&Vt(e.then)&&Vt(e.catch),L_=Object.prototype.toString,Xa=e=>L_.call(e),gT=e=>Xa(e).slice(8,-1),O_=e=>Xa(e)==="[object Object]",ld=e=>Ve(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,va=sd(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Kc=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},vT=/-(\w)/g,Gn=Kc(e=>e.replace(vT,(t,n)=>n?n.toUpperCase():"")),yT=/\B([A-Z])/g,Dr=Kc(e=>e.replace(yT,"-$1").toLowerCase()),Zc=Kc(e=>e.charAt(0).toUpperCase()+e.slice(1)),zu=Kc(e=>e?`on${Zc(e)}`:""),br=(e,t)=>!Object.is(e,t),rc=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},M_=(e,t,n,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:n})},yc=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let tp;const Qc=()=>tp||(tp=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function cd(e){if(It(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],s=Ve(i)?bT(i):cd(i);if(s)for(const o in s)t[o]=s[o]}return t}else if(Ve(e)||_e(e))return e}const wT=/;(?![^(]*\))/g,TT=/:([^]+)/,ET=/\/\*[^]*?\*\//g;function bT(e){const t={};return e.replace(ET,"").split(wT).forEach(n=>{if(n){const i=n.split(TT);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function Ja(e){let t="";if(Ve(e))t=e;else if(It(e))for(let n=0;n<e.length;n++){const i=Ja(e[n]);i&&(t+=i+" ")}else if(_e(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const IT="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",PT=sd(IT);function D_(e){return!!e||e===""}function AT(e,t){if(e.length!==t.length)return!1;let n=!0;for(let i=0;n&&i<e.length;i++)n=tl(e[i],t[i]);return n}function tl(e,t){if(e===t)return!0;let n=Jf(e),i=Jf(t);if(n||i)return n&&i?e.getTime()===t.getTime():!1;if(n=bi(e),i=bi(t),n||i)return e===t;if(n=It(e),i=It(t),n||i)return n&&i?AT(e,t):!1;if(n=_e(e),i=_e(t),n||i){if(!n||!i)return!1;const s=Object.keys(e).length,o=Object.keys(t).length;if(s!==o)return!1;for(const l in e){const h=e.hasOwnProperty(l),d=t.hasOwnProperty(l);if(h&&!d||!h&&d||!tl(e[l],t[l]))return!1}}return String(e)===String(t)}function ud(e,t){return e.findIndex(n=>tl(n,t))}const N_=e=>!!(e&&e.__v_isRef===!0),Nt=e=>Ve(e)?e:e==null?"":It(e)||_e(e)&&(e.toString===L_||!Vt(e.toString))?N_(e)?Nt(e.value):JSON.stringify(e,V_,2):String(e),V_=(e,t)=>N_(t)?V_(e,t.value):Xs(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[i,s],o)=>(n[ju(i,o)+" =>"]=s,n),{})}:Eo(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>ju(n))}:bi(t)?ju(t):_e(t)&&!It(t)&&!O_(t)?String(t):t,ju=(e,t="")=>{var n;return bi(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let xn;class RT{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=xn,!t&&xn&&(this.index=(xn.scopes||(xn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=xn;try{return xn=this,t()}finally{xn=n}}}on(){xn=this}off(){xn=this.parent}stop(t){if(this._active){this._active=!1;let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(this.effects.length=0,n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function CT(){return xn}let fe;const Hu=new WeakSet;class U_{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,xn&&xn.active&&xn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Hu.has(this)&&(Hu.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||B_(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,ep(this),z_(this);const t=fe,n=ni;fe=this,ni=!0;try{return this.fn()}finally{j_(this),fe=t,ni=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)fd(t);this.deps=this.depsTail=void 0,ep(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Hu.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){fh(this)&&this.run()}get dirty(){return fh(this)}}let F_=0,ya,wa;function B_(e,t=!1){if(e.flags|=8,t){e.next=wa,wa=e;return}e.next=ya,ya=e}function hd(){F_++}function dd(){if(--F_>0)return;if(wa){let t=wa;for(wa=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;ya;){let t=ya;for(ya=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){e||(e=i)}t=n}}if(e)throw e}function z_(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function j_(e){let t,n=e.depsTail,i=n;for(;i;){const s=i.prevDep;i.version===-1?(i===n&&(n=s),fd(i),ST(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=s}e.deps=t,e.depsTail=n}function fh(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(H_(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function H_(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Ma))return;e.globalVersion=Ma;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!fh(e)){e.flags&=-3;return}const n=fe,i=ni;fe=e,ni=!0;try{z_(e);const s=e.fn(e._value);(t.version===0||br(s,e._value))&&(e._value=s,t.version++)}catch(s){throw t.version++,s}finally{fe=n,ni=i,j_(e),e.flags&=-3}}function fd(e,t=!1){const{dep:n,prevSub:i,nextSub:s}=e;if(i&&(i.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=i,e.nextSub=void 0),n.subs===e&&(n.subs=i,!i&&n.computed)){n.computed.flags&=-5;for(let o=n.computed.deps;o;o=o.nextDep)fd(o,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function ST(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let ni=!0;const q_=[];function Nr(){q_.push(ni),ni=!1}function Vr(){const e=q_.pop();ni=e===void 0?!0:e}function ep(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=fe;fe=void 0;try{t()}finally{fe=n}}}let Ma=0;class xT{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class pd{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!fe||!ni||fe===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==fe)n=this.activeLink=new xT(fe,this),fe.deps?(n.prevDep=fe.depsTail,fe.depsTail.nextDep=n,fe.depsTail=n):fe.deps=fe.depsTail=n,W_(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const i=n.nextDep;i.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=i),n.prevDep=fe.depsTail,n.nextDep=void 0,fe.depsTail.nextDep=n,fe.depsTail=n,fe.deps===n&&(fe.deps=i)}return n}trigger(t){this.version++,Ma++,this.notify(t)}notify(t){hd();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{dd()}}}function W_(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)W_(i)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const ph=new WeakMap,os=Symbol(""),mh=Symbol(""),Da=Symbol("");function en(e,t,n){if(ni&&fe){let i=ph.get(e);i||ph.set(e,i=new Map);let s=i.get(n);s||(i.set(n,s=new pd),s.map=i,s.key=n),s.track()}}function ji(e,t,n,i,s,o){const l=ph.get(e);if(!l){Ma++;return}const h=d=>{d&&d.trigger()};if(hd(),t==="clear")l.forEach(h);else{const d=It(e),p=d&&ld(n);if(d&&n==="length"){const _=Number(i);l.forEach((v,T)=>{(T==="length"||T===Da||!bi(T)&&T>=_)&&h(v)})}else switch((n!==void 0||l.has(void 0))&&h(l.get(n)),p&&h(l.get(Da)),t){case"add":d?p&&h(l.get("length")):(h(l.get(os)),Xs(e)&&h(l.get(mh)));break;case"delete":d||(h(l.get(os)),Xs(e)&&h(l.get(mh)));break;case"set":Xs(e)&&h(l.get(os));break}}dd()}function qs(e){const t=re(e);return t===e?t:(en(t,"iterate",Da),Wn(e)?t:t.map(nn))}function Yc(e){return en(e=re(e),"iterate",Da),e}const kT={__proto__:null,[Symbol.iterator](){return qu(this,Symbol.iterator,nn)},concat(...e){return qs(this).concat(...e.map(t=>It(t)?qs(t):t))},entries(){return qu(this,"entries",e=>(e[1]=nn(e[1]),e))},every(e,t){return Fi(this,"every",e,t,void 0,arguments)},filter(e,t){return Fi(this,"filter",e,t,n=>n.map(nn),arguments)},find(e,t){return Fi(this,"find",e,t,nn,arguments)},findIndex(e,t){return Fi(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Fi(this,"findLast",e,t,nn,arguments)},findLastIndex(e,t){return Fi(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Fi(this,"forEach",e,t,void 0,arguments)},includes(...e){return Wu(this,"includes",e)},indexOf(...e){return Wu(this,"indexOf",e)},join(e){return qs(this).join(e)},lastIndexOf(...e){return Wu(this,"lastIndexOf",e)},map(e,t){return Fi(this,"map",e,t,void 0,arguments)},pop(){return oa(this,"pop")},push(...e){return oa(this,"push",e)},reduce(e,...t){return np(this,"reduce",e,t)},reduceRight(e,...t){return np(this,"reduceRight",e,t)},shift(){return oa(this,"shift")},some(e,t){return Fi(this,"some",e,t,void 0,arguments)},splice(...e){return oa(this,"splice",e)},toReversed(){return qs(this).toReversed()},toSorted(e){return qs(this).toSorted(e)},toSpliced(...e){return qs(this).toSpliced(...e)},unshift(...e){return oa(this,"unshift",e)},values(){return qu(this,"values",nn)}};function qu(e,t,n){const i=Yc(e),s=i[t]();return i!==e&&!Wn(e)&&(s._next=s.next,s.next=()=>{const o=s._next();return o.value&&(o.value=n(o.value)),o}),s}const LT=Array.prototype;function Fi(e,t,n,i,s,o){const l=Yc(e),h=l!==e&&!Wn(e),d=l[t];if(d!==LT[t]){const v=d.apply(e,o);return h?nn(v):v}let p=n;l!==e&&(h?p=function(v,T){return n.call(this,nn(v),T,e)}:n.length>2&&(p=function(v,T){return n.call(this,v,T,e)}));const _=d.call(l,p,i);return h&&s?s(_):_}function np(e,t,n,i){const s=Yc(e);let o=n;return s!==e&&(Wn(e)?n.length>3&&(o=function(l,h,d){return n.call(this,l,h,d,e)}):o=function(l,h,d){return n.call(this,l,nn(h),d,e)}),s[t](o,...i)}function Wu(e,t,n){const i=re(e);en(i,"iterate",Da);const s=i[t](...n);return(s===-1||s===!1)&&gd(n[0])?(n[0]=re(n[0]),i[t](...n)):s}function oa(e,t,n=[]){Nr(),hd();const i=re(e)[t].apply(e,n);return dd(),Vr(),i}const OT=sd("__proto__,__v_isRef,__isVue"),$_=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(bi));function MT(e){bi(e)||(e=String(e));const t=re(this);return en(t,"has",e),t.hasOwnProperty(e)}class G_{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,i){if(n==="__v_skip")return t.__v_skip;const s=this._isReadonly,o=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return o;if(n==="__v_raw")return i===(s?o?qT:Y_:o?Q_:Z_).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const l=It(t);if(!s){let d;if(l&&(d=kT[n]))return d;if(n==="hasOwnProperty")return MT}const h=Reflect.get(t,n,on(t)?t:i);return(bi(n)?$_.has(n):OT(n))||(s||en(t,"get",n),o)?h:on(h)?l&&ld(n)?h:h.value:_e(h)?s?J_(h):Xc(h):h}}class K_ extends G_{constructor(t=!1){super(!1,t)}set(t,n,i,s){let o=t[n];if(!this._isShallow){const d=ls(o);if(!Wn(i)&&!ls(i)&&(o=re(o),i=re(i)),!It(t)&&on(o)&&!on(i))return d?!1:(o.value=i,!0)}const l=It(t)&&ld(n)?Number(n)<t.length:se(t,n),h=Reflect.set(t,n,i,on(t)?t:s);return t===re(s)&&(l?br(i,o)&&ji(t,"set",n,i):ji(t,"add",n,i)),h}deleteProperty(t,n){const i=se(t,n);t[n];const s=Reflect.deleteProperty(t,n);return s&&i&&ji(t,"delete",n,void 0),s}has(t,n){const i=Reflect.has(t,n);return(!bi(n)||!$_.has(n))&&en(t,"has",n),i}ownKeys(t){return en(t,"iterate",It(t)?"length":os),Reflect.ownKeys(t)}}class DT extends G_{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const NT=new K_,VT=new DT,UT=new K_(!0);const _h=e=>e,Gl=e=>Reflect.getPrototypeOf(e);function FT(e,t,n){return function(...i){const s=this.__v_raw,o=re(s),l=Xs(o),h=e==="entries"||e===Symbol.iterator&&l,d=e==="keys"&&l,p=s[e](...i),_=n?_h:t?gh:nn;return!t&&en(o,"iterate",d?mh:os),{next(){const{value:v,done:T}=p.next();return T?{value:v,done:T}:{value:h?[_(v[0]),_(v[1])]:_(v),done:T}},[Symbol.iterator](){return this}}}}function Kl(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function BT(e,t){const n={get(s){const o=this.__v_raw,l=re(o),h=re(s);e||(br(s,h)&&en(l,"get",s),en(l,"get",h));const{has:d}=Gl(l),p=t?_h:e?gh:nn;if(d.call(l,s))return p(o.get(s));if(d.call(l,h))return p(o.get(h));o!==l&&o.get(s)},get size(){const s=this.__v_raw;return!e&&en(re(s),"iterate",os),Reflect.get(s,"size",s)},has(s){const o=this.__v_raw,l=re(o),h=re(s);return e||(br(s,h)&&en(l,"has",s),en(l,"has",h)),s===h?o.has(s):o.has(s)||o.has(h)},forEach(s,o){const l=this,h=l.__v_raw,d=re(h),p=t?_h:e?gh:nn;return!e&&en(d,"iterate",os),h.forEach((_,v)=>s.call(o,p(_),p(v),l))}};return ln(n,e?{add:Kl("add"),set:Kl("set"),delete:Kl("delete"),clear:Kl("clear")}:{add(s){!t&&!Wn(s)&&!ls(s)&&(s=re(s));const o=re(this);return Gl(o).has.call(o,s)||(o.add(s),ji(o,"add",s,s)),this},set(s,o){!t&&!Wn(o)&&!ls(o)&&(o=re(o));const l=re(this),{has:h,get:d}=Gl(l);let p=h.call(l,s);p||(s=re(s),p=h.call(l,s));const _=d.call(l,s);return l.set(s,o),p?br(o,_)&&ji(l,"set",s,o):ji(l,"add",s,o),this},delete(s){const o=re(this),{has:l,get:h}=Gl(o);let d=l.call(o,s);d||(s=re(s),d=l.call(o,s)),h&&h.call(o,s);const p=o.delete(s);return d&&ji(o,"delete",s,void 0),p},clear(){const s=re(this),o=s.size!==0,l=s.clear();return o&&ji(s,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(s=>{n[s]=FT(s,e,t)}),n}function md(e,t){const n=BT(e,t);return(i,s,o)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?i:Reflect.get(se(n,s)&&s in i?n:i,s,o)}const zT={get:md(!1,!1)},jT={get:md(!1,!0)},HT={get:md(!0,!1)};const Z_=new WeakMap,Q_=new WeakMap,Y_=new WeakMap,qT=new WeakMap;function WT(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function $T(e){return e.__v_skip||!Object.isExtensible(e)?0:WT(gT(e))}function Xc(e){return ls(e)?e:_d(e,!1,NT,zT,Z_)}function X_(e){return _d(e,!1,UT,jT,Q_)}function J_(e){return _d(e,!0,VT,HT,Y_)}function _d(e,t,n,i,s){if(!_e(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const o=s.get(e);if(o)return o;const l=$T(e);if(l===0)return e;const h=new Proxy(e,l===2?i:n);return s.set(e,h),h}function Js(e){return ls(e)?Js(e.__v_raw):!!(e&&e.__v_isReactive)}function ls(e){return!!(e&&e.__v_isReadonly)}function Wn(e){return!!(e&&e.__v_isShallow)}function gd(e){return e?!!e.__v_raw:!1}function re(e){const t=e&&e.__v_raw;return t?re(t):e}function GT(e){return!se(e,"__v_skip")&&Object.isExtensible(e)&&M_(e,"__v_skip",!0),e}const nn=e=>_e(e)?Xc(e):e,gh=e=>_e(e)?J_(e):e;function on(e){return e?e.__v_isRef===!0:!1}function ee(e){return tg(e,!1)}function KT(e){return tg(e,!0)}function tg(e,t){return on(e)?e:new ZT(e,t)}class ZT{constructor(t,n){this.dep=new pd,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:re(t),this._value=n?t:nn(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,i=this.__v_isShallow||Wn(t)||ls(t);t=i?t:re(t),br(t,n)&&(this._rawValue=t,this._value=i?t:nn(t),this.dep.trigger())}}function to(e){return on(e)?e.value:e}const QT={get:(e,t,n)=>t==="__v_raw"?e:to(Reflect.get(e,t,n)),set:(e,t,n,i)=>{const s=e[t];return on(s)&&!on(n)?(s.value=n,!0):Reflect.set(e,t,n,i)}};function eg(e){return Js(e)?e:new Proxy(e,QT)}class YT{constructor(t,n,i){this.fn=t,this.setter=n,this._value=void 0,this.dep=new pd(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Ma-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&fe!==this)return B_(this,!0),!0}get value(){const t=this.dep.track();return H_(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function XT(e,t,n=!1){let i,s;return Vt(e)?i=e:(i=e.get,s=e.set),new YT(i,s,n)}const Zl={},wc=new WeakMap;let ns;function JT(e,t=!1,n=ns){if(n){let i=wc.get(n);i||wc.set(n,i=[]),i.push(e)}}function tE(e,t,n=de){const{immediate:i,deep:s,once:o,scheduler:l,augmentJob:h,call:d}=n,p=J=>s?J:Wn(J)||s===!1||s===0?Hi(J,1):Hi(J);let _,v,T,b,V=!1,B=!1;if(on(e)?(v=()=>e.value,V=Wn(e)):Js(e)?(v=()=>p(e),V=!0):It(e)?(B=!0,V=e.some(J=>Js(J)||Wn(J)),v=()=>e.map(J=>{if(on(J))return J.value;if(Js(J))return p(J);if(Vt(J))return d?d(J,2):J()})):Vt(e)?t?v=d?()=>d(e,2):e:v=()=>{if(T){Nr();try{T()}finally{Vr()}}const J=ns;ns=_;try{return d?d(e,3,[b]):e(b)}finally{ns=J}}:v=gi,t&&s){const J=v,Et=s===!0?1/0:s;v=()=>Hi(J(),Et)}const H=CT(),et=()=>{_.stop(),H&&H.active&&ad(H.effects,_)};if(o&&t){const J=t;t=(...Et)=>{J(...Et),et()}}let Y=B?new Array(e.length).fill(Zl):Zl;const Q=J=>{if(!(!(_.flags&1)||!_.dirty&&!J))if(t){const Et=_.run();if(s||V||(B?Et.some((Pt,O)=>br(Pt,Y[O])):br(Et,Y))){T&&T();const Pt=ns;ns=_;try{const O=[Et,Y===Zl?void 0:B&&Y[0]===Zl?[]:Y,b];d?d(t,3,O):t(...O),Y=Et}finally{ns=Pt}}}else _.run()};return h&&h(Q),_=new U_(v),_.scheduler=l?()=>l(Q,!1):Q,b=J=>JT(J,!1,_),T=_.onStop=()=>{const J=wc.get(_);if(J){if(d)d(J,4);else for(const Et of J)Et();wc.delete(_)}},t?i?Q(!0):Y=_.run():l?l(Q.bind(null,!0),!0):_.run(),et.pause=_.pause.bind(_),et.resume=_.resume.bind(_),et.stop=et,et}function Hi(e,t=1/0,n){if(t<=0||!_e(e)||e.__v_skip||(n=n||new Set,n.has(e)))return e;if(n.add(e),t--,on(e))Hi(e.value,t,n);else if(It(e))for(let i=0;i<e.length;i++)Hi(e[i],t,n);else if(Eo(e)||Xs(e))e.forEach(i=>{Hi(i,t,n)});else if(O_(e)){for(const i in e)Hi(e[i],t,n);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&Hi(e[i],t,n)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function el(e,t,n,i){try{return i?e(...i):e()}catch(s){Jc(s,t,n)}}function Ii(e,t,n,i){if(Vt(e)){const s=el(e,t,n,i);return s&&k_(s)&&s.catch(o=>{Jc(o,t,n)}),s}if(It(e)){const s=[];for(let o=0;o<e.length;o++)s.push(Ii(e[o],t,n,i));return s}}function Jc(e,t,n,i=!0){const s=t?t.vnode:null,{errorHandler:o,throwUnhandledErrorInProduction:l}=t&&t.appContext.config||de;if(t){let h=t.parent;const d=t.proxy,p=`https://vuejs.org/error-reference/#runtime-${n}`;for(;h;){const _=h.ec;if(_){for(let v=0;v<_.length;v++)if(_[v](e,d,p)===!1)return}h=h.parent}if(o){Nr(),el(o,null,10,[e,d,p]),Vr();return}}eE(e,n,s,i,l)}function eE(e,t,n,i=!0,s=!1){if(s)throw e;console.error(e)}const mn=[];let di=-1;const eo=[];let pr=null,Ws=0;const ng=Promise.resolve();let Tc=null;function vd(e){const t=Tc||ng;return e?t.then(this?e.bind(this):e):t}function nE(e){let t=di+1,n=mn.length;for(;t<n;){const i=t+n>>>1,s=mn[i],o=Na(s);o<e||o===e&&s.flags&2?t=i+1:n=i}return t}function yd(e){if(!(e.flags&1)){const t=Na(e),n=mn[mn.length-1];!n||!(e.flags&2)&&t>=Na(n)?mn.push(e):mn.splice(nE(t),0,e),e.flags|=1,ig()}}function ig(){Tc||(Tc=ng.then(sg))}function iE(e){It(e)?eo.push(...e):pr&&e.id===-1?pr.splice(Ws+1,0,e):e.flags&1||(eo.push(e),e.flags|=1),ig()}function ip(e,t,n=di+1){for(;n<mn.length;n++){const i=mn[n];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;mn.splice(n,1),n--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function rg(e){if(eo.length){const t=[...new Set(eo)].sort((n,i)=>Na(n)-Na(i));if(eo.length=0,pr){pr.push(...t);return}for(pr=t,Ws=0;Ws<pr.length;Ws++){const n=pr[Ws];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}pr=null,Ws=0}}const Na=e=>e.id==null?e.flags&2?-1:1/0:e.id;function sg(e){try{for(di=0;di<mn.length;di++){const t=mn[di];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),el(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;di<mn.length;di++){const t=mn[di];t&&(t.flags&=-2)}di=-1,mn.length=0,rg(),Tc=null,(mn.length||eo.length)&&sg()}}let Ln=null,og=null;function Ec(e){const t=Ln;return Ln=e,og=e&&e.type.__scopeId||null,t}function bo(e,t=Ln,n){if(!t||e._n)return e;const i=(...s)=>{i._d&&fp(-1);const o=Ec(t);let l;try{l=e(...s)}finally{Ec(o),i._d&&fp(1)}return l};return i._n=!0,i._c=!0,i._d=!0,i}function pe(e,t){if(Ln===null)return e;const n=iu(Ln),i=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[o,l,h,d=de]=t[s];o&&(Vt(o)&&(o={mounted:o,updated:o}),o.deep&&Hi(l),i.push({dir:o,instance:n,value:l,oldValue:void 0,arg:h,modifiers:d}))}return e}function ts(e,t,n,i){const s=e.dirs,o=t&&t.dirs;for(let l=0;l<s.length;l++){const h=s[l];o&&(h.oldValue=o[l].value);let d=h.dir[i];d&&(Nr(),Ii(d,n,8,[e.el,h,e,t]),Vr())}}const rE=Symbol("_vte"),sE=e=>e.__isTeleport;function wd(e,t){e.shapeFlag&6&&e.component?(e.transition=t,wd(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}/*! #__NO_SIDE_EFFECTS__ */function ag(e,t){return Vt(e)?ln({name:e.name},t,{setup:e}):e}function lg(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function bc(e,t,n,i,s=!1){if(It(e)){e.forEach((V,B)=>bc(V,t&&(It(t)?t[B]:t),n,i,s));return}if(Ta(i)&&!s){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&bc(e,t,n,i.component.subTree);return}const o=i.shapeFlag&4?iu(i.component):i.el,l=s?null:o,{i:h,r:d}=e,p=t&&t.r,_=h.refs===de?h.refs={}:h.refs,v=h.setupState,T=re(v),b=v===de?()=>!1:V=>se(T,V);if(p!=null&&p!==d&&(Ve(p)?(_[p]=null,b(p)&&(v[p]=null)):on(p)&&(p.value=null)),Vt(d))el(d,h,12,[l,_]);else{const V=Ve(d),B=on(d);if(V||B){const H=()=>{if(e.f){const et=V?b(d)?v[d]:_[d]:d.value;s?It(et)&&ad(et,o):It(et)?et.includes(o)||et.push(o):V?(_[d]=[o],b(d)&&(v[d]=_[d])):(d.value=[o],e.k&&(_[e.k]=d.value))}else V?(_[d]=l,b(d)&&(v[d]=l)):B&&(d.value=l,e.k&&(_[e.k]=l))};l?(H.id=-1,Sn(H,n)):H()}}}Qc().requestIdleCallback;Qc().cancelIdleCallback;const Ta=e=>!!e.type.__asyncLoader,cg=e=>e.type.__isKeepAlive;function oE(e,t){ug(e,"a",t)}function aE(e,t){ug(e,"da",t)}function ug(e,t,n=sn){const i=e.__wdc||(e.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(tu(t,i,n),n){let s=n.parent;for(;s&&s.parent;)cg(s.parent.vnode)&&lE(i,t,n,s),s=s.parent}}function lE(e,t,n,i){const s=tu(t,e,i,!0);Td(()=>{ad(i[t],s)},n)}function tu(e,t,n=sn,i=!1){if(n){const s=n[e]||(n[e]=[]),o=t.__weh||(t.__weh=(...l)=>{Nr();const h=il(n),d=Ii(t,n,e,l);return h(),Vr(),d});return i?s.unshift(o):s.push(o),o}}const nr=e=>(t,n=sn)=>{(!Ua||e==="sp")&&tu(e,(...i)=>t(...i),n)},cE=nr("bm"),nl=nr("m"),uE=nr("bu"),hE=nr("u"),dE=nr("bum"),Td=nr("um"),fE=nr("sp"),pE=nr("rtg"),mE=nr("rtc");function _E(e,t=sn){tu("ec",e,t)}const gE="components";function kn(e,t){return yE(gE,e,!0,t)||e}const vE=Symbol.for("v-ndc");function yE(e,t,n=!0,i=!1){const s=Ln||sn;if(s){const o=s.type;{const h=ob(o,!1);if(h&&(h===t||h===Gn(t)||h===Zc(Gn(t))))return o}const l=rp(s[e]||o[e],t)||rp(s.appContext[e],t);return!l&&i?o:l}}function rp(e,t){return e&&(e[t]||e[Gn(t)]||e[Zc(Gn(t))])}function Qi(e,t,n,i){let s;const o=n,l=It(e);if(l||Ve(e)){const h=l&&Js(e);let d=!1;h&&(d=!Wn(e),e=Yc(e)),s=new Array(e.length);for(let p=0,_=e.length;p<_;p++)s[p]=t(d?nn(e[p]):e[p],p,void 0,o)}else if(typeof e=="number"){s=new Array(e);for(let h=0;h<e;h++)s[h]=t(h+1,h,void 0,o)}else if(_e(e))if(e[Symbol.iterator])s=Array.from(e,(h,d)=>t(h,d,void 0,o));else{const h=Object.keys(e);s=new Array(h.length);for(let d=0,p=h.length;d<p;d++){const _=h[d];s[d]=t(e[_],_,d,o)}}else s=[];return s}const vh=e=>e?kg(e)?iu(e):vh(e.parent):null,Ea=ln(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>vh(e.parent),$root:e=>vh(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>dg(e),$forceUpdate:e=>e.f||(e.f=()=>{yd(e.update)}),$nextTick:e=>e.n||(e.n=vd.bind(e.proxy)),$watch:e=>BE.bind(e)}),$u=(e,t)=>e!==de&&!e.__isScriptSetup&&se(e,t),wE={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:i,data:s,props:o,accessCache:l,type:h,appContext:d}=e;let p;if(t[0]!=="$"){const b=l[t];if(b!==void 0)switch(b){case 1:return i[t];case 2:return s[t];case 4:return n[t];case 3:return o[t]}else{if($u(i,t))return l[t]=1,i[t];if(s!==de&&se(s,t))return l[t]=2,s[t];if((p=e.propsOptions[0])&&se(p,t))return l[t]=3,o[t];if(n!==de&&se(n,t))return l[t]=4,n[t];yh&&(l[t]=0)}}const _=Ea[t];let v,T;if(_)return t==="$attrs"&&en(e.attrs,"get",""),_(e);if((v=h.__cssModules)&&(v=v[t]))return v;if(n!==de&&se(n,t))return l[t]=4,n[t];if(T=d.config.globalProperties,se(T,t))return T[t]},set({_:e},t,n){const{data:i,setupState:s,ctx:o}=e;return $u(s,t)?(s[t]=n,!0):i!==de&&se(i,t)?(i[t]=n,!0):se(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(o[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:s,propsOptions:o}},l){let h;return!!n[l]||e!==de&&se(e,l)||$u(t,l)||(h=o[0])&&se(h,l)||se(i,l)||se(Ea,l)||se(s.config.globalProperties,l)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:se(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function sp(e){return It(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let yh=!0;function TE(e){const t=dg(e),n=e.proxy,i=e.ctx;yh=!1,t.beforeCreate&&op(t.beforeCreate,e,"bc");const{data:s,computed:o,methods:l,watch:h,provide:d,inject:p,created:_,beforeMount:v,mounted:T,beforeUpdate:b,updated:V,activated:B,deactivated:H,beforeDestroy:et,beforeUnmount:Y,destroyed:Q,unmounted:J,render:Et,renderTracked:Pt,renderTriggered:O,errorCaptured:I,serverPrefetch:S,expose:M,inheritAttrs:D,components:k,directives:A,filters:qt}=t;if(p&&EE(p,i,null),l)for(const Ut in l){const ot=l[Ut];Vt(ot)&&(i[Ut]=ot.bind(n))}if(s){const Ut=s.call(n,n);_e(Ut)&&(e.data=Xc(Ut))}if(yh=!0,o)for(const Ut in o){const ot=o[Ut],Xe=Vt(ot)?ot.bind(n,n):Vt(ot.get)?ot.get.bind(n,n):gi,vt=!Vt(ot)&&Vt(ot.set)?ot.set.bind(n):gi,Gt=qn({get:Xe,set:vt});Object.defineProperty(i,Ut,{enumerable:!0,configurable:!0,get:()=>Gt.value,set:zt=>Gt.value=zt})}if(h)for(const Ut in h)hg(h[Ut],i,n,Ut);if(d){const Ut=Vt(d)?d.call(n):d;Reflect.ownKeys(Ut).forEach(ot=>{sc(ot,Ut[ot])})}_&&op(_,e,"c");function Xt(Ut,ot){It(ot)?ot.forEach(Xe=>Ut(Xe.bind(n))):ot&&Ut(ot.bind(n))}if(Xt(cE,v),Xt(nl,T),Xt(uE,b),Xt(hE,V),Xt(oE,B),Xt(aE,H),Xt(_E,I),Xt(mE,Pt),Xt(pE,O),Xt(dE,Y),Xt(Td,J),Xt(fE,S),It(M))if(M.length){const Ut=e.exposed||(e.exposed={});M.forEach(ot=>{Object.defineProperty(Ut,ot,{get:()=>n[ot],set:Xe=>n[ot]=Xe})})}else e.exposed||(e.exposed={});Et&&e.render===gi&&(e.render=Et),D!=null&&(e.inheritAttrs=D),k&&(e.components=k),A&&(e.directives=A),S&&lg(e)}function EE(e,t,n=gi){It(e)&&(e=wh(e));for(const i in e){const s=e[i];let o;_e(s)?"default"in s?o=vi(s.from||i,s.default,!0):o=vi(s.from||i):o=vi(s),on(o)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:l=>o.value=l}):t[i]=o}}function op(e,t,n){Ii(It(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,n)}function hg(e,t,n,i){let s=i.includes(".")?Ag(n,i):()=>n[i];if(Ve(e)){const o=t[e];Vt(o)&&ba(s,o)}else if(Vt(e))ba(s,e.bind(n));else if(_e(e))if(It(e))e.forEach(o=>hg(o,t,n,i));else{const o=Vt(e.handler)?e.handler.bind(n):t[e.handler];Vt(o)&&ba(s,o,e)}}function dg(e){const t=e.type,{mixins:n,extends:i}=t,{mixins:s,optionsCache:o,config:{optionMergeStrategies:l}}=e.appContext,h=o.get(t);let d;return h?d=h:!s.length&&!n&&!i?d=t:(d={},s.length&&s.forEach(p=>Ic(d,p,l,!0)),Ic(d,t,l)),_e(t)&&o.set(t,d),d}function Ic(e,t,n,i=!1){const{mixins:s,extends:o}=t;o&&Ic(e,o,n,!0),s&&s.forEach(l=>Ic(e,l,n,!0));for(const l in t)if(!(i&&l==="expose")){const h=bE[l]||n&&n[l];e[l]=h?h(e[l],t[l]):t[l]}return e}const bE={data:ap,props:lp,emits:lp,methods:ua,computed:ua,beforeCreate:pn,created:pn,beforeMount:pn,mounted:pn,beforeUpdate:pn,updated:pn,beforeDestroy:pn,beforeUnmount:pn,destroyed:pn,unmounted:pn,activated:pn,deactivated:pn,errorCaptured:pn,serverPrefetch:pn,components:ua,directives:ua,watch:PE,provide:ap,inject:IE};function ap(e,t){return t?e?function(){return ln(Vt(e)?e.call(this,this):e,Vt(t)?t.call(this,this):t)}:t:e}function IE(e,t){return ua(wh(e),wh(t))}function wh(e){if(It(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function pn(e,t){return e?[...new Set([].concat(e,t))]:t}function ua(e,t){return e?ln(Object.create(null),e,t):t}function lp(e,t){return e?It(e)&&It(t)?[...new Set([...e,...t])]:ln(Object.create(null),sp(e),sp(t??{})):t}function PE(e,t){if(!e)return t;if(!t)return e;const n=ln(Object.create(null),e);for(const i in t)n[i]=pn(e[i],t[i]);return n}function fg(){return{app:null,config:{isNativeTag:mT,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let AE=0;function RE(e,t){return function(i,s=null){Vt(i)||(i=ln({},i)),s!=null&&!_e(s)&&(s=null);const o=fg(),l=new WeakSet,h=[];let d=!1;const p=o.app={_uid:AE++,_component:i,_props:s,_container:null,_context:o,_instance:null,version:lb,get config(){return o.config},set config(_){},use(_,...v){return l.has(_)||(_&&Vt(_.install)?(l.add(_),_.install(p,...v)):Vt(_)&&(l.add(_),_(p,...v))),p},mixin(_){return o.mixins.includes(_)||o.mixins.push(_),p},component(_,v){return v?(o.components[_]=v,p):o.components[_]},directive(_,v){return v?(o.directives[_]=v,p):o.directives[_]},mount(_,v,T){if(!d){const b=p._ceVNode||ge(i,s);return b.appContext=o,T===!0?T="svg":T===!1&&(T=void 0),e(b,_,T),d=!0,p._container=_,_.__vue_app__=p,iu(b.component)}},onUnmount(_){h.push(_)},unmount(){d&&(Ii(h,p._instance,16),e(null,p._container),delete p._container.__vue_app__)},provide(_,v){return o.provides[_]=v,p},runWithContext(_){const v=no;no=p;try{return _()}finally{no=v}}};return p}}let no=null;function sc(e,t){if(sn){let n=sn.provides;const i=sn.parent&&sn.parent.provides;i===n&&(n=sn.provides=Object.create(i)),n[e]=t}}function vi(e,t,n=!1){const i=sn||Ln;if(i||no){const s=no?no._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return n&&Vt(t)?t.call(i&&i.proxy):t}}const pg={},mg=()=>Object.create(pg),_g=e=>Object.getPrototypeOf(e)===pg;function CE(e,t,n,i=!1){const s={},o=mg();e.propsDefaults=Object.create(null),gg(e,t,s,o);for(const l in e.propsOptions[0])l in s||(s[l]=void 0);n?e.props=i?s:X_(s):e.type.props?e.props=s:e.props=o,e.attrs=o}function SE(e,t,n,i){const{props:s,attrs:o,vnode:{patchFlag:l}}=e,h=re(s),[d]=e.propsOptions;let p=!1;if((i||l>0)&&!(l&16)){if(l&8){const _=e.vnode.dynamicProps;for(let v=0;v<_.length;v++){let T=_[v];if(eu(e.emitsOptions,T))continue;const b=t[T];if(d)if(se(o,T))b!==o[T]&&(o[T]=b,p=!0);else{const V=Gn(T);s[V]=Th(d,h,V,b,e,!1)}else b!==o[T]&&(o[T]=b,p=!0)}}}else{gg(e,t,s,o)&&(p=!0);let _;for(const v in h)(!t||!se(t,v)&&((_=Dr(v))===v||!se(t,_)))&&(d?n&&(n[v]!==void 0||n[_]!==void 0)&&(s[v]=Th(d,h,v,void 0,e,!0)):delete s[v]);if(o!==h)for(const v in o)(!t||!se(t,v))&&(delete o[v],p=!0)}p&&ji(e.attrs,"set","")}function gg(e,t,n,i){const[s,o]=e.propsOptions;let l=!1,h;if(t)for(let d in t){if(va(d))continue;const p=t[d];let _;s&&se(s,_=Gn(d))?!o||!o.includes(_)?n[_]=p:(h||(h={}))[_]=p:eu(e.emitsOptions,d)||(!(d in i)||p!==i[d])&&(i[d]=p,l=!0)}if(o){const d=re(n),p=h||de;for(let _=0;_<o.length;_++){const v=o[_];n[v]=Th(s,d,v,p[v],e,!se(p,v))}}return l}function Th(e,t,n,i,s,o){const l=e[n];if(l!=null){const h=se(l,"default");if(h&&i===void 0){const d=l.default;if(l.type!==Function&&!l.skipFactory&&Vt(d)){const{propsDefaults:p}=s;if(n in p)i=p[n];else{const _=il(s);i=p[n]=d.call(null,t),_()}}else i=d;s.ce&&s.ce._setProp(n,i)}l[0]&&(o&&!h?i=!1:l[1]&&(i===""||i===Dr(n))&&(i=!0))}return i}const xE=new WeakMap;function vg(e,t,n=!1){const i=n?xE:t.propsCache,s=i.get(e);if(s)return s;const o=e.props,l={},h=[];let d=!1;if(!Vt(e)){const _=v=>{d=!0;const[T,b]=vg(v,t,!0);ln(l,T),b&&h.push(...b)};!n&&t.mixins.length&&t.mixins.forEach(_),e.extends&&_(e.extends),e.mixins&&e.mixins.forEach(_)}if(!o&&!d)return _e(e)&&i.set(e,Ys),Ys;if(It(o))for(let _=0;_<o.length;_++){const v=Gn(o[_]);cp(v)&&(l[v]=de)}else if(o)for(const _ in o){const v=Gn(_);if(cp(v)){const T=o[_],b=l[v]=It(T)||Vt(T)?{type:T}:ln({},T),V=b.type;let B=!1,H=!0;if(It(V))for(let et=0;et<V.length;++et){const Y=V[et],Q=Vt(Y)&&Y.name;if(Q==="Boolean"){B=!0;break}else Q==="String"&&(H=!1)}else B=Vt(V)&&V.name==="Boolean";b[0]=B,b[1]=H,(B||se(b,"default"))&&h.push(v)}}const p=[l,h];return _e(e)&&i.set(e,p),p}function cp(e){return e[0]!=="$"&&!va(e)}const yg=e=>e[0]==="_"||e==="$stable",Ed=e=>It(e)?e.map(mi):[mi(e)],kE=(e,t,n)=>{if(t._n)return t;const i=bo((...s)=>Ed(t(...s)),n);return i._c=!1,i},wg=(e,t,n)=>{const i=e._ctx;for(const s in e){if(yg(s))continue;const o=e[s];if(Vt(o))t[s]=kE(s,o,i);else if(o!=null){const l=Ed(o);t[s]=()=>l}}},Tg=(e,t)=>{const n=Ed(t);e.slots.default=()=>n},Eg=(e,t,n)=>{for(const i in t)(n||i!=="_")&&(e[i]=t[i])},LE=(e,t,n)=>{const i=e.slots=mg();if(e.vnode.shapeFlag&32){const s=t._;s?(Eg(i,t,n),n&&M_(i,"_",s,!0)):wg(t,i)}else t&&Tg(e,t)},OE=(e,t,n)=>{const{vnode:i,slots:s}=e;let o=!0,l=de;if(i.shapeFlag&32){const h=t._;h?n&&h===1?o=!1:Eg(s,t,n):(o=!t.$stable,wg(t,s)),l=t}else t&&(Tg(e,t),l={default:1});if(o)for(const h in s)!yg(h)&&l[h]==null&&delete s[h]},Sn=GE;function ME(e){return DE(e)}function DE(e,t){const n=Qc();n.__VUE__=!0;const{insert:i,remove:s,patchProp:o,createElement:l,createText:h,createComment:d,setText:p,setElementText:_,parentNode:v,nextSibling:T,setScopeId:b=gi,insertStaticContent:V}=e,B=(P,R,N,W=null,K=null,$=null,st=void 0,it=null,nt=!!R.dynamicChildren)=>{if(P===R)return;P&&!aa(P,R)&&(W=q(P),zt(P,K,$,!0),P=null),R.patchFlag===-2&&(nt=!1,R.dynamicChildren=null);const{type:tt,ref:wt,shapeFlag:ct}=R;switch(tt){case nu:H(P,R,N,W);break;case cs:et(P,R,N,W);break;case oc:P==null&&Y(R,N,W,st);break;case We:k(P,R,N,W,K,$,st,it,nt);break;default:ct&1?Et(P,R,N,W,K,$,st,it,nt):ct&6?A(P,R,N,W,K,$,st,it,nt):(ct&64||ct&128)&&tt.process(P,R,N,W,K,$,st,it,nt,mt)}wt!=null&&K&&bc(wt,P&&P.ref,$,R||P,!R)},H=(P,R,N,W)=>{if(P==null)i(R.el=h(R.children),N,W);else{const K=R.el=P.el;R.children!==P.children&&p(K,R.children)}},et=(P,R,N,W)=>{P==null?i(R.el=d(R.children||""),N,W):R.el=P.el},Y=(P,R,N,W)=>{[P.el,P.anchor]=V(P.children,R,N,W,P.el,P.anchor)},Q=({el:P,anchor:R},N,W)=>{let K;for(;P&&P!==R;)K=T(P),i(P,N,W),P=K;i(R,N,W)},J=({el:P,anchor:R})=>{let N;for(;P&&P!==R;)N=T(P),s(P),P=N;s(R)},Et=(P,R,N,W,K,$,st,it,nt)=>{R.type==="svg"?st="svg":R.type==="math"&&(st="mathml"),P==null?Pt(R,N,W,K,$,st,it,nt):S(P,R,K,$,st,it,nt)},Pt=(P,R,N,W,K,$,st,it)=>{let nt,tt;const{props:wt,shapeFlag:ct,transition:_t,dirs:bt}=P;if(nt=P.el=l(P.type,$,wt&&wt.is,wt),ct&8?_(nt,P.children):ct&16&&I(P.children,nt,null,W,K,Gu(P,$),st,it),bt&&ts(P,null,W,"created"),O(nt,P,P.scopeId,st,W),wt){for(const Lt in wt)Lt!=="value"&&!va(Lt)&&o(nt,Lt,null,wt[Lt],$,W);"value"in wt&&o(nt,"value",null,wt.value,$),(tt=wt.onVnodeBeforeMount)&&hi(tt,W,P)}bt&&ts(P,null,W,"beforeMount");const yt=NE(K,_t);yt&&_t.beforeEnter(nt),i(nt,R,N),((tt=wt&&wt.onVnodeMounted)||yt||bt)&&Sn(()=>{tt&&hi(tt,W,P),yt&&_t.enter(nt),bt&&ts(P,null,W,"mounted")},K)},O=(P,R,N,W,K)=>{if(N&&b(P,N),W)for(let $=0;$<W.length;$++)b(P,W[$]);if(K){let $=K.subTree;if(R===$||Cg($.type)&&($.ssContent===R||$.ssFallback===R)){const st=K.vnode;O(P,st,st.scopeId,st.slotScopeIds,K.parent)}}},I=(P,R,N,W,K,$,st,it,nt=0)=>{for(let tt=nt;tt<P.length;tt++){const wt=P[tt]=it?mr(P[tt]):mi(P[tt]);B(null,wt,R,N,W,K,$,st,it)}},S=(P,R,N,W,K,$,st)=>{const it=R.el=P.el;let{patchFlag:nt,dynamicChildren:tt,dirs:wt}=R;nt|=P.patchFlag&16;const ct=P.props||de,_t=R.props||de;let bt;if(N&&es(N,!1),(bt=_t.onVnodeBeforeUpdate)&&hi(bt,N,R,P),wt&&ts(R,P,N,"beforeUpdate"),N&&es(N,!0),(ct.innerHTML&&_t.innerHTML==null||ct.textContent&&_t.textContent==null)&&_(it,""),tt?M(P.dynamicChildren,tt,it,N,W,Gu(R,K),$):st||ot(P,R,it,null,N,W,Gu(R,K),$,!1),nt>0){if(nt&16)D(it,ct,_t,N,K);else if(nt&2&&ct.class!==_t.class&&o(it,"class",null,_t.class,K),nt&4&&o(it,"style",ct.style,_t.style,K),nt&8){const yt=R.dynamicProps;for(let Lt=0;Lt<yt.length;Lt++){const Wt=yt[Lt],Be=ct[Wt],ke=_t[Wt];(ke!==Be||Wt==="value")&&o(it,Wt,Be,ke,K,N)}}nt&1&&P.children!==R.children&&_(it,R.children)}else!st&&tt==null&&D(it,ct,_t,N,K);((bt=_t.onVnodeUpdated)||wt)&&Sn(()=>{bt&&hi(bt,N,R,P),wt&&ts(R,P,N,"updated")},W)},M=(P,R,N,W,K,$,st)=>{for(let it=0;it<R.length;it++){const nt=P[it],tt=R[it],wt=nt.el&&(nt.type===We||!aa(nt,tt)||nt.shapeFlag&70)?v(nt.el):N;B(nt,tt,wt,null,W,K,$,st,!0)}},D=(P,R,N,W,K)=>{if(R!==N){if(R!==de)for(const $ in R)!va($)&&!($ in N)&&o(P,$,R[$],null,K,W);for(const $ in N){if(va($))continue;const st=N[$],it=R[$];st!==it&&$!=="value"&&o(P,$,it,st,K,W)}"value"in N&&o(P,"value",R.value,N.value,K)}},k=(P,R,N,W,K,$,st,it,nt)=>{const tt=R.el=P?P.el:h(""),wt=R.anchor=P?P.anchor:h("");let{patchFlag:ct,dynamicChildren:_t,slotScopeIds:bt}=R;bt&&(it=it?it.concat(bt):bt),P==null?(i(tt,N,W),i(wt,N,W),I(R.children||[],N,wt,K,$,st,it,nt)):ct>0&&ct&64&&_t&&P.dynamicChildren?(M(P.dynamicChildren,_t,N,K,$,st,it),(R.key!=null||K&&R===K.subTree)&&bg(P,R,!0)):ot(P,R,N,wt,K,$,st,it,nt)},A=(P,R,N,W,K,$,st,it,nt)=>{R.slotScopeIds=it,P==null?R.shapeFlag&512?K.ctx.activate(R,N,W,st,nt):qt(R,N,W,K,$,st,nt):Ye(P,R,nt)},qt=(P,R,N,W,K,$,st)=>{const it=P.component=eb(P,W,K);if(cg(P)&&(it.ctx.renderer=mt),nb(it,!1,st),it.asyncDep){if(K&&K.registerDep(it,Xt,st),!P.el){const nt=it.subTree=ge(cs);et(null,nt,R,N)}}else Xt(it,P,R,N,K,$,st)},Ye=(P,R,N)=>{const W=R.component=P.component;if(WE(P,R,N))if(W.asyncDep&&!W.asyncResolved){Ut(W,R,N);return}else W.next=R,W.update();else R.el=P.el,W.vnode=R},Xt=(P,R,N,W,K,$,st)=>{const it=()=>{if(P.isMounted){let{next:ct,bu:_t,u:bt,parent:yt,vnode:Lt}=P;{const ze=Ig(P);if(ze){ct&&(ct.el=Lt.el,Ut(P,ct,st)),ze.asyncDep.then(()=>{P.isUnmounted||it()});return}}let Wt=ct,Be;es(P,!1),ct?(ct.el=Lt.el,Ut(P,ct,st)):ct=Lt,_t&&rc(_t),(Be=ct.props&&ct.props.onVnodeBeforeUpdate)&&hi(Be,yt,ct,Lt),es(P,!0);const ke=hp(P),un=P.subTree;P.subTree=ke,B(un,ke,v(un.el),q(un),P,K,$),ct.el=ke.el,Wt===null&&$E(P,ke.el),bt&&Sn(bt,K),(Be=ct.props&&ct.props.onVnodeUpdated)&&Sn(()=>hi(Be,yt,ct,Lt),K)}else{let ct;const{el:_t,props:bt}=R,{bm:yt,m:Lt,parent:Wt,root:Be,type:ke}=P,un=Ta(R);es(P,!1),yt&&rc(yt),!un&&(ct=bt&&bt.onVnodeBeforeMount)&&hi(ct,Wt,R),es(P,!0);{Be.ce&&Be.ce._injectChildStyle(ke);const ze=P.subTree=hp(P);B(null,ze,N,W,P,K,$),R.el=ze.el}if(Lt&&Sn(Lt,K),!un&&(ct=bt&&bt.onVnodeMounted)){const ze=R;Sn(()=>hi(ct,Wt,ze),K)}(R.shapeFlag&256||Wt&&Ta(Wt.vnode)&&Wt.vnode.shapeFlag&256)&&P.a&&Sn(P.a,K),P.isMounted=!0,R=N=W=null}};P.scope.on();const nt=P.effect=new U_(it);P.scope.off();const tt=P.update=nt.run.bind(nt),wt=P.job=nt.runIfDirty.bind(nt);wt.i=P,wt.id=P.uid,nt.scheduler=()=>yd(wt),es(P,!0),tt()},Ut=(P,R,N)=>{R.component=P;const W=P.vnode.props;P.vnode=R,P.next=null,SE(P,R.props,W,N),OE(P,R.children,N),Nr(),ip(P),Vr()},ot=(P,R,N,W,K,$,st,it,nt=!1)=>{const tt=P&&P.children,wt=P?P.shapeFlag:0,ct=R.children,{patchFlag:_t,shapeFlag:bt}=R;if(_t>0){if(_t&128){vt(tt,ct,N,W,K,$,st,it,nt);return}else if(_t&256){Xe(tt,ct,N,W,K,$,st,it,nt);return}}bt&8?(wt&16&&At(tt,K,$),ct!==tt&&_(N,ct)):wt&16?bt&16?vt(tt,ct,N,W,K,$,st,it,nt):At(tt,K,$,!0):(wt&8&&_(N,""),bt&16&&I(ct,N,W,K,$,st,it,nt))},Xe=(P,R,N,W,K,$,st,it,nt)=>{P=P||Ys,R=R||Ys;const tt=P.length,wt=R.length,ct=Math.min(tt,wt);let _t;for(_t=0;_t<ct;_t++){const bt=R[_t]=nt?mr(R[_t]):mi(R[_t]);B(P[_t],bt,N,null,K,$,st,it,nt)}tt>wt?At(P,K,$,!0,!1,ct):I(R,N,W,K,$,st,it,nt,ct)},vt=(P,R,N,W,K,$,st,it,nt)=>{let tt=0;const wt=R.length;let ct=P.length-1,_t=wt-1;for(;tt<=ct&&tt<=_t;){const bt=P[tt],yt=R[tt]=nt?mr(R[tt]):mi(R[tt]);if(aa(bt,yt))B(bt,yt,N,null,K,$,st,it,nt);else break;tt++}for(;tt<=ct&&tt<=_t;){const bt=P[ct],yt=R[_t]=nt?mr(R[_t]):mi(R[_t]);if(aa(bt,yt))B(bt,yt,N,null,K,$,st,it,nt);else break;ct--,_t--}if(tt>ct){if(tt<=_t){const bt=_t+1,yt=bt<wt?R[bt].el:W;for(;tt<=_t;)B(null,R[tt]=nt?mr(R[tt]):mi(R[tt]),N,yt,K,$,st,it,nt),tt++}}else if(tt>_t)for(;tt<=ct;)zt(P[tt],K,$,!0),tt++;else{const bt=tt,yt=tt,Lt=new Map;for(tt=yt;tt<=_t;tt++){const Le=R[tt]=nt?mr(R[tt]):mi(R[tt]);Le.key!=null&&Lt.set(Le.key,tt)}let Wt,Be=0;const ke=_t-yt+1;let un=!1,ze=0;const Zn=new Array(ke);for(tt=0;tt<ke;tt++)Zn[tt]=0;for(tt=bt;tt<=ct;tt++){const Le=P[tt];if(Be>=ke){zt(Le,K,$,!0);continue}let _n;if(Le.key!=null)_n=Lt.get(Le.key);else for(Wt=yt;Wt<=_t;Wt++)if(Zn[Wt-yt]===0&&aa(Le,R[Wt])){_n=Wt;break}_n===void 0?zt(Le,K,$,!0):(Zn[_n-yt]=tt+1,_n>=ze?ze=_n:un=!0,B(Le,R[_n],N,null,K,$,st,it,nt),Be++)}const Ri=un?VE(Zn):Ys;for(Wt=Ri.length-1,tt=ke-1;tt>=0;tt--){const Le=yt+tt,_n=R[Le],oi=Le+1<wt?R[Le+1].el:W;Zn[tt]===0?B(null,_n,N,oi,K,$,st,it,nt):un&&(Wt<0||tt!==Ri[Wt]?Gt(_n,N,oi,2):Wt--)}}},Gt=(P,R,N,W,K=null)=>{const{el:$,type:st,transition:it,children:nt,shapeFlag:tt}=P;if(tt&6){Gt(P.component.subTree,R,N,W);return}if(tt&128){P.suspense.move(R,N,W);return}if(tt&64){st.move(P,R,N,mt);return}if(st===We){i($,R,N);for(let ct=0;ct<nt.length;ct++)Gt(nt[ct],R,N,W);i(P.anchor,R,N);return}if(st===oc){Q(P,R,N);return}if(W!==2&&tt&1&&it)if(W===0)it.beforeEnter($),i($,R,N),Sn(()=>it.enter($),K);else{const{leave:ct,delayLeave:_t,afterLeave:bt}=it,yt=()=>i($,R,N),Lt=()=>{ct($,()=>{yt(),bt&&bt()})};_t?_t($,yt,Lt):Lt()}else i($,R,N)},zt=(P,R,N,W=!1,K=!1)=>{const{type:$,props:st,ref:it,children:nt,dynamicChildren:tt,shapeFlag:wt,patchFlag:ct,dirs:_t,cacheIndex:bt}=P;if(ct===-2&&(K=!1),it!=null&&bc(it,null,N,P,!0),bt!=null&&(R.renderCache[bt]=void 0),wt&256){R.ctx.deactivate(P);return}const yt=wt&1&&_t,Lt=!Ta(P);let Wt;if(Lt&&(Wt=st&&st.onVnodeBeforeUnmount)&&hi(Wt,R,P),wt&6)Ft(P.component,N,W);else{if(wt&128){P.suspense.unmount(N,W);return}yt&&ts(P,null,R,"beforeUnmount"),wt&64?P.type.remove(P,R,N,mt,W):tt&&!tt.hasOnce&&($!==We||ct>0&&ct&64)?At(tt,R,N,!1,!0):($===We&&ct&384||!K&&wt&16)&&At(nt,R,N),W&&jt(P)}(Lt&&(Wt=st&&st.onVnodeUnmounted)||yt)&&Sn(()=>{Wt&&hi(Wt,R,P),yt&&ts(P,null,R,"unmounted")},N)},jt=P=>{const{type:R,el:N,anchor:W,transition:K}=P;if(R===We){ae(N,W);return}if(R===oc){J(P);return}const $=()=>{s(N),K&&!K.persisted&&K.afterLeave&&K.afterLeave()};if(P.shapeFlag&1&&K&&!K.persisted){const{leave:st,delayLeave:it}=K,nt=()=>st(N,$);it?it(P.el,$,nt):nt()}else $()},ae=(P,R)=>{let N;for(;P!==R;)N=T(P),s(P),P=N;s(R)},Ft=(P,R,N)=>{const{bum:W,scope:K,job:$,subTree:st,um:it,m:nt,a:tt}=P;up(nt),up(tt),W&&rc(W),K.stop(),$&&($.flags|=8,zt(st,P,R,N)),it&&Sn(it,R),Sn(()=>{P.isUnmounted=!0},R),R&&R.pendingBranch&&!R.isUnmounted&&P.asyncDep&&!P.asyncResolved&&P.suspenseId===R.pendingId&&(R.deps--,R.deps===0&&R.resolve())},At=(P,R,N,W=!1,K=!1,$=0)=>{for(let st=$;st<P.length;st++)zt(P[st],R,N,W,K)},q=P=>{if(P.shapeFlag&6)return q(P.component.subTree);if(P.shapeFlag&128)return P.suspense.next();const R=T(P.anchor||P.el),N=R&&R[rE];return N?T(N):R};let at=!1;const lt=(P,R,N)=>{P==null?R._vnode&&zt(R._vnode,null,null,!0):B(R._vnode||null,P,R,null,null,null,N),R._vnode=P,at||(at=!0,ip(),rg(),at=!1)},mt={p:B,um:zt,m:Gt,r:jt,mt:qt,mc:I,pc:ot,pbc:M,n:q,o:e};return{render:lt,hydrate:void 0,createApp:RE(lt)}}function Gu({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function es({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function NE(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function bg(e,t,n=!1){const i=e.children,s=t.children;if(It(i)&&It(s))for(let o=0;o<i.length;o++){const l=i[o];let h=s[o];h.shapeFlag&1&&!h.dynamicChildren&&((h.patchFlag<=0||h.patchFlag===32)&&(h=s[o]=mr(s[o]),h.el=l.el),!n&&h.patchFlag!==-2&&bg(l,h)),h.type===nu&&(h.el=l.el)}}function VE(e){const t=e.slice(),n=[0];let i,s,o,l,h;const d=e.length;for(i=0;i<d;i++){const p=e[i];if(p!==0){if(s=n[n.length-1],e[s]<p){t[i]=s,n.push(i);continue}for(o=0,l=n.length-1;o<l;)h=o+l>>1,e[n[h]]<p?o=h+1:l=h;p<e[n[o]]&&(o>0&&(t[i]=n[o-1]),n[o]=i)}}for(o=n.length,l=n[o-1];o-- >0;)n[o]=l,l=t[l];return n}function Ig(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Ig(t)}function up(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const UE=Symbol.for("v-scx"),FE=()=>vi(UE);function ba(e,t,n){return Pg(e,t,n)}function Pg(e,t,n=de){const{immediate:i,deep:s,flush:o,once:l}=n,h=ln({},n),d=t&&i||!t&&o!=="post";let p;if(Ua){if(o==="sync"){const b=FE();p=b.__watcherHandles||(b.__watcherHandles=[])}else if(!d){const b=()=>{};return b.stop=gi,b.resume=gi,b.pause=gi,b}}const _=sn;h.call=(b,V,B)=>Ii(b,_,V,B);let v=!1;o==="post"?h.scheduler=b=>{Sn(b,_&&_.suspense)}:o!=="sync"&&(v=!0,h.scheduler=(b,V)=>{V?b():yd(b)}),h.augmentJob=b=>{t&&(b.flags|=4),v&&(b.flags|=2,_&&(b.id=_.uid,b.i=_))};const T=tE(e,t,h);return Ua&&(p?p.push(T):d&&T()),T}function BE(e,t,n){const i=this.proxy,s=Ve(e)?e.includes(".")?Ag(i,e):()=>i[e]:e.bind(i,i);let o;Vt(t)?o=t:(o=t.handler,n=t);const l=il(this),h=Pg(s,o.bind(i),n);return l(),h}function Ag(e,t){const n=t.split(".");return()=>{let i=e;for(let s=0;s<n.length&&i;s++)i=i[n[s]];return i}}const zE=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Gn(t)}Modifiers`]||e[`${Dr(t)}Modifiers`];function jE(e,t,...n){if(e.isUnmounted)return;const i=e.vnode.props||de;let s=n;const o=t.startsWith("update:"),l=o&&zE(i,t.slice(7));l&&(l.trim&&(s=n.map(_=>Ve(_)?_.trim():_)),l.number&&(s=n.map(yc)));let h,d=i[h=zu(t)]||i[h=zu(Gn(t))];!d&&o&&(d=i[h=zu(Dr(t))]),d&&Ii(d,e,6,s);const p=i[h+"Once"];if(p){if(!e.emitted)e.emitted={};else if(e.emitted[h])return;e.emitted[h]=!0,Ii(p,e,6,s)}}function Rg(e,t,n=!1){const i=t.emitsCache,s=i.get(e);if(s!==void 0)return s;const o=e.emits;let l={},h=!1;if(!Vt(e)){const d=p=>{const _=Rg(p,t,!0);_&&(h=!0,ln(l,_))};!n&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}return!o&&!h?(_e(e)&&i.set(e,null),null):(It(o)?o.forEach(d=>l[d]=null):ln(l,o),_e(e)&&i.set(e,l),l)}function eu(e,t){return!e||!Gc(t)?!1:(t=t.slice(2).replace(/Once$/,""),se(e,t[0].toLowerCase()+t.slice(1))||se(e,Dr(t))||se(e,t))}function hp(e){const{type:t,vnode:n,proxy:i,withProxy:s,propsOptions:[o],slots:l,attrs:h,emit:d,render:p,renderCache:_,props:v,data:T,setupState:b,ctx:V,inheritAttrs:B}=e,H=Ec(e);let et,Y;try{if(n.shapeFlag&4){const J=s||i,Et=J;et=mi(p.call(Et,J,_,v,b,T,V)),Y=h}else{const J=t;et=mi(J.length>1?J(v,{attrs:h,slots:l,emit:d}):J(v,null)),Y=t.props?h:HE(h)}}catch(J){Ia.length=0,Jc(J,e,1),et=ge(cs)}let Q=et;if(Y&&B!==!1){const J=Object.keys(Y),{shapeFlag:Et}=Q;J.length&&Et&7&&(o&&J.some(od)&&(Y=qE(Y,o)),Q=lo(Q,Y,!1,!0))}return n.dirs&&(Q=lo(Q,null,!1,!0),Q.dirs=Q.dirs?Q.dirs.concat(n.dirs):n.dirs),n.transition&&wd(Q,n.transition),et=Q,Ec(H),et}const HE=e=>{let t;for(const n in e)(n==="class"||n==="style"||Gc(n))&&((t||(t={}))[n]=e[n]);return t},qE=(e,t)=>{const n={};for(const i in e)(!od(i)||!(i.slice(9)in t))&&(n[i]=e[i]);return n};function WE(e,t,n){const{props:i,children:s,component:o}=e,{props:l,children:h,patchFlag:d}=t,p=o.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&d>=0){if(d&1024)return!0;if(d&16)return i?dp(i,l,p):!!l;if(d&8){const _=t.dynamicProps;for(let v=0;v<_.length;v++){const T=_[v];if(l[T]!==i[T]&&!eu(p,T))return!0}}}else return(s||h)&&(!h||!h.$stable)?!0:i===l?!1:i?l?dp(i,l,p):!0:!!l;return!1}function dp(e,t,n){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let s=0;s<i.length;s++){const o=i[s];if(t[o]!==e[o]&&!eu(n,o))return!0}return!1}function $E({vnode:e,parent:t},n){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=n,t=t.parent;else break}}const Cg=e=>e.__isSuspense;function GE(e,t){t&&t.pendingBranch?It(e)?t.effects.push(...e):t.effects.push(e):iE(e)}const We=Symbol.for("v-fgt"),nu=Symbol.for("v-txt"),cs=Symbol.for("v-cmt"),oc=Symbol.for("v-stc"),Ia=[];let On=null;function ut(e=!1){Ia.push(On=e?null:[])}function KE(){Ia.pop(),On=Ia[Ia.length-1]||null}let Va=1;function fp(e,t=!1){Va+=e,e<0&&On&&t&&(On.hasOnce=!0)}function Sg(e){return e.dynamicChildren=Va>0?On||Ys:null,KE(),Va>0&&On&&On.push(e),e}function ft(e,t,n,i,s,o){return Sg(C(e,t,n,i,s,o,!0))}function Eh(e,t,n,i,s){return Sg(ge(e,t,n,i,s,!0))}function Pc(e){return e?e.__v_isVNode===!0:!1}function aa(e,t){return e.type===t.type&&e.key===t.key}const xg=({key:e})=>e??null,ac=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?Ve(e)||on(e)||Vt(e)?{i:Ln,r:e,k:t,f:!!n}:e:null);function C(e,t=null,n=null,i=0,s=null,o=e===We?0:1,l=!1,h=!1){const d={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&xg(t),ref:t&&ac(t),scopeId:og,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Ln};return h?(bd(d,n),o&128&&e.normalize(d)):n&&(d.shapeFlag|=Ve(n)?8:16),Va>0&&!l&&On&&(d.patchFlag>0||o&6)&&d.patchFlag!==32&&On.push(d),d}const ge=ZE;function ZE(e,t=null,n=null,i=0,s=null,o=!1){if((!e||e===vE)&&(e=cs),Pc(e)){const h=lo(e,t,!0);return n&&bd(h,n),Va>0&&!o&&On&&(h.shapeFlag&6?On[On.indexOf(e)]=h:On.push(h)),h.patchFlag=-2,h}if(ab(e)&&(e=e.__vccOpts),t){t=QE(t);let{class:h,style:d}=t;h&&!Ve(h)&&(t.class=Ja(h)),_e(d)&&(gd(d)&&!It(d)&&(d=ln({},d)),t.style=cd(d))}const l=Ve(e)?1:Cg(e)?128:sE(e)?64:_e(e)?4:Vt(e)?2:0;return C(e,t,n,i,s,l,o,!0)}function QE(e){return e?gd(e)||_g(e)?ln({},e):e:null}function lo(e,t,n=!1,i=!1){const{props:s,ref:o,patchFlag:l,children:h,transition:d}=e,p=t?XE(s||{},t):s,_={__v_isVNode:!0,__v_skip:!0,type:e.type,props:p,key:p&&xg(p),ref:t&&t.ref?n&&o?It(o)?o.concat(ac(t)):[o,ac(t)]:ac(t):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:h,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==We?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:d,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&lo(e.ssContent),ssFallback:e.ssFallback&&lo(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return d&&i&&wd(_,d.clone(_)),_}function $e(e=" ",t=0){return ge(nu,null,e,t)}function YE(e,t){const n=ge(oc,null,e);return n.staticCount=t,n}function ne(e="",t=!1){return t?(ut(),Eh(cs,null,e)):ge(cs,null,e)}function mi(e){return e==null||typeof e=="boolean"?ge(cs):It(e)?ge(We,null,e.slice()):Pc(e)?mr(e):ge(nu,null,String(e))}function mr(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:lo(e)}function bd(e,t){let n=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(It(t))n=16;else if(typeof t=="object")if(i&65){const s=t.default;s&&(s._c&&(s._d=!1),bd(e,s()),s._c&&(s._d=!0));return}else{n=32;const s=t._;!s&&!_g(t)?t._ctx=Ln:s===3&&Ln&&(Ln.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Vt(t)?(t={default:t,_ctx:Ln},n=32):(t=String(t),i&64?(n=16,t=[$e(t)]):n=8);e.children=t,e.shapeFlag|=n}function XE(...e){const t={};for(let n=0;n<e.length;n++){const i=e[n];for(const s in i)if(s==="class")t.class!==i.class&&(t.class=Ja([t.class,i.class]));else if(s==="style")t.style=cd([t.style,i.style]);else if(Gc(s)){const o=t[s],l=i[s];l&&o!==l&&!(It(o)&&o.includes(l))&&(t[s]=o?[].concat(o,l):l)}else s!==""&&(t[s]=i[s])}return t}function hi(e,t,n,i=null){Ii(e,t,7,[n,i])}const JE=fg();let tb=0;function eb(e,t,n){const i=e.type,s=(t?t.appContext:e.appContext)||JE,o={uid:tb++,vnode:e,type:i,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new RT(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:vg(i,s),emitsOptions:Rg(i,s),emit:null,emitted:null,propsDefaults:de,inheritAttrs:i.inheritAttrs,ctx:de,data:de,props:de,attrs:de,slots:de,refs:de,setupState:de,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=t?t.root:o,o.emit=jE.bind(null,o),e.ce&&e.ce(o),o}let sn=null,Ac,bh;{const e=Qc(),t=(n,i)=>{let s;return(s=e[n])||(s=e[n]=[]),s.push(i),o=>{s.length>1?s.forEach(l=>l(o)):s[0](o)}};Ac=t("__VUE_INSTANCE_SETTERS__",n=>sn=n),bh=t("__VUE_SSR_SETTERS__",n=>Ua=n)}const il=e=>{const t=sn;return Ac(e),e.scope.on(),()=>{e.scope.off(),Ac(t)}},pp=()=>{sn&&sn.scope.off(),Ac(null)};function kg(e){return e.vnode.shapeFlag&4}let Ua=!1;function nb(e,t=!1,n=!1){t&&bh(t);const{props:i,children:s}=e.vnode,o=kg(e);CE(e,i,o,t),LE(e,s,n);const l=o?ib(e,t):void 0;return t&&bh(!1),l}function ib(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,wE);const{setup:i}=n;if(i){Nr();const s=e.setupContext=i.length>1?sb(e):null,o=il(e),l=el(i,e,0,[e.props,s]),h=k_(l);if(Vr(),o(),(h||e.sp)&&!Ta(e)&&lg(e),h){if(l.then(pp,pp),t)return l.then(d=>{mp(e,d)}).catch(d=>{Jc(d,e,0)});e.asyncDep=l}else mp(e,l)}else Lg(e)}function mp(e,t,n){Vt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:_e(t)&&(e.setupState=eg(t)),Lg(e)}function Lg(e,t,n){const i=e.type;e.render||(e.render=i.render||gi);{const s=il(e);Nr();try{TE(e)}finally{Vr(),s()}}}const rb={get(e,t){return en(e,"get",""),e[t]}};function sb(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,rb),slots:e.slots,emit:e.emit,expose:t}}function iu(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(eg(GT(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Ea)return Ea[n](e)},has(t,n){return n in t||n in Ea}})):e.proxy}function ob(e,t=!0){return Vt(e)?e.displayName||e.name:e.name||t&&e.__name}function ab(e){return Vt(e)&&"__vccOpts"in e}const qn=(e,t)=>XT(e,t,Ua);function Og(e,t,n){const i=arguments.length;return i===2?_e(t)&&!It(t)?Pc(t)?ge(e,null,[t]):ge(e,t):ge(e,null,t):(i>3?n=Array.prototype.slice.call(arguments,2):i===3&&Pc(n)&&(n=[n]),ge(e,t,n))}const lb="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ih;const _p=typeof window<"u"&&window.trustedTypes;if(_p)try{Ih=_p.createPolicy("vue",{createHTML:e=>e})}catch{}const Mg=Ih?e=>Ih.createHTML(e):e=>e,cb="http://www.w3.org/2000/svg",ub="http://www.w3.org/1998/Math/MathML",zi=typeof document<"u"?document:null,gp=zi&&zi.createElement("template"),hb={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,i)=>{const s=t==="svg"?zi.createElementNS(cb,e):t==="mathml"?zi.createElementNS(ub,e):n?zi.createElement(e,{is:n}):zi.createElement(e);return e==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:e=>zi.createTextNode(e),createComment:e=>zi.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>zi.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,i,s,o){const l=n?n.previousSibling:t.lastChild;if(s&&(s===o||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),n),!(s===o||!(s=s.nextSibling)););else{gp.innerHTML=Mg(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const h=gp.content;if(i==="svg"||i==="mathml"){const d=h.firstChild;for(;d.firstChild;)h.appendChild(d.firstChild);h.removeChild(d)}t.insertBefore(h,n)}return[l?l.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},db=Symbol("_vtc");function fb(e,t,n){const i=e[db];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const vp=Symbol("_vod"),pb=Symbol("_vsh"),mb=Symbol(""),_b=/(^|;)\s*display\s*:/;function gb(e,t,n){const i=e.style,s=Ve(n);let o=!1;if(n&&!s){if(t)if(Ve(t))for(const l of t.split(";")){const h=l.slice(0,l.indexOf(":")).trim();n[h]==null&&lc(i,h,"")}else for(const l in t)n[l]==null&&lc(i,l,"");for(const l in n)l==="display"&&(o=!0),lc(i,l,n[l])}else if(s){if(t!==n){const l=i[mb];l&&(n+=";"+l),i.cssText=n,o=_b.test(n)}}else t&&e.removeAttribute("style");vp in e&&(e[vp]=o?i.display:"",e[pb]&&(i.display="none"))}const yp=/\s*!important$/;function lc(e,t,n){if(It(n))n.forEach(i=>lc(e,t,i));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const i=vb(e,t);yp.test(n)?e.setProperty(Dr(i),n.replace(yp,""),"important"):e[i]=n}}const wp=["Webkit","Moz","ms"],Ku={};function vb(e,t){const n=Ku[t];if(n)return n;let i=Gn(t);if(i!=="filter"&&i in e)return Ku[t]=i;i=Zc(i);for(let s=0;s<wp.length;s++){const o=wp[s]+i;if(o in e)return Ku[t]=o}return t}const Tp="http://www.w3.org/1999/xlink";function Ep(e,t,n,i,s,o=PT(t)){i&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(Tp,t.slice(6,t.length)):e.setAttributeNS(Tp,t,n):n==null||o&&!D_(n)?e.removeAttribute(t):e.setAttribute(t,o?"":bi(n)?String(n):n)}function bp(e,t,n,i,s){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?Mg(n):n);return}const o=e.tagName;if(t==="value"&&o!=="PROGRESS"&&!o.includes("-")){const h=o==="OPTION"?e.getAttribute("value")||"":e.value,d=n==null?e.type==="checkbox"?"on":"":String(n);(h!==d||!("_value"in e))&&(e.value=d),n==null&&e.removeAttribute(t),e._value=n;return}let l=!1;if(n===""||n==null){const h=typeof e[t];h==="boolean"?n=D_(n):n==null&&h==="string"?(n="",l=!0):h==="number"&&(n=0,l=!0)}try{e[t]=n}catch{}l&&e.removeAttribute(s||t)}function gr(e,t,n,i){e.addEventListener(t,n,i)}function yb(e,t,n,i){e.removeEventListener(t,n,i)}const Ip=Symbol("_vei");function wb(e,t,n,i,s=null){const o=e[Ip]||(e[Ip]={}),l=o[t];if(i&&l)l.value=i;else{const[h,d]=Tb(t);if(i){const p=o[t]=Ib(i,s);gr(e,h,p,d)}else l&&(yb(e,h,l,d),o[t]=void 0)}}const Pp=/(?:Once|Passive|Capture)$/;function Tb(e){let t;if(Pp.test(e)){t={};let i;for(;i=e.match(Pp);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Dr(e.slice(2)),t]}let Zu=0;const Eb=Promise.resolve(),bb=()=>Zu||(Eb.then(()=>Zu=0),Zu=Date.now());function Ib(e,t){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;Ii(Pb(i,n.value),t,5,[i])};return n.value=e,n.attached=bb(),n}function Pb(e,t){if(It(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(i=>s=>!s._stopped&&i&&i(s))}else return t}const Ap=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Ab=(e,t,n,i,s,o)=>{const l=s==="svg";t==="class"?fb(e,i,l):t==="style"?gb(e,n,i):Gc(t)?od(t)||wb(e,t,n,i,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Rb(e,t,i,l))?(bp(e,t,i),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Ep(e,t,i,l,o,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Ve(i))?bp(e,Gn(t),i,o,t):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),Ep(e,t,i,l))};function Rb(e,t,n,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&Ap(t)&&Vt(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Ap(t)&&Ve(n)?!1:t in e}const co=e=>{const t=e.props["onUpdate:modelValue"]||!1;return It(t)?n=>rc(t,n):t};function Cb(e){e.target.composing=!0}function Rp(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Gi=Symbol("_assign"),Ae={created(e,{modifiers:{lazy:t,trim:n,number:i}},s){e[Gi]=co(s);const o=i||s.props&&s.props.type==="number";gr(e,t?"change":"input",l=>{if(l.target.composing)return;let h=e.value;n&&(h=h.trim()),o&&(h=yc(h)),e[Gi](h)}),n&&gr(e,"change",()=>{e.value=e.value.trim()}),t||(gr(e,"compositionstart",Cb),gr(e,"compositionend",Rp),gr(e,"change",Rp))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:i,trim:s,number:o}},l){if(e[Gi]=co(l),e.composing)return;const h=(o||e.type==="number")&&!/^0\d/.test(e.value)?yc(e.value):e.value,d=t??"";h!==d&&(document.activeElement===e&&e.type!=="range"&&(i&&t===n||s&&e.value.trim()===d)||(e.value=d))}},Dg={deep:!0,created(e,t,n){e[Gi]=co(n),gr(e,"change",()=>{const i=e._modelValue,s=Fa(e),o=e.checked,l=e[Gi];if(It(i)){const h=ud(i,s),d=h!==-1;if(o&&!d)l(i.concat(s));else if(!o&&d){const p=[...i];p.splice(h,1),l(p)}}else if(Eo(i)){const h=new Set(i);o?h.add(s):h.delete(s),l(h)}else l(Vg(e,o))})},mounted:Cp,beforeUpdate(e,t,n){e[Gi]=co(n),Cp(e,t,n)}};function Cp(e,{value:t,oldValue:n},i){e._modelValue=t;let s;if(It(t))s=ud(t,i.props.value)>-1;else if(Eo(t))s=t.has(i.props.value);else{if(t===n)return;s=tl(t,Vg(e,!0))}e.checked!==s&&(e.checked=s)}const Ng={deep:!0,created(e,{value:t,modifiers:{number:n}},i){const s=Eo(t);gr(e,"change",()=>{const o=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>n?yc(Fa(l)):Fa(l));e[Gi](e.multiple?s?new Set(o):o:o[0]),e._assigning=!0,vd(()=>{e._assigning=!1})}),e[Gi]=co(i)},mounted(e,{value:t}){Sp(e,t)},beforeUpdate(e,t,n){e[Gi]=co(n)},updated(e,{value:t}){e._assigning||Sp(e,t)}};function Sp(e,t){const n=e.multiple,i=It(t);if(!(n&&!i&&!Eo(t))){for(let s=0,o=e.options.length;s<o;s++){const l=e.options[s],h=Fa(l);if(n)if(i){const d=typeof h;d==="string"||d==="number"?l.selected=t.some(p=>String(p)===String(h)):l.selected=ud(t,h)>-1}else l.selected=t.has(h);else if(tl(Fa(l),t)){e.selectedIndex!==s&&(e.selectedIndex=s);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Fa(e){return"_value"in e?e._value:e.value}function Vg(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const Sb=["ctrl","shift","alt","meta"],xb={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Sb.some(n=>e[`${n}Key`]&&!t.includes(n))},io=(e,t)=>{const n=e._withMods||(e._withMods={}),i=t.join(".");return n[i]||(n[i]=(s,...o)=>{for(let l=0;l<t.length;l++){const h=xb[t[l]];if(h&&h(s,t))return}return e(s,...o)})},kb={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Qu=(e,t)=>{const n=e._withKeys||(e._withKeys={}),i=t.join(".");return n[i]||(n[i]=s=>{if(!("key"in s))return;const o=Dr(s.key);if(t.some(l=>l===o||kb[l]===o))return e(s)})},Lb=ln({patchProp:Ab},hb);let xp;function Ob(){return xp||(xp=ME(Lb))}const Mb=(...e)=>{const t=Ob().createApp(...e),{mount:n}=t;return t.mount=i=>{const s=Nb(i);if(!s)return;const o=t._component;!Vt(o)&&!o.render&&!o.template&&(o.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const l=n(s,!1,Db(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),l},t};function Db(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Nb(e){return Ve(e)?document.querySelector(e):e}const Pn=(e,t)=>{const n=e.__vccOpts||e;for(const[i,s]of t)n[i]=s;return n},Vb={name:"App"};function Ub(e,t,n,i,s,o){const l=kn("router-view");return ut(),ft("div",null,[ge(l)])}const Fb=Pn(Vb,[["render",Ub]]);/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const $s=typeof document<"u";function Ug(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Bb(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&Ug(e.default)}const ie=Object.assign;function Yu(e,t){const n={};for(const i in t){const s=t[i];n[i]=ri(s)?s.map(e):e(s)}return n}const Pa=()=>{},ri=Array.isArray,Fg=/#/g,zb=/&/g,jb=/\//g,Hb=/=/g,qb=/\?/g,Bg=/\+/g,Wb=/%5B/g,$b=/%5D/g,zg=/%5E/g,Gb=/%60/g,jg=/%7B/g,Kb=/%7C/g,Hg=/%7D/g,Zb=/%20/g;function Id(e){return encodeURI(""+e).replace(Kb,"|").replace(Wb,"[").replace($b,"]")}function Qb(e){return Id(e).replace(jg,"{").replace(Hg,"}").replace(zg,"^")}function Ph(e){return Id(e).replace(Bg,"%2B").replace(Zb,"+").replace(Fg,"%23").replace(zb,"%26").replace(Gb,"`").replace(jg,"{").replace(Hg,"}").replace(zg,"^")}function Yb(e){return Ph(e).replace(Hb,"%3D")}function Xb(e){return Id(e).replace(Fg,"%23").replace(qb,"%3F")}function Jb(e){return e==null?"":Xb(e).replace(jb,"%2F")}function Ba(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const tI=/\/$/,eI=e=>e.replace(tI,"");function Xu(e,t,n="/"){let i,s={},o="",l="";const h=t.indexOf("#");let d=t.indexOf("?");return h<d&&h>=0&&(d=-1),d>-1&&(i=t.slice(0,d),o=t.slice(d+1,h>-1?h:t.length),s=e(o)),h>-1&&(i=i||t.slice(0,h),l=t.slice(h,t.length)),i=sI(i??t,n),{fullPath:i+(o&&"?")+o+l,path:i,query:s,hash:Ba(l)}}function nI(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function kp(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function iI(e,t,n){const i=t.matched.length-1,s=n.matched.length-1;return i>-1&&i===s&&uo(t.matched[i],n.matched[s])&&qg(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function uo(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function qg(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!rI(e[n],t[n]))return!1;return!0}function rI(e,t){return ri(e)?Lp(e,t):ri(t)?Lp(t,e):e===t}function Lp(e,t){return ri(t)?e.length===t.length&&e.every((n,i)=>n===t[i]):e.length===1&&e[0]===t}function sI(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),i=e.split("/"),s=i[i.length-1];(s===".."||s===".")&&i.push("");let o=n.length-1,l,h;for(l=0;l<i.length;l++)if(h=i[l],h!==".")if(h==="..")o>1&&o--;else break;return n.slice(0,o).join("/")+"/"+i.slice(l).join("/")}const dr={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var za;(function(e){e.pop="pop",e.push="push"})(za||(za={}));var Aa;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Aa||(Aa={}));function oI(e){if(!e)if($s){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),eI(e)}const aI=/^[^#]+#/;function lI(e,t){return e.replace(aI,"#")+t}function cI(e,t){const n=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-n.left-(t.left||0),top:i.top-n.top-(t.top||0)}}const ru=()=>({left:window.scrollX,top:window.scrollY});function uI(e){let t;if("el"in e){const n=e.el,i=typeof n=="string"&&n.startsWith("#"),s=typeof n=="string"?i?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!s)return;t=cI(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function Op(e,t){return(history.state?history.state.position-t:-1)+e}const Ah=new Map;function hI(e,t){Ah.set(e,t)}function dI(e){const t=Ah.get(e);return Ah.delete(e),t}let fI=()=>location.protocol+"//"+location.host;function Wg(e,t){const{pathname:n,search:i,hash:s}=t,o=e.indexOf("#");if(o>-1){let h=s.includes(e.slice(o))?e.slice(o).length:1,d=s.slice(h);return d[0]!=="/"&&(d="/"+d),kp(d,"")}return kp(n,e)+i+s}function pI(e,t,n,i){let s=[],o=[],l=null;const h=({state:T})=>{const b=Wg(e,location),V=n.value,B=t.value;let H=0;if(T){if(n.value=b,t.value=T,l&&l===V){l=null;return}H=B?T.position-B.position:0}else i(b);s.forEach(et=>{et(n.value,V,{delta:H,type:za.pop,direction:H?H>0?Aa.forward:Aa.back:Aa.unknown})})};function d(){l=n.value}function p(T){s.push(T);const b=()=>{const V=s.indexOf(T);V>-1&&s.splice(V,1)};return o.push(b),b}function _(){const{history:T}=window;T.state&&T.replaceState(ie({},T.state,{scroll:ru()}),"")}function v(){for(const T of o)T();o=[],window.removeEventListener("popstate",h),window.removeEventListener("beforeunload",_)}return window.addEventListener("popstate",h),window.addEventListener("beforeunload",_,{passive:!0}),{pauseListeners:d,listen:p,destroy:v}}function Mp(e,t,n,i=!1,s=!1){return{back:e,current:t,forward:n,replaced:i,position:window.history.length,scroll:s?ru():null}}function mI(e){const{history:t,location:n}=window,i={value:Wg(e,n)},s={value:t.state};s.value||o(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function o(d,p,_){const v=e.indexOf("#"),T=v>-1?(n.host&&document.querySelector("base")?e:e.slice(v))+d:fI()+e+d;try{t[_?"replaceState":"pushState"](p,"",T),s.value=p}catch(b){console.error(b),n[_?"replace":"assign"](T)}}function l(d,p){const _=ie({},t.state,Mp(s.value.back,d,s.value.forward,!0),p,{position:s.value.position});o(d,_,!0),i.value=d}function h(d,p){const _=ie({},s.value,t.state,{forward:d,scroll:ru()});o(_.current,_,!0);const v=ie({},Mp(i.value,d,null),{position:_.position+1},p);o(d,v,!1),i.value=d}return{location:i,state:s,push:h,replace:l}}function _I(e){e=oI(e);const t=mI(e),n=pI(e,t.state,t.location,t.replace);function i(o,l=!0){l||n.pauseListeners(),history.go(o)}const s=ie({location:"",base:e,go:i,createHref:lI.bind(null,e)},t,n);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function gI(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),_I(e)}function vI(e){return typeof e=="string"||e&&typeof e=="object"}function $g(e){return typeof e=="string"||typeof e=="symbol"}const Gg=Symbol("");var Dp;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(Dp||(Dp={}));function ho(e,t){return ie(new Error,{type:e,[Gg]:!0},t)}function Bi(e,t){return e instanceof Error&&Gg in e&&(t==null||!!(e.type&t))}const Np="[^/]+?",yI={sensitive:!1,strict:!1,start:!0,end:!0},wI=/[.+*?^${}()[\]/\\]/g;function TI(e,t){const n=ie({},yI,t),i=[];let s=n.start?"^":"";const o=[];for(const p of e){const _=p.length?[]:[90];n.strict&&!p.length&&(s+="/");for(let v=0;v<p.length;v++){const T=p[v];let b=40+(n.sensitive?.25:0);if(T.type===0)v||(s+="/"),s+=T.value.replace(wI,"\\$&"),b+=40;else if(T.type===1){const{value:V,repeatable:B,optional:H,regexp:et}=T;o.push({name:V,repeatable:B,optional:H});const Y=et||Np;if(Y!==Np){b+=10;try{new RegExp(`(${Y})`)}catch(J){throw new Error(`Invalid custom RegExp for param "${V}" (${Y}): `+J.message)}}let Q=B?`((?:${Y})(?:/(?:${Y}))*)`:`(${Y})`;v||(Q=H&&p.length<2?`(?:/${Q})`:"/"+Q),H&&(Q+="?"),s+=Q,b+=20,H&&(b+=-8),B&&(b+=-20),Y===".*"&&(b+=-50)}_.push(b)}i.push(_)}if(n.strict&&n.end){const p=i.length-1;i[p][i[p].length-1]+=.7000000000000001}n.strict||(s+="/?"),n.end?s+="$":n.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const l=new RegExp(s,n.sensitive?"":"i");function h(p){const _=p.match(l),v={};if(!_)return null;for(let T=1;T<_.length;T++){const b=_[T]||"",V=o[T-1];v[V.name]=b&&V.repeatable?b.split("/"):b}return v}function d(p){let _="",v=!1;for(const T of e){(!v||!_.endsWith("/"))&&(_+="/"),v=!1;for(const b of T)if(b.type===0)_+=b.value;else if(b.type===1){const{value:V,repeatable:B,optional:H}=b,et=V in p?p[V]:"";if(ri(et)&&!B)throw new Error(`Provided param "${V}" is an array but it is not repeatable (* or + modifiers)`);const Y=ri(et)?et.join("/"):et;if(!Y)if(H)T.length<2&&(_.endsWith("/")?_=_.slice(0,-1):v=!0);else throw new Error(`Missing required param "${V}"`);_+=Y}}return _||"/"}return{re:l,score:i,keys:o,parse:h,stringify:d}}function EI(e,t){let n=0;for(;n<e.length&&n<t.length;){const i=t[n]-e[n];if(i)return i;n++}return e.length<t.length?e.length===1&&e[0]===80?-1:1:e.length>t.length?t.length===1&&t[0]===80?1:-1:0}function Kg(e,t){let n=0;const i=e.score,s=t.score;for(;n<i.length&&n<s.length;){const o=EI(i[n],s[n]);if(o)return o;n++}if(Math.abs(s.length-i.length)===1){if(Vp(i))return 1;if(Vp(s))return-1}return s.length-i.length}function Vp(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const bI={type:0,value:""},II=/[a-zA-Z0-9_]/;function PI(e){if(!e)return[[]];if(e==="/")return[[bI]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(b){throw new Error(`ERR (${n})/"${p}": ${b}`)}let n=0,i=n;const s=[];let o;function l(){o&&s.push(o),o=[]}let h=0,d,p="",_="";function v(){p&&(n===0?o.push({type:0,value:p}):n===1||n===2||n===3?(o.length>1&&(d==="*"||d==="+")&&t(`A repeatable param (${p}) must be alone in its segment. eg: '/:ids+.`),o.push({type:1,value:p,regexp:_,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):t("Invalid state to consume buffer"),p="")}function T(){p+=d}for(;h<e.length;){if(d=e[h++],d==="\\"&&n!==2){i=n,n=4;continue}switch(n){case 0:d==="/"?(p&&v(),l()):d===":"?(v(),n=1):T();break;case 4:T(),n=i;break;case 1:d==="("?n=2:II.test(d)?T():(v(),n=0,d!=="*"&&d!=="?"&&d!=="+"&&h--);break;case 2:d===")"?_[_.length-1]=="\\"?_=_.slice(0,-1)+d:n=3:_+=d;break;case 3:v(),n=0,d!=="*"&&d!=="?"&&d!=="+"&&h--,_="";break;default:t("Unknown state");break}}return n===2&&t(`Unfinished custom RegExp for param "${p}"`),v(),l(),s}function AI(e,t,n){const i=TI(PI(e.path),n),s=ie(i,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function RI(e,t){const n=[],i=new Map;t=zp({strict:!1,end:!0,sensitive:!1},t);function s(v){return i.get(v)}function o(v,T,b){const V=!b,B=Fp(v);B.aliasOf=b&&b.record;const H=zp(t,v),et=[B];if("alias"in v){const J=typeof v.alias=="string"?[v.alias]:v.alias;for(const Et of J)et.push(Fp(ie({},B,{components:b?b.record.components:B.components,path:Et,aliasOf:b?b.record:B})))}let Y,Q;for(const J of et){const{path:Et}=J;if(T&&Et[0]!=="/"){const Pt=T.record.path,O=Pt[Pt.length-1]==="/"?"":"/";J.path=T.record.path+(Et&&O+Et)}if(Y=AI(J,T,H),b?b.alias.push(Y):(Q=Q||Y,Q!==Y&&Q.alias.push(Y),V&&v.name&&!Bp(Y)&&l(v.name)),Zg(Y)&&d(Y),B.children){const Pt=B.children;for(let O=0;O<Pt.length;O++)o(Pt[O],Y,b&&b.children[O])}b=b||Y}return Q?()=>{l(Q)}:Pa}function l(v){if($g(v)){const T=i.get(v);T&&(i.delete(v),n.splice(n.indexOf(T),1),T.children.forEach(l),T.alias.forEach(l))}else{const T=n.indexOf(v);T>-1&&(n.splice(T,1),v.record.name&&i.delete(v.record.name),v.children.forEach(l),v.alias.forEach(l))}}function h(){return n}function d(v){const T=xI(v,n);n.splice(T,0,v),v.record.name&&!Bp(v)&&i.set(v.record.name,v)}function p(v,T){let b,V={},B,H;if("name"in v&&v.name){if(b=i.get(v.name),!b)throw ho(1,{location:v});H=b.record.name,V=ie(Up(T.params,b.keys.filter(Q=>!Q.optional).concat(b.parent?b.parent.keys.filter(Q=>Q.optional):[]).map(Q=>Q.name)),v.params&&Up(v.params,b.keys.map(Q=>Q.name))),B=b.stringify(V)}else if(v.path!=null)B=v.path,b=n.find(Q=>Q.re.test(B)),b&&(V=b.parse(B),H=b.record.name);else{if(b=T.name?i.get(T.name):n.find(Q=>Q.re.test(T.path)),!b)throw ho(1,{location:v,currentLocation:T});H=b.record.name,V=ie({},T.params,v.params),B=b.stringify(V)}const et=[];let Y=b;for(;Y;)et.unshift(Y.record),Y=Y.parent;return{name:H,path:B,params:V,matched:et,meta:SI(et)}}e.forEach(v=>o(v));function _(){n.length=0,i.clear()}return{addRoute:o,resolve:p,removeRoute:l,clearRoutes:_,getRoutes:h,getRecordMatcher:s}}function Up(e,t){const n={};for(const i of t)i in e&&(n[i]=e[i]);return n}function Fp(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:CI(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function CI(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const i in e.components)t[i]=typeof n=="object"?n[i]:n;return t}function Bp(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function SI(e){return e.reduce((t,n)=>ie(t,n.meta),{})}function zp(e,t){const n={};for(const i in e)n[i]=i in t?t[i]:e[i];return n}function xI(e,t){let n=0,i=t.length;for(;n!==i;){const o=n+i>>1;Kg(e,t[o])<0?i=o:n=o+1}const s=kI(e);return s&&(i=t.lastIndexOf(s,i-1)),i}function kI(e){let t=e;for(;t=t.parent;)if(Zg(t)&&Kg(e,t)===0)return t}function Zg({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function LI(e){const t={};if(e===""||e==="?")return t;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let s=0;s<i.length;++s){const o=i[s].replace(Bg," "),l=o.indexOf("="),h=Ba(l<0?o:o.slice(0,l)),d=l<0?null:Ba(o.slice(l+1));if(h in t){let p=t[h];ri(p)||(p=t[h]=[p]),p.push(d)}else t[h]=d}return t}function jp(e){let t="";for(let n in e){const i=e[n];if(n=Yb(n),i==null){i!==void 0&&(t+=(t.length?"&":"")+n);continue}(ri(i)?i.map(o=>o&&Ph(o)):[i&&Ph(i)]).forEach(o=>{o!==void 0&&(t+=(t.length?"&":"")+n,o!=null&&(t+="="+o))})}return t}function OI(e){const t={};for(const n in e){const i=e[n];i!==void 0&&(t[n]=ri(i)?i.map(s=>s==null?null:""+s):i==null?i:""+i)}return t}const MI=Symbol(""),Hp=Symbol(""),su=Symbol(""),Qg=Symbol(""),Rh=Symbol("");function la(){let e=[];function t(i){return e.push(i),()=>{const s=e.indexOf(i);s>-1&&e.splice(s,1)}}function n(){e=[]}return{add:t,list:()=>e.slice(),reset:n}}function _r(e,t,n,i,s,o=l=>l()){const l=i&&(i.enterCallbacks[s]=i.enterCallbacks[s]||[]);return()=>new Promise((h,d)=>{const p=T=>{T===!1?d(ho(4,{from:n,to:t})):T instanceof Error?d(T):vI(T)?d(ho(2,{from:t,to:T})):(l&&i.enterCallbacks[s]===l&&typeof T=="function"&&l.push(T),h())},_=o(()=>e.call(i&&i.instances[s],t,n,p));let v=Promise.resolve(_);e.length<3&&(v=v.then(p)),v.catch(T=>d(T))})}function Ju(e,t,n,i,s=o=>o()){const o=[];for(const l of e)for(const h in l.components){let d=l.components[h];if(!(t!=="beforeRouteEnter"&&!l.instances[h]))if(Ug(d)){const _=(d.__vccOpts||d)[t];_&&o.push(_r(_,n,i,l,h,s))}else{let p=d();o.push(()=>p.then(_=>{if(!_)throw new Error(`Couldn't resolve component "${h}" at "${l.path}"`);const v=Bb(_)?_.default:_;l.mods[h]=_,l.components[h]=v;const b=(v.__vccOpts||v)[t];return b&&_r(b,n,i,l,h,s)()}))}}return o}function qp(e){const t=vi(su),n=vi(Qg),i=qn(()=>{const d=to(e.to);return t.resolve(d)}),s=qn(()=>{const{matched:d}=i.value,{length:p}=d,_=d[p-1],v=n.matched;if(!_||!v.length)return-1;const T=v.findIndex(uo.bind(null,_));if(T>-1)return T;const b=Wp(d[p-2]);return p>1&&Wp(_)===b&&v[v.length-1].path!==b?v.findIndex(uo.bind(null,d[p-2])):T}),o=qn(()=>s.value>-1&&FI(n.params,i.value.params)),l=qn(()=>s.value>-1&&s.value===n.matched.length-1&&qg(n.params,i.value.params));function h(d={}){if(UI(d)){const p=t[to(e.replace)?"replace":"push"](to(e.to)).catch(Pa);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>p),p}return Promise.resolve()}return{route:i,href:qn(()=>i.value.href),isActive:o,isExactActive:l,navigate:h}}function DI(e){return e.length===1?e[0]:e}const NI=ag({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:qp,setup(e,{slots:t}){const n=Xc(qp(e)),{options:i}=vi(su),s=qn(()=>({[$p(e.activeClass,i.linkActiveClass,"router-link-active")]:n.isActive,[$p(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const o=t.default&&DI(t.default(n));return e.custom?o:Og("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:s.value},o)}}}),VI=NI;function UI(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function FI(e,t){for(const n in t){const i=t[n],s=e[n];if(typeof i=="string"){if(i!==s)return!1}else if(!ri(s)||s.length!==i.length||i.some((o,l)=>o!==s[l]))return!1}return!0}function Wp(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const $p=(e,t,n)=>e??t??n,BI=ag({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const i=vi(Rh),s=qn(()=>e.route||i.value),o=vi(Hp,0),l=qn(()=>{let p=to(o);const{matched:_}=s.value;let v;for(;(v=_[p])&&!v.components;)p++;return p}),h=qn(()=>s.value.matched[l.value]);sc(Hp,qn(()=>l.value+1)),sc(MI,h),sc(Rh,s);const d=ee();return ba(()=>[d.value,h.value,e.name],([p,_,v],[T,b,V])=>{_&&(_.instances[v]=p,b&&b!==_&&p&&p===T&&(_.leaveGuards.size||(_.leaveGuards=b.leaveGuards),_.updateGuards.size||(_.updateGuards=b.updateGuards))),p&&_&&(!b||!uo(_,b)||!T)&&(_.enterCallbacks[v]||[]).forEach(B=>B(p))},{flush:"post"}),()=>{const p=s.value,_=e.name,v=h.value,T=v&&v.components[_];if(!T)return Gp(n.default,{Component:T,route:p});const b=v.props[_],V=b?b===!0?p.params:typeof b=="function"?b(p):b:null,H=Og(T,ie({},V,t,{onVnodeUnmounted:et=>{et.component.isUnmounted&&(v.instances[_]=null)},ref:d}));return Gp(n.default,{Component:H,route:p})||H}}});function Gp(e,t){if(!e)return null;const n=e(t);return n.length===1?n[0]:n}const zI=BI;function jI(e){const t=RI(e.routes,e),n=e.parseQuery||LI,i=e.stringifyQuery||jp,s=e.history,o=la(),l=la(),h=la(),d=KT(dr);let p=dr;$s&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const _=Yu.bind(null,q=>""+q),v=Yu.bind(null,Jb),T=Yu.bind(null,Ba);function b(q,at){let lt,mt;return $g(q)?(lt=t.getRecordMatcher(q),mt=at):mt=q,t.addRoute(mt,lt)}function V(q){const at=t.getRecordMatcher(q);at&&t.removeRoute(at)}function B(){return t.getRoutes().map(q=>q.record)}function H(q){return!!t.getRecordMatcher(q)}function et(q,at){if(at=ie({},at||d.value),typeof q=="string"){const N=Xu(n,q,at.path),W=t.resolve({path:N.path},at),K=s.createHref(N.fullPath);return ie(N,W,{params:T(W.params),hash:Ba(N.hash),redirectedFrom:void 0,href:K})}let lt;if(q.path!=null)lt=ie({},q,{path:Xu(n,q.path,at.path).path});else{const N=ie({},q.params);for(const W in N)N[W]==null&&delete N[W];lt=ie({},q,{params:v(N)}),at.params=v(at.params)}const mt=t.resolve(lt,at),Kt=q.hash||"";mt.params=_(T(mt.params));const P=nI(i,ie({},q,{hash:Qb(Kt),path:mt.path})),R=s.createHref(P);return ie({fullPath:P,hash:Kt,query:i===jp?OI(q.query):q.query||{}},mt,{redirectedFrom:void 0,href:R})}function Y(q){return typeof q=="string"?Xu(n,q,d.value.path):ie({},q)}function Q(q,at){if(p!==q)return ho(8,{from:at,to:q})}function J(q){return O(q)}function Et(q){return J(ie(Y(q),{replace:!0}))}function Pt(q){const at=q.matched[q.matched.length-1];if(at&&at.redirect){const{redirect:lt}=at;let mt=typeof lt=="function"?lt(q):lt;return typeof mt=="string"&&(mt=mt.includes("?")||mt.includes("#")?mt=Y(mt):{path:mt},mt.params={}),ie({query:q.query,hash:q.hash,params:mt.path!=null?{}:q.params},mt)}}function O(q,at){const lt=p=et(q),mt=d.value,Kt=q.state,P=q.force,R=q.replace===!0,N=Pt(lt);if(N)return O(ie(Y(N),{state:typeof N=="object"?ie({},Kt,N.state):Kt,force:P,replace:R}),at||lt);const W=lt;W.redirectedFrom=at;let K;return!P&&iI(i,mt,lt)&&(K=ho(16,{to:W,from:mt}),Gt(mt,mt,!0,!1)),(K?Promise.resolve(K):M(W,mt)).catch($=>Bi($)?Bi($,2)?$:vt($):ot($,W,mt)).then($=>{if($){if(Bi($,2))return O(ie({replace:R},Y($.to),{state:typeof $.to=="object"?ie({},Kt,$.to.state):Kt,force:P}),at||W)}else $=k(W,mt,!0,R,Kt);return D(W,mt,$),$})}function I(q,at){const lt=Q(q,at);return lt?Promise.reject(lt):Promise.resolve()}function S(q){const at=ae.values().next().value;return at&&typeof at.runWithContext=="function"?at.runWithContext(q):q()}function M(q,at){let lt;const[mt,Kt,P]=HI(q,at);lt=Ju(mt.reverse(),"beforeRouteLeave",q,at);for(const N of mt)N.leaveGuards.forEach(W=>{lt.push(_r(W,q,at))});const R=I.bind(null,q,at);return lt.push(R),At(lt).then(()=>{lt=[];for(const N of o.list())lt.push(_r(N,q,at));return lt.push(R),At(lt)}).then(()=>{lt=Ju(Kt,"beforeRouteUpdate",q,at);for(const N of Kt)N.updateGuards.forEach(W=>{lt.push(_r(W,q,at))});return lt.push(R),At(lt)}).then(()=>{lt=[];for(const N of P)if(N.beforeEnter)if(ri(N.beforeEnter))for(const W of N.beforeEnter)lt.push(_r(W,q,at));else lt.push(_r(N.beforeEnter,q,at));return lt.push(R),At(lt)}).then(()=>(q.matched.forEach(N=>N.enterCallbacks={}),lt=Ju(P,"beforeRouteEnter",q,at,S),lt.push(R),At(lt))).then(()=>{lt=[];for(const N of l.list())lt.push(_r(N,q,at));return lt.push(R),At(lt)}).catch(N=>Bi(N,8)?N:Promise.reject(N))}function D(q,at,lt){h.list().forEach(mt=>S(()=>mt(q,at,lt)))}function k(q,at,lt,mt,Kt){const P=Q(q,at);if(P)return P;const R=at===dr,N=$s?history.state:{};lt&&(mt||R?s.replace(q.fullPath,ie({scroll:R&&N&&N.scroll},Kt)):s.push(q.fullPath,Kt)),d.value=q,Gt(q,at,lt,R),vt()}let A;function qt(){A||(A=s.listen((q,at,lt)=>{if(!Ft.listening)return;const mt=et(q),Kt=Pt(mt);if(Kt){O(ie(Kt,{replace:!0,force:!0}),mt).catch(Pa);return}p=mt;const P=d.value;$s&&hI(Op(P.fullPath,lt.delta),ru()),M(mt,P).catch(R=>Bi(R,12)?R:Bi(R,2)?(O(ie(Y(R.to),{force:!0}),mt).then(N=>{Bi(N,20)&&!lt.delta&&lt.type===za.pop&&s.go(-1,!1)}).catch(Pa),Promise.reject()):(lt.delta&&s.go(-lt.delta,!1),ot(R,mt,P))).then(R=>{R=R||k(mt,P,!1),R&&(lt.delta&&!Bi(R,8)?s.go(-lt.delta,!1):lt.type===za.pop&&Bi(R,20)&&s.go(-1,!1)),D(mt,P,R)}).catch(Pa)}))}let Ye=la(),Xt=la(),Ut;function ot(q,at,lt){vt(q);const mt=Xt.list();return mt.length?mt.forEach(Kt=>Kt(q,at,lt)):console.error(q),Promise.reject(q)}function Xe(){return Ut&&d.value!==dr?Promise.resolve():new Promise((q,at)=>{Ye.add([q,at])})}function vt(q){return Ut||(Ut=!q,qt(),Ye.list().forEach(([at,lt])=>q?lt(q):at()),Ye.reset()),q}function Gt(q,at,lt,mt){const{scrollBehavior:Kt}=e;if(!$s||!Kt)return Promise.resolve();const P=!lt&&dI(Op(q.fullPath,0))||(mt||!lt)&&history.state&&history.state.scroll||null;return vd().then(()=>Kt(q,at,P)).then(R=>R&&uI(R)).catch(R=>ot(R,q,at))}const zt=q=>s.go(q);let jt;const ae=new Set,Ft={currentRoute:d,listening:!0,addRoute:b,removeRoute:V,clearRoutes:t.clearRoutes,hasRoute:H,getRoutes:B,resolve:et,options:e,push:J,replace:Et,go:zt,back:()=>zt(-1),forward:()=>zt(1),beforeEach:o.add,beforeResolve:l.add,afterEach:h.add,onError:Xt.add,isReady:Xe,install(q){const at=this;q.component("RouterLink",VI),q.component("RouterView",zI),q.config.globalProperties.$router=at,Object.defineProperty(q.config.globalProperties,"$route",{enumerable:!0,get:()=>to(d)}),$s&&!jt&&d.value===dr&&(jt=!0,J(s.location).catch(Kt=>{}));const lt={};for(const Kt in dr)Object.defineProperty(lt,Kt,{get:()=>d.value[Kt],enumerable:!0});q.provide(su,at),q.provide(Qg,X_(lt)),q.provide(Rh,d);const mt=q.unmount;ae.add(q),q.unmount=function(){ae.delete(q),ae.size<1&&(p=dr,A&&A(),A=null,d.value=dr,jt=!1,Ut=!1),mt()}}};function At(q){return q.reduce((at,lt)=>at.then(()=>S(lt)),Promise.resolve())}return Ft}function HI(e,t){const n=[],i=[],s=[],o=Math.max(t.matched.length,e.matched.length);for(let l=0;l<o;l++){const h=t.matched[l];h&&(e.matched.find(p=>uo(p,h))?i.push(h):n.push(h));const d=e.matched[l];d&&(t.matched.find(p=>uo(p,d))||s.push(d))}return[n,i,s]}function ou(){return vi(su)}const qI="/TripMaster/icons/icon-192x192.png",WI={name:"Home",setup(){const e=ou();return{goToLogin:()=>{e.push("/login")},goToRegister:()=>{e.push("/register")},goToInfo:()=>{e.push("/info")}}}},$I={class:"home-page d-flex flex-column justify-content-center align-items-center min-vh-100"},GI={class:"auth-buttons"},KI={class:"info-button"};function ZI(e,t,n,i,s,o){return ut(),ft("div",$I,[t[3]||(t[3]=C("div",{class:"logo-container text-center mb-4"},[C("img",{src:qI,alt:"TripMaster Logo",class:"app-logo"})],-1)),t[4]||(t[4]=C("div",{class:"welcome-text text-center my-2"},[C("h1",null,"TripMaster"),C("p",{class:"slogan"},"Start your adventure today and make every journey unforgettable!")],-1)),C("div",GI,[C("button",{onClick:t[0]||(t[0]=(...l)=>i.goToLogin&&i.goToLogin(...l))},"Login"),C("button",{onClick:t[1]||(t[1]=(...l)=>i.goToRegister&&i.goToRegister(...l))},"Register")]),C("div",KI,[C("button",{onClick:t[2]||(t[2]=(...l)=>i.goToInfo&&i.goToInfo(...l))},"Find out more about the app and authors")])])}const QI=Pn(WI,[["render",ZI],["__scopeId","data-v-901e26bc"]]),YI=()=>{};var Kp={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yg=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let s=e.charCodeAt(i);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=s&63|128):(s&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(e.charCodeAt(++i)&1023),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=s&63|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=s&63|128)}return t},XI=function(e){const t=[];let n=0,i=0;for(;n<e.length;){const s=e[n++];if(s<128)t[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=e[n++];t[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=e[n++],l=e[n++],h=e[n++],d=((s&7)<<18|(o&63)<<12|(l&63)<<6|h&63)-65536;t[i++]=String.fromCharCode(55296+(d>>10)),t[i++]=String.fromCharCode(56320+(d&1023))}else{const o=e[n++],l=e[n++];t[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|l&63)}}return t.join("")},Xg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<e.length;s+=3){const o=e[s],l=s+1<e.length,h=l?e[s+1]:0,d=s+2<e.length,p=d?e[s+2]:0,_=o>>2,v=(o&3)<<4|h>>4;let T=(h&15)<<2|p>>6,b=p&63;d||(b=64,l||(T=64)),i.push(n[_],n[v],n[T],n[b])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Yg(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):XI(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<e.length;){const o=n[e.charAt(s++)],h=s<e.length?n[e.charAt(s)]:0;++s;const p=s<e.length?n[e.charAt(s)]:64;++s;const v=s<e.length?n[e.charAt(s)]:64;if(++s,o==null||h==null||p==null||v==null)throw new JI;const T=o<<2|h>>4;if(i.push(T),p!==64){const b=h<<4&240|p>>2;if(i.push(b),v!==64){const V=p<<6&192|v;i.push(V)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class JI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const tP=function(e){const t=Yg(e);return Xg.encodeByteArray(t,!0)},Rc=function(e){return tP(e).replace(/\./g,"")},Jg=function(e){try{return Xg.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nP=()=>eP().__FIREBASE_DEFAULTS__,iP=()=>{if(typeof process>"u"||typeof Kp>"u")return;const e=Kp.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},rP=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&Jg(e[1]);return t&&JSON.parse(t)},au=()=>{try{return YI()||nP()||iP()||rP()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},tv=e=>{var t,n;return(n=(t=au())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},ev=e=>{const t=tv(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),i]:[t.substring(0,n),i]},nv=()=>{var e;return(e=au())===null||e===void 0?void 0:e.config},iv=e=>{var t;return(t=au())===null||t===void 0?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rv(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=t||"demo-project",s=e.iat||0,o=e.sub||e.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Rc(JSON.stringify(n)),Rc(JSON.stringify(l)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function oP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(cn())}function aP(){var e;const t=(e=au())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function lP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function cP(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function uP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function hP(){const e=cn();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function dP(){return!aP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function fP(){try{return typeof indexedDB=="object"}catch{return!1}}function pP(){return new Promise((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var o;t(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mP="FirebaseError";class Ai extends Error{constructor(t,n,i){super(n),this.code=t,this.customData=i,this.name=mP,Object.setPrototypeOf(this,Ai.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,rl.prototype.create)}}class rl{constructor(t,n,i){this.service=t,this.serviceName=n,this.errors=i}create(t,...n){const i=n[0]||{},s=`${this.service}/${t}`,o=this.errors[t],l=o?_P(o,i):"Error",h=`${this.serviceName}: ${l} (${s}).`;return new Ai(s,h,i)}}function _P(e,t){return e.replace(gP,(n,i)=>{const s=t[i];return s!=null?String(s):`<${i}?>`})}const gP=/\{\$([^}]+)}/g;function vP(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function us(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const s of n){if(!i.includes(s))return!1;const o=e[s],l=t[s];if(Zp(o)&&Zp(l)){if(!us(o,l))return!1}else if(o!==l)return!1}for(const s of i)if(!n.includes(s))return!1;return!0}function Zp(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sl(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach(s=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function ha(e){const t={};return e.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[s,o]=i.split("=");t[decodeURIComponent(s)]=decodeURIComponent(o)}}),t}function da(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function yP(e,t){const n=new wP(e,t);return n.subscribe.bind(n)}class wP{constructor(t,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{t(this)}).catch(i=>{this.error(i)})}next(t){this.forEachObserver(n=>{n.next(t)})}error(t){this.forEachObserver(n=>{n.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,n,i){let s;if(t===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");TP(t,["next","error","complete"])?s=t:s={next:t,error:n,complete:i},s.next===void 0&&(s.next=th),s.error===void 0&&(s.error=th),s.complete===void 0&&(s.complete=th);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,t)}sendOne(t,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{n(this.observers[t])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function TP(e,t){if(typeof e!="object"||e===null)return!1;for(const n of t)if(n in e&&typeof e[n]=="function")return!0;return!1}function th(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Te(e){return e&&e._delegate?e._delegate:e}class Cr{constructor(t,n,i){this.name=t,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const is="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const i=new sP;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(IP(t))try{this.getOrInitializeService({instanceIdentifier:is})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(t=is){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=is){return this.instances.has(t)}getOptions(t=is){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[o,l]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(o);i===h&&l.resolve(s)}return s}onInit(t,n){var i;const s=this.normalizeInstanceIdentifier(n),o=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;o.add(t),this.onInitCallbacks.set(s,o);const l=this.instances.get(s);return l&&t(l,s),()=>{o.delete(t)}}invokeOnInitCallbacks(t,n){const i=this.onInitCallbacks.get(n);if(i)for(const s of i)try{s(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:bP(t),options:n}),this.instances.set(t,i),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=is){return this.component?this.component.multipleInstances?t:is:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function bP(e){return e===is?void 0:e}function IP(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new EP(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qt;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Qt||(Qt={}));const AP={debug:Qt.DEBUG,verbose:Qt.VERBOSE,info:Qt.INFO,warn:Qt.WARN,error:Qt.ERROR,silent:Qt.SILENT},RP=Qt.INFO,CP={[Qt.DEBUG]:"log",[Qt.VERBOSE]:"log",[Qt.INFO]:"info",[Qt.WARN]:"warn",[Qt.ERROR]:"error"},SP=(e,t,...n)=>{if(t<e.logLevel)return;const i=new Date().toISOString(),s=CP[t];if(s)console[s](`[${i}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Pd{constructor(t){this.name=t,this._logLevel=RP,this._logHandler=SP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Qt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?AP[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Qt.DEBUG,...t),this._logHandler(this,Qt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Qt.VERBOSE,...t),this._logHandler(this,Qt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Qt.INFO,...t),this._logHandler(this,Qt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Qt.WARN,...t),this._logHandler(this,Qt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Qt.ERROR,...t),this._logHandler(this,Qt.ERROR,...t)}}const xP=(e,t)=>t.some(n=>e instanceof n);let Qp,Yp;function kP(){return Qp||(Qp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function LP(){return Yp||(Yp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const sv=new WeakMap,Ch=new WeakMap,ov=new WeakMap,eh=new WeakMap,Ad=new WeakMap;function OP(e){const t=new Promise((n,i)=>{const s=()=>{e.removeEventListener("success",o),e.removeEventListener("error",l)},o=()=>{n(Ir(e.result)),s()},l=()=>{i(e.error),s()};e.addEventListener("success",o),e.addEventListener("error",l)});return t.then(n=>{n instanceof IDBCursor&&sv.set(n,e)}).catch(()=>{}),Ad.set(t,e),t}function MP(e){if(Ch.has(e))return;const t=new Promise((n,i)=>{const s=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",l),e.removeEventListener("abort",l)},o=()=>{n(),s()},l=()=>{i(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",o),e.addEventListener("error",l),e.addEventListener("abort",l)});Ch.set(e,t)}let Sh={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Ch.get(e);if(t==="objectStoreNames")return e.objectStoreNames||ov.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ir(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function DP(e){Sh=e(Sh)}function NP(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const i=e.call(nh(this),t,...n);return ov.set(i,t.sort?t.sort():[t]),Ir(i)}:LP().includes(e)?function(...t){return e.apply(nh(this),t),Ir(sv.get(this))}:function(...t){return Ir(e.apply(nh(this),t))}}function VP(e){return typeof e=="function"?NP(e):(e instanceof IDBTransaction&&MP(e),xP(e,kP())?new Proxy(e,Sh):e)}function Ir(e){if(e instanceof IDBRequest)return OP(e);if(eh.has(e))return eh.get(e);const t=VP(e);return t!==e&&(eh.set(e,t),Ad.set(t,e)),t}const nh=e=>Ad.get(e);function UP(e,t,{blocked:n,upgrade:i,blocking:s,terminated:o}={}){const l=indexedDB.open(e,t),h=Ir(l);return i&&l.addEventListener("upgradeneeded",d=>{i(Ir(l.result),d.oldVersion,d.newVersion,Ir(l.transaction),d)}),n&&l.addEventListener("blocked",d=>n(d.oldVersion,d.newVersion,d)),h.then(d=>{o&&d.addEventListener("close",()=>o()),s&&d.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),h}const FP=["get","getKey","getAll","getAllKeys","count"],BP=["put","add","delete","clear"],ih=new Map;function Xp(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(ih.get(t))return ih.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,s=BP.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(s||FP.includes(n)))return;const o=async function(l,...h){const d=this.transaction(l,s?"readwrite":"readonly");let p=d.store;return i&&(p=p.index(h.shift())),(await Promise.all([p[n](...h),s&&d.done]))[0]};return ih.set(t,o),o}DP(e=>({...e,get:(t,n,i)=>Xp(t,n)||e.get(t,n,i),has:(t,n)=>!!Xp(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(jP(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function jP(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const xh="@firebase/app",Jp="0.11.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi=new Pd("@firebase/app"),HP="@firebase/app-compat",qP="@firebase/analytics-compat",WP="@firebase/analytics",$P="@firebase/app-check-compat",GP="@firebase/app-check",KP="@firebase/auth",ZP="@firebase/auth-compat",QP="@firebase/database",YP="@firebase/data-connect",XP="@firebase/database-compat",JP="@firebase/functions",t0="@firebase/functions-compat",e0="@firebase/installations",n0="@firebase/installations-compat",i0="@firebase/messaging",r0="@firebase/messaging-compat",s0="@firebase/performance",o0="@firebase/performance-compat",a0="@firebase/remote-config",l0="@firebase/remote-config-compat",c0="@firebase/storage",u0="@firebase/storage-compat",h0="@firebase/firestore",d0="@firebase/vertexai",f0="@firebase/firestore-compat",p0="firebase",m0="11.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kh="[DEFAULT]",_0={[xh]:"fire-core",[HP]:"fire-core-compat",[WP]:"fire-analytics",[qP]:"fire-analytics-compat",[GP]:"fire-app-check",[$P]:"fire-app-check-compat",[KP]:"fire-auth",[ZP]:"fire-auth-compat",[QP]:"fire-rtdb",[YP]:"fire-data-connect",[XP]:"fire-rtdb-compat",[JP]:"fire-fn",[t0]:"fire-fn-compat",[e0]:"fire-iid",[n0]:"fire-iid-compat",[i0]:"fire-fcm",[r0]:"fire-fcm-compat",[s0]:"fire-perf",[o0]:"fire-perf-compat",[a0]:"fire-rc",[l0]:"fire-rc-compat",[c0]:"fire-gcs",[u0]:"fire-gcs-compat",[h0]:"fire-fst",[f0]:"fire-fst-compat",[d0]:"fire-vertex","fire-js":"fire-js",[p0]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cc=new Map,g0=new Map,Lh=new Map;function tm(e,t){try{e.container.addComponent(t)}catch(n){Yi.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function hs(e){const t=e.name;if(Lh.has(t))return Yi.debug(`There were multiple attempts to register component ${t}.`),!1;Lh.set(t,e);for(const n of Cc.values())tm(n,e);for(const n of g0.values())tm(n,e);return!0}function lu(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function wn(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v0={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Pr=new rl("app","Firebase",v0);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(t,n,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Cr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Pr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gs=m0;function av(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const i=Object.assign({name:kh,automaticDataCollectionEnabled:!1},t),s=i.name;if(typeof s!="string"||!s)throw Pr.create("bad-app-name",{appName:String(s)});if(n||(n=nv()),!n)throw Pr.create("no-options");const o=Cc.get(s);if(o){if(us(n,o.options)&&us(i,o.config))return o;throw Pr.create("duplicate-app",{appName:s})}const l=new PP(s);for(const d of Lh.values())l.addComponent(d);const h=new y0(n,i,l);return Cc.set(s,h),h}function Rd(e=kh){const t=Cc.get(e);if(!t&&e===kh&&nv())return av();if(!t)throw Pr.create("no-app",{appName:e});return t}function yi(e,t,n){var i;let s=(i=_0[e])!==null&&i!==void 0?i:e;n&&(s+=`-${n}`);const o=s.match(/\s|\//),l=t.match(/\s|\//);if(o||l){const h=[`Unable to register library "${s}" with version "${t}":`];o&&h.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&l&&h.push("and"),l&&h.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Yi.warn(h.join(" "));return}hs(new Cr(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w0="firebase-heartbeat-database",T0=1,ja="firebase-heartbeat-store";let rh=null;function lv(){return rh||(rh=UP(w0,T0,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(ja)}catch(n){console.warn(n)}}}}).catch(e=>{throw Pr.create("idb-open",{originalErrorMessage:e.message})})),rh}async function E0(e){try{const n=(await lv()).transaction(ja),i=await n.objectStore(ja).get(cv(e));return await n.done,i}catch(t){if(t instanceof Ai)Yi.warn(t.message);else{const n=Pr.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Yi.warn(n.message)}}}async function em(e,t){try{const i=(await lv()).transaction(ja,"readwrite");await i.objectStore(ja).put(t,cv(e)),await i.done}catch(n){if(n instanceof Ai)Yi.warn(n.message);else{const i=Pr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Yi.warn(i.message)}}}function cv(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b0=1024,I0=30;class P0{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new R0(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=nm();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(l=>l.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>I0){const l=C0(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Yi.warn(i)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=nm(),{heartbeatsToSend:i,unsentEntries:s}=A0(this._heartbeatsCache.heartbeats),o=Rc(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return Yi.warn(n),""}}}function nm(){return new Date().toISOString().substring(0,10)}function A0(e,t=b0){const n=[];let i=e.slice();for(const s of e){const o=n.find(l=>l.agent===s.agent);if(o){if(o.dates.push(s.date),im(n)>t){o.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),im(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class R0{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return fP()?pP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await E0(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return em(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return em(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function im(e){return Rc(JSON.stringify({version:2,heartbeats:e})).length}function C0(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let i=1;i<e.length;i++)e[i].date<n&&(n=e[i].date,t=i);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S0(e){hs(new Cr("platform-logger",t=>new zP(t),"PRIVATE")),hs(new Cr("heartbeat",t=>new P0(t),"PRIVATE")),yi(xh,Jp,e),yi(xh,Jp,"esm2017"),yi("fire-js","")}S0("");var rm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ar,uv;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(O,I){function S(){}S.prototype=I.prototype,O.D=I.prototype,O.prototype=new S,O.prototype.constructor=O,O.C=function(M,D,k){for(var A=Array(arguments.length-2),qt=2;qt<arguments.length;qt++)A[qt-2]=arguments[qt];return I.prototype[D].apply(M,A)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(i,n),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(O,I,S){S||(S=0);var M=Array(16);if(typeof I=="string")for(var D=0;16>D;++D)M[D]=I.charCodeAt(S++)|I.charCodeAt(S++)<<8|I.charCodeAt(S++)<<16|I.charCodeAt(S++)<<24;else for(D=0;16>D;++D)M[D]=I[S++]|I[S++]<<8|I[S++]<<16|I[S++]<<24;I=O.g[0],S=O.g[1],D=O.g[2];var k=O.g[3],A=I+(k^S&(D^k))+M[0]+3614090360&4294967295;I=S+(A<<7&4294967295|A>>>25),A=k+(D^I&(S^D))+M[1]+3905402710&4294967295,k=I+(A<<12&4294967295|A>>>20),A=D+(S^k&(I^S))+M[2]+606105819&4294967295,D=k+(A<<17&4294967295|A>>>15),A=S+(I^D&(k^I))+M[3]+3250441966&4294967295,S=D+(A<<22&4294967295|A>>>10),A=I+(k^S&(D^k))+M[4]+4118548399&4294967295,I=S+(A<<7&4294967295|A>>>25),A=k+(D^I&(S^D))+M[5]+1200080426&4294967295,k=I+(A<<12&4294967295|A>>>20),A=D+(S^k&(I^S))+M[6]+2821735955&4294967295,D=k+(A<<17&4294967295|A>>>15),A=S+(I^D&(k^I))+M[7]+4249261313&4294967295,S=D+(A<<22&4294967295|A>>>10),A=I+(k^S&(D^k))+M[8]+1770035416&4294967295,I=S+(A<<7&4294967295|A>>>25),A=k+(D^I&(S^D))+M[9]+2336552879&4294967295,k=I+(A<<12&4294967295|A>>>20),A=D+(S^k&(I^S))+M[10]+4294925233&4294967295,D=k+(A<<17&4294967295|A>>>15),A=S+(I^D&(k^I))+M[11]+2304563134&4294967295,S=D+(A<<22&4294967295|A>>>10),A=I+(k^S&(D^k))+M[12]+1804603682&4294967295,I=S+(A<<7&4294967295|A>>>25),A=k+(D^I&(S^D))+M[13]+4254626195&4294967295,k=I+(A<<12&4294967295|A>>>20),A=D+(S^k&(I^S))+M[14]+2792965006&4294967295,D=k+(A<<17&4294967295|A>>>15),A=S+(I^D&(k^I))+M[15]+1236535329&4294967295,S=D+(A<<22&4294967295|A>>>10),A=I+(D^k&(S^D))+M[1]+4129170786&4294967295,I=S+(A<<5&4294967295|A>>>27),A=k+(S^D&(I^S))+M[6]+3225465664&4294967295,k=I+(A<<9&4294967295|A>>>23),A=D+(I^S&(k^I))+M[11]+643717713&4294967295,D=k+(A<<14&4294967295|A>>>18),A=S+(k^I&(D^k))+M[0]+3921069994&4294967295,S=D+(A<<20&4294967295|A>>>12),A=I+(D^k&(S^D))+M[5]+3593408605&4294967295,I=S+(A<<5&4294967295|A>>>27),A=k+(S^D&(I^S))+M[10]+38016083&4294967295,k=I+(A<<9&4294967295|A>>>23),A=D+(I^S&(k^I))+M[15]+3634488961&4294967295,D=k+(A<<14&4294967295|A>>>18),A=S+(k^I&(D^k))+M[4]+3889429448&4294967295,S=D+(A<<20&4294967295|A>>>12),A=I+(D^k&(S^D))+M[9]+568446438&4294967295,I=S+(A<<5&4294967295|A>>>27),A=k+(S^D&(I^S))+M[14]+3275163606&4294967295,k=I+(A<<9&4294967295|A>>>23),A=D+(I^S&(k^I))+M[3]+4107603335&4294967295,D=k+(A<<14&4294967295|A>>>18),A=S+(k^I&(D^k))+M[8]+1163531501&4294967295,S=D+(A<<20&4294967295|A>>>12),A=I+(D^k&(S^D))+M[13]+2850285829&4294967295,I=S+(A<<5&4294967295|A>>>27),A=k+(S^D&(I^S))+M[2]+4243563512&4294967295,k=I+(A<<9&4294967295|A>>>23),A=D+(I^S&(k^I))+M[7]+1735328473&4294967295,D=k+(A<<14&4294967295|A>>>18),A=S+(k^I&(D^k))+M[12]+2368359562&4294967295,S=D+(A<<20&4294967295|A>>>12),A=I+(S^D^k)+M[5]+4294588738&4294967295,I=S+(A<<4&4294967295|A>>>28),A=k+(I^S^D)+M[8]+2272392833&4294967295,k=I+(A<<11&4294967295|A>>>21),A=D+(k^I^S)+M[11]+1839030562&4294967295,D=k+(A<<16&4294967295|A>>>16),A=S+(D^k^I)+M[14]+4259657740&4294967295,S=D+(A<<23&4294967295|A>>>9),A=I+(S^D^k)+M[1]+2763975236&4294967295,I=S+(A<<4&4294967295|A>>>28),A=k+(I^S^D)+M[4]+1272893353&4294967295,k=I+(A<<11&4294967295|A>>>21),A=D+(k^I^S)+M[7]+4139469664&4294967295,D=k+(A<<16&4294967295|A>>>16),A=S+(D^k^I)+M[10]+3200236656&4294967295,S=D+(A<<23&4294967295|A>>>9),A=I+(S^D^k)+M[13]+681279174&4294967295,I=S+(A<<4&4294967295|A>>>28),A=k+(I^S^D)+M[0]+3936430074&4294967295,k=I+(A<<11&4294967295|A>>>21),A=D+(k^I^S)+M[3]+3572445317&4294967295,D=k+(A<<16&4294967295|A>>>16),A=S+(D^k^I)+M[6]+76029189&4294967295,S=D+(A<<23&4294967295|A>>>9),A=I+(S^D^k)+M[9]+3654602809&4294967295,I=S+(A<<4&4294967295|A>>>28),A=k+(I^S^D)+M[12]+3873151461&4294967295,k=I+(A<<11&4294967295|A>>>21),A=D+(k^I^S)+M[15]+530742520&4294967295,D=k+(A<<16&4294967295|A>>>16),A=S+(D^k^I)+M[2]+3299628645&4294967295,S=D+(A<<23&4294967295|A>>>9),A=I+(D^(S|~k))+M[0]+4096336452&4294967295,I=S+(A<<6&4294967295|A>>>26),A=k+(S^(I|~D))+M[7]+1126891415&4294967295,k=I+(A<<10&4294967295|A>>>22),A=D+(I^(k|~S))+M[14]+2878612391&4294967295,D=k+(A<<15&4294967295|A>>>17),A=S+(k^(D|~I))+M[5]+4237533241&4294967295,S=D+(A<<21&4294967295|A>>>11),A=I+(D^(S|~k))+M[12]+1700485571&4294967295,I=S+(A<<6&4294967295|A>>>26),A=k+(S^(I|~D))+M[3]+2399980690&4294967295,k=I+(A<<10&4294967295|A>>>22),A=D+(I^(k|~S))+M[10]+4293915773&4294967295,D=k+(A<<15&4294967295|A>>>17),A=S+(k^(D|~I))+M[1]+2240044497&4294967295,S=D+(A<<21&4294967295|A>>>11),A=I+(D^(S|~k))+M[8]+1873313359&4294967295,I=S+(A<<6&4294967295|A>>>26),A=k+(S^(I|~D))+M[15]+4264355552&4294967295,k=I+(A<<10&4294967295|A>>>22),A=D+(I^(k|~S))+M[6]+2734768916&4294967295,D=k+(A<<15&4294967295|A>>>17),A=S+(k^(D|~I))+M[13]+1309151649&4294967295,S=D+(A<<21&4294967295|A>>>11),A=I+(D^(S|~k))+M[4]+4149444226&4294967295,I=S+(A<<6&4294967295|A>>>26),A=k+(S^(I|~D))+M[11]+3174756917&4294967295,k=I+(A<<10&4294967295|A>>>22),A=D+(I^(k|~S))+M[2]+718787259&4294967295,D=k+(A<<15&4294967295|A>>>17),A=S+(k^(D|~I))+M[9]+3951481745&4294967295,O.g[0]=O.g[0]+I&4294967295,O.g[1]=O.g[1]+(D+(A<<21&4294967295|A>>>11))&4294967295,O.g[2]=O.g[2]+D&4294967295,O.g[3]=O.g[3]+k&4294967295}i.prototype.u=function(O,I){I===void 0&&(I=O.length);for(var S=I-this.blockSize,M=this.B,D=this.h,k=0;k<I;){if(D==0)for(;k<=S;)s(this,O,k),k+=this.blockSize;if(typeof O=="string"){for(;k<I;)if(M[D++]=O.charCodeAt(k++),D==this.blockSize){s(this,M),D=0;break}}else for(;k<I;)if(M[D++]=O[k++],D==this.blockSize){s(this,M),D=0;break}}this.h=D,this.o+=I},i.prototype.v=function(){var O=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);O[0]=128;for(var I=1;I<O.length-8;++I)O[I]=0;var S=8*this.o;for(I=O.length-8;I<O.length;++I)O[I]=S&255,S/=256;for(this.u(O),O=Array(16),I=S=0;4>I;++I)for(var M=0;32>M;M+=8)O[S++]=this.g[I]>>>M&255;return O};function o(O,I){var S=h;return Object.prototype.hasOwnProperty.call(S,O)?S[O]:S[O]=I(O)}function l(O,I){this.h=I;for(var S=[],M=!0,D=O.length-1;0<=D;D--){var k=O[D]|0;M&&k==I||(S[D]=k,M=!1)}this.g=S}var h={};function d(O){return-128<=O&&128>O?o(O,function(I){return new l([I|0],0>I?-1:0)}):new l([O|0],0>O?-1:0)}function p(O){if(isNaN(O)||!isFinite(O))return v;if(0>O)return H(p(-O));for(var I=[],S=1,M=0;O>=S;M++)I[M]=O/S|0,S*=4294967296;return new l(I,0)}function _(O,I){if(O.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(O.charAt(0)=="-")return H(_(O.substring(1),I));if(0<=O.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=p(Math.pow(I,8)),M=v,D=0;D<O.length;D+=8){var k=Math.min(8,O.length-D),A=parseInt(O.substring(D,D+k),I);8>k?(k=p(Math.pow(I,k)),M=M.j(k).add(p(A))):(M=M.j(S),M=M.add(p(A)))}return M}var v=d(0),T=d(1),b=d(16777216);e=l.prototype,e.m=function(){if(B(this))return-H(this).m();for(var O=0,I=1,S=0;S<this.g.length;S++){var M=this.i(S);O+=(0<=M?M:4294967296+M)*I,I*=4294967296}return O},e.toString=function(O){if(O=O||10,2>O||36<O)throw Error("radix out of range: "+O);if(V(this))return"0";if(B(this))return"-"+H(this).toString(O);for(var I=p(Math.pow(O,6)),S=this,M="";;){var D=J(S,I).g;S=et(S,D.j(I));var k=((0<S.g.length?S.g[0]:S.h)>>>0).toString(O);if(S=D,V(S))return k+M;for(;6>k.length;)k="0"+k;M=k+M}},e.i=function(O){return 0>O?0:O<this.g.length?this.g[O]:this.h};function V(O){if(O.h!=0)return!1;for(var I=0;I<O.g.length;I++)if(O.g[I]!=0)return!1;return!0}function B(O){return O.h==-1}e.l=function(O){return O=et(this,O),B(O)?-1:V(O)?0:1};function H(O){for(var I=O.g.length,S=[],M=0;M<I;M++)S[M]=~O.g[M];return new l(S,~O.h).add(T)}e.abs=function(){return B(this)?H(this):this},e.add=function(O){for(var I=Math.max(this.g.length,O.g.length),S=[],M=0,D=0;D<=I;D++){var k=M+(this.i(D)&65535)+(O.i(D)&65535),A=(k>>>16)+(this.i(D)>>>16)+(O.i(D)>>>16);M=A>>>16,k&=65535,A&=65535,S[D]=A<<16|k}return new l(S,S[S.length-1]&-2147483648?-1:0)};function et(O,I){return O.add(H(I))}e.j=function(O){if(V(this)||V(O))return v;if(B(this))return B(O)?H(this).j(H(O)):H(H(this).j(O));if(B(O))return H(this.j(H(O)));if(0>this.l(b)&&0>O.l(b))return p(this.m()*O.m());for(var I=this.g.length+O.g.length,S=[],M=0;M<2*I;M++)S[M]=0;for(M=0;M<this.g.length;M++)for(var D=0;D<O.g.length;D++){var k=this.i(M)>>>16,A=this.i(M)&65535,qt=O.i(D)>>>16,Ye=O.i(D)&65535;S[2*M+2*D]+=A*Ye,Y(S,2*M+2*D),S[2*M+2*D+1]+=k*Ye,Y(S,2*M+2*D+1),S[2*M+2*D+1]+=A*qt,Y(S,2*M+2*D+1),S[2*M+2*D+2]+=k*qt,Y(S,2*M+2*D+2)}for(M=0;M<I;M++)S[M]=S[2*M+1]<<16|S[2*M];for(M=I;M<2*I;M++)S[M]=0;return new l(S,0)};function Y(O,I){for(;(O[I]&65535)!=O[I];)O[I+1]+=O[I]>>>16,O[I]&=65535,I++}function Q(O,I){this.g=O,this.h=I}function J(O,I){if(V(I))throw Error("division by zero");if(V(O))return new Q(v,v);if(B(O))return I=J(H(O),I),new Q(H(I.g),H(I.h));if(B(I))return I=J(O,H(I)),new Q(H(I.g),I.h);if(30<O.g.length){if(B(O)||B(I))throw Error("slowDivide_ only works with positive integers.");for(var S=T,M=I;0>=M.l(O);)S=Et(S),M=Et(M);var D=Pt(S,1),k=Pt(M,1);for(M=Pt(M,2),S=Pt(S,2);!V(M);){var A=k.add(M);0>=A.l(O)&&(D=D.add(S),k=A),M=Pt(M,1),S=Pt(S,1)}return I=et(O,D.j(I)),new Q(D,I)}for(D=v;0<=O.l(I);){for(S=Math.max(1,Math.floor(O.m()/I.m())),M=Math.ceil(Math.log(S)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),k=p(S),A=k.j(I);B(A)||0<A.l(O);)S-=M,k=p(S),A=k.j(I);V(k)&&(k=T),D=D.add(k),O=et(O,A)}return new Q(D,O)}e.A=function(O){return J(this,O).h},e.and=function(O){for(var I=Math.max(this.g.length,O.g.length),S=[],M=0;M<I;M++)S[M]=this.i(M)&O.i(M);return new l(S,this.h&O.h)},e.or=function(O){for(var I=Math.max(this.g.length,O.g.length),S=[],M=0;M<I;M++)S[M]=this.i(M)|O.i(M);return new l(S,this.h|O.h)},e.xor=function(O){for(var I=Math.max(this.g.length,O.g.length),S=[],M=0;M<I;M++)S[M]=this.i(M)^O.i(M);return new l(S,this.h^O.h)};function Et(O){for(var I=O.g.length+1,S=[],M=0;M<I;M++)S[M]=O.i(M)<<1|O.i(M-1)>>>31;return new l(S,O.h)}function Pt(O,I){var S=I>>5;I%=32;for(var M=O.g.length-S,D=[],k=0;k<M;k++)D[k]=0<I?O.i(k+S)>>>I|O.i(k+S+1)<<32-I:O.i(k+S);return new l(D,O.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,uv=i,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=p,l.fromString=_,Ar=l}).apply(typeof rm<"u"?rm:typeof self<"u"?self:typeof window<"u"?window:{});var Ql=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var hv,fa,dv,cc,Oh,fv,pv,mv;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,m,y){return c==Array.prototype||c==Object.prototype||(c[m]=y.value),c};function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ql=="object"&&Ql];for(var m=0;m<c.length;++m){var y=c[m];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var i=n(this);function s(c,m){if(m)t:{var y=i;c=c.split(".");for(var E=0;E<c.length-1;E++){var U=c[E];if(!(U in y))break t;y=y[U]}c=c[c.length-1],E=y[c],m=m(E),m!=E&&m!=null&&t(y,c,{configurable:!0,writable:!0,value:m})}}function o(c,m){c instanceof String&&(c+="");var y=0,E=!1,U={next:function(){if(!E&&y<c.length){var j=y++;return{value:m(j,c[j]),done:!1}}return E=!0,{done:!0,value:void 0}}};return U[Symbol.iterator]=function(){return U},U}s("Array.prototype.values",function(c){return c||function(){return o(this,function(m,y){return y})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},h=this||self;function d(c){var m=typeof c;return m=m!="object"?m:c?Array.isArray(c)?"array":m:"null",m=="array"||m=="object"&&typeof c.length=="number"}function p(c){var m=typeof c;return m=="object"&&c!=null||m=="function"}function _(c,m,y){return c.call.apply(c.bind,arguments)}function v(c,m,y){if(!c)throw Error();if(2<arguments.length){var E=Array.prototype.slice.call(arguments,2);return function(){var U=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(U,E),c.apply(m,U)}}return function(){return c.apply(m,arguments)}}function T(c,m,y){return T=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:v,T.apply(null,arguments)}function b(c,m){var y=Array.prototype.slice.call(arguments,1);return function(){var E=y.slice();return E.push.apply(E,arguments),c.apply(this,E)}}function V(c,m){function y(){}y.prototype=m.prototype,c.aa=m.prototype,c.prototype=new y,c.prototype.constructor=c,c.Qb=function(E,U,j){for(var rt=Array(arguments.length-2),le=2;le<arguments.length;le++)rt[le-2]=arguments[le];return m.prototype[U].apply(E,rt)}}function B(c){const m=c.length;if(0<m){const y=Array(m);for(let E=0;E<m;E++)y[E]=c[E];return y}return[]}function H(c,m){for(let y=1;y<arguments.length;y++){const E=arguments[y];if(d(E)){const U=c.length||0,j=E.length||0;c.length=U+j;for(let rt=0;rt<j;rt++)c[U+rt]=E[rt]}else c.push(E)}}class et{constructor(m,y){this.i=m,this.j=y,this.h=0,this.g=null}get(){let m;return 0<this.h?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function Y(c){return/^[\s\xa0]*$/.test(c)}function Q(){var c=h.navigator;return c&&(c=c.userAgent)?c:""}function J(c){return J[" "](c),c}J[" "]=function(){};var Et=Q().indexOf("Gecko")!=-1&&!(Q().toLowerCase().indexOf("webkit")!=-1&&Q().indexOf("Edge")==-1)&&!(Q().indexOf("Trident")!=-1||Q().indexOf("MSIE")!=-1)&&Q().indexOf("Edge")==-1;function Pt(c,m,y){for(const E in c)m.call(y,c[E],E,c)}function O(c,m){for(const y in c)m.call(void 0,c[y],y,c)}function I(c){const m={};for(const y in c)m[y]=c[y];return m}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(c,m){let y,E;for(let U=1;U<arguments.length;U++){E=arguments[U];for(y in E)c[y]=E[y];for(let j=0;j<S.length;j++)y=S[j],Object.prototype.hasOwnProperty.call(E,y)&&(c[y]=E[y])}}function D(c){var m=1;c=c.split(":");const y=[];for(;0<m&&c.length;)y.push(c.shift()),m--;return c.length&&y.push(c.join(":")),y}function k(c){h.setTimeout(()=>{throw c},0)}function A(){var c=Xe;let m=null;return c.g&&(m=c.g,c.g=c.g.next,c.g||(c.h=null),m.next=null),m}class qt{constructor(){this.h=this.g=null}add(m,y){const E=Ye.get();E.set(m,y),this.h?this.h.next=E:this.g=E,this.h=E}}var Ye=new et(()=>new Xt,c=>c.reset());class Xt{constructor(){this.next=this.g=this.h=null}set(m,y){this.h=m,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let Ut,ot=!1,Xe=new qt,vt=()=>{const c=h.Promise.resolve(void 0);Ut=()=>{c.then(Gt)}};var Gt=()=>{for(var c;c=A();){try{c.h.call(c.g)}catch(y){k(y)}var m=Ye;m.j(c),100>m.h&&(m.h++,c.next=m.g,m.g=c)}ot=!1};function zt(){this.s=this.s,this.C=this.C}zt.prototype.s=!1,zt.prototype.ma=function(){this.s||(this.s=!0,this.N())},zt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function jt(c,m){this.type=c,this.g=this.target=m,this.defaultPrevented=!1}jt.prototype.h=function(){this.defaultPrevented=!0};var ae=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var c=!1,m=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const y=()=>{};h.addEventListener("test",y,m),h.removeEventListener("test",y,m)}catch{}return c}();function Ft(c,m){if(jt.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var y=this.type=c.type,E=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=m,m=c.relatedTarget){if(Et){t:{try{J(m.nodeName);var U=!0;break t}catch{}U=!1}U||(m=null)}}else y=="mouseover"?m=c.fromElement:y=="mouseout"&&(m=c.toElement);this.relatedTarget=m,E?(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:At[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&Ft.aa.h.call(this)}}V(Ft,jt);var At={2:"touch",3:"pen",4:"mouse"};Ft.prototype.h=function(){Ft.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var q="closure_listenable_"+(1e6*Math.random()|0),at=0;function lt(c,m,y,E,U){this.listener=c,this.proxy=null,this.src=m,this.type=y,this.capture=!!E,this.ha=U,this.key=++at,this.da=this.fa=!1}function mt(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Kt(c){this.src=c,this.g={},this.h=0}Kt.prototype.add=function(c,m,y,E,U){var j=c.toString();c=this.g[j],c||(c=this.g[j]=[],this.h++);var rt=R(c,m,E,U);return-1<rt?(m=c[rt],y||(m.fa=!1)):(m=new lt(m,this.src,j,!!E,U),m.fa=y,c.push(m)),m};function P(c,m){var y=m.type;if(y in c.g){var E=c.g[y],U=Array.prototype.indexOf.call(E,m,void 0),j;(j=0<=U)&&Array.prototype.splice.call(E,U,1),j&&(mt(m),c.g[y].length==0&&(delete c.g[y],c.h--))}}function R(c,m,y,E){for(var U=0;U<c.length;++U){var j=c[U];if(!j.da&&j.listener==m&&j.capture==!!y&&j.ha==E)return U}return-1}var N="closure_lm_"+(1e6*Math.random()|0),W={};function K(c,m,y,E,U){if(Array.isArray(m)){for(var j=0;j<m.length;j++)K(c,m[j],y,E,U);return null}return y=bt(y),c&&c[q]?c.K(m,y,p(E)?!!E.capture:!1,U):$(c,m,y,!1,E,U)}function $(c,m,y,E,U,j){if(!m)throw Error("Invalid event type");var rt=p(U)?!!U.capture:!!U,le=ct(c);if(le||(c[N]=le=new Kt(c)),y=le.add(m,y,E,rt,j),y.proxy)return y;if(E=st(),y.proxy=E,E.src=c,E.listener=y,c.addEventListener)ae||(U=rt),U===void 0&&(U=!1),c.addEventListener(m.toString(),E,U);else if(c.attachEvent)c.attachEvent(tt(m.toString()),E);else if(c.addListener&&c.removeListener)c.addListener(E);else throw Error("addEventListener and attachEvent are unavailable.");return y}function st(){function c(y){return m.call(c.src,c.listener,y)}const m=wt;return c}function it(c,m,y,E,U){if(Array.isArray(m))for(var j=0;j<m.length;j++)it(c,m[j],y,E,U);else E=p(E)?!!E.capture:!!E,y=bt(y),c&&c[q]?(c=c.i,m=String(m).toString(),m in c.g&&(j=c.g[m],y=R(j,y,E,U),-1<y&&(mt(j[y]),Array.prototype.splice.call(j,y,1),j.length==0&&(delete c.g[m],c.h--)))):c&&(c=ct(c))&&(m=c.g[m.toString()],c=-1,m&&(c=R(m,y,E,U)),(y=-1<c?m[c]:null)&&nt(y))}function nt(c){if(typeof c!="number"&&c&&!c.da){var m=c.src;if(m&&m[q])P(m.i,c);else{var y=c.type,E=c.proxy;m.removeEventListener?m.removeEventListener(y,E,c.capture):m.detachEvent?m.detachEvent(tt(y),E):m.addListener&&m.removeListener&&m.removeListener(E),(y=ct(m))?(P(y,c),y.h==0&&(y.src=null,m[N]=null)):mt(c)}}}function tt(c){return c in W?W[c]:W[c]="on"+c}function wt(c,m){if(c.da)c=!0;else{m=new Ft(m,this);var y=c.listener,E=c.ha||c.src;c.fa&&nt(c),c=y.call(E,m)}return c}function ct(c){return c=c[N],c instanceof Kt?c:null}var _t="__closure_events_fn_"+(1e9*Math.random()>>>0);function bt(c){return typeof c=="function"?c:(c[_t]||(c[_t]=function(m){return c.handleEvent(m)}),c[_t])}function yt(){zt.call(this),this.i=new Kt(this),this.M=this,this.F=null}V(yt,zt),yt.prototype[q]=!0,yt.prototype.removeEventListener=function(c,m,y,E){it(this,c,m,y,E)};function Lt(c,m){var y,E=c.F;if(E)for(y=[];E;E=E.F)y.push(E);if(c=c.M,E=m.type||m,typeof m=="string")m=new jt(m,c);else if(m instanceof jt)m.target=m.target||c;else{var U=m;m=new jt(E,c),M(m,U)}if(U=!0,y)for(var j=y.length-1;0<=j;j--){var rt=m.g=y[j];U=Wt(rt,E,!0,m)&&U}if(rt=m.g=c,U=Wt(rt,E,!0,m)&&U,U=Wt(rt,E,!1,m)&&U,y)for(j=0;j<y.length;j++)rt=m.g=y[j],U=Wt(rt,E,!1,m)&&U}yt.prototype.N=function(){if(yt.aa.N.call(this),this.i){var c=this.i,m;for(m in c.g){for(var y=c.g[m],E=0;E<y.length;E++)mt(y[E]);delete c.g[m],c.h--}}this.F=null},yt.prototype.K=function(c,m,y,E){return this.i.add(String(c),m,!1,y,E)},yt.prototype.L=function(c,m,y,E){return this.i.add(String(c),m,!0,y,E)};function Wt(c,m,y,E){if(m=c.i.g[String(m)],!m)return!0;m=m.concat();for(var U=!0,j=0;j<m.length;++j){var rt=m[j];if(rt&&!rt.da&&rt.capture==y){var le=rt.listener,Oe=rt.ha||rt.src;rt.fa&&P(c.i,rt),U=le.call(Oe,E)!==!1&&U}}return U&&!E.defaultPrevented}function Be(c,m,y){if(typeof c=="function")y&&(c=T(c,y));else if(c&&typeof c.handleEvent=="function")c=T(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(m)?-1:h.setTimeout(c,m||0)}function ke(c){c.g=Be(()=>{c.g=null,c.i&&(c.i=!1,ke(c))},c.l);const m=c.h;c.h=null,c.m.apply(null,m)}class un extends zt{constructor(m,y){super(),this.m=m,this.l=y,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:ke(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ze(c){zt.call(this),this.h=c,this.g={}}V(ze,zt);var Zn=[];function Ri(c){Pt(c.g,function(m,y){this.g.hasOwnProperty(y)&&nt(m)},c),c.g={}}ze.prototype.N=function(){ze.aa.N.call(this),Ri(this)},ze.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Le=h.JSON.stringify,_n=h.JSON.parse,oi=class{stringify(c){return h.JSON.stringify(c,void 0)}parse(c){return h.JSON.parse(c,void 0)}};function xo(){}xo.prototype.h=null;function gl(c){return c.h||(c.h=c.i())}function ko(){}var ir={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ws(){jt.call(this,"d")}V(ws,jt);function Lo(){jt.call(this,"c")}V(Lo,jt);var Ci={},vl=null;function Ts(){return vl=vl||new yt}Ci.La="serverreachability";function yl(c){jt.call(this,Ci.La,c)}V(yl,jt);function qr(c){const m=Ts();Lt(m,new yl(m))}Ci.STAT_EVENT="statevent";function Es(c,m){jt.call(this,Ci.STAT_EVENT,c),this.stat=m}V(Es,jt);function Ge(c){const m=Ts();Lt(m,new Es(m,c))}Ci.Ma="timingevent";function wl(c,m){jt.call(this,Ci.Ma,c),this.size=m}V(wl,jt);function Wr(c,m){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){c()},m)}function $r(){this.g=!0}$r.prototype.xa=function(){this.g=!1};function Nn(c,m,y,E,U,j){c.info(function(){if(c.g)if(j)for(var rt="",le=j.split("&"),Oe=0;Oe<le.length;Oe++){var Jt=le[Oe].split("=");if(1<Jt.length){var ue=Jt[0];Jt=Jt[1];var be=ue.split("_");rt=2<=be.length&&be[1]=="type"?rt+(ue+"="+Jt+"&"):rt+(ue+"=redacted&")}}else rt=null;else rt=j;return"XMLHTTP REQ ("+E+") [attempt "+U+"]: "+m+`
`+y+`
`+rt})}function gt(c,m,y,E,U,j,rt){c.info(function(){return"XMLHTTP RESP ("+E+") [ attempt "+U+"]: "+m+`
`+y+`
`+j+" "+rt})}function Si(c,m,y,E){c.info(function(){return"XMLHTTP TEXT ("+m+"): "+El(c,y)+(E?" "+E:"")})}function Tl(c,m){c.info(function(){return"TIMEOUT: "+m})}$r.prototype.info=function(){};function El(c,m){if(!c.g)return m;if(!m)return null;try{var y=JSON.parse(m);if(y){for(c=0;c<y.length;c++)if(Array.isArray(y[c])){var E=y[c];if(!(2>E.length)){var U=E[1];if(Array.isArray(U)&&!(1>U.length)){var j=U[0];if(j!="noop"&&j!="stop"&&j!="close")for(var rt=1;rt<U.length;rt++)U[rt]=""}}}}return Le(y)}catch{return m}}var Gr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},bs={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Is;function Qn(){}V(Qn,xo),Qn.prototype.g=function(){return new XMLHttpRequest},Qn.prototype.i=function(){return{}},Is=new Qn;function Yn(c,m,y,E){this.j=c,this.i=m,this.l=y,this.R=E||1,this.U=new ze(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new bl}function bl(){this.i=null,this.g="",this.h=!1}var Il={},Oo={};function Mo(c,m,y){c.L=1,c.v=Un(Pe(m)),c.m=y,c.P=!0,Do(c,null)}function Do(c,m){c.F=Date.now(),As(c),c.A=Pe(c.v);var y=c.A,E=c.R;Array.isArray(E)||(E=[String(E)]),Rl(y.i,"t",E),c.C=0,y=c.j.J,c.h=new bl,c.g=Ml(c.j,y?m:null,!c.m),0<c.O&&(c.M=new un(T(c.Y,c,c.g),c.O)),m=c.U,y=c.g,E=c.ca;var U="readystatechange";Array.isArray(U)||(U&&(Zn[0]=U.toString()),U=Zn);for(var j=0;j<U.length;j++){var rt=K(y,U[j],E||m.handleEvent,!1,m.h||m);if(!rt)break;m.g[rt.key]=rt}m=c.H?I(c.H):{},c.m?(c.u||(c.u="POST"),m["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,m)):(c.u="GET",c.g.ea(c.A,c.u,null,m)),qr(),Nn(c.i,c.u,c.A,c.l,c.R,c.m)}Yn.prototype.ca=function(c){c=c.target;const m=this.M;m&&hn(c)==3?m.j():this.Y(c)},Yn.prototype.Y=function(c){try{if(c==this.g)t:{const be=hn(this.g);var m=this.g.Ba();const ur=this.g.Z();if(!(3>be)&&(be!=3||this.g&&(this.h.h||this.g.oa()||Yo(this.g)))){this.J||be!=4||m==7||(m==8||0>=ur?qr(3):qr(2)),No(this);var y=this.g.Z();this.X=y;e:if(Pl(this)){var E=Yo(this.g);c="";var U=E.length,j=hn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){xi(this),Kr(this);var rt="";break e}this.h.i=new h.TextDecoder}for(m=0;m<U;m++)this.h.h=!0,c+=this.h.i.decode(E[m],{stream:!(j&&m==U-1)});E.length=0,this.h.g+=c,this.C=0,rt=this.h.g}else rt=this.g.oa();if(this.o=y==200,gt(this.i,this.u,this.A,this.l,this.R,be,y),this.o){if(this.T&&!this.K){e:{if(this.g){var le,Oe=this.g;if((le=Oe.g?Oe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Y(le)){var Jt=le;break e}}Jt=null}if(y=Jt)Si(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Zr(this,y);else{this.o=!1,this.s=3,Ge(12),xi(this),Kr(this);break t}}if(this.P){y=!0;let Se;for(;!this.J&&this.C<rt.length;)if(Se=Ps(this,rt),Se==Oo){be==4&&(this.s=4,Ge(14),y=!1),Si(this.i,this.l,null,"[Incomplete Response]");break}else if(Se==Il){this.s=4,Ge(15),Si(this.i,this.l,rt,"[Invalid Chunk]"),y=!1;break}else Si(this.i,this.l,Se,null),Zr(this,Se);if(Pl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),be!=4||rt.length!=0||this.h.h||(this.s=1,Ge(16),y=!1),this.o=this.o&&y,!y)Si(this.i,this.l,rt,"[Invalid Chunked Response]"),xi(this),Kr(this);else if(0<rt.length&&!this.W){this.W=!0;var ue=this.j;ue.g==this&&ue.ba&&!ue.M&&(ue.j.info("Great, no buffering proxy detected. Bytes received: "+rt.length),Ds(ue),ue.M=!0,Ge(11))}}else Si(this.i,this.l,rt,null),Zr(this,rt);be==4&&xi(this),this.o&&!this.J&&(be==4?Jo(this.j,this):(this.o=!1,As(this)))}else Mu(this.g),y==400&&0<rt.indexOf("Unknown SID")?(this.s=3,Ge(12)):(this.s=0,Ge(13)),xi(this),Kr(this)}}}catch{}finally{}};function Pl(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function Ps(c,m){var y=c.C,E=m.indexOf(`
`,y);return E==-1?Oo:(y=Number(m.substring(y,E)),isNaN(y)?Il:(E+=1,E+y>m.length?Oo:(m=m.slice(E,E+y),c.C=E+y,m)))}Yn.prototype.cancel=function(){this.J=!0,xi(this)};function As(c){c.S=Date.now()+c.I,Al(c,c.I)}function Al(c,m){if(c.B!=null)throw Error("WatchDog timer not null");c.B=Wr(T(c.ba,c),m)}function No(c){c.B&&(h.clearTimeout(c.B),c.B=null)}Yn.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(Tl(this.i,this.A),this.L!=2&&(qr(),Ge(17)),xi(this),this.s=2,Kr(this)):Al(this,this.S-c)};function Kr(c){c.j.G==0||c.J||Jo(c.j,c)}function xi(c){No(c);var m=c.M;m&&typeof m.ma=="function"&&m.ma(),c.M=null,Ri(c.U),c.g&&(m=c.g,c.g=null,m.abort(),m.ma())}function Zr(c,m){try{var y=c.j;if(y.G!=0&&(y.g==c||Zt(y.h,c))){if(!c.K&&Zt(y.h,c)&&y.G==3){try{var E=y.Da.g.parse(m)}catch{E=null}if(Array.isArray(E)&&E.length==3){var U=E;if(U[0]==0){t:if(!y.u){if(y.g)if(y.g.F+3e3<c.F)Vs(y),Os(y);else break t;Ms(y),Ge(18)}}else y.za=U[1],0<y.za-y.T&&37500>U[2]&&y.F&&y.v==0&&!y.C&&(y.C=Wr(T(y.Za,y),6e3));if(1>=rr(y.h)&&y.ca){try{y.ca()}catch{}y.ca=void 0}}else Di(y,11)}else if((c.K||y.g==c)&&Vs(y),!Y(m))for(U=y.Da.g.parse(m),m=0;m<U.length;m++){let Jt=U[m];if(y.T=Jt[0],Jt=Jt[1],y.G==2)if(Jt[0]=="c"){y.K=Jt[1],y.ia=Jt[2];const ue=Jt[3];ue!=null&&(y.la=ue,y.j.info("VER="+y.la));const be=Jt[4];be!=null&&(y.Aa=be,y.j.info("SVER="+y.Aa));const ur=Jt[5];ur!=null&&typeof ur=="number"&&0<ur&&(E=1.5*ur,y.L=E,y.j.info("backChannelRequestTimeoutMs_="+E)),E=y;const Se=c.g;if(Se){const Fs=Se.g?Se.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Fs){var j=E.h;j.g||Fs.indexOf("spdy")==-1&&Fs.indexOf("quic")==-1&&Fs.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(he(j,j.h),j.h=null))}if(E.D){const ci=Se.g?Se.g.getResponseHeader("X-HTTP-Session-Id"):null;ci&&(E.ya=ci,kt(E.I,E.D,ci))}}y.G=3,y.l&&y.l.ua(),y.ba&&(y.R=Date.now()-c.F,y.j.info("Handshake RTT: "+y.R+"ms")),E=y;var rt=c;if(E.qa=Us(E,E.J?E.ia:null,E.W),rt.K){Yr(E.h,rt);var le=rt,Oe=E.L;Oe&&(le.I=Oe),le.B&&(No(le),As(le)),E.g=rt}else ti(E);0<y.i.length&&cr(y)}else Jt[0]!="stop"&&Jt[0]!="close"||Di(y,7);else y.G==3&&(Jt[0]=="stop"||Jt[0]=="close"?Jt[0]=="stop"?Di(y,7):Ls(y):Jt[0]!="noop"&&y.l&&y.l.ta(Jt),y.v=0)}}qr(4)}catch{}}var Qr=class{constructor(c,m){this.g=c,this.map=m}};function Vo(c){this.l=c||10,h.PerformanceNavigationTiming?(c=h.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Uo(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function rr(c){return c.h?1:c.g?c.g.size:0}function Zt(c,m){return c.h?c.h==m:c.g?c.g.has(m):!1}function he(c,m){c.g?c.g.add(m):c.h=m}function Yr(c,m){c.h&&c.h==m?c.h=null:c.g&&c.g.has(m)&&c.g.delete(m)}Vo.prototype.cancel=function(){if(this.i=ki(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function ki(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let m=c.i;for(const y of c.g.values())m=m.concat(y.D);return m}return B(c.i)}function sr(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(d(c)){for(var m=[],y=c.length,E=0;E<y;E++)m.push(c[E]);return m}m=[],y=0;for(E in c)m[y++]=c[E];return m}function Fo(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(d(c)||typeof c=="string"){var m=[];c=c.length;for(var y=0;y<c;y++)m.push(y);return m}m=[],y=0;for(const E in c)m[y++]=E;return m}}}function Dt(c,m){if(c.forEach&&typeof c.forEach=="function")c.forEach(m,void 0);else if(d(c)||typeof c=="string")Array.prototype.forEach.call(c,m,void 0);else for(var y=Fo(c),E=sr(c),U=E.length,j=0;j<U;j++)m.call(void 0,E[j],y&&y[j],c)}var ye=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Bo(c,m){if(c){c=c.split("&");for(var y=0;y<c.length;y++){var E=c[y].indexOf("="),U=null;if(0<=E){var j=c[y].substring(0,E);U=c[y].substring(E+1)}else j=c[y];m(j,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function Vn(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Vn){this.h=c.h,Rs(this,c.j),this.o=c.o,this.g=c.g,Li(this,c.s),this.l=c.l;var m=c.i,y=new Oi;y.i=m.i,m.g&&(y.g=new Map(m.g),y.h=m.h),ai(this,y),this.m=c.m}else c&&(m=String(c).match(ye))?(this.h=!1,Rs(this,m[1]||"",!0),this.o=Xn(m[2]||""),this.g=Xn(m[3]||"",!0),Li(this,m[4]),this.l=Xn(m[5]||"",!0),ai(this,m[6]||"",!0),this.m=Xn(m[7]||"")):(this.h=!1,this.i=new Oi(null,this.h))}Vn.prototype.toString=function(){var c=[],m=this.j;m&&c.push(Jn(m,or,!0),":");var y=this.g;return(y||m=="file")&&(c.push("//"),(m=this.o)&&c.push(Jn(m,or,!0),"@"),c.push(encodeURIComponent(String(y)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.s,y!=null&&c.push(":",String(y))),(y=this.l)&&(this.g&&y.charAt(0)!="/"&&c.push("/"),c.push(Jn(y,y.charAt(0)=="/"?Ho:jo,!0))),(y=this.i.toString())&&c.push("?",y),(y=this.m)&&c.push("#",Jn(y,qo)),c.join("")};function Pe(c){return new Vn(c)}function Rs(c,m,y){c.j=y?Xn(m,!0):m,c.j&&(c.j=c.j.replace(/:$/,""))}function Li(c,m){if(m){if(m=Number(m),isNaN(m)||0>m)throw Error("Bad port number "+m);c.s=m}else c.s=null}function ai(c,m,y){m instanceof Oi?(c.i=m,Fn(c.i,c.h)):(y||(m=Jn(m,Cs)),c.i=new Oi(m,c.h))}function kt(c,m,y){c.i.set(m,y)}function Un(c){return kt(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Xn(c,m){return c?m?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Jn(c,m,y){return typeof c=="string"?(c=encodeURI(c).replace(m,zo),y&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function zo(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var or=/[#\/\?@]/g,jo=/[#\?:]/g,Ho=/[#\?]/g,Cs=/[#\?@]/g,qo=/#/g;function Oi(c,m){this.h=this.g=null,this.i=c||null,this.j=!!m}function An(c){c.g||(c.g=new Map,c.h=0,c.i&&Bo(c.i,function(m,y){c.add(decodeURIComponent(m.replace(/\+/g," ")),y)}))}e=Oi.prototype,e.add=function(c,m){An(this),this.i=null,c=Rt(this,c);var y=this.g.get(c);return y||this.g.set(c,y=[]),y.push(m),this.h+=1,this};function Wo(c,m){An(c),m=Rt(c,m),c.g.has(m)&&(c.i=null,c.h-=c.g.get(m).length,c.g.delete(m))}function Ss(c,m){return An(c),m=Rt(c,m),c.g.has(m)}e.forEach=function(c,m){An(this),this.g.forEach(function(y,E){y.forEach(function(U){c.call(m,U,E,this)},this)},this)},e.na=function(){An(this);const c=Array.from(this.g.values()),m=Array.from(this.g.keys()),y=[];for(let E=0;E<m.length;E++){const U=c[E];for(let j=0;j<U.length;j++)y.push(m[E])}return y},e.V=function(c){An(this);let m=[];if(typeof c=="string")Ss(this,c)&&(m=m.concat(this.g.get(Rt(this,c))));else{c=Array.from(this.g.values());for(let y=0;y<c.length;y++)m=m.concat(c[y])}return m},e.set=function(c,m){return An(this),this.i=null,c=Rt(this,c),Ss(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[m]),this.h+=1,this},e.get=function(c,m){return c?(c=this.V(c),0<c.length?String(c[0]):m):m};function Rl(c,m,y){Wo(c,m),0<y.length&&(c.i=null,c.g.set(Rt(c,m),B(y)),c.h+=y.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],m=Array.from(this.g.keys());for(var y=0;y<m.length;y++){var E=m[y];const j=encodeURIComponent(String(E)),rt=this.V(E);for(E=0;E<rt.length;E++){var U=j;rt[E]!==""&&(U+="="+encodeURIComponent(String(rt[E]))),c.push(U)}}return this.i=c.join("&")};function Rt(c,m){return m=String(m),c.j&&(m=m.toLowerCase()),m}function Fn(c,m){m&&!c.j&&(An(c),c.i=null,c.g.forEach(function(y,E){var U=E.toLowerCase();E!=U&&(Wo(this,E),Rl(this,U,y))},c)),c.j=m}function ce(c,m){const y=new $r;if(h.Image){const E=new Image;E.onload=b(Bn,y,"TestLoadImage: loaded",!0,m,E),E.onerror=b(Bn,y,"TestLoadImage: error",!1,m,E),E.onabort=b(Bn,y,"TestLoadImage: abort",!1,m,E),E.ontimeout=b(Bn,y,"TestLoadImage: timeout",!1,m,E),h.setTimeout(function(){E.ontimeout&&E.ontimeout()},1e4),E.src=c}else m(!1)}function Cl(c,m){const y=new $r,E=new AbortController,U=setTimeout(()=>{E.abort(),Bn(y,"TestPingServer: timeout",!1,m)},1e4);fetch(c,{signal:E.signal}).then(j=>{clearTimeout(U),j.ok?Bn(y,"TestPingServer: ok",!0,m):Bn(y,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(U),Bn(y,"TestPingServer: error",!1,m)})}function Bn(c,m,y,E,U){try{U&&(U.onload=null,U.onerror=null,U.onabort=null,U.ontimeout=null),E(y)}catch{}}function $o(){this.g=new oi}function Go(c,m,y){const E=y||"";try{Dt(c,function(U,j){let rt=U;p(U)&&(rt=Le(U)),m.push(E+j+"="+encodeURIComponent(rt))})}catch(U){throw m.push(E+"type="+encodeURIComponent("_badmap")),U}}function zn(c){this.l=c.Ub||null,this.j=c.eb||!1}V(zn,xo),zn.prototype.g=function(){return new ar(this.l,this.j)},zn.prototype.i=function(c){return function(){return c}}({});function ar(c,m){yt.call(this),this.D=c,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}V(ar,yt),e=ar.prototype,e.open=function(c,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=m,this.readyState=1,Rn(this)},e.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const m={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(m.body=c),(this.D||h).fetch(new Request(this.A,m)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ee(this)),this.readyState=0},e.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Rn(this)),this.g&&(this.readyState=3,Rn(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;lr(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function lr(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}e.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var m=c.value?c.value:new Uint8Array(0);(m=this.v.decode(m,{stream:!c.done}))&&(this.response=this.responseText+=m)}c.done?Ee(this):Rn(this),this.readyState==3&&lr(this)}},e.Ra=function(c){this.g&&(this.response=this.responseText=c,Ee(this))},e.Qa=function(c){this.g&&(this.response=c,Ee(this))},e.ga=function(){this.g&&Ee(this)};function Ee(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Rn(c)}e.setRequestHeader=function(c,m){this.u.append(c,m)},e.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],m=this.h.entries();for(var y=m.next();!y.done;)y=y.value,c.push(y[0]+": "+y[1]),y=m.next();return c.join(`\r
`)};function Rn(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(ar.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Ko(c){let m="";return Pt(c,function(y,E){m+=E,m+=":",m+=y,m+=`\r
`}),m}function xs(c,m,y){t:{for(E in y){var E=!1;break t}E=!0}E||(y=Ko(y),typeof c=="string"?y!=null&&encodeURIComponent(String(y)):kt(c,m,y))}function we(c){yt.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}V(we,yt);var Sl=/^https?$/i,Zo=["POST","PUT"];e=we.prototype,e.Ha=function(c){this.J=c},e.ea=function(c,m,y,E){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);m=m?m.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Is.g(),this.v=this.o?gl(this.o):gl(Is),this.g.onreadystatechange=T(this.Ea,this);try{this.B=!0,this.g.open(m,String(c),!0),this.B=!1}catch(j){xl(this,j);return}if(c=y||"",y=new Map(this.headers),E)if(Object.getPrototypeOf(E)===Object.prototype)for(var U in E)y.set(U,E[U]);else if(typeof E.keys=="function"&&typeof E.get=="function")for(const j of E.keys())y.set(j,E.get(j));else throw Error("Unknown input type for opt_headers: "+String(E));E=Array.from(y.keys()).find(j=>j.toLowerCase()=="content-type"),U=h.FormData&&c instanceof h.FormData,!(0<=Array.prototype.indexOf.call(Zo,m,void 0))||E||U||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[j,rt]of y)this.g.setRequestHeader(j,rt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{gn(this),this.u=!0,this.g.send(c),this.u=!1}catch(j){xl(this,j)}};function xl(c,m){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=m,c.m=5,Qo(c),ks(c)}function Qo(c){c.A||(c.A=!0,Lt(c,"complete"),Lt(c,"error"))}e.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,Lt(this,"complete"),Lt(this,"abort"),ks(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ks(this,!0)),we.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?$t(this):this.bb())},e.bb=function(){$t(this)};function $t(c){if(c.h&&typeof l<"u"&&(!c.v[1]||hn(c)!=4||c.Z()!=2)){if(c.u&&hn(c)==4)Be(c.Ea,0,c);else if(Lt(c,"readystatechange"),hn(c)==4){c.h=!1;try{const rt=c.Z();t:switch(rt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break t;default:m=!1}var y;if(!(y=m)){var E;if(E=rt===0){var U=String(c.D).match(ye)[1]||null;!U&&h.self&&h.self.location&&(U=h.self.location.protocol.slice(0,-1)),E=!Sl.test(U?U.toLowerCase():"")}y=E}if(y)Lt(c,"complete"),Lt(c,"success");else{c.m=6;try{var j=2<hn(c)?c.g.statusText:""}catch{j=""}c.l=j+" ["+c.Z()+"]",Qo(c)}}finally{ks(c)}}}}function ks(c,m){if(c.g){gn(c);const y=c.g,E=c.v[0]?()=>{}:null;c.g=null,c.v=null,m||Lt(c,"ready");try{y.onreadystatechange=E}catch{}}}function gn(c){c.I&&(h.clearTimeout(c.I),c.I=null)}e.isActive=function(){return!!this.g};function hn(c){return c.g?c.g.readyState:0}e.Z=function(){try{return 2<hn(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(c){if(this.g){var m=this.g.responseText;return c&&m.indexOf(c)==0&&(m=m.substring(c.length)),_n(m)}};function Yo(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Mu(c){const m={};c=(c.g&&2<=hn(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let E=0;E<c.length;E++){if(Y(c[E]))continue;var y=D(c[E]);const U=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const j=m[U]||[];m[U]=j,j.push(y)}O(m,function(E){return E.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Mi(c,m,y){return y&&y.internalChannelParams&&y.internalChannelParams[c]||m}function kl(c){this.Aa=0,this.i=[],this.j=new $r,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Mi("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Mi("baseRetryDelayMs",5e3,c),this.cb=Mi("retryDelaySeedMs",1e4,c),this.Wa=Mi("forwardChannelMaxRetries",2,c),this.wa=Mi("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Vo(c&&c.concurrentRequestLimit),this.Da=new $o,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=kl.prototype,e.la=8,e.G=1,e.connect=function(c,m,y,E){Ge(0),this.W=c,this.H=m||{},y&&E!==void 0&&(this.H.OSID=y,this.H.OAID=E),this.F=this.X,this.I=Us(this,null,this.W),cr(this)};function Ls(c){if(Ll(c),c.G==3){var m=c.U++,y=Pe(c.I);if(kt(y,"SID",c.K),kt(y,"RID",m),kt(y,"TYPE","terminate"),Xr(c,y),m=new Yn(c,c.j,m),m.L=2,m.v=Un(Pe(y)),y=!1,h.navigator&&h.navigator.sendBeacon)try{y=h.navigator.sendBeacon(m.v.toString(),"")}catch{}!y&&h.Image&&(new Image().src=m.v,y=!0),y||(m.g=Ml(m.j,null),m.g.ea(m.v)),m.F=Date.now(),As(m)}Ol(c)}function Os(c){c.g&&(Ds(c),c.g.cancel(),c.g=null)}function Ll(c){Os(c),c.u&&(h.clearTimeout(c.u),c.u=null),Vs(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&h.clearTimeout(c.s),c.s=null)}function cr(c){if(!Uo(c.h)&&!c.s){c.s=!0;var m=c.Ga;Ut||vt(),ot||(Ut(),ot=!0),Xe.add(m,c),c.B=0}}function Du(c,m){return rr(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=m.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=Wr(T(c.Ga,c,m),ta(c,c.B)),c.B++,!0)}e.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const U=new Yn(this,this.j,c);let j=this.o;if(this.S&&(j?(j=I(j),M(j,this.S)):j=this.S),this.m!==null||this.O||(U.H=j,j=null),this.P)t:{for(var m=0,y=0;y<this.i.length;y++){e:{var E=this.i[y];if("__data__"in E.map&&(E=E.map.__data__,typeof E=="string")){E=E.length;break e}E=void 0}if(E===void 0)break;if(m+=E,4096<m){m=y;break t}if(m===4096||y===this.i.length-1){m=y+1;break t}}m=1e3}else m=1e3;m=Xo(this,U,m),y=Pe(this.I),kt(y,"RID",c),kt(y,"CVER",22),this.D&&kt(y,"X-HTTP-Session-Id",this.D),Xr(this,y),j&&(this.O?m="headers="+encodeURIComponent(String(Ko(j)))+"&"+m:this.m&&xs(y,this.m,j)),he(this.h,U),this.Ua&&kt(y,"TYPE","init"),this.P?(kt(y,"$req",m),kt(y,"SID","null"),U.T=!0,Mo(U,y,null)):Mo(U,y,m),this.G=2}}else this.G==3&&(c?Cn(this,c):this.i.length==0||Uo(this.h)||Cn(this))};function Cn(c,m){var y;m?y=m.l:y=c.U++;const E=Pe(c.I);kt(E,"SID",c.K),kt(E,"RID",y),kt(E,"AID",c.T),Xr(c,E),c.m&&c.o&&xs(E,c.m,c.o),y=new Yn(c,c.j,y,c.B+1),c.m===null&&(y.H=c.o),m&&(c.i=m.D.concat(c.i)),m=Xo(c,y,1e3),y.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),he(c.h,y),Mo(y,E,m)}function Xr(c,m){c.H&&Pt(c.H,function(y,E){kt(m,E,y)}),c.l&&Dt({},function(y,E){kt(m,E,y)})}function Xo(c,m,y){y=Math.min(c.i.length,y);var E=c.l?T(c.l.Na,c.l,c):null;t:{var U=c.i;let j=-1;for(;;){const rt=["count="+y];j==-1?0<y?(j=U[0].g,rt.push("ofs="+j)):j=0:rt.push("ofs="+j);let le=!0;for(let Oe=0;Oe<y;Oe++){let Jt=U[Oe].g;const ue=U[Oe].map;if(Jt-=j,0>Jt)j=Math.max(0,U[Oe].g-100),le=!1;else try{Go(ue,rt,"req"+Jt+"_")}catch{E&&E(ue)}}if(le){E=rt.join("&");break t}}}return c=c.i.splice(0,y),m.D=c,E}function ti(c){if(!c.g&&!c.u){c.Y=1;var m=c.Fa;Ut||vt(),ot||(Ut(),ot=!0),Xe.add(m,c),c.v=0}}function Ms(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=Wr(T(c.Fa,c),ta(c,c.v)),c.v++,!0)}e.Fa=function(){if(this.u=null,Ns(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=Wr(T(this.ab,this),c)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ge(10),Os(this),Ns(this))};function Ds(c){c.A!=null&&(h.clearTimeout(c.A),c.A=null)}function Ns(c){c.g=new Yn(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var m=Pe(c.qa);kt(m,"RID","rpc"),kt(m,"SID",c.K),kt(m,"AID",c.T),kt(m,"CI",c.F?"0":"1"),!c.F&&c.ja&&kt(m,"TO",c.ja),kt(m,"TYPE","xmlhttp"),Xr(c,m),c.m&&c.o&&xs(m,c.m,c.o),c.L&&(c.g.I=c.L);var y=c.g;c=c.ia,y.L=1,y.v=Un(Pe(m)),y.m=null,y.P=!0,Do(y,c)}e.Za=function(){this.C!=null&&(this.C=null,Os(this),Ms(this),Ge(19))};function Vs(c){c.C!=null&&(h.clearTimeout(c.C),c.C=null)}function Jo(c,m){var y=null;if(c.g==m){Vs(c),Ds(c),c.g=null;var E=2}else if(Zt(c.h,m))y=m.D,Yr(c.h,m),E=1;else return;if(c.G!=0){if(m.o)if(E==1){y=m.m?m.m.length:0,m=Date.now()-m.F;var U=c.B;E=Ts(),Lt(E,new wl(E,y)),cr(c)}else ti(c);else if(U=m.s,U==3||U==0&&0<m.X||!(E==1&&Du(c,m)||E==2&&Ms(c)))switch(y&&0<y.length&&(m=c.h,m.i=m.i.concat(y)),U){case 1:Di(c,5);break;case 4:Di(c,10);break;case 3:Di(c,6);break;default:Di(c,2)}}}function ta(c,m){let y=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(y*=2),y*m}function Di(c,m){if(c.j.info("Error code "+m),m==2){var y=T(c.fb,c),E=c.Xa;const U=!E;E=new Vn(E||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||Rs(E,"https"),Un(E),U?ce(E.toString(),y):Cl(E.toString(),y)}else Ge(2);c.G=0,c.l&&c.l.sa(m),Ol(c),Ll(c)}e.fb=function(c){c?(this.j.info("Successfully pinged google.com"),Ge(2)):(this.j.info("Failed to ping google.com"),Ge(1))};function Ol(c){if(c.G=0,c.ka=[],c.l){const m=ki(c.h);(m.length!=0||c.i.length!=0)&&(H(c.ka,m),H(c.ka,c.i),c.h.i.length=0,B(c.i),c.i.length=0),c.l.ra()}}function Us(c,m,y){var E=y instanceof Vn?Pe(y):new Vn(y);if(E.g!="")m&&(E.g=m+"."+E.g),Li(E,E.s);else{var U=h.location;E=U.protocol,m=m?m+"."+U.hostname:U.hostname,U=+U.port;var j=new Vn(null);E&&Rs(j,E),m&&(j.g=m),U&&Li(j,U),y&&(j.l=y),E=j}return y=c.D,m=c.ya,y&&m&&kt(E,y,m),kt(E,"VER",c.la),Xr(c,E),E}function Ml(c,m,y){if(m&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return m=c.Ca&&!c.pa?new we(new zn({eb:y})):new we(c.pa),m.Ha(c.J),m}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function ea(){}e=ea.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function Jr(){}Jr.prototype.g=function(c,m){return new je(c,m)};function je(c,m){yt.call(this),this.g=new kl(m),this.l=c,this.h=m&&m.messageUrlParams||null,c=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(c?c["X-WebChannel-Content-Type"]=m.messageContentType:c={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.va&&(c?c["X-WebChannel-Client-Profile"]=m.va:c={"X-WebChannel-Client-Profile":m.va}),this.g.S=c,(c=m&&m.Sb)&&!Y(c)&&(this.g.m=c),this.v=m&&m.supportsCrossDomainXhr||!1,this.u=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!Y(m)&&(this.g.D=m,c=this.h,c!==null&&m in c&&(c=this.h,m in c&&delete c[m])),this.j=new jn(this)}V(je,yt),je.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},je.prototype.close=function(){Ls(this.g)},je.prototype.o=function(c){var m=this.g;if(typeof c=="string"){var y={};y.__data__=c,c=y}else this.u&&(y={},y.__data__=Le(c),c=y);m.i.push(new Qr(m.Ya++,c)),m.G==3&&cr(m)},je.prototype.N=function(){this.g.l=null,delete this.j,Ls(this.g),delete this.g,je.aa.N.call(this)};function li(c){ws.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var m=c.__sm__;if(m){t:{for(const y in m){c=y;break t}c=void 0}(this.i=c)&&(c=this.i,m=m!==null&&c in m?m[c]:void 0),this.data=m}else this.data=c}V(li,ws);function Dl(){Lo.call(this),this.status=1}V(Dl,Lo);function jn(c){this.g=c}V(jn,ea),jn.prototype.ua=function(){Lt(this.g,"a")},jn.prototype.ta=function(c){Lt(this.g,new li(c))},jn.prototype.sa=function(c){Lt(this.g,new Dl)},jn.prototype.ra=function(){Lt(this.g,"b")},Jr.prototype.createWebChannel=Jr.prototype.g,je.prototype.send=je.prototype.o,je.prototype.open=je.prototype.m,je.prototype.close=je.prototype.close,mv=function(){return new Jr},pv=function(){return Ts()},fv=Ci,Oh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Gr.NO_ERROR=0,Gr.TIMEOUT=8,Gr.HTTP_ERROR=6,cc=Gr,bs.COMPLETE="complete",dv=bs,ko.EventType=ir,ir.OPEN="a",ir.CLOSE="b",ir.ERROR="c",ir.MESSAGE="d",yt.prototype.listen=yt.prototype.K,fa=ko,we.prototype.listenOnce=we.prototype.L,we.prototype.getLastError=we.prototype.Ka,we.prototype.getLastErrorCode=we.prototype.Ba,we.prototype.getStatus=we.prototype.Z,we.prototype.getResponseJson=we.prototype.Oa,we.prototype.getResponseText=we.prototype.oa,we.prototype.send=we.prototype.ea,we.prototype.setWithCredentials=we.prototype.Ha,hv=we}).apply(typeof Ql<"u"?Ql:typeof self<"u"?self:typeof window<"u"?window:{});const sm="@firebase/firestore",om="4.7.10";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}tn.UNAUTHENTICATED=new tn(null),tn.GOOGLE_CREDENTIALS=new tn("google-credentials-uid"),tn.FIRST_PARTY=new tn("first-party-uid"),tn.MOCK_USER=new tn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Io="11.5.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ds=new Pd("@firebase/firestore");function Gs(){return ds.logLevel}function dt(e,...t){if(ds.logLevel<=Qt.DEBUG){const n=t.map(Cd);ds.debug(`Firestore (${Io}): ${e}`,...n)}}function Xi(e,...t){if(ds.logLevel<=Qt.ERROR){const n=t.map(Cd);ds.error(`Firestore (${Io}): ${e}`,...n)}}function fo(e,...t){if(ds.logLevel<=Qt.WARN){const n=t.map(Cd);ds.warn(`Firestore (${Io}): ${e}`,...n)}}function Cd(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(e="Unexpected state"){const t=`FIRESTORE (${Io}) INTERNAL ASSERTION FAILED: `+e;throw Xi(t),new Error(t)}function oe(e,t){e||xt()}function Mt(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pt extends Ai{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class x0{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(tn.UNAUTHENTICATED))}shutdown(){}}class k0{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class L0{constructor(t){this.t=t,this.currentUser=tn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){oe(this.o===void 0);let i=this.i;const s=d=>this.i!==i?(i=this.i,n(d)):Promise.resolve();let o=new Ki;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ki,t.enqueueRetryable(()=>s(this.currentUser))};const l=()=>{const d=o;t.enqueueRetryable(async()=>{await d.promise,await s(this.currentUser)})},h=d=>{dt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(d=>h(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?h(d):(dt("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ki)}},0),l()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(i=>this.i!==t?(dt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(oe(typeof i.accessToken=="string"),new _v(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return oe(t===null||typeof t=="string"),new tn(t)}}class O0{constructor(t,n,i){this.l=t,this.h=n,this.P=i,this.type="FirstParty",this.user=tn.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.T.set("Authorization",t),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class M0{constructor(t,n,i){this.l=t,this.h=n,this.P=i}getToken(){return Promise.resolve(new O0(this.l,this.h,this.P))}start(t,n){t.enqueueRetryable(()=>n(tn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class am{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class D0{constructor(t,n){this.A=n,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,wn(t)&&t.settings.appCheckToken&&(this.V=t.settings.appCheckToken)}start(t,n){oe(this.o===void 0);const i=o=>{o.error!=null&&dt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.R;return this.R=o.token,dt("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?n(o.token):Promise.resolve()};this.o=o=>{t.enqueueRetryable(()=>i(o))};const s=o=>{dt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>s(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?s(o):dt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new am(this.V));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(oe(typeof n.token=="string"),this.R=n.token,new am(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let i=0;i<e;i++)n[i]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gv(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=N0(40);for(let o=0;o<s.length;++o)i.length<20&&s[o]<n&&(i+=t.charAt(s[o]%62))}return i}}function Bt(e,t){return e<t?-1:e>t?1:0}function Mh(e,t){let n=0;for(;n<e.length&&n<t.length;){const i=e.codePointAt(n),s=t.codePointAt(n);if(i!==s){if(i<128&&s<128)return Bt(i,s);{const o=gv(),l=V0(o.encode(lm(e,n)),o.encode(lm(t,n)));return l!==0?l:Bt(i,s)}}n+=i>65535?2:1}return Bt(e.length,t.length)}function lm(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function V0(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return Bt(e[n],t[n]);return Bt(e.length,t.length)}function po(e,t,n){return e.length===t.length&&e.every((i,s)=>n(i,t[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cm=-62135596800,um=1e6;class Ue{static now(){return Ue.fromMillis(Date.now())}static fromDate(t){return Ue.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),i=Math.floor((t-1e3*n)*um);return new Ue(n,i)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new pt(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new pt(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<cm)throw new pt(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new pt(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/um}_compareTo(t){return this.seconds===t.seconds?Bt(this.nanoseconds,t.nanoseconds):Bt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds-cm;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{static fromTimestamp(t){return new Ot(t)}static min(){return new Ot(new Ue(0,0))}static max(){return new Ot(new Ue(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hm="__name__";class fi{constructor(t,n,i){n===void 0?n=0:n>t.length&&xt(),i===void 0?i=t.length-n:i>t.length-n&&xt(),this.segments=t,this.offset=n,this.len=i}get length(){return this.len}isEqual(t){return fi.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof fi?t.forEach(i=>{n.push(i)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,i=this.limit();n<i;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const i=Math.min(t.length,n.length);for(let s=0;s<i;s++){const o=fi.compareSegments(t.get(s),n.get(s));if(o!==0)return o}return Bt(t.length,n.length)}static compareSegments(t,n){const i=fi.isNumericId(t),s=fi.isNumericId(n);return i&&!s?-1:!i&&s?1:i&&s?fi.extractNumericId(t).compare(fi.extractNumericId(n)):Mh(t,n)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Ar.fromString(t.substring(4,t.length-2))}}class ve extends fi{construct(t,n,i){return new ve(t,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const i of t){if(i.indexOf("//")>=0)throw new pt(G.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter(s=>s.length>0))}return new ve(n)}static emptyPath(){return new ve([])}}const U0=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ze extends fi{construct(t,n,i){return new Ze(t,n,i)}static isValidIdentifier(t){return U0.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ze.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===hm}static keyField(){return new Ze([hm])}static fromServerFormat(t){const n=[];let i="",s=0;const o=()=>{if(i.length===0)throw new pt(G.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let l=!1;for(;s<t.length;){const h=t[s];if(h==="\\"){if(s+1===t.length)throw new pt(G.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const d=t[s+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new pt(G.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=d,s+=2}else h==="`"?(l=!l,s++):h!=="."||l?(i+=h,s++):(o(),s++)}if(o(),l)throw new pt(G.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ze(n)}static emptyPath(){return new Ze([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(t){this.path=t}static fromPath(t){return new Tt(ve.fromString(t))}static fromName(t){return new Tt(ve.fromString(t).popFirst(5))}static empty(){return new Tt(ve.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&ve.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return ve.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Tt(new ve(t.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ha=-1;function F0(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,s=Ot.fromTimestamp(i===1e9?new Ue(n+1,0):new Ue(n,i));return new Sr(s,Tt.empty(),t)}function B0(e){return new Sr(e.readTime,e.key,Ha)}class Sr{constructor(t,n,i){this.readTime=t,this.documentKey=n,this.largestBatchId=i}static min(){return new Sr(Ot.min(),Tt.empty(),Ha)}static max(){return new Sr(Ot.max(),Tt.empty(),Ha)}}function z0(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=Tt.comparator(e.documentKey,t.documentKey),n!==0?n:Bt(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class H0{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Po(e){if(e.code!==G.FAILED_PRECONDITION||e.message!==j0)throw e;dt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&xt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new Z((i,s)=>{this.nextCallback=o=>{this.wrapSuccess(t,o).next(i,s)},this.catchCallback=o=>{this.wrapFailure(n,o).next(i,s)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof Z?n:Z.resolve(n)}catch(n){return Z.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):Z.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):Z.reject(n)}static resolve(t){return new Z((n,i)=>{n(t)})}static reject(t){return new Z((n,i)=>{i(t)})}static waitFor(t){return new Z((n,i)=>{let s=0,o=0,l=!1;t.forEach(h=>{++s,h.next(()=>{++o,l&&o===s&&n()},d=>i(d))}),l=!0,o===s&&n()})}static or(t){let n=Z.resolve(!1);for(const i of t)n=n.next(s=>s?Z.resolve(s):i());return n}static forEach(t,n){const i=[];return t.forEach((s,o)=>{i.push(n.call(this,s,o))}),this.waitFor(i)}static mapArray(t,n){return new Z((i,s)=>{const o=t.length,l=new Array(o);let h=0;for(let d=0;d<o;d++){const p=d;n(t[p]).next(_=>{l[p]=_,++h,h===o&&i(l)},_=>s(_))}})}static doWhile(t,n){return new Z((i,s)=>{const o=()=>{t()===!0?n().next(()=>{o()},s):i()};o()})}}function q0(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ao(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.oe(i),this._e=i=>n.writeSequenceNumber(i))}oe(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this._e&&this._e(t),t}}cu.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sd=-1;function uu(e){return e==null}function Sc(e){return e===0&&1/e==-1/0}function W0(e){return typeof e=="number"&&Number.isInteger(e)&&!Sc(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yv="";function $0(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=dm(t)),t=G0(e.get(n),t);return dm(t)}function G0(e,t){let n=t;const i=e.length;for(let s=0;s<i;s++){const o=e.charAt(s);switch(o){case"\0":n+="";break;case yv:n+="";break;default:n+=o}}return n}function dm(e){return e+yv+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fm(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Ur(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function wv(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(t,n){this.comparator=t,this.root=n||Ke.EMPTY}insert(t,n){return new Ie(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Ke.BLACK,null,null))}remove(t){return new Ie(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ke.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(t){let n=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(t,i.key);if(s===0)return n+i.left.size;s<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,i)=>(t(n,i),!1))}toString(){const t=[];return this.inorderTraversal((n,i)=>(t.push(`${n}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Yl(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Yl(this.root,t,this.comparator,!1)}getReverseIterator(){return new Yl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Yl(this.root,t,this.comparator,!0)}}class Yl{constructor(t,n,i,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!t.isEmpty();)if(o=n?i(t.key,n):1,n&&s&&(o*=-1),o<0)t=this.isReverse?t.left:t.right;else{if(o===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Ke{constructor(t,n,i,s,o){this.key=t,this.value=n,this.color=i??Ke.RED,this.left=s??Ke.EMPTY,this.right=o??Ke.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,i,s,o){return new Ke(t??this.key,n??this.value,i??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,i){let s=this;const o=i(t,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(t,n,i),null):o===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(t,n,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ke.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let i,s=this;if(n(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(t,s.key)===0){if(s.right.isEmpty())return Ke.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Ke.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Ke.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw xt();const t=this.left.check();if(t!==this.right.check())throw xt();return t+(this.isRed()?0:1)}}Ke.EMPTY=null,Ke.RED=!0,Ke.BLACK=!1;Ke.EMPTY=new class{constructor(){this.size=0}get key(){throw xt()}get value(){throw xt()}get color(){throw xt()}get left(){throw xt()}get right(){throw xt()}copy(t,n,i,s,o){return this}insert(t,n,i){return new Ke(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(t){this.comparator=t,this.data=new Ie(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,i)=>(t(n),!1))}forEachInRange(t,n){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,t[1])>=0)return;n(s.key)}}forEachWhile(t,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new pm(this.data.getIterator())}getIteratorFrom(t){return new pm(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(i=>{n=n.add(i)}),n}isEqual(t){if(!(t instanceof Fe)||this.size!==t.size)return!1;const n=this.data.getIterator(),i=t.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,o=i.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new Fe(this.comparator);return n.data=t,n}}class pm{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(t){this.fields=t,t.sort(Ze.comparator)}static empty(){return new Mn([])}unionWith(t){let n=new Fe(Ze.comparator);for(const i of this.fields)n=n.add(i);for(const i of t)n=n.add(i);return new Mn(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return po(this.fields,t.fields,(n,i)=>n.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Tv("Invalid base64 string: "+o):o}}(t);return new Qe(n)}static fromUint8Array(t){const n=function(s){let o="";for(let l=0;l<s.length;++l)o+=String.fromCharCode(s[l]);return o}(t);return new Qe(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const i=new Uint8Array(n.length);for(let s=0;s<n.length;s++)i[s]=n.charCodeAt(s);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Bt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Qe.EMPTY_BYTE_STRING=new Qe("");const K0=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xr(e){if(oe(!!e),typeof e=="string"){let t=0;const n=K0.exec(e);if(oe(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),t=Number(s)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:xe(e.seconds),nanos:xe(e.nanos)}}function xe(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function kr(e){return typeof e=="string"?Qe.fromBase64String(e):Qe.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ev="server_timestamp",bv="__type__",Iv="__previous_value__",Pv="__local_write_time__";function xd(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[bv])===null||n===void 0?void 0:n.stringValue)===Ev}function hu(e){const t=e.mapValue.fields[Iv];return xd(t)?hu(t):t}function qa(e){const t=xr(e.mapValue.fields[Pv].timestampValue);return new Ue(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0{constructor(t,n,i,s,o,l,h,d,p){this.databaseId=t,this.appId=n,this.persistenceKey=i,this.host=s,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=h,this.longPollingOptions=d,this.useFetchStreams=p}}const xc="(default)";class Wa{constructor(t,n){this.projectId=t,this.database=n||xc}static empty(){return new Wa("","")}get isDefaultDatabase(){return this.database===xc}isEqual(t){return t instanceof Wa&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Av="__type__",Q0="__max__",Xl={mapValue:{}},Rv="__vector__",kc="value";function Lr(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?xd(e)?4:X0(e)?9007199254740991:Y0(e)?10:11:xt()}function Pi(e,t){if(e===t)return!0;const n=Lr(e);if(n!==Lr(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return qa(e).isEqual(qa(t));case 3:return function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const l=xr(s.timestampValue),h=xr(o.timestampValue);return l.seconds===h.seconds&&l.nanos===h.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(s,o){return kr(s.bytesValue).isEqual(kr(o.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(s,o){return xe(s.geoPointValue.latitude)===xe(o.geoPointValue.latitude)&&xe(s.geoPointValue.longitude)===xe(o.geoPointValue.longitude)}(e,t);case 2:return function(s,o){if("integerValue"in s&&"integerValue"in o)return xe(s.integerValue)===xe(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const l=xe(s.doubleValue),h=xe(o.doubleValue);return l===h?Sc(l)===Sc(h):isNaN(l)&&isNaN(h)}return!1}(e,t);case 9:return po(e.arrayValue.values||[],t.arrayValue.values||[],Pi);case 10:case 11:return function(s,o){const l=s.mapValue.fields||{},h=o.mapValue.fields||{};if(fm(l)!==fm(h))return!1;for(const d in l)if(l.hasOwnProperty(d)&&(h[d]===void 0||!Pi(l[d],h[d])))return!1;return!0}(e,t);default:return xt()}}function $a(e,t){return(e.values||[]).find(n=>Pi(n,t))!==void 0}function mo(e,t){if(e===t)return 0;const n=Lr(e),i=Lr(t);if(n!==i)return Bt(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Bt(e.booleanValue,t.booleanValue);case 2:return function(o,l){const h=xe(o.integerValue||o.doubleValue),d=xe(l.integerValue||l.doubleValue);return h<d?-1:h>d?1:h===d?0:isNaN(h)?isNaN(d)?0:-1:1}(e,t);case 3:return mm(e.timestampValue,t.timestampValue);case 4:return mm(qa(e),qa(t));case 5:return Mh(e.stringValue,t.stringValue);case 6:return function(o,l){const h=kr(o),d=kr(l);return h.compareTo(d)}(e.bytesValue,t.bytesValue);case 7:return function(o,l){const h=o.split("/"),d=l.split("/");for(let p=0;p<h.length&&p<d.length;p++){const _=Bt(h[p],d[p]);if(_!==0)return _}return Bt(h.length,d.length)}(e.referenceValue,t.referenceValue);case 8:return function(o,l){const h=Bt(xe(o.latitude),xe(l.latitude));return h!==0?h:Bt(xe(o.longitude),xe(l.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return _m(e.arrayValue,t.arrayValue);case 10:return function(o,l){var h,d,p,_;const v=o.fields||{},T=l.fields||{},b=(h=v[kc])===null||h===void 0?void 0:h.arrayValue,V=(d=T[kc])===null||d===void 0?void 0:d.arrayValue,B=Bt(((p=b==null?void 0:b.values)===null||p===void 0?void 0:p.length)||0,((_=V==null?void 0:V.values)===null||_===void 0?void 0:_.length)||0);return B!==0?B:_m(b,V)}(e.mapValue,t.mapValue);case 11:return function(o,l){if(o===Xl.mapValue&&l===Xl.mapValue)return 0;if(o===Xl.mapValue)return 1;if(l===Xl.mapValue)return-1;const h=o.fields||{},d=Object.keys(h),p=l.fields||{},_=Object.keys(p);d.sort(),_.sort();for(let v=0;v<d.length&&v<_.length;++v){const T=Mh(d[v],_[v]);if(T!==0)return T;const b=mo(h[d[v]],p[_[v]]);if(b!==0)return b}return Bt(d.length,_.length)}(e.mapValue,t.mapValue);default:throw xt()}}function mm(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return Bt(e,t);const n=xr(e),i=xr(t),s=Bt(n.seconds,i.seconds);return s!==0?s:Bt(n.nanos,i.nanos)}function _m(e,t){const n=e.values||[],i=t.values||[];for(let s=0;s<n.length&&s<i.length;++s){const o=mo(n[s],i[s]);if(o)return o}return Bt(n.length,i.length)}function _o(e){return Dh(e)}function Dh(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const i=xr(n);return`time(${i.seconds},${i.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return kr(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return Tt.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let i="[",s=!0;for(const o of n.values||[])s?s=!1:i+=",",i+=Dh(o);return i+"]"}(e.arrayValue):"mapValue"in e?function(n){const i=Object.keys(n.fields||{}).sort();let s="{",o=!0;for(const l of i)o?o=!1:s+=",",s+=`${l}:${Dh(n.fields[l])}`;return s+"}"}(e.mapValue):xt()}function uc(e){switch(Lr(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=hu(e);return t?16+uc(t):16;case 5:return 2*e.stringValue.length;case 6:return kr(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((s,o)=>s+uc(o),0)}(e.arrayValue);case 10:case 11:return function(i){let s=0;return Ur(i.fields,(o,l)=>{s+=o.length+uc(l)}),s}(e.mapValue);default:throw xt()}}function gm(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Nh(e){return!!e&&"integerValue"in e}function kd(e){return!!e&&"arrayValue"in e}function vm(e){return!!e&&"nullValue"in e}function ym(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function hc(e){return!!e&&"mapValue"in e}function Y0(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[Av])===null||n===void 0?void 0:n.stringValue)===Rv}function Ra(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Ur(e.mapValue.fields,(n,i)=>t.mapValue.fields[n]=Ra(i)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Ra(e.arrayValue.values[n]);return t}return Object.assign({},e)}function X0(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Q0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(t){this.value=t}static empty(){return new Tn({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let i=0;i<t.length-1;++i)if(n=(n.mapValue.fields||{})[t.get(i)],!hc(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ra(n)}setAll(t){let n=Ze.emptyPath(),i={},s=[];t.forEach((l,h)=>{if(!n.isImmediateParentOf(h)){const d=this.getFieldsMap(n);this.applyChanges(d,i,s),i={},s=[],n=h.popLast()}l?i[h.lastSegment()]=Ra(l):s.push(h.lastSegment())});const o=this.getFieldsMap(n);this.applyChanges(o,i,s)}delete(t){const n=this.field(t.popLast());hc(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return Pi(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<t.length;++i){let s=n.mapValue.fields[t.get(i)];hc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[t.get(i)]=s),n=s}return n.mapValue.fields}applyChanges(t,n,i){Ur(n,(s,o)=>t[s]=o);for(const s of i)delete t[s]}clone(){return new Tn(Ra(this.value))}}function Cv(e){const t=[];return Ur(e.fields,(n,i)=>{const s=new Ze([n]);if(hc(i)){const o=Cv(i.mapValue).fields;if(o.length===0)t.push(s);else for(const l of o)t.push(s.child(l))}else t.push(s)}),new Mn(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(t,n,i,s,o,l,h){this.key=t,this.documentType=n,this.version=i,this.readTime=s,this.createTime=o,this.data=l,this.documentState=h}static newInvalidDocument(t){return new rn(t,0,Ot.min(),Ot.min(),Ot.min(),Tn.empty(),0)}static newFoundDocument(t,n,i,s){return new rn(t,1,n,Ot.min(),i,s,0)}static newNoDocument(t,n){return new rn(t,2,n,Ot.min(),Ot.min(),Tn.empty(),0)}static newUnknownDocument(t,n){return new rn(t,3,n,Ot.min(),Ot.min(),Tn.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(Ot.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Tn.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Tn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ot.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof rn&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new rn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lc{constructor(t,n){this.position=t,this.inclusive=n}}function wm(e,t,n){let i=0;for(let s=0;s<e.position.length;s++){const o=t[s],l=e.position[s];if(o.field.isKeyField()?i=Tt.comparator(Tt.fromName(l.referenceValue),n.key):i=mo(l,n.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function Tm(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Pi(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ga{constructor(t,n="asc"){this.field=t,this.dir=n}}function J0(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{}class Ne extends Sv{constructor(t,n,i){super(),this.field=t,this.op=n,this.value=i}static create(t,n,i){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,i):new eA(t,n,i):n==="array-contains"?new rA(t,i):n==="in"?new sA(t,i):n==="not-in"?new oA(t,i):n==="array-contains-any"?new aA(t,i):new Ne(t,n,i)}static createKeyFieldInFilter(t,n,i){return n==="in"?new nA(t,i):new iA(t,i)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(mo(n,this.value)):n!==null&&Lr(this.value)===Lr(n)&&this.matchesComparison(mo(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return xt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class si extends Sv{constructor(t,n){super(),this.filters=t,this.op=n,this.ce=null}static create(t,n){return new si(t,n)}matches(t){return xv(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function xv(e){return e.op==="and"}function kv(e){return tA(e)&&xv(e)}function tA(e){for(const t of e.filters)if(t instanceof si)return!1;return!0}function Vh(e){if(e instanceof Ne)return e.field.canonicalString()+e.op.toString()+_o(e.value);if(kv(e))return e.filters.map(t=>Vh(t)).join(",");{const t=e.filters.map(n=>Vh(n)).join(",");return`${e.op}(${t})`}}function Lv(e,t){return e instanceof Ne?function(i,s){return s instanceof Ne&&i.op===s.op&&i.field.isEqual(s.field)&&Pi(i.value,s.value)}(e,t):e instanceof si?function(i,s){return s instanceof si&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce((o,l,h)=>o&&Lv(l,s.filters[h]),!0):!1}(e,t):void xt()}function Ov(e){return e instanceof Ne?function(n){return`${n.field.canonicalString()} ${n.op} ${_o(n.value)}`}(e):e instanceof si?function(n){return n.op.toString()+" {"+n.getFilters().map(Ov).join(" ,")+"}"}(e):"Filter"}class eA extends Ne{constructor(t,n,i){super(t,n,i),this.key=Tt.fromName(i.referenceValue)}matches(t){const n=Tt.comparator(t.key,this.key);return this.matchesComparison(n)}}class nA extends Ne{constructor(t,n){super(t,"in",n),this.keys=Mv("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class iA extends Ne{constructor(t,n){super(t,"not-in",n),this.keys=Mv("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function Mv(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(i=>Tt.fromName(i.referenceValue))}class rA extends Ne{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return kd(n)&&$a(n.arrayValue,this.value)}}class sA extends Ne{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&$a(this.value.arrayValue,n)}}class oA extends Ne{constructor(t,n){super(t,"not-in",n)}matches(t){if($a(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&!$a(this.value.arrayValue,n)}}class aA extends Ne{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!kd(n)||!n.arrayValue.values)&&n.arrayValue.values.some(i=>$a(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA{constructor(t,n=null,i=[],s=[],o=null,l=null,h=null){this.path=t,this.collectionGroup=n,this.orderBy=i,this.filters=s,this.limit=o,this.startAt=l,this.endAt=h,this.le=null}}function Em(e,t=null,n=[],i=[],s=null,o=null,l=null){return new lA(e,t,n,i,s,o,l)}function Ld(e){const t=Mt(e);if(t.le===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(i=>Vh(i)).join(","),n+="|ob:",n+=t.orderBy.map(i=>function(o){return o.field.canonicalString()+o.dir}(i)).join(","),uu(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>_o(i)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>_o(i)).join(",")),t.le=n}return t.le}function Od(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!J0(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Lv(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Tm(e.startAt,t.startAt)&&Tm(e.endAt,t.endAt)}function Uh(e){return Tt.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(t,n=null,i=[],s=[],o=null,l="F",h=null,d=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=s,this.limit=o,this.limitType=l,this.startAt=h,this.endAt=d,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function cA(e,t,n,i,s,o,l,h){return new Ro(e,t,n,i,s,o,l,h)}function du(e){return new Ro(e)}function bm(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function Dv(e){return e.collectionGroup!==null}function Ca(e){const t=Mt(e);if(t.he===null){t.he=[];const n=new Set;for(const o of t.explicitOrderBy)t.he.push(o),n.add(o.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(l){let h=new Fe(Ze.comparator);return l.filters.forEach(d=>{d.getFlattenedFilters().forEach(p=>{p.isInequality()&&(h=h.add(p.field))})}),h})(t).forEach(o=>{n.has(o.canonicalString())||o.isKeyField()||t.he.push(new Ga(o,i))}),n.has(Ze.keyField().canonicalString())||t.he.push(new Ga(Ze.keyField(),i))}return t.he}function wi(e){const t=Mt(e);return t.Pe||(t.Pe=uA(t,Ca(e))),t.Pe}function uA(e,t){if(e.limitType==="F")return Em(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(s=>{const o=s.dir==="desc"?"asc":"desc";return new Ga(s.field,o)});const n=e.endAt?new Lc(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Lc(e.startAt.position,e.startAt.inclusive):null;return Em(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}}function Fh(e,t){const n=e.filters.concat([t]);return new Ro(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Bh(e,t,n){return new Ro(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function fu(e,t){return Od(wi(e),wi(t))&&e.limitType===t.limitType}function Nv(e){return`${Ld(wi(e))}|lt:${e.limitType}`}function Ks(e){return`Query(target=${function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map(s=>Ov(s)).join(", ")}]`),uu(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map(s=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(s)).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map(s=>_o(s)).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map(s=>_o(s)).join(",")),`Target(${i})`}(wi(e))}; limitType=${e.limitType})`}function pu(e,t){return t.isFoundDocument()&&function(i,s){const o=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Tt.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)}(e,t)&&function(i,s){for(const o of Ca(i))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0}(e,t)&&function(i,s){for(const o of i.filters)if(!o.matches(s))return!1;return!0}(e,t)&&function(i,s){return!(i.startAt&&!function(l,h,d){const p=wm(l,h,d);return l.inclusive?p<=0:p<0}(i.startAt,Ca(i),s)||i.endAt&&!function(l,h,d){const p=wm(l,h,d);return l.inclusive?p>=0:p>0}(i.endAt,Ca(i),s))}(e,t)}function hA(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Vv(e){return(t,n)=>{let i=!1;for(const s of Ca(e)){const o=dA(s,t,n);if(o!==0)return o;i=i||s.field.isKeyField()}return 0}}function dA(e,t,n){const i=e.field.isKeyField()?Tt.comparator(t.key,n.key):function(o,l,h){const d=l.data.field(o),p=h.data.field(o);return d!==null&&p!==null?mo(d,p):xt()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return xt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i!==void 0){for(const[s,o]of i)if(this.equalsFn(s,t))return o}}has(t){return this.get(t)!==void 0}set(t,n){const i=this.mapKeyFn(t),s=this.inner[i];if(s===void 0)return this.inner[i]=[[t,n]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],t))return void(s[o]=[t,n]);s.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return i.length===1?delete this.inner[n]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(t){Ur(this.inner,(n,i)=>{for(const[s,o]of i)t(s,o)})}isEmpty(){return wv(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fA=new Ie(Tt.comparator);function Ji(){return fA}const Uv=new Ie(Tt.comparator);function pa(...e){let t=Uv;for(const n of e)t=t.insert(n.key,n);return t}function Fv(e){let t=Uv;return e.forEach((n,i)=>t=t.insert(n,i.overlayedDocument)),t}function rs(){return Sa()}function Bv(){return Sa()}function Sa(){return new vs(e=>e.toString(),(e,t)=>e.isEqual(t))}const pA=new Ie(Tt.comparator),mA=new Fe(Tt.comparator);function Yt(...e){let t=mA;for(const n of e)t=t.add(n);return t}const _A=new Fe(Bt);function gA(){return _A}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Md(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Sc(t)?"-0":t}}function zv(e){return{integerValue:""+e}}function vA(e,t){return W0(t)?zv(t):Md(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(){this._=void 0}}function yA(e,t,n){return e instanceof Oc?function(s,o){const l={fields:{[bv]:{stringValue:Ev},[Pv]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&xd(o)&&(o=hu(o)),o&&(l.fields[Iv]=o),{mapValue:l}}(n,t):e instanceof Ka?Hv(e,t):e instanceof Za?qv(e,t):function(s,o){const l=jv(s,o),h=Im(l)+Im(s.Ie);return Nh(l)&&Nh(s.Ie)?zv(h):Md(s.serializer,h)}(e,t)}function wA(e,t,n){return e instanceof Ka?Hv(e,t):e instanceof Za?qv(e,t):n}function jv(e,t){return e instanceof Mc?function(i){return Nh(i)||function(o){return!!o&&"doubleValue"in o}(i)}(t)?t:{integerValue:0}:null}class Oc extends mu{}class Ka extends mu{constructor(t){super(),this.elements=t}}function Hv(e,t){const n=Wv(t);for(const i of e.elements)n.some(s=>Pi(s,i))||n.push(i);return{arrayValue:{values:n}}}class Za extends mu{constructor(t){super(),this.elements=t}}function qv(e,t){let n=Wv(t);for(const i of e.elements)n=n.filter(s=>!Pi(s,i));return{arrayValue:{values:n}}}class Mc extends mu{constructor(t,n){super(),this.serializer=t,this.Ie=n}}function Im(e){return xe(e.integerValue||e.doubleValue)}function Wv(e){return kd(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function TA(e,t){return e.field.isEqual(t.field)&&function(i,s){return i instanceof Ka&&s instanceof Ka||i instanceof Za&&s instanceof Za?po(i.elements,s.elements,Pi):i instanceof Mc&&s instanceof Mc?Pi(i.Ie,s.Ie):i instanceof Oc&&s instanceof Oc}(e.transform,t.transform)}class EA{constructor(t,n){this.version=t,this.transformResults=n}}class $n{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new $n}static exists(t){return new $n(void 0,t)}static updateTime(t){return new $n(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function dc(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class _u{}function $v(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new Dd(e.key,$n.none()):new ol(e.key,e.data,$n.none());{const n=e.data,i=Tn.empty();let s=new Fe(Ze.comparator);for(let o of t.fields)if(!s.has(o)){let l=n.field(o);l===null&&o.length>1&&(o=o.popLast(),l=n.field(o)),l===null?i.delete(o):i.set(o,l),s=s.add(o)}return new Fr(e.key,i,new Mn(s.toArray()),$n.none())}}function bA(e,t,n){e instanceof ol?function(s,o,l){const h=s.value.clone(),d=Am(s.fieldTransforms,o,l.transformResults);h.setAll(d),o.convertToFoundDocument(l.version,h).setHasCommittedMutations()}(e,t,n):e instanceof Fr?function(s,o,l){if(!dc(s.precondition,o))return void o.convertToUnknownDocument(l.version);const h=Am(s.fieldTransforms,o,l.transformResults),d=o.data;d.setAll(Gv(s)),d.setAll(h),o.convertToFoundDocument(l.version,d).setHasCommittedMutations()}(e,t,n):function(s,o,l){o.convertToNoDocument(l.version).setHasCommittedMutations()}(0,t,n)}function xa(e,t,n,i){return e instanceof ol?function(o,l,h,d){if(!dc(o.precondition,l))return h;const p=o.value.clone(),_=Rm(o.fieldTransforms,d,l);return p.setAll(_),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),null}(e,t,n,i):e instanceof Fr?function(o,l,h,d){if(!dc(o.precondition,l))return h;const p=Rm(o.fieldTransforms,d,l),_=l.data;return _.setAll(Gv(o)),_.setAll(p),l.convertToFoundDocument(l.version,_).setHasLocalMutations(),h===null?null:h.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(v=>v.field))}(e,t,n,i):function(o,l,h){return dc(o.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):h}(e,t,n)}function IA(e,t){let n=null;for(const i of e.fieldTransforms){const s=t.data.field(i.field),o=jv(i.transform,s||null);o!=null&&(n===null&&(n=Tn.empty()),n.set(i.field,o))}return n||null}function Pm(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&po(i,s,(o,l)=>TA(o,l))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class ol extends _u{constructor(t,n,i,s=[]){super(),this.key=t,this.value=n,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Fr extends _u{constructor(t,n,i,s,o=[]){super(),this.key=t,this.data=n,this.fieldMask=i,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function Gv(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}}),t}function Am(e,t,n){const i=new Map;oe(e.length===n.length);for(let s=0;s<n.length;s++){const o=e[s],l=o.transform,h=t.data.field(o.field);i.set(o.field,wA(l,h,n[s]))}return i}function Rm(e,t,n){const i=new Map;for(const s of e){const o=s.transform,l=n.data.field(s.field);i.set(s.field,yA(o,l,t))}return i}class Dd extends _u{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class PA extends _u{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(t,n,i,s){this.batchId=t,this.localWriteTime=n,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(t,n){const i=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(t.key)&&bA(o,t,i[s])}}applyToLocalView(t,n){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(n=xa(i,t,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(n=xa(i,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const i=Bv();return this.mutations.forEach(s=>{const o=t.get(s.key),l=o.overlayedDocument;let h=this.applyToLocalView(l,o.mutatedFields);h=n.has(s.key)?null:h;const d=$v(l,h);d!==null&&i.set(s.key,d),l.isValidDocument()||l.convertToNoDocument(Ot.min())}),i}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),Yt())}isEqual(t){return this.batchId===t.batchId&&po(this.mutations,t.mutations,(n,i)=>Pm(n,i))&&po(this.baseMutations,t.baseMutations,(n,i)=>Pm(n,i))}}class Nd{constructor(t,n,i,s){this.batch=t,this.commitVersion=n,this.mutationResults=i,this.docVersions=s}static from(t,n,i){oe(t.mutations.length===i.length);let s=function(){return pA}();const o=t.mutations;for(let l=0;l<o.length;l++)s=s.insert(o[l].key,i[l].version);return new Nd(t,n,i,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var De,te;function SA(e){switch(e){case G.OK:return xt();case G.CANCELLED:case G.UNKNOWN:case G.DEADLINE_EXCEEDED:case G.RESOURCE_EXHAUSTED:case G.INTERNAL:case G.UNAVAILABLE:case G.UNAUTHENTICATED:return!1;case G.INVALID_ARGUMENT:case G.NOT_FOUND:case G.ALREADY_EXISTS:case G.PERMISSION_DENIED:case G.FAILED_PRECONDITION:case G.ABORTED:case G.OUT_OF_RANGE:case G.UNIMPLEMENTED:case G.DATA_LOSS:return!0;default:return xt()}}function Kv(e){if(e===void 0)return Xi("GRPC error has no .code"),G.UNKNOWN;switch(e){case De.OK:return G.OK;case De.CANCELLED:return G.CANCELLED;case De.UNKNOWN:return G.UNKNOWN;case De.DEADLINE_EXCEEDED:return G.DEADLINE_EXCEEDED;case De.RESOURCE_EXHAUSTED:return G.RESOURCE_EXHAUSTED;case De.INTERNAL:return G.INTERNAL;case De.UNAVAILABLE:return G.UNAVAILABLE;case De.UNAUTHENTICATED:return G.UNAUTHENTICATED;case De.INVALID_ARGUMENT:return G.INVALID_ARGUMENT;case De.NOT_FOUND:return G.NOT_FOUND;case De.ALREADY_EXISTS:return G.ALREADY_EXISTS;case De.PERMISSION_DENIED:return G.PERMISSION_DENIED;case De.FAILED_PRECONDITION:return G.FAILED_PRECONDITION;case De.ABORTED:return G.ABORTED;case De.OUT_OF_RANGE:return G.OUT_OF_RANGE;case De.UNIMPLEMENTED:return G.UNIMPLEMENTED;case De.DATA_LOSS:return G.DATA_LOSS;default:return xt()}}(te=De||(De={}))[te.OK=0]="OK",te[te.CANCELLED=1]="CANCELLED",te[te.UNKNOWN=2]="UNKNOWN",te[te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",te[te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",te[te.NOT_FOUND=5]="NOT_FOUND",te[te.ALREADY_EXISTS=6]="ALREADY_EXISTS",te[te.PERMISSION_DENIED=7]="PERMISSION_DENIED",te[te.UNAUTHENTICATED=16]="UNAUTHENTICATED",te[te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",te[te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",te[te.ABORTED=10]="ABORTED",te[te.OUT_OF_RANGE=11]="OUT_OF_RANGE",te[te.UNIMPLEMENTED=12]="UNIMPLEMENTED",te[te.INTERNAL=13]="INTERNAL",te[te.UNAVAILABLE=14]="UNAVAILABLE",te[te.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xA=new Ar([4294967295,4294967295],0);function Cm(e){const t=gv().encode(e),n=new uv;return n.update(t),new Uint8Array(n.digest())}function Sm(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),s=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new Ar([n,i],0),new Ar([s,o],0)]}class Vd{constructor(t,n,i){if(this.bitmap=t,this.padding=n,this.hashCount=i,n<0||n>=8)throw new ma(`Invalid padding: ${n}`);if(i<0)throw new ma(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new ma(`Invalid hash count: ${i}`);if(t.length===0&&n!==0)throw new ma(`Invalid padding when bitmap length is 0: ${n}`);this.Ee=8*t.length-n,this.de=Ar.fromNumber(this.Ee)}Ae(t,n,i){let s=t.add(n.multiply(Ar.fromNumber(i)));return s.compare(xA)===1&&(s=new Ar([s.getBits(0),s.getBits(1)],0)),s.modulo(this.de).toNumber()}Re(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.Ee===0)return!1;const n=Cm(t),[i,s]=Sm(n);for(let o=0;o<this.hashCount;o++){const l=this.Ae(i,s,o);if(!this.Re(l))return!1}return!0}static create(t,n,i){const s=t%8==0?0:8-t%8,o=new Uint8Array(Math.ceil(t/8)),l=new Vd(o,s,n);return i.forEach(h=>l.insert(h)),l}insert(t){if(this.Ee===0)return;const n=Cm(t),[i,s]=Sm(n);for(let o=0;o<this.hashCount;o++){const l=this.Ae(i,s,o);this.Ve(l)}}Ve(t){const n=Math.floor(t/8),i=t%8;this.bitmap[n]|=1<<i}}class ma extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(t,n,i,s,o){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(t,n,i){const s=new Map;return s.set(t,al.createSynthesizedTargetChangeForCurrentChange(t,n,i)),new gu(Ot.min(),s,new Ie(Bt),Ji(),Yt())}}class al{constructor(t,n,i,s,o){this.resumeToken=t,this.current=n,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(t,n,i){return new al(i,n,Yt(),Yt(),Yt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{constructor(t,n,i,s){this.me=t,this.removedTargetIds=n,this.key=i,this.fe=s}}class Zv{constructor(t,n){this.targetId=t,this.ge=n}}class Qv{constructor(t,n,i=Qe.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=n,this.resumeToken=i,this.cause=s}}class xm{constructor(){this.pe=0,this.ye=km(),this.we=Qe.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.be}Ce(t){t.approximateByteSize()>0&&(this.be=!0,this.we=t)}Fe(){let t=Yt(),n=Yt(),i=Yt();return this.ye.forEach((s,o)=>{switch(o){case 0:t=t.add(s);break;case 2:n=n.add(s);break;case 1:i=i.add(s);break;default:xt()}}),new al(this.we,this.Se,t,n,i)}Me(){this.be=!1,this.ye=km()}xe(t,n){this.be=!0,this.ye=this.ye.insert(t,n)}Oe(t){this.be=!0,this.ye=this.ye.remove(t)}Ne(){this.pe+=1}Be(){this.pe-=1,oe(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class kA{constructor(t){this.ke=t,this.qe=new Map,this.Qe=Ji(),this.$e=Jl(),this.Ue=Jl(),this.Ke=new Ie(Bt)}We(t){for(const n of t.me)t.fe&&t.fe.isFoundDocument()?this.Ge(n,t.fe):this.ze(n,t.key,t.fe);for(const n of t.removedTargetIds)this.ze(n,t.key,t.fe)}je(t){this.forEachTarget(t,n=>{const i=this.He(n);switch(t.state){case 0:this.Je(n)&&i.Ce(t.resumeToken);break;case 1:i.Be(),i.De||i.Me(),i.Ce(t.resumeToken);break;case 2:i.Be(),i.De||this.removeTarget(n);break;case 3:this.Je(n)&&(i.Le(),i.Ce(t.resumeToken));break;case 4:this.Je(n)&&(this.Ye(n),i.Ce(t.resumeToken));break;default:xt()}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.qe.forEach((i,s)=>{this.Je(s)&&n(s)})}Ze(t){const n=t.targetId,i=t.ge.count,s=this.Xe(n);if(s){const o=s.target;if(Uh(o))if(i===0){const l=new Tt(o.path);this.ze(n,l,rn.newNoDocument(l,Ot.min()))}else oe(i===1);else{const l=this.et(n);if(l!==i){const h=this.tt(t),d=h?this.nt(h,t,l):1;if(d!==0){this.Ye(n);const p=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,p)}}}}}tt(t){const n=t.ge.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:o=0}=n;let l,h;try{l=kr(i).toUint8Array()}catch(d){if(d instanceof Tv)return fo("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{h=new Vd(l,s,o)}catch(d){return fo(d instanceof ma?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return h.Ee===0?null:h}nt(t,n,i){return n.ge.count===i-this.st(t,n.targetId)?0:2}st(t,n){const i=this.ke.getRemoteKeysForTarget(n);let s=0;return i.forEach(o=>{const l=this.ke.it(),h=`projects/${l.projectId}/databases/${l.database}/documents/${o.path.canonicalString()}`;t.mightContain(h)||(this.ze(n,o,null),s++)}),s}ot(t){const n=new Map;this.qe.forEach((o,l)=>{const h=this.Xe(l);if(h){if(o.current&&Uh(h.target)){const d=new Tt(h.target.path);this._t(d).has(l)||this.ut(l,d)||this.ze(l,d,rn.newNoDocument(d,t))}o.ve&&(n.set(l,o.Fe()),o.Me())}});let i=Yt();this.Ue.forEach((o,l)=>{let h=!0;l.forEachWhile(d=>{const p=this.Xe(d);return!p||p.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)}),h&&(i=i.add(o))}),this.Qe.forEach((o,l)=>l.setReadTime(t));const s=new gu(t,n,this.Ke,this.Qe,i);return this.Qe=Ji(),this.$e=Jl(),this.Ue=Jl(),this.Ke=new Ie(Bt),s}Ge(t,n){if(!this.Je(t))return;const i=this.ut(t,n.key)?2:0;this.He(t).xe(n.key,i),this.Qe=this.Qe.insert(n.key,n),this.$e=this.$e.insert(n.key,this._t(n.key).add(t)),this.Ue=this.Ue.insert(n.key,this.ct(n.key).add(t))}ze(t,n,i){if(!this.Je(t))return;const s=this.He(t);this.ut(t,n)?s.xe(n,1):s.Oe(n),this.Ue=this.Ue.insert(n,this.ct(n).delete(t)),this.Ue=this.Ue.insert(n,this.ct(n).add(t)),i&&(this.Qe=this.Qe.insert(n,i))}removeTarget(t){this.qe.delete(t)}et(t){const n=this.He(t).Fe();return this.ke.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}Ne(t){this.He(t).Ne()}He(t){let n=this.qe.get(t);return n||(n=new xm,this.qe.set(t,n)),n}ct(t){let n=this.Ue.get(t);return n||(n=new Fe(Bt),this.Ue=this.Ue.insert(t,n)),n}_t(t){let n=this.$e.get(t);return n||(n=new Fe(Bt),this.$e=this.$e.insert(t,n)),n}Je(t){const n=this.Xe(t)!==null;return n||dt("WatchChangeAggregator","Detected inactive target",t),n}Xe(t){const n=this.qe.get(t);return n&&n.De?null:this.ke.lt(t)}Ye(t){this.qe.set(t,new xm),this.ke.getRemoteKeysForTarget(t).forEach(n=>{this.ze(t,n,null)})}ut(t,n){return this.ke.getRemoteKeysForTarget(t).has(n)}}function Jl(){return new Ie(Tt.comparator)}function km(){return new Ie(Tt.comparator)}const LA={asc:"ASCENDING",desc:"DESCENDING"},OA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},MA={and:"AND",or:"OR"};class DA{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function zh(e,t){return e.useProto3Json||uu(t)?t:{value:t}}function Dc(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Yv(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function NA(e,t){return Dc(e,t.toTimestamp())}function Ti(e){return oe(!!e),Ot.fromTimestamp(function(n){const i=xr(n);return new Ue(i.seconds,i.nanos)}(e))}function Ud(e,t){return jh(e,t).canonicalString()}function jh(e,t){const n=function(s){return new ve(["projects",s.projectId,"databases",s.database])}(e).child("documents");return t===void 0?n:n.child(t)}function Xv(e){const t=ve.fromString(e);return oe(iy(t)),t}function Hh(e,t){return Ud(e.databaseId,t.path)}function sh(e,t){const n=Xv(t);if(n.get(1)!==e.databaseId.projectId)throw new pt(G.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new pt(G.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Tt(ty(n))}function Jv(e,t){return Ud(e.databaseId,t)}function VA(e){const t=Xv(e);return t.length===4?ve.emptyPath():ty(t)}function qh(e){return new ve(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function ty(e){return oe(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function Lm(e,t,n){return{name:Hh(e,t),fields:n.value.mapValue.fields}}function UA(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:xt()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],o=function(p,_){return p.useProto3Json?(oe(_===void 0||typeof _=="string"),Qe.fromBase64String(_||"")):(oe(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array),Qe.fromUint8Array(_||new Uint8Array))}(e,t.targetChange.resumeToken),l=t.targetChange.cause,h=l&&function(p){const _=p.code===void 0?G.UNKNOWN:Kv(p.code);return new pt(_,p.message||"")}(l);n=new Qv(i,s,o,h||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const s=sh(e,i.document.name),o=Ti(i.document.updateTime),l=i.document.createTime?Ti(i.document.createTime):Ot.min(),h=new Tn({mapValue:{fields:i.document.fields}}),d=rn.newFoundDocument(s,o,l,h),p=i.targetIds||[],_=i.removedTargetIds||[];n=new fc(p,_,d.key,d)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const s=sh(e,i.document),o=i.readTime?Ti(i.readTime):Ot.min(),l=rn.newNoDocument(s,o),h=i.removedTargetIds||[];n=new fc([],h,l.key,l)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const s=sh(e,i.document),o=i.removedTargetIds||[];n=new fc([],o,s,null)}else{if(!("filter"in t))return xt();{t.filter;const i=t.filter;i.targetId;const{count:s=0,unchangedNames:o}=i,l=new CA(s,o),h=i.targetId;n=new Zv(h,l)}}return n}function FA(e,t){let n;if(t instanceof ol)n={update:Lm(e,t.key,t.value)};else if(t instanceof Dd)n={delete:Hh(e,t.key)};else if(t instanceof Fr)n={update:Lm(e,t.key,t.data),updateMask:KA(t.fieldMask)};else{if(!(t instanceof PA))return xt();n={verify:Hh(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(i=>function(o,l){const h=l.transform;if(h instanceof Oc)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Ka)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Za)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof Mc)return{fieldPath:l.field.canonicalString(),increment:h.Ie};throw xt()}(0,i))),t.precondition.isNone||(n.currentDocument=function(s,o){return o.updateTime!==void 0?{updateTime:NA(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:xt()}(e,t.precondition)),n}function BA(e,t){return e&&e.length>0?(oe(t!==void 0),e.map(n=>function(s,o){let l=s.updateTime?Ti(s.updateTime):Ti(o);return l.isEqual(Ot.min())&&(l=Ti(o)),new EA(l,s.transformResults||[])}(n,t))):[]}function zA(e,t){return{documents:[Jv(e,t.path)]}}function jA(e,t){const n={structuredQuery:{}},i=t.path;let s;t.collectionGroup!==null?(s=i,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=Jv(e,s);const o=function(p){if(p.length!==0)return ny(si.create(p,"and"))}(t.filters);o&&(n.structuredQuery.where=o);const l=function(p){if(p.length!==0)return p.map(_=>function(T){return{field:Zs(T.field),direction:WA(T.dir)}}(_))}(t.orderBy);l&&(n.structuredQuery.orderBy=l);const h=zh(e,t.limit);return h!==null&&(n.structuredQuery.limit=h),t.startAt&&(n.structuredQuery.startAt=function(p){return{before:p.inclusive,values:p.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(p){return{before:!p.inclusive,values:p.position}}(t.endAt)),{ht:n,parent:s}}function HA(e){let t=VA(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let s=null;if(i>0){oe(i===1);const _=n.from[0];_.allDescendants?s=_.collectionId:t=t.child(_.collectionId)}let o=[];n.where&&(o=function(v){const T=ey(v);return T instanceof si&&kv(T)?T.getFilters():[T]}(n.where));let l=[];n.orderBy&&(l=function(v){return v.map(T=>function(V){return new Ga(Qs(V.field),function(H){switch(H){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(V.direction))}(T))}(n.orderBy));let h=null;n.limit&&(h=function(v){let T;return T=typeof v=="object"?v.value:v,uu(T)?null:T}(n.limit));let d=null;n.startAt&&(d=function(v){const T=!!v.before,b=v.values||[];return new Lc(b,T)}(n.startAt));let p=null;return n.endAt&&(p=function(v){const T=!v.before,b=v.values||[];return new Lc(b,T)}(n.endAt)),cA(t,s,l,o,h,"F",d,p)}function qA(e,t){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return xt()}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function ey(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=Qs(n.unaryFilter.field);return Ne.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=Qs(n.unaryFilter.field);return Ne.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Qs(n.unaryFilter.field);return Ne.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Qs(n.unaryFilter.field);return Ne.create(l,"!=",{nullValue:"NULL_VALUE"});default:return xt()}}(e):e.fieldFilter!==void 0?function(n){return Ne.create(Qs(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return xt()}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return si.create(n.compositeFilter.filters.map(i=>ey(i)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return xt()}}(n.compositeFilter.op))}(e):xt()}function WA(e){return LA[e]}function $A(e){return OA[e]}function GA(e){return MA[e]}function Zs(e){return{fieldPath:e.canonicalString()}}function Qs(e){return Ze.fromServerFormat(e.fieldPath)}function ny(e){return e instanceof Ne?function(n){if(n.op==="=="){if(ym(n.value))return{unaryFilter:{field:Zs(n.field),op:"IS_NAN"}};if(vm(n.value))return{unaryFilter:{field:Zs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(ym(n.value))return{unaryFilter:{field:Zs(n.field),op:"IS_NOT_NAN"}};if(vm(n.value))return{unaryFilter:{field:Zs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zs(n.field),op:$A(n.op),value:n.value}}}(e):e instanceof si?function(n){const i=n.getFilters().map(s=>ny(s));return i.length===1?i[0]:{compositeFilter:{op:GA(n.op),filters:i}}}(e):xt()}function KA(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function iy(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(t,n,i,s,o=Ot.min(),l=Ot.min(),h=Qe.EMPTY_BYTE_STRING,d=null){this.target=t,this.targetId=n,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=h,this.expectedCount=d}withSequenceNumber(t){return new Er(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new Er(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Er(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Er(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{constructor(t){this.Tt=t}}function QA(e){const t=HA({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Bh(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YA{constructor(){this.Tn=new XA}addToCollectionParentIndex(t,n){return this.Tn.add(n),Z.resolve()}getCollectionParents(t,n){return Z.resolve(this.Tn.getEntries(n))}addFieldIndex(t,n){return Z.resolve()}deleteFieldIndex(t,n){return Z.resolve()}deleteAllFieldIndexes(t){return Z.resolve()}createTargetIndexes(t,n){return Z.resolve()}getDocumentsMatchingTarget(t,n){return Z.resolve(null)}getIndexType(t,n){return Z.resolve(0)}getFieldIndexes(t,n){return Z.resolve([])}getNextCollectionGroupToUpdate(t){return Z.resolve(null)}getMinOffset(t,n){return Z.resolve(Sr.min())}getMinOffsetFromCollectionGroup(t,n){return Z.resolve(Sr.min())}updateCollectionGroup(t,n,i){return Z.resolve()}updateIndexEntries(t,n){return Z.resolve()}}class XA{constructor(){this.index={}}add(t){const n=t.lastSegment(),i=t.popLast(),s=this.index[n]||new Fe(ve.comparator),o=!s.has(i);return this.index[n]=s.add(i),o}has(t){const n=t.lastSegment(),i=t.popLast(),s=this.index[n];return s&&s.has(i)}getEntries(t){return(this.index[t]||new Fe(ve.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Om={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ry=41943040;class yn{static withCacheSize(t){return new yn(t,yn.DEFAULT_COLLECTION_PERCENTILE,yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yn.DEFAULT_COLLECTION_PERCENTILE=10,yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,yn.DEFAULT=new yn(ry,yn.DEFAULT_COLLECTION_PERCENTILE,yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),yn.DISABLED=new yn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(t){this.$n=t}next(){return this.$n+=2,this.$n}static Un(){return new go(0)}static Kn(){return new go(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mm="LruGarbageCollector",JA=1048576;function Dm([e,t],[n,i]){const s=Bt(e,n);return s===0?Bt(t,i):s}class tR{constructor(t){this.Hn=t,this.buffer=new Fe(Dm),this.Jn=0}Yn(){return++this.Jn}Zn(t){const n=[t,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();Dm(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class eR{constructor(t,n,i){this.garbageCollector=t,this.asyncQueue=n,this.localStore=i,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(t){dt(Mm,`Garbage collection scheduled in ${t}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ao(n)?dt(Mm,"Ignoring IndexedDB error during garbage collection: ",n):await Po(n)}await this.er(3e5)})}}class nR{constructor(t,n){this.tr=t,this.params=n}calculateTargetCount(t,n){return this.tr.nr(t).next(i=>Math.floor(n/100*i))}nthSequenceNumber(t,n){if(n===0)return Z.resolve(cu.ae);const i=new tR(n);return this.tr.forEachTarget(t,s=>i.Zn(s.sequenceNumber)).next(()=>this.tr.rr(t,s=>i.Zn(s))).next(()=>i.maxValue)}removeTargets(t,n,i){return this.tr.removeTargets(t,n,i)}removeOrphanedDocuments(t,n){return this.tr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(dt("LruGarbageCollector","Garbage collection skipped; disabled"),Z.resolve(Om)):this.getCacheSize(t).next(i=>i<this.params.cacheSizeCollectionThreshold?(dt("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Om):this.ir(t,n))}getCacheSize(t){return this.tr.getCacheSize(t)}ir(t,n){let i,s,o,l,h,d,p;const _=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(dt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),s=this.params.maximumSequenceNumbersToCollect):s=v,l=Date.now(),this.nthSequenceNumber(t,s))).next(v=>(i=v,h=Date.now(),this.removeTargets(t,i,n))).next(v=>(o=v,d=Date.now(),this.removeOrphanedDocuments(t,i))).next(v=>(p=Date.now(),Gs()<=Qt.DEBUG&&dt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-_}ms
	Determined least recently used ${s} in `+(h-l)+`ms
	Removed ${o} targets in `+(d-h)+`ms
	Removed ${v} documents in `+(p-d)+`ms
Total Duration: ${p-_}ms`),Z.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:v})))}}function iR(e,t){return new nR(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rR{constructor(){this.changes=new vs(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,rn.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?Z.resolve(i):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oR{constructor(t,n,i,s){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=s}getDocument(t,n){let i=null;return this.documentOverlayCache.getOverlay(t,n).next(s=>(i=s,this.remoteDocumentCache.getEntry(t,n))).next(s=>(i!==null&&xa(i.mutation,s,Mn.empty(),Ue.now()),s))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.getLocalViewOfDocuments(t,i,Yt()).next(()=>i))}getLocalViewOfDocuments(t,n,i=Yt()){const s=rs();return this.populateOverlays(t,s,n).next(()=>this.computeViews(t,n,s,i).next(o=>{let l=pa();return o.forEach((h,d)=>{l=l.insert(h,d.overlayedDocument)}),l}))}getOverlayedDocuments(t,n){const i=rs();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,Yt()))}populateOverlays(t,n,i){const s=[];return i.forEach(o=>{n.has(o)||s.push(o)}),this.documentOverlayCache.getOverlays(t,s).next(o=>{o.forEach((l,h)=>{n.set(l,h)})})}computeViews(t,n,i,s){let o=Ji();const l=Sa(),h=function(){return Sa()}();return n.forEach((d,p)=>{const _=i.get(p.key);s.has(p.key)&&(_===void 0||_.mutation instanceof Fr)?o=o.insert(p.key,p):_!==void 0?(l.set(p.key,_.mutation.getFieldMask()),xa(_.mutation,p,_.mutation.getFieldMask(),Ue.now())):l.set(p.key,Mn.empty())}),this.recalculateAndSaveOverlays(t,o).next(d=>(d.forEach((p,_)=>l.set(p,_)),n.forEach((p,_)=>{var v;return h.set(p,new sR(_,(v=l.get(p))!==null&&v!==void 0?v:null))}),h))}recalculateAndSaveOverlays(t,n){const i=Sa();let s=new Ie((l,h)=>l-h),o=Yt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(l=>{for(const h of l)h.keys().forEach(d=>{const p=n.get(d);if(p===null)return;let _=i.get(d)||Mn.empty();_=h.applyToLocalView(p,_),i.set(d,_);const v=(s.get(h.batchId)||Yt()).add(d);s=s.insert(h.batchId,v)})}).next(()=>{const l=[],h=s.getReverseIterator();for(;h.hasNext();){const d=h.getNext(),p=d.key,_=d.value,v=Bv();_.forEach(T=>{if(!o.has(T)){const b=$v(n.get(T),i.get(T));b!==null&&v.set(T,b),o=o.add(T)}}),l.push(this.documentOverlayCache.saveOverlays(t,p,v))}return Z.waitFor(l)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,n,i,s){return function(l){return Tt.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):Dv(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,i,s):this.getDocumentsMatchingCollectionQuery(t,n,i,s)}getNextDocuments(t,n,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,i,s).next(o=>{const l=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,i.largestBatchId,s-o.size):Z.resolve(rs());let h=Ha,d=o;return l.next(p=>Z.forEach(p,(_,v)=>(h<v.largestBatchId&&(h=v.largestBatchId),o.get(_)?Z.resolve():this.remoteDocumentCache.getEntry(t,_).next(T=>{d=d.insert(_,T)}))).next(()=>this.populateOverlays(t,p,o)).next(()=>this.computeViews(t,d,p,Yt())).next(_=>({batchId:h,changes:Fv(_)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new Tt(n)).next(i=>{let s=pa();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s})}getDocumentsMatchingCollectionGroupQuery(t,n,i,s){const o=n.collectionGroup;let l=pa();return this.indexManager.getCollectionParents(t,o).next(h=>Z.forEach(h,d=>{const p=function(v,T){return new Ro(T,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(n,d.child(o));return this.getDocumentsMatchingCollectionQuery(t,p,i,s).next(_=>{_.forEach((v,T)=>{l=l.insert(v,T)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(t,n,i,s){let o;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,i.largestBatchId).next(l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,i,o,s))).next(l=>{o.forEach((d,p)=>{const _=p.getKey();l.get(_)===null&&(l=l.insert(_,rn.newInvalidDocument(_)))});let h=pa();return l.forEach((d,p)=>{const _=o.get(d);_!==void 0&&xa(_.mutation,p,Mn.empty(),Ue.now()),pu(n,p)&&(h=h.insert(d,p))}),h})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aR{constructor(t){this.serializer=t,this.dr=new Map,this.Ar=new Map}getBundleMetadata(t,n){return Z.resolve(this.dr.get(n))}saveBundleMetadata(t,n){return this.dr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Ti(s.createTime)}}(n)),Z.resolve()}getNamedQuery(t,n){return Z.resolve(this.Ar.get(n))}saveNamedQuery(t,n){return this.Ar.set(n.name,function(s){return{name:s.name,query:QA(s.bundledQuery),readTime:Ti(s.readTime)}}(n)),Z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lR{constructor(){this.overlays=new Ie(Tt.comparator),this.Rr=new Map}getOverlay(t,n){return Z.resolve(this.overlays.get(n))}getOverlays(t,n){const i=rs();return Z.forEach(n,s=>this.getOverlay(t,s).next(o=>{o!==null&&i.set(s,o)})).next(()=>i)}saveOverlays(t,n,i){return i.forEach((s,o)=>{this.Et(t,n,o)}),Z.resolve()}removeOverlaysForBatchId(t,n,i){const s=this.Rr.get(i);return s!==void 0&&(s.forEach(o=>this.overlays=this.overlays.remove(o)),this.Rr.delete(i)),Z.resolve()}getOverlaysForCollection(t,n,i){const s=rs(),o=n.length+1,l=new Tt(n.child("")),h=this.overlays.getIteratorFrom(l);for(;h.hasNext();){const d=h.getNext().value,p=d.getKey();if(!n.isPrefixOf(p.path))break;p.path.length===o&&d.largestBatchId>i&&s.set(d.getKey(),d)}return Z.resolve(s)}getOverlaysForCollectionGroup(t,n,i,s){let o=new Ie((p,_)=>p-_);const l=this.overlays.getIterator();for(;l.hasNext();){const p=l.getNext().value;if(p.getKey().getCollectionGroup()===n&&p.largestBatchId>i){let _=o.get(p.largestBatchId);_===null&&(_=rs(),o=o.insert(p.largestBatchId,_)),_.set(p.getKey(),p)}}const h=rs(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((p,_)=>h.set(p,_)),!(h.size()>=s)););return Z.resolve(h)}Et(t,n,i){const s=this.overlays.get(i.key);if(s!==null){const l=this.Rr.get(s.largestBatchId).delete(i.key);this.Rr.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(i.key,new RA(n,i));let o=this.Rr.get(n);o===void 0&&(o=Yt(),this.Rr.set(n,o)),this.Rr.set(n,o.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR{constructor(){this.sessionToken=Qe.EMPTY_BYTE_STRING}getSessionToken(t){return Z.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,Z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(){this.Vr=new Fe(qe.mr),this.gr=new Fe(qe.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(t,n){const i=new qe(t,n);this.Vr=this.Vr.add(i),this.gr=this.gr.add(i)}yr(t,n){t.forEach(i=>this.addReference(i,n))}removeReference(t,n){this.wr(new qe(t,n))}Sr(t,n){t.forEach(i=>this.removeReference(i,n))}br(t){const n=new Tt(new ve([])),i=new qe(n,t),s=new qe(n,t+1),o=[];return this.gr.forEachInRange([i,s],l=>{this.wr(l),o.push(l.key)}),o}Dr(){this.Vr.forEach(t=>this.wr(t))}wr(t){this.Vr=this.Vr.delete(t),this.gr=this.gr.delete(t)}vr(t){const n=new Tt(new ve([])),i=new qe(n,t),s=new qe(n,t+1);let o=Yt();return this.gr.forEachInRange([i,s],l=>{o=o.add(l.key)}),o}containsKey(t){const n=new qe(t,0),i=this.Vr.firstAfterOrEqual(n);return i!==null&&t.isEqual(i.key)}}class qe{constructor(t,n){this.key=t,this.Cr=n}static mr(t,n){return Tt.comparator(t.key,n.key)||Bt(t.Cr,n.Cr)}static pr(t,n){return Bt(t.Cr,n.Cr)||Tt.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uR{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.Fr=1,this.Mr=new Fe(qe.mr)}checkEmpty(t){return Z.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,i,s){const o=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new AA(o,n,i,s);this.mutationQueue.push(l);for(const h of s)this.Mr=this.Mr.add(new qe(h.key,o)),this.indexManager.addToCollectionParentIndex(t,h.key.path.popLast());return Z.resolve(l)}lookupMutationBatch(t,n){return Z.resolve(this.Or(n))}getNextMutationBatchAfterBatchId(t,n){const i=n+1,s=this.Nr(i),o=s<0?0:s;return Z.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return Z.resolve(this.mutationQueue.length===0?Sd:this.Fr-1)}getAllMutationBatches(t){return Z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const i=new qe(n,0),s=new qe(n,Number.POSITIVE_INFINITY),o=[];return this.Mr.forEachInRange([i,s],l=>{const h=this.Or(l.Cr);o.push(h)}),Z.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(t,n){let i=new Fe(Bt);return n.forEach(s=>{const o=new qe(s,0),l=new qe(s,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([o,l],h=>{i=i.add(h.Cr)})}),Z.resolve(this.Br(i))}getAllMutationBatchesAffectingQuery(t,n){const i=n.path,s=i.length+1;let o=i;Tt.isDocumentKey(o)||(o=o.child(""));const l=new qe(new Tt(o),0);let h=new Fe(Bt);return this.Mr.forEachWhile(d=>{const p=d.key.path;return!!i.isPrefixOf(p)&&(p.length===s&&(h=h.add(d.Cr)),!0)},l),Z.resolve(this.Br(h))}Br(t){const n=[];return t.forEach(i=>{const s=this.Or(i);s!==null&&n.push(s)}),n}removeMutationBatch(t,n){oe(this.Lr(n.batchId,"removed")===0),this.mutationQueue.shift();let i=this.Mr;return Z.forEach(n.mutations,s=>{const o=new qe(s.key,n.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.Mr=i})}qn(t){}containsKey(t,n){const i=new qe(n,0),s=this.Mr.firstAfterOrEqual(i);return Z.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,Z.resolve()}Lr(t,n){return this.Nr(t)}Nr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Or(t){const n=this.Nr(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{constructor(t){this.kr=t,this.docs=function(){return new Ie(Tt.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const i=n.key,s=this.docs.get(i),o=s?s.size:0,l=this.kr(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const i=this.docs.get(n);return Z.resolve(i?i.document.mutableCopy():rn.newInvalidDocument(n))}getEntries(t,n){let i=Ji();return n.forEach(s=>{const o=this.docs.get(s);i=i.insert(s,o?o.document.mutableCopy():rn.newInvalidDocument(s))}),Z.resolve(i)}getDocumentsMatchingQuery(t,n,i,s){let o=Ji();const l=n.path,h=new Tt(l.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(h);for(;d.hasNext();){const{key:p,value:{document:_}}=d.getNext();if(!l.isPrefixOf(p.path))break;p.path.length>l.length+1||z0(B0(_),i)<=0||(s.has(_.key)||pu(n,_))&&(o=o.insert(_.key,_.mutableCopy()))}return Z.resolve(o)}getAllFromCollectionGroup(t,n,i,s){xt()}qr(t,n){return Z.forEach(this.docs,i=>n(i))}newChangeBuffer(t){return new dR(this)}getSize(t){return Z.resolve(this.size)}}class dR extends rR{constructor(t){super(),this.Ir=t}applyChanges(t){const n=[];return this.changes.forEach((i,s)=>{s.isValidDocument()?n.push(this.Ir.addEntry(t,s)):this.Ir.removeEntry(i)}),Z.waitFor(n)}getFromCache(t,n){return this.Ir.getEntry(t,n)}getAllFromCache(t,n){return this.Ir.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fR{constructor(t){this.persistence=t,this.Qr=new vs(n=>Ld(n),Od),this.lastRemoteSnapshotVersion=Ot.min(),this.highestTargetId=0,this.$r=0,this.Ur=new Fd,this.targetCount=0,this.Kr=go.Un()}forEachTarget(t,n){return this.Qr.forEach((i,s)=>n(s)),Z.resolve()}getLastRemoteSnapshotVersion(t){return Z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Z.resolve(this.$r)}allocateTargetId(t){return this.highestTargetId=this.Kr.next(),Z.resolve(this.highestTargetId)}setTargetsMetadata(t,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.$r&&(this.$r=n),Z.resolve()}zn(t){this.Qr.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this.Kr=new go(n),this.highestTargetId=n),t.sequenceNumber>this.$r&&(this.$r=t.sequenceNumber)}addTargetData(t,n){return this.zn(n),this.targetCount+=1,Z.resolve()}updateTargetData(t,n){return this.zn(n),Z.resolve()}removeTargetData(t,n){return this.Qr.delete(n.target),this.Ur.br(n.targetId),this.targetCount-=1,Z.resolve()}removeTargets(t,n,i){let s=0;const o=[];return this.Qr.forEach((l,h)=>{h.sequenceNumber<=n&&i.get(h.targetId)===null&&(this.Qr.delete(l),o.push(this.removeMatchingKeysForTargetId(t,h.targetId)),s++)}),Z.waitFor(o).next(()=>s)}getTargetCount(t){return Z.resolve(this.targetCount)}getTargetData(t,n){const i=this.Qr.get(n)||null;return Z.resolve(i)}addMatchingKeys(t,n,i){return this.Ur.yr(n,i),Z.resolve()}removeMatchingKeys(t,n,i){this.Ur.Sr(n,i);const s=this.persistence.referenceDelegate,o=[];return s&&n.forEach(l=>{o.push(s.markPotentiallyOrphaned(t,l))}),Z.waitFor(o)}removeMatchingKeysForTargetId(t,n){return this.Ur.br(n),Z.resolve()}getMatchingKeysForTargetId(t,n){const i=this.Ur.vr(n);return Z.resolve(i)}containsKey(t,n){return Z.resolve(this.Ur.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{constructor(t,n){this.Wr={},this.overlays={},this.Gr=new cu(0),this.zr=!1,this.zr=!0,this.jr=new cR,this.referenceDelegate=t(this),this.Hr=new fR(this),this.indexManager=new YA,this.remoteDocumentCache=function(s){return new hR(s)}(i=>this.referenceDelegate.Jr(i)),this.serializer=new ZA(n),this.Yr=new aR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new lR,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let i=this.Wr[t.toKey()];return i||(i=new uR(n,this.referenceDelegate),this.Wr[t.toKey()]=i),i}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(t,n,i){dt("MemoryPersistence","Starting transaction:",t);const s=new pR(this.Gr.next());return this.referenceDelegate.Zr(),i(s).next(o=>this.referenceDelegate.Xr(s).next(()=>o)).toPromise().then(o=>(s.raiseOnCommittedEvent(),o))}ei(t,n){return Z.or(Object.values(this.Wr).map(i=>()=>i.containsKey(t,n)))}}class pR extends H0{constructor(t){super(),this.currentSequenceNumber=t}}class Bd{constructor(t){this.persistence=t,this.ti=new Fd,this.ni=null}static ri(t){return new Bd(t)}get ii(){if(this.ni)return this.ni;throw xt()}addReference(t,n,i){return this.ti.addReference(i,n),this.ii.delete(i.toString()),Z.resolve()}removeReference(t,n,i){return this.ti.removeReference(i,n),this.ii.add(i.toString()),Z.resolve()}markPotentiallyOrphaned(t,n){return this.ii.add(n.toString()),Z.resolve()}removeTarget(t,n){this.ti.br(n.targetId).forEach(s=>this.ii.add(s.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,n.targetId).next(s=>{s.forEach(o=>this.ii.add(o.toString()))}).next(()=>i.removeTargetData(t,n))}Zr(){this.ni=new Set}Xr(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Z.forEach(this.ii,i=>{const s=Tt.fromPath(i);return this.si(t,s).next(o=>{o||n.removeEntry(s,Ot.min())})}).next(()=>(this.ni=null,n.apply(t)))}updateLimboDocument(t,n){return this.si(t,n).next(i=>{i?this.ii.delete(n.toString()):this.ii.add(n.toString())})}Jr(t){return 0}si(t,n){return Z.or([()=>Z.resolve(this.ti.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.ei(t,n)])}}class Nc{constructor(t,n){this.persistence=t,this.oi=new vs(i=>$0(i.path),(i,s)=>i.isEqual(s)),this.garbageCollector=iR(this,n)}static ri(t,n){return new Nc(t,n)}Zr(){}Xr(t){return Z.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}nr(t){const n=this.sr(t);return this.persistence.getTargetCache().getTargetCount(t).next(i=>n.next(s=>i+s))}sr(t){let n=0;return this.rr(t,i=>{n++}).next(()=>n)}rr(t,n){return Z.forEach(this.oi,(i,s)=>this.ar(t,i,s).next(o=>o?Z.resolve():n(s)))}removeTargets(t,n,i){return this.persistence.getTargetCache().removeTargets(t,n,i)}removeOrphanedDocuments(t,n){let i=0;const s=this.persistence.getRemoteDocumentCache(),o=s.newChangeBuffer();return s.qr(t,l=>this.ar(t,l,n).next(h=>{h||(i++,o.removeEntry(l,Ot.min()))})).next(()=>o.apply(t)).next(()=>i)}markPotentiallyOrphaned(t,n){return this.oi.set(n,t.currentSequenceNumber),Z.resolve()}removeTarget(t,n){const i=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,i)}addReference(t,n,i){return this.oi.set(i,t.currentSequenceNumber),Z.resolve()}removeReference(t,n,i){return this.oi.set(i,t.currentSequenceNumber),Z.resolve()}updateLimboDocument(t,n){return this.oi.set(n,t.currentSequenceNumber),Z.resolve()}Jr(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=uc(t.data.value)),n}ar(t,n,i){return Z.or([()=>this.persistence.ei(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const s=this.oi.get(n);return Z.resolve(s!==void 0&&s>i)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(t,n,i,s){this.targetId=t,this.fromCache=n,this.Hi=i,this.Ji=s}static Yi(t,n){let i=Yt(),s=Yt();for(const o of n.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new zd(t,n.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return dP()?8:q0(cn())>0?6:4}()}initialize(t,n){this.ns=t,this.indexManager=n,this.Zi=!0}getDocumentsMatchingQuery(t,n,i,s){const o={result:null};return this.rs(t,n).next(l=>{o.result=l}).next(()=>{if(!o.result)return this.ss(t,n,s,i).next(l=>{o.result=l})}).next(()=>{if(o.result)return;const l=new mR;return this._s(t,n,l).next(h=>{if(o.result=h,this.Xi)return this.us(t,n,l,h.size)})}).next(()=>o.result)}us(t,n,i,s){return i.documentReadCount<this.es?(Gs()<=Qt.DEBUG&&dt("QueryEngine","SDK will not create cache indexes for query:",Ks(n),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),Z.resolve()):(Gs()<=Qt.DEBUG&&dt("QueryEngine","Query:",Ks(n),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.ts*s?(Gs()<=Qt.DEBUG&&dt("QueryEngine","The SDK decides to create cache indexes for query:",Ks(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,wi(n))):Z.resolve())}rs(t,n){if(bm(n))return Z.resolve(null);let i=wi(n);return this.indexManager.getIndexType(t,i).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Bh(n,null,"F"),i=wi(n)),this.indexManager.getDocumentsMatchingTarget(t,i).next(o=>{const l=Yt(...o);return this.ns.getDocuments(t,l).next(h=>this.indexManager.getMinOffset(t,i).next(d=>{const p=this.cs(n,h);return this.ls(n,p,l,d.readTime)?this.rs(t,Bh(n,null,"F")):this.hs(t,p,n,d)}))})))}ss(t,n,i,s){return bm(n)||s.isEqual(Ot.min())?Z.resolve(null):this.ns.getDocuments(t,i).next(o=>{const l=this.cs(n,o);return this.ls(n,l,i,s)?Z.resolve(null):(Gs()<=Qt.DEBUG&&dt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ks(n)),this.hs(t,l,n,F0(s,Ha)).next(h=>h))})}cs(t,n){let i=new Fe(Vv(t));return n.forEach((s,o)=>{pu(t,o)&&(i=i.add(o))}),i}ls(t,n,i,s){if(t.limit===null)return!1;if(i.size!==n.size)return!0;const o=t.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}_s(t,n,i){return Gs()<=Qt.DEBUG&&dt("QueryEngine","Using full collection scan to execute query:",Ks(n)),this.ns.getDocumentsMatchingQuery(t,n,Sr.min(),i)}hs(t,n,i,s){return this.ns.getDocumentsMatchingQuery(t,i,s).next(o=>(n.forEach(l=>{o=o.insert(l.key,l)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jd="LocalStore",gR=3e8;class vR{constructor(t,n,i,s){this.persistence=t,this.Ps=n,this.serializer=s,this.Ts=new Ie(Bt),this.Is=new vs(o=>Ld(o),Od),this.Es=new Map,this.ds=t.getRemoteDocumentCache(),this.Hr=t.getTargetCache(),this.Yr=t.getBundleCache(),this.As(i)}As(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new oR(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.Ts))}}function yR(e,t,n,i){return new vR(e,t,n,i)}async function oy(e,t){const n=Mt(e);return await n.persistence.runTransaction("Handle user change","readonly",i=>{let s;return n.mutationQueue.getAllMutationBatches(i).next(o=>(s=o,n.As(t),n.mutationQueue.getAllMutationBatches(i))).next(o=>{const l=[],h=[];let d=Yt();for(const p of s){l.push(p.batchId);for(const _ of p.mutations)d=d.add(_.key)}for(const p of o){h.push(p.batchId);for(const _ of p.mutations)d=d.add(_.key)}return n.localDocuments.getDocuments(i,d).next(p=>({Rs:p,removedBatchIds:l,addedBatchIds:h}))})})}function wR(e,t){const n=Mt(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const s=t.batch.keys(),o=n.ds.newChangeBuffer({trackRemovals:!0});return function(h,d,p,_){const v=p.batch,T=v.keys();let b=Z.resolve();return T.forEach(V=>{b=b.next(()=>_.getEntry(d,V)).next(B=>{const H=p.docVersions.get(V);oe(H!==null),B.version.compareTo(H)<0&&(v.applyToRemoteDocument(B,p),B.isValidDocument()&&(B.setReadTime(p.commitVersion),_.addEntry(B)))})}),b.next(()=>h.mutationQueue.removeMutationBatch(d,v))}(n,i,t,o).next(()=>o.apply(i)).next(()=>n.mutationQueue.performConsistencyCheck(i)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(i,s,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(h){let d=Yt();for(let p=0;p<h.mutationResults.length;++p)h.mutationResults[p].transformResults.length>0&&(d=d.add(h.batch.mutations[p].key));return d}(t))).next(()=>n.localDocuments.getDocuments(i,s))})}function ay(e){const t=Mt(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.Hr.getLastRemoteSnapshotVersion(n))}function TR(e,t){const n=Mt(e),i=t.snapshotVersion;let s=n.Ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const l=n.ds.newChangeBuffer({trackRemovals:!0});s=n.Ts;const h=[];t.targetChanges.forEach((_,v)=>{const T=s.get(v);if(!T)return;h.push(n.Hr.removeMatchingKeys(o,_.removedDocuments,v).next(()=>n.Hr.addMatchingKeys(o,_.addedDocuments,v)));let b=T.withSequenceNumber(o.currentSequenceNumber);t.targetMismatches.get(v)!==null?b=b.withResumeToken(Qe.EMPTY_BYTE_STRING,Ot.min()).withLastLimboFreeSnapshotVersion(Ot.min()):_.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(_.resumeToken,i)),s=s.insert(v,b),function(B,H,et){return B.resumeToken.approximateByteSize()===0||H.snapshotVersion.toMicroseconds()-B.snapshotVersion.toMicroseconds()>=gR?!0:et.addedDocuments.size+et.modifiedDocuments.size+et.removedDocuments.size>0}(T,b,_)&&h.push(n.Hr.updateTargetData(o,b))});let d=Ji(),p=Yt();if(t.documentUpdates.forEach(_=>{t.resolvedLimboDocuments.has(_)&&h.push(n.persistence.referenceDelegate.updateLimboDocument(o,_))}),h.push(ER(o,l,t.documentUpdates).next(_=>{d=_.Vs,p=_.fs})),!i.isEqual(Ot.min())){const _=n.Hr.getLastRemoteSnapshotVersion(o).next(v=>n.Hr.setTargetsMetadata(o,o.currentSequenceNumber,i));h.push(_)}return Z.waitFor(h).next(()=>l.apply(o)).next(()=>n.localDocuments.getLocalViewOfDocuments(o,d,p)).next(()=>d)}).then(o=>(n.Ts=s,o))}function ER(e,t,n){let i=Yt(),s=Yt();return n.forEach(o=>i=i.add(o)),t.getEntries(e,i).next(o=>{let l=Ji();return n.forEach((h,d)=>{const p=o.get(h);d.isFoundDocument()!==p.isFoundDocument()&&(s=s.add(h)),d.isNoDocument()&&d.version.isEqual(Ot.min())?(t.removeEntry(h,d.readTime),l=l.insert(h,d)):!p.isValidDocument()||d.version.compareTo(p.version)>0||d.version.compareTo(p.version)===0&&p.hasPendingWrites?(t.addEntry(d),l=l.insert(h,d)):dt(jd,"Ignoring outdated watch update for ",h,". Current version:",p.version," Watch version:",d.version)}),{Vs:l,fs:s}})}function bR(e,t){const n=Mt(e);return n.persistence.runTransaction("Get next mutation batch","readonly",i=>(t===void 0&&(t=Sd),n.mutationQueue.getNextMutationBatchAfterBatchId(i,t)))}function IR(e,t){const n=Mt(e);return n.persistence.runTransaction("Allocate target","readwrite",i=>{let s;return n.Hr.getTargetData(i,t).next(o=>o?(s=o,Z.resolve(s)):n.Hr.allocateTargetId(i).next(l=>(s=new Er(t,l,"TargetPurposeListen",i.currentSequenceNumber),n.Hr.addTargetData(i,s).next(()=>s))))}).then(i=>{const s=n.Ts.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ts=n.Ts.insert(i.targetId,i),n.Is.set(t,i.targetId)),i})}async function Wh(e,t,n){const i=Mt(e),s=i.Ts.get(t),o=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",o,l=>i.persistence.referenceDelegate.removeTarget(l,s))}catch(l){if(!Ao(l))throw l;dt(jd,`Failed to update sequence numbers for target ${t}: ${l}`)}i.Ts=i.Ts.remove(t),i.Is.delete(s.target)}function Nm(e,t,n){const i=Mt(e);let s=Ot.min(),o=Yt();return i.persistence.runTransaction("Execute query","readwrite",l=>function(d,p,_){const v=Mt(d),T=v.Is.get(_);return T!==void 0?Z.resolve(v.Ts.get(T)):v.Hr.getTargetData(p,_)}(i,l,wi(t)).next(h=>{if(h)return s=h.lastLimboFreeSnapshotVersion,i.Hr.getMatchingKeysForTargetId(l,h.targetId).next(d=>{o=d})}).next(()=>i.Ps.getDocumentsMatchingQuery(l,t,n?s:Ot.min(),n?o:Yt())).next(h=>(PR(i,hA(t),h),{documents:h,gs:o})))}function PR(e,t,n){let i=e.Es.get(t)||Ot.min();n.forEach((s,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)}),e.Es.set(t,i)}class Vm{constructor(){this.activeTargetIds=gA()}Ds(t){this.activeTargetIds=this.activeTargetIds.add(t)}vs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}bs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class AR{constructor(){this.ho=new Vm,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,i){}addLocalQueryTarget(t,n=!0){return n&&this.ho.Ds(t),this.Po[t]||"not-current"}updateQueryState(t,n,i){this.Po[t]=n}removeLocalQueryTarget(t){this.ho.vs(t)}isLocalQueryTarget(t){return this.ho.activeTargetIds.has(t)}clearQueryState(t){delete this.Po[t]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(t){return this.ho.activeTargetIds.has(t)}start(){return this.ho=new Vm,Promise.resolve()}handleUserChange(t,n,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RR{To(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Um="ConnectivityMonitor";class Fm{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(t){this.Vo.push(t)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){dt(Um,"Network connectivity changed: AVAILABLE");for(const t of this.Vo)t(0)}Ro(){dt(Um,"Network connectivity changed: UNAVAILABLE");for(const t of this.Vo)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tc=null;function $h(){return tc===null?tc=function(){return 268435456+Math.round(2147483648*Math.random())}():tc++,"0x"+tc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oh="RestConnection",CR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class SR{get fo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.po=n+"://"+t.host,this.yo=`projects/${i}/databases/${s}`,this.wo=this.databaseId.database===xc?`project_id=${i}`:`project_id=${i}&database_id=${s}`}So(t,n,i,s,o){const l=$h(),h=this.bo(t,n.toUriEncodedString());dt(oh,`Sending RPC '${t}' ${l}:`,h,i);const d={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(d,s,o),this.vo(t,h,d,i).then(p=>(dt(oh,`Received RPC '${t}' ${l}: `,p),p),p=>{throw fo(oh,`RPC '${t}' ${l} failed with error: `,p,"url: ",h,"request:",i),p})}Co(t,n,i,s,o,l){return this.So(t,n,i,s,o)}Do(t,n,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Io}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}bo(t,n){const i=CR[t];return`${this.po}/v1/${n}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR{constructor(t){this.Fo=t.Fo,this.Mo=t.Mo}xo(t){this.Oo=t}No(t){this.Bo=t}Lo(t){this.ko=t}onMessage(t){this.qo=t}close(){this.Mo()}send(t){this.Fo(t)}Qo(){this.Oo()}$o(){this.Bo()}Uo(t){this.ko(t)}Ko(t){this.qo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Je="WebChannelConnection";class kR extends SR{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}vo(t,n,i,s){const o=$h();return new Promise((l,h)=>{const d=new hv;d.setWithCredentials(!0),d.listenOnce(dv.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case cc.NO_ERROR:const _=d.getResponseJson();dt(Je,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(_)),l(_);break;case cc.TIMEOUT:dt(Je,`RPC '${t}' ${o} timed out`),h(new pt(G.DEADLINE_EXCEEDED,"Request time out"));break;case cc.HTTP_ERROR:const v=d.getStatus();if(dt(Je,`RPC '${t}' ${o} failed with status:`,v,"response text:",d.getResponseText()),v>0){let T=d.getResponseJson();Array.isArray(T)&&(T=T[0]);const b=T==null?void 0:T.error;if(b&&b.status&&b.message){const V=function(H){const et=H.toLowerCase().replace(/_/g,"-");return Object.values(G).indexOf(et)>=0?et:G.UNKNOWN}(b.status);h(new pt(V,b.message))}else h(new pt(G.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new pt(G.UNAVAILABLE,"Connection failed."));break;default:xt()}}finally{dt(Je,`RPC '${t}' ${o} completed.`)}});const p=JSON.stringify(s);dt(Je,`RPC '${t}' ${o} sending request:`,s),d.send(n,"POST",p,i,15)})}Wo(t,n,i){const s=$h(),o=[this.po,"/","google.firestore.v1.Firestore","/",t,"/channel"],l=mv(),h=pv(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(d.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Do(d.initMessageHeaders,n,i),d.encodeInitMessageHeaders=!0;const _=o.join("");dt(Je,`Creating RPC '${t}' stream ${s}: ${_}`,d);const v=l.createWebChannel(_,d);let T=!1,b=!1;const V=new xR({Fo:H=>{b?dt(Je,`Not sending because RPC '${t}' stream ${s} is closed:`,H):(T||(dt(Je,`Opening RPC '${t}' stream ${s} transport.`),v.open(),T=!0),dt(Je,`RPC '${t}' stream ${s} sending:`,H),v.send(H))},Mo:()=>v.close()}),B=(H,et,Y)=>{H.listen(et,Q=>{try{Y(Q)}catch(J){setTimeout(()=>{throw J},0)}})};return B(v,fa.EventType.OPEN,()=>{b||(dt(Je,`RPC '${t}' stream ${s} transport opened.`),V.Qo())}),B(v,fa.EventType.CLOSE,()=>{b||(b=!0,dt(Je,`RPC '${t}' stream ${s} transport closed`),V.Uo())}),B(v,fa.EventType.ERROR,H=>{b||(b=!0,fo(Je,`RPC '${t}' stream ${s} transport errored:`,H),V.Uo(new pt(G.UNAVAILABLE,"The operation could not be completed")))}),B(v,fa.EventType.MESSAGE,H=>{var et;if(!b){const Y=H.data[0];oe(!!Y);const Q=Y,J=(Q==null?void 0:Q.error)||((et=Q[0])===null||et===void 0?void 0:et.error);if(J){dt(Je,`RPC '${t}' stream ${s} received error:`,J);const Et=J.status;let Pt=function(S){const M=De[S];if(M!==void 0)return Kv(M)}(Et),O=J.message;Pt===void 0&&(Pt=G.INTERNAL,O="Unknown error status: "+Et+" with message "+J.message),b=!0,V.Uo(new pt(Pt,O)),v.close()}else dt(Je,`RPC '${t}' stream ${s} received:`,Y),V.Ko(Y)}}),B(h,fv.STAT_EVENT,H=>{H.stat===Oh.PROXY?dt(Je,`RPC '${t}' stream ${s} detected buffering proxy`):H.stat===Oh.NOPROXY&&dt(Je,`RPC '${t}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{V.$o()},0),V}}function ah(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vu(e){return new DA(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{constructor(t,n,i=1e3,s=1.5,o=6e4){this.Ti=t,this.timerId=n,this.Go=i,this.zo=s,this.jo=o,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(t){this.cancel();const n=Math.floor(this.Ho+this.e_()),i=Math.max(0,Date.now()-this.Yo),s=Math.max(0,n-i);s>0&&dt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ho} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,s,()=>(this.Yo=Date.now(),t())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bm="PersistentStream";class cy{constructor(t,n,i,s,o,l,h,d){this.Ti=t,this.n_=i,this.r_=s,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=h,this.listener=d,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new ly(t,n)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(t){this.E_(),this.stream.send(t)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(t,n){this.E_(),this.d_(),this.a_.cancel(),this.i_++,t!==4?this.a_.reset():n&&n.code===G.RESOURCE_EXHAUSTED?(Xi(n.toString()),Xi("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):n&&n.code===G.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Lo(n)}A_(){}auth(){this.state=1;const t=this.R_(this.i_),n=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,s])=>{this.i_===n&&this.V_(i,s)},i=>{t(()=>{const s=new pt(G.UNKNOWN,"Fetching auth token failed: "+i.message);return this.m_(s)})})}V_(t,n){const i=this.R_(this.i_);this.stream=this.f_(t,n),this.stream.xo(()=>{i(()=>this.listener.xo())}),this.stream.No(()=>{i(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(s=>{i(()=>this.m_(s))}),this.stream.onMessage(s=>{i(()=>++this.__==1?this.g_(s):this.onNext(s))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(t){return dt(Bm,`close with error: ${t}`),this.stream=null,this.close(4,t)}R_(t){return n=>{this.Ti.enqueueAndForget(()=>this.i_===t?n():(dt(Bm,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class LR extends cy{constructor(t,n,i,s,o,l){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,s,l),this.serializer=o}f_(t,n){return this.connection.Wo("Listen",t,n)}g_(t){return this.onNext(t)}onNext(t){this.a_.reset();const n=UA(this.serializer,t),i=function(o){if(!("targetChange"in o))return Ot.min();const l=o.targetChange;return l.targetIds&&l.targetIds.length?Ot.min():l.readTime?Ti(l.readTime):Ot.min()}(t);return this.listener.p_(n,i)}y_(t){const n={};n.database=qh(this.serializer),n.addTarget=function(o,l){let h;const d=l.target;if(h=Uh(d)?{documents:zA(o,d)}:{query:jA(o,d).ht},h.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){h.resumeToken=Yv(o,l.resumeToken);const p=zh(o,l.expectedCount);p!==null&&(h.expectedCount=p)}else if(l.snapshotVersion.compareTo(Ot.min())>0){h.readTime=Dc(o,l.snapshotVersion.toTimestamp());const p=zh(o,l.expectedCount);p!==null&&(h.expectedCount=p)}return h}(this.serializer,t);const i=qA(this.serializer,t);i&&(n.labels=i),this.I_(n)}w_(t){const n={};n.database=qh(this.serializer),n.removeTarget=t,this.I_(n)}}class OR extends cy{constructor(t,n,i,s,o,l){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,s,l),this.serializer=o}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(t,n){return this.connection.Wo("Write",t,n)}g_(t){return oe(!!t.streamToken),this.lastStreamToken=t.streamToken,oe(!t.writeResults||t.writeResults.length===0),this.listener.D_()}onNext(t){oe(!!t.streamToken),this.lastStreamToken=t.streamToken,this.a_.reset();const n=BA(t.writeResults,t.commitTime),i=Ti(t.commitTime);return this.listener.v_(i,n)}C_(){const t={};t.database=qh(this.serializer),this.I_(t)}b_(t){const n={streamToken:this.lastStreamToken,writes:t.map(i=>FA(this.serializer,i))};this.I_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MR{}class DR extends MR{constructor(t,n,i,s){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=i,this.serializer=s,this.F_=!1}M_(){if(this.F_)throw new pt(G.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,n,i,s){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.So(t,jh(n,i),s,o,l)).catch(o=>{throw o.name==="FirebaseError"?(o.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new pt(G.UNKNOWN,o.toString())})}Co(t,n,i,s,o){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,h])=>this.connection.Co(t,jh(n,i),s,l,h,o)).catch(l=>{throw l.name==="FirebaseError"?(l.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new pt(G.UNKNOWN,l.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class NR{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(t){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.L_("Offline")))}set(t){this.Q_(),this.x_=0,t==="Online"&&(this.N_=!1),this.L_(t)}L_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}k_(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(Xi(n),this.N_=!1):dt("OnlineStateTracker",n)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fs="RemoteStore";class VR{constructor(t,n,i,s,o){this.localStore=t,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=o,this.z_.To(l=>{i.enqueueAndForget(async()=>{ys(this)&&(dt(fs,"Restarting streams for network reachability change."),await async function(d){const p=Mt(d);p.W_.add(4),await ll(p),p.j_.set("Unknown"),p.W_.delete(4),await yu(p)}(this))})}),this.j_=new NR(i,s)}}async function yu(e){if(ys(e))for(const t of e.G_)await t(!0)}async function ll(e){for(const t of e.G_)await t(!1)}function uy(e,t){const n=Mt(e);n.K_.has(t.targetId)||(n.K_.set(t.targetId,t),$d(n)?Wd(n):Co(n).c_()&&qd(n,t))}function Hd(e,t){const n=Mt(e),i=Co(n);n.K_.delete(t),i.c_()&&hy(n,t),n.K_.size===0&&(i.c_()?i.P_():ys(n)&&n.j_.set("Unknown"))}function qd(e,t){if(e.H_.Ne(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ot.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Co(e).y_(t)}function hy(e,t){e.H_.Ne(t),Co(e).w_(t)}function Wd(e){e.H_=new kA({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),lt:t=>e.K_.get(t)||null,it:()=>e.datastore.serializer.databaseId}),Co(e).start(),e.j_.B_()}function $d(e){return ys(e)&&!Co(e).u_()&&e.K_.size>0}function ys(e){return Mt(e).W_.size===0}function dy(e){e.H_=void 0}async function UR(e){e.j_.set("Online")}async function FR(e){e.K_.forEach((t,n)=>{qd(e,t)})}async function BR(e,t){dy(e),$d(e)?(e.j_.q_(t),Wd(e)):e.j_.set("Unknown")}async function zR(e,t,n){if(e.j_.set("Online"),t instanceof Qv&&t.state===2&&t.cause)try{await async function(s,o){const l=o.cause;for(const h of o.targetIds)s.K_.has(h)&&(await s.remoteSyncer.rejectListen(h,l),s.K_.delete(h),s.H_.removeTarget(h))}(e,t)}catch(i){dt(fs,"Failed to remove targets %s: %s ",t.targetIds.join(","),i),await Vc(e,i)}else if(t instanceof fc?e.H_.We(t):t instanceof Zv?e.H_.Ze(t):e.H_.je(t),!n.isEqual(Ot.min()))try{const i=await ay(e.localStore);n.compareTo(i)>=0&&await function(o,l){const h=o.H_.ot(l);return h.targetChanges.forEach((d,p)=>{if(d.resumeToken.approximateByteSize()>0){const _=o.K_.get(p);_&&o.K_.set(p,_.withResumeToken(d.resumeToken,l))}}),h.targetMismatches.forEach((d,p)=>{const _=o.K_.get(d);if(!_)return;o.K_.set(d,_.withResumeToken(Qe.EMPTY_BYTE_STRING,_.snapshotVersion)),hy(o,d);const v=new Er(_.target,d,p,_.sequenceNumber);qd(o,v)}),o.remoteSyncer.applyRemoteEvent(h)}(e,n)}catch(i){dt(fs,"Failed to raise snapshot:",i),await Vc(e,i)}}async function Vc(e,t,n){if(!Ao(t))throw t;e.W_.add(1),await ll(e),e.j_.set("Offline"),n||(n=()=>ay(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{dt(fs,"Retrying IndexedDB access"),await n(),e.W_.delete(1),await yu(e)})}function fy(e,t){return t().catch(n=>Vc(e,n,t))}async function wu(e){const t=Mt(e),n=Or(t);let i=t.U_.length>0?t.U_[t.U_.length-1].batchId:Sd;for(;jR(t);)try{const s=await bR(t.localStore,i);if(s===null){t.U_.length===0&&n.P_();break}i=s.batchId,HR(t,s)}catch(s){await Vc(t,s)}py(t)&&my(t)}function jR(e){return ys(e)&&e.U_.length<10}function HR(e,t){e.U_.push(t);const n=Or(e);n.c_()&&n.S_&&n.b_(t.mutations)}function py(e){return ys(e)&&!Or(e).u_()&&e.U_.length>0}function my(e){Or(e).start()}async function qR(e){Or(e).C_()}async function WR(e){const t=Or(e);for(const n of e.U_)t.b_(n.mutations)}async function $R(e,t,n){const i=e.U_.shift(),s=Nd.from(i,t,n);await fy(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await wu(e)}async function GR(e,t){t&&Or(e).S_&&await async function(i,s){if(function(l){return SA(l)&&l!==G.ABORTED}(s.code)){const o=i.U_.shift();Or(i).h_(),await fy(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),await wu(i)}}(e,t),py(e)&&my(e)}async function zm(e,t){const n=Mt(e);n.asyncQueue.verifyOperationInProgress(),dt(fs,"RemoteStore received new credentials");const i=ys(n);n.W_.add(3),await ll(n),i&&n.j_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.W_.delete(3),await yu(n)}async function KR(e,t){const n=Mt(e);t?(n.W_.delete(2),await yu(n)):t||(n.W_.add(2),await ll(n),n.j_.set("Unknown"))}function Co(e){return e.J_||(e.J_=function(n,i,s){const o=Mt(n);return o.M_(),new LR(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(e.datastore,e.asyncQueue,{xo:UR.bind(null,e),No:FR.bind(null,e),Lo:BR.bind(null,e),p_:zR.bind(null,e)}),e.G_.push(async t=>{t?(e.J_.h_(),$d(e)?Wd(e):e.j_.set("Unknown")):(await e.J_.stop(),dy(e))})),e.J_}function Or(e){return e.Y_||(e.Y_=function(n,i,s){const o=Mt(n);return o.M_(),new OR(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(e.datastore,e.asyncQueue,{xo:()=>Promise.resolve(),No:qR.bind(null,e),Lo:GR.bind(null,e),D_:WR.bind(null,e),v_:$R.bind(null,e)}),e.G_.push(async t=>{t?(e.Y_.h_(),await wu(e)):(await e.Y_.stop(),e.U_.length>0&&(dt(fs,`Stopping write stream with ${e.U_.length} pending writes`),e.U_=[]))})),e.Y_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(t,n,i,s,o){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=i,this.op=s,this.removalCallback=o,this.deferred=new Ki,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,i,s,o){const l=Date.now()+i,h=new Gd(t,n,l,s,o);return h.start(i),h}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new pt(G.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Kd(e,t){if(Xi("AsyncQueue",`${t}: ${e}`),Ao(e))return new pt(G.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{static emptySet(t){return new ro(t.comparator)}constructor(t){this.comparator=t?(n,i)=>t(n,i)||Tt.comparator(n.key,i.key):(n,i)=>Tt.comparator(n.key,i.key),this.keyedMap=pa(),this.sortedSet=new Ie(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,i)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof ro)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,o=i.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const i=new ro;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=n,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(){this.Z_=new Ie(Tt.comparator)}track(t){const n=t.doc.key,i=this.Z_.get(n);i?t.type!==0&&i.type===3?this.Z_=this.Z_.insert(n,t):t.type===3&&i.type!==1?this.Z_=this.Z_.insert(n,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.Z_=this.Z_.insert(n,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.Z_=this.Z_.insert(n,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.Z_=this.Z_.remove(n):t.type===1&&i.type===2?this.Z_=this.Z_.insert(n,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.Z_=this.Z_.insert(n,{type:2,doc:t.doc}):xt():this.Z_=this.Z_.insert(n,t)}X_(){const t=[];return this.Z_.inorderTraversal((n,i)=>{t.push(i)}),t}}class vo{constructor(t,n,i,s,o,l,h,d,p){this.query=t,this.docs=n,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=o,this.fromCache=l,this.syncStateChanged=h,this.excludesMetadataChanges=d,this.hasCachedResults=p}static fromInitialDocuments(t,n,i,s,o){const l=[];return n.forEach(h=>{l.push({type:0,doc:h})}),new vo(t,n,ro.emptySet(n),l,i,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&fu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,i=t.docChanges;if(n.length!==i.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==i[s].type||!n[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(t=>t.ra())}}class QR{constructor(){this.queries=Hm(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(n,i){const s=Mt(n),o=s.queries;s.queries=Hm(),o.forEach((l,h)=>{for(const d of h.ta)d.onError(i)})})(this,new pt(G.ABORTED,"Firestore shutting down"))}}function Hm(){return new vs(e=>Nv(e),fu)}async function Zd(e,t){const n=Mt(e);let i=3;const s=t.query;let o=n.queries.get(s);o?!o.na()&&t.ra()&&(i=2):(o=new ZR,i=t.ra()?0:1);try{switch(i){case 0:o.ea=await n.onListen(s,!0);break;case 1:o.ea=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(l){const h=Kd(l,`Initialization of query '${Ks(t.query)}' failed`);return void t.onError(h)}n.queries.set(s,o),o.ta.push(t),t.sa(n.onlineState),o.ea&&t.oa(o.ea)&&Yd(n)}async function Qd(e,t){const n=Mt(e),i=t.query;let s=3;const o=n.queries.get(i);if(o){const l=o.ta.indexOf(t);l>=0&&(o.ta.splice(l,1),o.ta.length===0?s=t.ra()?0:1:!o.na()&&t.ra()&&(s=2))}switch(s){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function YR(e,t){const n=Mt(e);let i=!1;for(const s of t){const o=s.query,l=n.queries.get(o);if(l){for(const h of l.ta)h.oa(s)&&(i=!0);l.ea=s}}i&&Yd(n)}function XR(e,t,n){const i=Mt(e),s=i.queries.get(t);if(s)for(const o of s.ta)o.onError(n);i.queries.delete(t)}function Yd(e){e.ia.forEach(t=>{t.next()})}var Gh,qm;(qm=Gh||(Gh={}))._a="default",qm.Cache="cache";class Xd{constructor(t,n,i){this.query=t,this.aa=n,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=i||{}}oa(t){if(!this.options.includeMetadataChanges){const i=[];for(const s of t.docChanges)s.type!==3&&i.push(s);t=new vo(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.ua?this.la(t)&&(this.aa.next(t),n=!0):this.ha(t,this.onlineState)&&(this.Pa(t),n=!0),this.ca=t,n}onError(t){this.aa.error(t)}sa(t){this.onlineState=t;let n=!1;return this.ca&&!this.ua&&this.ha(this.ca,t)&&(this.Pa(this.ca),n=!0),n}ha(t,n){if(!t.fromCache||!this.ra())return!0;const i=n!=="Offline";return(!this.options.Ta||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}la(t){if(t.docChanges.length>0)return!0;const n=this.ca&&this.ca.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Pa(t){t=vo.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.ua=!0,this.aa.next(t)}ra(){return this.options.source!==Gh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(t){this.key=t}}class gy{constructor(t){this.key=t}}class JR{constructor(t,n){this.query=t,this.fa=n,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=Yt(),this.mutatedKeys=Yt(),this.ya=Vv(t),this.wa=new ro(this.ya)}get Sa(){return this.fa}ba(t,n){const i=n?n.Da:new jm,s=n?n.wa:this.wa;let o=n?n.mutatedKeys:this.mutatedKeys,l=s,h=!1;const d=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,p=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((_,v)=>{const T=s.get(_),b=pu(this.query,v)?v:null,V=!!T&&this.mutatedKeys.has(T.key),B=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let H=!1;T&&b?T.data.isEqual(b.data)?V!==B&&(i.track({type:3,doc:b}),H=!0):this.va(T,b)||(i.track({type:2,doc:b}),H=!0,(d&&this.ya(b,d)>0||p&&this.ya(b,p)<0)&&(h=!0)):!T&&b?(i.track({type:0,doc:b}),H=!0):T&&!b&&(i.track({type:1,doc:T}),H=!0,(d||p)&&(h=!0)),H&&(b?(l=l.add(b),o=B?o.add(_):o.delete(_)):(l=l.delete(_),o=o.delete(_)))}),this.query.limit!==null)for(;l.size>this.query.limit;){const _=this.query.limitType==="F"?l.last():l.first();l=l.delete(_.key),o=o.delete(_.key),i.track({type:1,doc:_})}return{wa:l,Da:i,ls:h,mutatedKeys:o}}va(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,i,s){const o=this.wa;this.wa=t.wa,this.mutatedKeys=t.mutatedKeys;const l=t.Da.X_();l.sort((_,v)=>function(b,V){const B=H=>{switch(H){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xt()}};return B(b)-B(V)}(_.type,v.type)||this.ya(_.doc,v.doc)),this.Ca(i),s=s!=null&&s;const h=n&&!s?this.Fa():[],d=this.pa.size===0&&this.current&&!s?1:0,p=d!==this.ga;return this.ga=d,l.length!==0||p?{snapshot:new vo(this.query,t.wa,o,l,t.mutatedKeys,d===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),Ma:h}:{Ma:h}}sa(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new jm,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(t){return!this.fa.has(t)&&!!this.wa.has(t)&&!this.wa.get(t).hasLocalMutations}Ca(t){t&&(t.addedDocuments.forEach(n=>this.fa=this.fa.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.fa=this.fa.delete(n)),this.current=t.current)}Fa(){if(!this.current)return[];const t=this.pa;this.pa=Yt(),this.wa.forEach(i=>{this.xa(i.key)&&(this.pa=this.pa.add(i.key))});const n=[];return t.forEach(i=>{this.pa.has(i)||n.push(new gy(i))}),this.pa.forEach(i=>{t.has(i)||n.push(new _y(i))}),n}Oa(t){this.fa=t.gs,this.pa=Yt();const n=this.ba(t.documents);return this.applyChanges(n,!0)}Na(){return vo.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const Jd="SyncEngine";class tC{constructor(t,n,i){this.query=t,this.targetId=n,this.view=i}}class eC{constructor(t){this.key=t,this.Ba=!1}}class nC{constructor(t,n,i,s,o,l){this.localStore=t,this.remoteStore=n,this.eventManager=i,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.La={},this.ka=new vs(h=>Nv(h),fu),this.qa=new Map,this.Qa=new Set,this.$a=new Ie(Tt.comparator),this.Ua=new Map,this.Ka=new Fd,this.Wa={},this.Ga=new Map,this.za=go.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function iC(e,t,n=!0){const i=by(e);let s;const o=i.ka.get(t);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.Na()):s=await vy(i,t,n,!0),s}async function rC(e,t){const n=by(e);await vy(n,t,!0,!1)}async function vy(e,t,n,i){const s=await IR(e.localStore,wi(t)),o=s.targetId,l=e.sharedClientState.addLocalQueryTarget(o,n);let h;return i&&(h=await sC(e,t,o,l==="current",s.resumeToken)),e.isPrimaryClient&&n&&uy(e.remoteStore,s),h}async function sC(e,t,n,i,s){e.Ha=(v,T,b)=>async function(B,H,et,Y){let Q=H.view.ba(et);Q.ls&&(Q=await Nm(B.localStore,H.query,!1).then(({documents:O})=>H.view.ba(O,Q)));const J=Y&&Y.targetChanges.get(H.targetId),Et=Y&&Y.targetMismatches.get(H.targetId)!=null,Pt=H.view.applyChanges(Q,B.isPrimaryClient,J,Et);return $m(B,H.targetId,Pt.Ma),Pt.snapshot}(e,v,T,b);const o=await Nm(e.localStore,t,!0),l=new JR(t,o.gs),h=l.ba(o.documents),d=al.createSynthesizedTargetChangeForCurrentChange(n,i&&e.onlineState!=="Offline",s),p=l.applyChanges(h,e.isPrimaryClient,d);$m(e,n,p.Ma);const _=new tC(t,n,l);return e.ka.set(t,_),e.qa.has(n)?e.qa.get(n).push(t):e.qa.set(n,[t]),p.snapshot}async function oC(e,t,n){const i=Mt(e),s=i.ka.get(t),o=i.qa.get(s.targetId);if(o.length>1)return i.qa.set(s.targetId,o.filter(l=>!fu(l,t))),void i.ka.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await Wh(i.localStore,s.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(s.targetId),n&&Hd(i.remoteStore,s.targetId),Kh(i,s.targetId)}).catch(Po)):(Kh(i,s.targetId),await Wh(i.localStore,s.targetId,!0))}async function aC(e,t){const n=Mt(e),i=n.ka.get(t),s=n.qa.get(i.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),Hd(n.remoteStore,i.targetId))}async function lC(e,t,n){const i=mC(e);try{const s=await function(l,h){const d=Mt(l),p=Ue.now(),_=h.reduce((b,V)=>b.add(V.key),Yt());let v,T;return d.persistence.runTransaction("Locally write mutations","readwrite",b=>{let V=Ji(),B=Yt();return d.ds.getEntries(b,_).next(H=>{V=H,V.forEach((et,Y)=>{Y.isValidDocument()||(B=B.add(et))})}).next(()=>d.localDocuments.getOverlayedDocuments(b,V)).next(H=>{v=H;const et=[];for(const Y of h){const Q=IA(Y,v.get(Y.key).overlayedDocument);Q!=null&&et.push(new Fr(Y.key,Q,Cv(Q.value.mapValue),$n.exists(!0)))}return d.mutationQueue.addMutationBatch(b,p,et,h)}).next(H=>{T=H;const et=H.applyToLocalDocumentSet(v,B);return d.documentOverlayCache.saveOverlays(b,H.batchId,et)})}).then(()=>({batchId:T.batchId,changes:Fv(v)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(s.batchId),function(l,h,d){let p=l.Wa[l.currentUser.toKey()];p||(p=new Ie(Bt)),p=p.insert(h,d),l.Wa[l.currentUser.toKey()]=p}(i,s.batchId,n),await cl(i,s.changes),await wu(i.remoteStore)}catch(s){const o=Kd(s,"Failed to persist write");n.reject(o)}}async function yy(e,t){const n=Mt(e);try{const i=await TR(n.localStore,t);t.targetChanges.forEach((s,o)=>{const l=n.Ua.get(o);l&&(oe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?l.Ba=!0:s.modifiedDocuments.size>0?oe(l.Ba):s.removedDocuments.size>0&&(oe(l.Ba),l.Ba=!1))}),await cl(n,i,t)}catch(i){await Po(i)}}function Wm(e,t,n){const i=Mt(e);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const s=[];i.ka.forEach((o,l)=>{const h=l.view.sa(t);h.snapshot&&s.push(h.snapshot)}),function(l,h){const d=Mt(l);d.onlineState=h;let p=!1;d.queries.forEach((_,v)=>{for(const T of v.ta)T.sa(h)&&(p=!0)}),p&&Yd(d)}(i.eventManager,t),s.length&&i.La.p_(s),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function cC(e,t,n){const i=Mt(e);i.sharedClientState.updateQueryState(t,"rejected",n);const s=i.Ua.get(t),o=s&&s.key;if(o){let l=new Ie(Tt.comparator);l=l.insert(o,rn.newNoDocument(o,Ot.min()));const h=Yt().add(o),d=new gu(Ot.min(),new Map,new Ie(Bt),l,h);await yy(i,d),i.$a=i.$a.remove(o),i.Ua.delete(t),tf(i)}else await Wh(i.localStore,t,!1).then(()=>Kh(i,t,n)).catch(Po)}async function uC(e,t){const n=Mt(e),i=t.batch.batchId;try{const s=await wR(n.localStore,t);Ty(n,i,null),wy(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await cl(n,s)}catch(s){await Po(s)}}async function hC(e,t,n){const i=Mt(e);try{const s=await function(l,h){const d=Mt(l);return d.persistence.runTransaction("Reject batch","readwrite-primary",p=>{let _;return d.mutationQueue.lookupMutationBatch(p,h).next(v=>(oe(v!==null),_=v.keys(),d.mutationQueue.removeMutationBatch(p,v))).next(()=>d.mutationQueue.performConsistencyCheck(p)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(p,_,h)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,_)).next(()=>d.localDocuments.getDocuments(p,_))})}(i.localStore,t);Ty(i,t,n),wy(i,t),i.sharedClientState.updateMutationState(t,"rejected",n),await cl(i,s)}catch(s){await Po(s)}}function wy(e,t){(e.Ga.get(t)||[]).forEach(n=>{n.resolve()}),e.Ga.delete(t)}function Ty(e,t,n){const i=Mt(e);let s=i.Wa[i.currentUser.toKey()];if(s){const o=s.get(t);o&&(n?o.reject(n):o.resolve(),s=s.remove(t)),i.Wa[i.currentUser.toKey()]=s}}function Kh(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.qa.get(t))e.ka.delete(i),n&&e.La.Ja(i,n);e.qa.delete(t),e.isPrimaryClient&&e.Ka.br(t).forEach(i=>{e.Ka.containsKey(i)||Ey(e,i)})}function Ey(e,t){e.Qa.delete(t.path.canonicalString());const n=e.$a.get(t);n!==null&&(Hd(e.remoteStore,n),e.$a=e.$a.remove(t),e.Ua.delete(n),tf(e))}function $m(e,t,n){for(const i of n)i instanceof _y?(e.Ka.addReference(i.key,t),dC(e,i)):i instanceof gy?(dt(Jd,"Document no longer in limbo: "+i.key),e.Ka.removeReference(i.key,t),e.Ka.containsKey(i.key)||Ey(e,i.key)):xt()}function dC(e,t){const n=t.key,i=n.path.canonicalString();e.$a.get(n)||e.Qa.has(i)||(dt(Jd,"New document in limbo: "+n),e.Qa.add(i),tf(e))}function tf(e){for(;e.Qa.size>0&&e.$a.size<e.maxConcurrentLimboResolutions;){const t=e.Qa.values().next().value;e.Qa.delete(t);const n=new Tt(ve.fromString(t)),i=e.za.next();e.Ua.set(i,new eC(n)),e.$a=e.$a.insert(n,i),uy(e.remoteStore,new Er(wi(du(n.path)),i,"TargetPurposeLimboResolution",cu.ae))}}async function cl(e,t,n){const i=Mt(e),s=[],o=[],l=[];i.ka.isEmpty()||(i.ka.forEach((h,d)=>{l.push(i.Ha(d,t,n).then(p=>{var _;if((p||n)&&i.isPrimaryClient){const v=p?!p.fromCache:(_=n==null?void 0:n.targetChanges.get(d.targetId))===null||_===void 0?void 0:_.current;i.sharedClientState.updateQueryState(d.targetId,v?"current":"not-current")}if(p){s.push(p);const v=zd.Yi(d.targetId,p);o.push(v)}}))}),await Promise.all(l),i.La.p_(s),await async function(d,p){const _=Mt(d);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>Z.forEach(p,T=>Z.forEach(T.Hi,b=>_.persistence.referenceDelegate.addReference(v,T.targetId,b)).next(()=>Z.forEach(T.Ji,b=>_.persistence.referenceDelegate.removeReference(v,T.targetId,b)))))}catch(v){if(!Ao(v))throw v;dt(jd,"Failed to update sequence numbers: "+v)}for(const v of p){const T=v.targetId;if(!v.fromCache){const b=_.Ts.get(T),V=b.snapshotVersion,B=b.withLastLimboFreeSnapshotVersion(V);_.Ts=_.Ts.insert(T,B)}}}(i.localStore,o))}async function fC(e,t){const n=Mt(e);if(!n.currentUser.isEqual(t)){dt(Jd,"User change. New user:",t.toKey());const i=await oy(n.localStore,t);n.currentUser=t,function(o,l){o.Ga.forEach(h=>{h.forEach(d=>{d.reject(new pt(G.CANCELLED,l))})}),o.Ga.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await cl(n,i.Rs)}}function pC(e,t){const n=Mt(e),i=n.Ua.get(t);if(i&&i.Ba)return Yt().add(i.key);{let s=Yt();const o=n.qa.get(t);if(!o)return s;for(const l of o){const h=n.ka.get(l);s=s.unionWith(h.view.Sa)}return s}}function by(e){const t=Mt(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=yy.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=pC.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=cC.bind(null,t),t.La.p_=YR.bind(null,t.eventManager),t.La.Ja=XR.bind(null,t.eventManager),t}function mC(e){const t=Mt(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=uC.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=hC.bind(null,t),t}class Uc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=vu(t.databaseInfo.databaseId),this.sharedClientState=this.Za(t),this.persistence=this.Xa(t),await this.persistence.start(),this.localStore=this.eu(t),this.gcScheduler=this.tu(t,this.localStore),this.indexBackfillerScheduler=this.nu(t,this.localStore)}tu(t,n){return null}nu(t,n){return null}eu(t){return yR(this.persistence,new _R,t.initialUser,this.serializer)}Xa(t){return new sy(Bd.ri,this.serializer)}Za(t){return new AR}async terminate(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Uc.provider={build:()=>new Uc};class _C extends Uc{constructor(t){super(),this.cacheSizeBytes=t}tu(t,n){oe(this.persistence.referenceDelegate instanceof Nc);const i=this.persistence.referenceDelegate.garbageCollector;return new eR(i,t.asyncQueue,n)}Xa(t){const n=this.cacheSizeBytes!==void 0?yn.withCacheSize(this.cacheSizeBytes):yn.DEFAULT;return new sy(i=>Nc.ri(i,n),this.serializer)}}class Zh{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Wm(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=fC.bind(null,this.syncEngine),await KR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new QR}()}createDatastore(t){const n=vu(t.databaseInfo.databaseId),i=function(o){return new kR(o)}(t.databaseInfo);return function(o,l,h,d){return new DR(o,l,h,d)}(t.authCredentials,t.appCheckCredentials,i,n)}createRemoteStore(t){return function(i,s,o,l,h){return new VR(i,s,o,l,h)}(this.localStore,this.datastore,t.asyncQueue,n=>Wm(this.syncEngine,n,0),function(){return Fm.D()?new Fm:new RR}())}createSyncEngine(t,n){return function(s,o,l,h,d,p,_){const v=new nC(s,o,l,h,d,p);return _&&(v.ja=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(s){const o=Mt(s);dt(fs,"RemoteStore shutting down."),o.W_.add(5),await ll(o),o.z_.shutdown(),o.j_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Zh.provider={build:()=>new Zh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.iu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.iu(this.observer.error,t):Xi("Uncaught Error in snapshot listener:",t.toString()))}su(){this.muted=!0}iu(t,n){setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr="FirestoreClient";class gC{constructor(t,n,i,s,o){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=s,this.user=tn.UNAUTHENTICATED,this.clientId=vv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,async l=>{dt(Mr,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l}),this.appCheckCredentials.start(i,l=>(dt(Mr,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ki;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=Kd(n,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function lh(e,t){e.asyncQueue.verifyOperationInProgress(),dt(Mr,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener(async s=>{i.isEqual(s)||(await oy(t.localStore,s),i=s)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Gm(e,t){e.asyncQueue.verifyOperationInProgress();const n=await vC(e);dt(Mr,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(i=>zm(t.remoteStore,i)),e.setAppCheckTokenChangeListener((i,s)=>zm(t.remoteStore,s)),e._onlineComponents=t}async function vC(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){dt(Mr,"Using user provided OfflineComponentProvider");try{await lh(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(s){return s.name==="FirebaseError"?s.code===G.FAILED_PRECONDITION||s.code===G.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;fo("Error using user provided cache. Falling back to memory cache: "+n),await lh(e,new Uc)}}else dt(Mr,"Using default OfflineComponentProvider"),await lh(e,new _C(void 0));return e._offlineComponents}async function Iy(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(dt(Mr,"Using user provided OnlineComponentProvider"),await Gm(e,e._uninitializedComponentsProvider._online)):(dt(Mr,"Using default OnlineComponentProvider"),await Gm(e,new Zh))),e._onlineComponents}function yC(e){return Iy(e).then(t=>t.syncEngine)}async function Fc(e){const t=await Iy(e),n=t.eventManager;return n.onListen=iC.bind(null,t.syncEngine),n.onUnlisten=oC.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=rC.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=aC.bind(null,t.syncEngine),n}function wC(e,t,n={}){const i=new Ki;return e.asyncQueue.enqueueAndForget(async()=>function(o,l,h,d,p){const _=new ef({next:T=>{_.su(),l.enqueueAndForget(()=>Qd(o,v));const b=T.docs.has(h);!b&&T.fromCache?p.reject(new pt(G.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&T.fromCache&&d&&d.source==="server"?p.reject(new pt(G.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(T)},error:T=>p.reject(T)}),v=new Xd(du(h.path),_,{includeMetadataChanges:!0,Ta:!0});return Zd(o,v)}(await Fc(e),e.asyncQueue,t,n,i)),i.promise}function TC(e,t,n={}){const i=new Ki;return e.asyncQueue.enqueueAndForget(async()=>function(o,l,h,d,p){const _=new ef({next:T=>{_.su(),l.enqueueAndForget(()=>Qd(o,v)),T.fromCache&&d.source==="server"?p.reject(new pt(G.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(T)},error:T=>p.reject(T)}),v=new Xd(h,_,{includeMetadataChanges:!0,Ta:!0});return Zd(o,v)}(await Fc(e),e.asyncQueue,t,n,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Py(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Km=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ay(e,t,n){if(!n)throw new pt(G.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function EC(e,t,n,i){if(t===!0&&i===!0)throw new pt(G.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Zm(e){if(!Tt.isDocumentKey(e))throw new pt(G.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Qm(e){if(Tt.isDocumentKey(e))throw new pt(G.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Tu(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":xt()}function In(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new pt(G.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Tu(e);throw new pt(G.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ry="firestore.googleapis.com",Ym=!0;class Xm{constructor(t){var n,i;if(t.host===void 0){if(t.ssl!==void 0)throw new pt(G.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ry,this.ssl=Ym}else this.host=t.host,this.ssl=(n=t.ssl)!==null&&n!==void 0?n:Ym;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=ry;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<JA)throw new pt(G.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}EC("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Py((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new pt(G.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new pt(G.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new pt(G.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,s){return i.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Eu{constructor(t,n,i,s){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Xm({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new pt(G.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new pt(G.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Xm(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new x0;switch(i.type){case"firstParty":return new M0(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new pt(G.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const i=Km.get(n);i&&(dt("ComponentProvider","Removing Datastore"),Km.delete(n),i.terminate())}(this),Promise.resolve()}}function bC(e,t,n,i={}){var s;const o=(e=In(e,Eu))._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),h=`${t}:${n}`;o.host!==Ry&&o.host!==h&&fo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=Object.assign(Object.assign({},o),{host:h,ssl:!1,emulatorOptions:i});if(!us(d,l)&&(e._setSettings(d),i.mockUserToken)){let p,_;if(typeof i.mockUserToken=="string")p=i.mockUserToken,_=tn.MOCK_USER;else{p=rv(i.mockUserToken,(s=e._app)===null||s===void 0?void 0:s.options.projectId);const v=i.mockUserToken.sub||i.mockUserToken.user_id;if(!v)throw new pt(G.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new tn(v)}e._authCredentials=new k0(new _v(p,_))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(t,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new Br(this.firestore,t,this._query)}}class an{constructor(t,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rr(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new an(this.firestore,t,this._key)}}class Rr extends Br{constructor(t,n,i){super(t,n,du(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new an(this.firestore,null,new Tt(t))}withConverter(t){return new Rr(this.firestore,t,this._path)}}function En(e,t,...n){if(e=Te(e),Ay("collection","path",t),e instanceof Eu){const i=ve.fromString(t,...n);return Qm(i),new Rr(e,null,i)}{if(!(e instanceof an||e instanceof Rr))throw new pt(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(ve.fromString(t,...n));return Qm(i),new Rr(e.firestore,null,i)}}function bn(e,t,...n){if(e=Te(e),arguments.length===1&&(t=vv.newId()),Ay("doc","path",t),e instanceof Eu){const i=ve.fromString(t,...n);return Zm(i),new an(e,null,new Tt(i))}{if(!(e instanceof an||e instanceof Rr))throw new pt(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(ve.fromString(t,...n));return Zm(i),new an(e.firestore,e instanceof Rr?e.converter:null,new Tt(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jm="AsyncQueue";class t_{constructor(t=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new ly(this,"async_queue_retry"),this.Su=()=>{const i=ah();i&&dt(Jm,"Visibility state changed to "+i.visibilityState),this.a_.t_()},this.bu=t;const n=ah();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Du(),this.vu(t)}enterRestrictedMode(t){if(!this.mu){this.mu=!0,this.yu=t||!1;const n=ah();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Su)}}enqueue(t){if(this.Du(),this.mu)return new Promise(()=>{});const n=new Ki;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Vu.push(t),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(t){if(!Ao(t))throw t;dt(Jm,"Operation failed with retryable error: "+t)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(t){const n=this.bu.then(()=>(this.pu=!0,t().catch(i=>{this.gu=i,this.pu=!1;const s=function(l){let h=l.message||"";return l.stack&&(h=l.stack.includes(l.message)?l.stack:l.message+`
`+l.stack),h}(i);throw Xi("INTERNAL UNHANDLED ERROR: ",s),i}).then(i=>(this.pu=!1,i))));return this.bu=n,n}enqueueAfterDelay(t,n,i){this.Du(),this.wu.indexOf(t)>-1&&(n=0);const s=Gd.createAndSchedule(this,t,n,i,o=>this.Fu(o));return this.fu.push(s),s}Du(){this.gu&&xt()}verifyOperationInProgress(){}async Mu(){let t;do t=this.bu,await t;while(t!==this.bu)}xu(t){for(const n of this.fu)if(n.timerId===t)return!0;return!1}Ou(t){return this.Mu().then(()=>{this.fu.sort((n,i)=>n.targetTimeMs-i.targetTimeMs);for(const n of this.fu)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.Mu()})}Nu(t){this.wu.push(t)}Fu(t){const n=this.fu.indexOf(t);this.fu.splice(n,1)}}function e_(e){return function(n,i){if(typeof n!="object"||n===null)return!1;const s=n;for(const o of i)if(o in s&&typeof s[o]=="function")return!0;return!1}(e,["next","error","complete"])}class tr extends Eu{constructor(t,n,i,s){super(t,n,i,s),this.type="firestore",this._queue=new t_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new t_(t),this._firestoreClient=void 0,await t}}}function IC(e,t){const n=typeof e=="object"?e:Rd(),i=typeof e=="string"?e:xc,s=lu(n,"firestore").getImmediate({identifier:i});if(!s._initialized){const o=ev("firestore");o&&bC(s,...o)}return s}function bu(e){if(e._terminated)throw new pt(G.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||PC(e),e._firestoreClient}function PC(e){var t,n,i;const s=e._freezeSettings(),o=function(h,d,p,_){return new Z0(h,d,p,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,Py(_.experimentalLongPollingOptions),_.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,s);e._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((i=s.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(e._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),e._firestoreClient=new gC(e._authCredentials,e._appCheckCredentials,e._queue,o,e._componentsProvider&&function(h){const d=h==null?void 0:h._online.build();return{_offline:h==null?void 0:h._offline.build(d),_online:d}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(t){this._byteString=t}static fromBase64String(t){try{return new yo(Qe.fromBase64String(t))}catch(n){throw new pt(G.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new yo(Qe.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new pt(G.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ze(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new pt(G.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new pt(G.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Bt(this._lat,t._lat)||Bt(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(i,s){if(i.length!==s.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==s[o])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC=/^__.*__$/;class RC{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return this.fieldMask!==null?new Fr(t,this.data,this.fieldMask,n,this.fieldTransforms):new ol(t,this.data,n,this.fieldTransforms)}}class Cy{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return new Fr(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function Sy(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xt()}}class of{constructor(t,n,i,s,o,l){this.settings=t,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=s,o===void 0&&this.Bu(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(t){return new of(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(t){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(t),s=this.ku({path:i,Qu:!1});return s.$u(t),s}Uu(t){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(t),s=this.ku({path:i,Qu:!1});return s.Bu(),s}Ku(t){return this.ku({path:void 0,Qu:!0})}Wu(t){return Bc(t,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Bu(){if(this.path)for(let t=0;t<this.path.length;t++)this.$u(this.path.get(t))}$u(t){if(t.length===0)throw this.Wu("Document fields must not be empty");if(Sy(this.Lu)&&AC.test(t))throw this.Wu('Document fields cannot begin and end with "__"')}}class CC{constructor(t,n,i){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=i||vu(t)}ju(t,n,i,s=!1){return new of({Lu:t,methodName:n,zu:i,path:Ze.emptyPath(),Qu:!1,Gu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Pu(e){const t=e._freezeSettings(),n=vu(e._databaseId);return new CC(e._databaseId,!!t.ignoreUndefinedProperties,n)}function xy(e,t,n,i,s,o={}){const l=e.ju(o.merge||o.mergeFields?2:0,t,n,s);af("Data must be an object, but it was:",l,i);const h=ky(i,l);let d,p;if(o.merge)d=new Mn(l.fieldMask),p=l.fieldTransforms;else if(o.mergeFields){const _=[];for(const v of o.mergeFields){const T=Qh(t,v,n);if(!l.contains(T))throw new pt(G.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);Oy(_,T)||_.push(T)}d=new Mn(_),p=l.fieldTransforms.filter(v=>d.covers(v.field))}else d=null,p=l.fieldTransforms;return new RC(new Tn(h),d,p)}class Au extends nf{_toFieldTransform(t){if(t.Lu!==2)throw t.Lu===1?t.Wu(`${this._methodName}() can only appear at the top level of your update data`):t.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Au}}function SC(e,t,n,i){const s=e.ju(1,t,n);af("Data must be an object, but it was:",s,i);const o=[],l=Tn.empty();Ur(i,(d,p)=>{const _=lf(t,d,n);p=Te(p);const v=s.Uu(_);if(p instanceof Au)o.push(_);else{const T=ul(p,v);T!=null&&(o.push(_),l.set(_,T))}});const h=new Mn(o);return new Cy(l,h,s.fieldTransforms)}function xC(e,t,n,i,s,o){const l=e.ju(1,t,n),h=[Qh(t,i,n)],d=[s];if(o.length%2!=0)throw new pt(G.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<o.length;T+=2)h.push(Qh(t,o[T])),d.push(o[T+1]);const p=[],_=Tn.empty();for(let T=h.length-1;T>=0;--T)if(!Oy(p,h[T])){const b=h[T];let V=d[T];V=Te(V);const B=l.Uu(b);if(V instanceof Au)p.push(b);else{const H=ul(V,B);H!=null&&(p.push(b),_.set(b,H))}}const v=new Mn(p);return new Cy(_,v,l.fieldTransforms)}function kC(e,t,n,i=!1){return ul(n,e.ju(i?4:3,t))}function ul(e,t){if(Ly(e=Te(e)))return af("Unsupported field value:",t,e),ky(e,t);if(e instanceof nf)return function(i,s){if(!Sy(s.Lu))throw s.Wu(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Wu(`${i._methodName}() is not currently supported inside arrays`);const o=i._toFieldTransform(s);o&&s.fieldTransforms.push(o)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Qu&&t.Lu!==4)throw t.Wu("Nested arrays are not supported");return function(i,s){const o=[];let l=0;for(const h of i){let d=ul(h,s.Ku(l));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),l++}return{arrayValue:{values:o}}}(e,t)}return function(i,s){if((i=Te(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return vA(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const o=Ue.fromDate(i);return{timestampValue:Dc(s.serializer,o)}}if(i instanceof Ue){const o=new Ue(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Dc(s.serializer,o)}}if(i instanceof rf)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof yo)return{bytesValue:Yv(s.serializer,i._byteString)};if(i instanceof an){const o=s.databaseId,l=i.firestore._databaseId;if(!l.isEqual(o))throw s.Wu(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Ud(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof sf)return function(l,h){return{mapValue:{fields:{[Av]:{stringValue:Rv},[kc]:{arrayValue:{values:l.toArray().map(p=>{if(typeof p!="number")throw h.Wu("VectorValues must only contain numeric values.");return Md(h.serializer,p)})}}}}}}(i,s);throw s.Wu(`Unsupported field value: ${Tu(i)}`)}(e,t)}function ky(e,t){const n={};return wv(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ur(e,(i,s)=>{const o=ul(s,t.qu(i));o!=null&&(n[i]=o)}),{mapValue:{fields:n}}}function Ly(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof Ue||e instanceof rf||e instanceof yo||e instanceof an||e instanceof nf||e instanceof sf)}function af(e,t,n){if(!Ly(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const i=Tu(n);throw i==="an object"?t.Wu(e+" a custom object"):t.Wu(e+" "+i)}}function Qh(e,t,n){if((t=Te(t))instanceof Iu)return t._internalPath;if(typeof t=="string")return lf(e,t);throw Bc("Field path arguments must be of type string or ",e,!1,void 0,n)}const LC=new RegExp("[~\\*/\\[\\]]");function lf(e,t,n){if(t.search(LC)>=0)throw Bc(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Iu(...t.split("."))._internalPath}catch{throw Bc(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Bc(e,t,n,i,s){const o=i&&!i.isEmpty(),l=s!==void 0;let h=`Function ${t}() called with invalid data`;n&&(h+=" (via `toFirestore()`)"),h+=". ";let d="";return(o||l)&&(d+=" (found",o&&(d+=` in field ${i}`),l&&(d+=` in document ${s}`),d+=")"),new pt(G.INVALID_ARGUMENT,h+e+d)}function Oy(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class My{constructor(t,n,i,s,o){this._firestore=t,this._userDataWriter=n,this._key=i,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new an(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new OC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(Ru("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class OC extends My{data(){return super.data()}}function Ru(e,t){return typeof t=="string"?lf(e,t):t instanceof Iu?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dy(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new pt(G.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cf{}class Ny extends cf{}function Vy(e,t,...n){let i=[];t instanceof cf&&i.push(t),i=i.concat(n),function(o){const l=o.filter(d=>d instanceof uf).length,h=o.filter(d=>d instanceof Cu).length;if(l>1||l>0&&h>0)throw new pt(G.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const s of i)e=s._apply(e);return e}class Cu extends Ny{constructor(t,n,i){super(),this._field=t,this._op=n,this._value=i,this.type="where"}static _create(t,n,i){return new Cu(t,n,i)}_apply(t){const n=this._parse(t);return Uy(t._query,n),new Br(t.firestore,t.converter,Fh(t._query,n))}_parse(t){const n=Pu(t.firestore);return function(o,l,h,d,p,_,v){let T;if(p.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new pt(G.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){i_(v,_);const V=[];for(const B of v)V.push(n_(d,o,B));T={arrayValue:{values:V}}}else T=n_(d,o,v)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||i_(v,_),T=kC(h,l,v,_==="in"||_==="not-in");return Ne.create(p,_,T)}(t._query,"where",n,t.firestore._databaseId,this._field,this._op,this._value)}}function MC(e,t,n){const i=t,s=Ru("where",e);return Cu._create(s,i,n)}class uf extends cf{constructor(t,n){super(),this.type=t,this._queryConstraints=n}static _create(t,n){return new uf(t,n)}_parse(t){const n=this._queryConstraints.map(i=>i._parse(t)).filter(i=>i.getFilters().length>0);return n.length===1?n[0]:si.create(n,this._getOperator())}_apply(t){const n=this._parse(t);return n.getFilters().length===0?t:(function(s,o){let l=s;const h=o.getFlattenedFilters();for(const d of h)Uy(l,d),l=Fh(l,d)}(t._query,n),new Br(t.firestore,t.converter,Fh(t._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class hf extends Ny{constructor(t,n){super(),this._field=t,this._direction=n,this.type="orderBy"}static _create(t,n){return new hf(t,n)}_apply(t){const n=function(s,o,l){if(s.startAt!==null)throw new pt(G.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new pt(G.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ga(o,l)}(t._query,this._field,this._direction);return new Br(t.firestore,t.converter,function(s,o){const l=s.explicitOrderBy.concat([o]);return new Ro(s.path,s.collectionGroup,l,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(t._query,n))}}function DC(e,t="asc"){const n=t,i=Ru("orderBy",e);return hf._create(i,n)}function n_(e,t,n){if(typeof(n=Te(n))=="string"){if(n==="")throw new pt(G.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Dv(t)&&n.indexOf("/")!==-1)throw new pt(G.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=t.path.child(ve.fromString(n));if(!Tt.isDocumentKey(i))throw new pt(G.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return gm(e,new Tt(i))}if(n instanceof an)return gm(e,n._key);throw new pt(G.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Tu(n)}.`)}function i_(e,t){if(!Array.isArray(e)||e.length===0)throw new pt(G.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Uy(e,t){const n=function(s,o){for(const l of s)for(const h of l.getFlattenedFilters())if(o.indexOf(h.op)>=0)return h.op;return null}(e.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(n!==null)throw n===t.op?new pt(G.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new pt(G.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class NC{convertValue(t,n="none"){switch(Lr(t)){case 0:return null;case 1:return t.booleanValue;case 2:return xe(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(kr(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 11:return this.convertObject(t.mapValue,n);case 10:return this.convertVectorValue(t.mapValue);default:throw xt()}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const i={};return Ur(t,(s,o)=>{i[s]=this.convertValue(o,n)}),i}convertVectorValue(t){var n,i,s;const o=(s=(i=(n=t.fields)===null||n===void 0?void 0:n[kc].arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.map(l=>xe(l.doubleValue));return new sf(o)}convertGeoPoint(t){return new rf(xe(t.latitude),xe(t.longitude))}convertArray(t,n){return(t.values||[]).map(i=>this.convertValue(i,n))}convertServerTimestamp(t,n){switch(n){case"previous":const i=hu(t);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(qa(t));default:return null}}convertTimestamp(t){const n=xr(t);return new Ue(n.seconds,n.nanos)}convertDocumentKey(t,n){const i=ve.fromString(t);oe(iy(i));const s=new Wa(i.get(1),i.get(3)),o=new Tt(i.popFirst(5));return s.isEqual(n)||Xi(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fy(e,t,n){let i;return i=e?e.toFirestore(t):t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class By extends My{constructor(t,n,i,s,o,l){super(t,n,i,s,l),this._firestore=t,this._firestoreImpl=t,this.metadata=o}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new pc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const i=this._document.data.field(Ru("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}}class pc extends By{data(t={}){return super.data(t)}}class zy{constructor(t,n,i,s){this._firestore=t,this._userDataWriter=n,this._snapshot=s,this.metadata=new _a(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(i=>{t.call(n,new pc(this._firestore,this._userDataWriter,i.key,i,new _a(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new pt(G.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,o){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map(h=>{const d=new pc(s._firestore,s._userDataWriter,h.doc.key,h.doc,new _a(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);return h.doc,{type:"added",doc:d,oldIndex:-1,newIndex:l++}})}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(h=>o||h.type!==3).map(h=>{const d=new pc(s._firestore,s._userDataWriter,h.doc.key,h.doc,new _a(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);let p=-1,_=-1;return h.type!==0&&(p=l.indexOf(h.doc.key),l=l.delete(h.doc.key)),h.type!==1&&(l=l.add(h.doc),_=l.indexOf(h.doc.key)),{type:VC(h.type),doc:d,oldIndex:p,newIndex:_}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function VC(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UC(e){e=In(e,an);const t=In(e.firestore,tr);return wC(bu(t),e._key).then(n=>jy(t,e,n))}class df extends NC{constructor(t){super(),this.firestore=t}convertBytes(t){return new yo(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new an(this.firestore,null,n)}}function Yh(e){e=In(e,Br);const t=In(e.firestore,tr),n=bu(t),i=new df(t);return Dy(e._query),TC(n,e._query).then(s=>new zy(t,i,e,s))}function FC(e,t,n){e=In(e,an);const i=In(e.firestore,tr),s=Fy(e.converter,t);return Su(i,[xy(Pu(i),"setDoc",e._key,s,e.converter!==null,n).toMutation(e._key,$n.none())])}function ka(e,t,n,...i){e=In(e,an);const s=In(e.firestore,tr),o=Pu(s);let l;return l=typeof(t=Te(t))=="string"||t instanceof Iu?xC(o,"updateDoc",e._key,t,n,i):SC(o,"updateDoc",e._key,t),Su(s,[l.toMutation(e._key,$n.exists(!0))])}function hl(e){return Su(In(e.firestore,tr),[new Dd(e._key,$n.none())])}function dl(e,t){const n=In(e.firestore,tr),i=bn(e),s=Fy(e.converter,t);return Su(n,[xy(Pu(e.firestore),"addDoc",i._key,s,e.converter!==null,{}).toMutation(i._key,$n.exists(!1))]).then(()=>i)}function wo(e,...t){var n,i,s;e=Te(e);let o={includeMetadataChanges:!1,source:"default"},l=0;typeof t[l]!="object"||e_(t[l])||(o=t[l],l++);const h={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(e_(t[l])){const v=t[l];t[l]=(n=v.next)===null||n===void 0?void 0:n.bind(v),t[l+1]=(i=v.error)===null||i===void 0?void 0:i.bind(v),t[l+2]=(s=v.complete)===null||s===void 0?void 0:s.bind(v)}let d,p,_;if(e instanceof an)p=In(e.firestore,tr),_=du(e._key.path),d={next:v=>{t[l]&&t[l](jy(p,e,v))},error:t[l+1],complete:t[l+2]};else{const v=In(e,Br);p=In(v.firestore,tr),_=v._query;const T=new df(p);d={next:b=>{t[l]&&t[l](new zy(p,T,v,b))},error:t[l+1],complete:t[l+2]},Dy(e._query)}return function(T,b,V,B){const H=new ef(B),et=new Xd(b,H,V);return T.asyncQueue.enqueueAndForget(async()=>Zd(await Fc(T),et)),()=>{H.su(),T.asyncQueue.enqueueAndForget(async()=>Qd(await Fc(T),et))}}(bu(p),_,h,d)}function Su(e,t){return function(i,s){const o=new Ki;return i.asyncQueue.enqueueAndForget(async()=>lC(await yC(i),s,o)),o.promise}(bu(e),t)}function jy(e,t,n){const i=n.docs.get(t._key),s=new df(e);return new By(e,s,t._key,i,new _a(n.hasPendingWrites,n.fromCache),t.converter)}(function(t,n=!0){(function(s){Io=s})(gs),hs(new Cr("firestore",(i,{instanceIdentifier:s,options:o})=>{const l=i.getProvider("app").getImmediate(),h=new tr(new L0(i.getProvider("auth-internal")),new D0(l,i.getProvider("app-check-internal")),function(p,_){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new pt(G.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wa(p.options.projectId,_)}(l,s),l);return o=Object.assign({useFetchStreams:n},o),h._setSettings(o),h},"PUBLIC").setMultipleInstances(!0)),yi(sm,om,t),yi(sm,om,"esm2017")})();var BC="firebase",zC="11.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yi(BC,zC,"app");function ff(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n}function Hy(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const jC=Hy,qy=new rl("auth","Firebase",Hy());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zc=new Pd("@firebase/auth");function HC(e,...t){zc.logLevel<=Qt.WARN&&zc.warn(`Auth (${gs}): ${e}`,...t)}function mc(e,...t){zc.logLevel<=Qt.ERROR&&zc.error(`Auth (${gs}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kn(e,...t){throw mf(e,...t)}function ii(e,...t){return mf(e,...t)}function pf(e,t,n){const i=Object.assign(Object.assign({},jC()),{[t]:n});return new rl("auth","Firebase",i).create(t,{appName:e.name})}function Zi(e){return pf(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qC(e,t,n){const i=n;if(!(t instanceof i))throw i.name!==t.constructor.name&&Kn(e,"argument-error"),pf(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function mf(e,...t){if(typeof e!="string"){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return qy.create(e,...t)}function St(e,t,...n){if(!e)throw mf(t,...n)}function Wi(e){const t="INTERNAL ASSERTION FAILED: "+e;throw mc(t),new Error(t)}function er(e,t){e||Wi(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xh(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.href)||""}function WC(){return r_()==="http:"||r_()==="https:"}function r_(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $C(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(WC()||cP()||"connection"in navigator)?navigator.onLine:!0}function GC(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(t,n){this.shortDelay=t,this.longDelay=n,er(n>t,"Short delay should be less than long delay!"),this.isMobile=oP()||uP()}get(){return $C()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _f(e,t){er(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{static initialize(t,n,i){this.fetchImpl=t,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],QC=new fl(3e4,6e4);function zr(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function jr(e,t,n,i,s={}){return $y(e,s,async()=>{let o={},l={};i&&(t==="GET"?l=i:o={body:JSON.stringify(i)});const h=sl(Object.assign({key:e.config.apiKey},l)).slice(1),d=await e._getAdditionalHeaders();d["Content-Type"]="application/json",e.languageCode&&(d["X-Firebase-Locale"]=e.languageCode);const p=Object.assign({method:t,headers:d},o);return lP()||(p.referrerPolicy="no-referrer"),Wy.fetch()(await Gy(e,e.config.apiHost,n,h),p)})}async function $y(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},KC),t);try{const s=new XC(e),o=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw ec(e,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const h=o.ok?l.errorMessage:l.error.message,[d,p]=h.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw ec(e,"credential-already-in-use",l);if(d==="EMAIL_EXISTS")throw ec(e,"email-already-in-use",l);if(d==="USER_DISABLED")throw ec(e,"user-disabled",l);const _=i[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw pf(e,_,p);Kn(e,_)}}catch(s){if(s instanceof Ai)throw s;Kn(e,"network-request-failed",{message:String(s)})}}async function pl(e,t,n,i,s={}){const o=await jr(e,t,n,i,s);return"mfaPendingCredential"in o&&Kn(e,"multi-factor-auth-required",{_serverResponse:o}),o}async function Gy(e,t,n,i){const s=`${t}${n}?${i}`,o=e,l=o.config.emulator?_f(e.config,s):`${e.config.apiScheme}://${s}`;return ZC.includes(n)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}function YC(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class XC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(ii(this.auth,"network-request-failed")),QC.get())})}}function ec(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const s=ii(e,t,i);return s.customData._tokenResponse=n,s}function s_(e){return e!==void 0&&e.enterprise!==void 0}class JC{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],t.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===t)return YC(n.enforcementState);return null}isProviderEnabled(t){return this.getProviderEnforcementState(t)==="ENFORCE"||this.getProviderEnforcementState(t)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function tS(e,t){return jr(e,"GET","/v2/recaptchaConfig",zr(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eS(e,t){return jr(e,"POST","/v1/accounts:delete",t)}async function jc(e,t){return jr(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function La(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function nS(e,t=!1){const n=Te(e),i=await n.getIdToken(t),s=gf(i);St(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,l=o==null?void 0:o.sign_in_provider;return{claims:s,token:i,authTime:La(ch(s.auth_time)),issuedAtTime:La(ch(s.iat)),expirationTime:La(ch(s.exp)),signInProvider:l||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function ch(e){return Number(e)*1e3}function gf(e){const[t,n,i]=e.split(".");if(t===void 0||n===void 0||i===void 0)return mc("JWT malformed, contained fewer than 3 sections"),null;try{const s=Jg(n);return s?JSON.parse(s):(mc("Failed to decode base64 JWT payload"),null)}catch(s){return mc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function o_(e){const t=gf(e);return St(t,"internal-error"),St(typeof t.exp<"u","internal-error"),St(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qa(e,t,n=!1){if(n)return t;try{return await t}catch(i){throw i instanceof Ai&&iS(i)&&e.auth.currentUser===e&&await e.auth.signOut(),i}}function iS({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var n;if(t){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(t=!1){if(!this.isRunning)return;const n=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(t,n){this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=La(this.lastLoginAt),this.creationTime=La(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hc(e){var t;const n=e.auth,i=await e.getIdToken(),s=await Qa(e,jc(n,{idToken:i}));St(s==null?void 0:s.users.length,n,"internal-error");const o=s.users[0];e._notifyReloadListener(o);const l=!((t=o.providerUserInfo)===null||t===void 0)&&t.length?Ky(o.providerUserInfo):[],h=oS(e.providerData,l),d=e.isAnonymous,p=!(e.email&&o.passwordHash)&&!(h!=null&&h.length),_=d?p:!1,v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:h,metadata:new Jh(o.createdAt,o.lastLoginAt),isAnonymous:_};Object.assign(e,v)}async function sS(e){const t=Te(e);await Hc(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function oS(e,t){return[...e.filter(i=>!t.some(s=>s.providerId===i.providerId)),...t]}function Ky(e){return e.map(t=>{var{providerId:n}=t,i=ff(t,["providerId"]);return{providerId:n,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aS(e,t){const n=await $y(e,{},async()=>{const i=sl({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:o}=e.config,l=await Gy(e,s,"/v1/token",`key=${o}`),h=await e._getAdditionalHeaders();return h["Content-Type"]="application/x-www-form-urlencoded",Wy.fetch()(l,{method:"POST",headers:h,body:i})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function lS(e,t){return jr(e,"POST","/v2/accounts:revokeToken",zr(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){St(t.idToken,"internal-error"),St(typeof t.idToken<"u","internal-error"),St(typeof t.refreshToken<"u","internal-error");const n="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):o_(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,n)}updateFromIdToken(t){St(t.length!==0,"internal-error");const n=o_(t);this.updateTokensAndExpiration(t,null,n)}async getToken(t,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(St(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,n){const{accessToken:i,refreshToken:s,expiresIn:o}=await aS(t,n);this.updateTokensAndExpiration(i,s,Number(o))}updateTokensAndExpiration(t,n,i){this.refreshToken=n||null,this.accessToken=t||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(t,n){const{refreshToken:i,accessToken:s,expirationTime:o}=n,l=new so;return i&&(St(typeof i=="string","internal-error",{appName:t}),l.refreshToken=i),s&&(St(typeof s=="string","internal-error",{appName:t}),l.accessToken=s),o&&(St(typeof o=="number","internal-error",{appName:t}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new so,this.toJSON())}_performRefresh(){return Wi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fr(e,t){St(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class ei{constructor(t){var{uid:n,auth:i,stsTokenManager:s}=t,o=ff(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new rS(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=i,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Jh(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(t){const n=await Qa(this,this.stsTokenManager.getToken(this.auth,t));return St(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(t){return nS(this,t)}reload(){return sS(this)}_assign(t){this!==t&&(St(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(n=>Object.assign({},n)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const n=new ei(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(t){St(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,n=!1){let i=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),i=!0),n&&await Hc(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(wn(this.auth.app))return Promise.reject(Zi(this.auth));const t=await this.getIdToken();return await Qa(this,eS(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,n){var i,s,o,l,h,d,p,_;const v=(i=n.displayName)!==null&&i!==void 0?i:void 0,T=(s=n.email)!==null&&s!==void 0?s:void 0,b=(o=n.phoneNumber)!==null&&o!==void 0?o:void 0,V=(l=n.photoURL)!==null&&l!==void 0?l:void 0,B=(h=n.tenantId)!==null&&h!==void 0?h:void 0,H=(d=n._redirectEventId)!==null&&d!==void 0?d:void 0,et=(p=n.createdAt)!==null&&p!==void 0?p:void 0,Y=(_=n.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:Q,emailVerified:J,isAnonymous:Et,providerData:Pt,stsTokenManager:O}=n;St(Q&&O,t,"internal-error");const I=so.fromJSON(this.name,O);St(typeof Q=="string",t,"internal-error"),fr(v,t.name),fr(T,t.name),St(typeof J=="boolean",t,"internal-error"),St(typeof Et=="boolean",t,"internal-error"),fr(b,t.name),fr(V,t.name),fr(B,t.name),fr(H,t.name),fr(et,t.name),fr(Y,t.name);const S=new ei({uid:Q,auth:t,email:T,emailVerified:J,displayName:v,isAnonymous:Et,photoURL:V,phoneNumber:b,tenantId:B,stsTokenManager:I,createdAt:et,lastLoginAt:Y});return Pt&&Array.isArray(Pt)&&(S.providerData=Pt.map(M=>Object.assign({},M))),H&&(S._redirectEventId=H),S}static async _fromIdTokenResponse(t,n,i=!1){const s=new so;s.updateFromServerResponse(n);const o=new ei({uid:n.localId,auth:t,stsTokenManager:s,isAnonymous:i});return await Hc(o),o}static async _fromGetAccountInfoResponse(t,n,i){const s=n.users[0];St(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?Ky(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!(o!=null&&o.length),h=new so;h.updateFromIdToken(i);const d=new ei({uid:s.localId,auth:t,stsTokenManager:h,isAnonymous:l}),p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Jh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(o!=null&&o.length)};return Object.assign(d,p),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a_=new Map;function $i(e){er(e instanceof Function,"Expected a class definition");let t=a_.get(e);return t?(er(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,a_.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,n){this.storage[t]=n}async _get(t){const n=this.storage[t];return n===void 0?null:n}async _remove(t){delete this.storage[t]}_addListener(t,n){}_removeListener(t,n){}}Zy.type="NONE";const l_=Zy;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _c(e,t,n){return`firebase:${e}:${t}:${n}`}class oo{constructor(t,n,i){this.persistence=t,this.auth=n,this.userKey=i;const{config:s,name:o}=this.auth;this.fullUserKey=_c(this.userKey,s.apiKey,o),this.fullPersistenceKey=_c("persistence",s.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const n=await jc(this.auth,{idToken:t}).catch(()=>{});return n?ei._fromGetAccountInfoResponse(this.auth,n,t):null}return ei._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,n,i="authUser"){if(!n.length)return new oo($i(l_),t,i);const s=(await Promise.all(n.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let o=s[0]||$i(l_);const l=_c(i,t.config.apiKey,t.name);let h=null;for(const p of n)try{const _=await p._get(l);if(_){let v;if(typeof _=="string"){const T=await jc(t,{idToken:_}).catch(()=>{});if(!T)break;v=await ei._fromGetAccountInfoResponse(t,T,_)}else v=ei._fromJSON(t,_);p!==o&&(h=v),o=p;break}}catch{}const d=s.filter(p=>p._shouldAllowMigration);return!o._shouldAllowMigration||!d.length?new oo(o,t,i):(o=d[0],h&&await o._set(l,h.toJSON()),await Promise.all(n.map(async p=>{if(p!==o)try{await p._remove(l)}catch{}})),new oo(o,t,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c_(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Jy(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Qy(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ew(t))return"Blackberry";if(nw(t))return"Webos";if(Yy(t))return"Safari";if((t.includes("chrome/")||Xy(t))&&!t.includes("edge/"))return"Chrome";if(tw(t))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=e.match(n);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function Qy(e=cn()){return/firefox\//i.test(e)}function Yy(e=cn()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Xy(e=cn()){return/crios\//i.test(e)}function Jy(e=cn()){return/iemobile/i.test(e)}function tw(e=cn()){return/android/i.test(e)}function ew(e=cn()){return/blackberry/i.test(e)}function nw(e=cn()){return/webos/i.test(e)}function vf(e=cn()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function cS(e=cn()){var t;return vf(e)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function uS(){return hP()&&document.documentMode===10}function iw(e=cn()){return vf(e)||tw(e)||nw(e)||ew(e)||/windows phone/i.test(e)||Jy(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rw(e,t=[]){let n;switch(e){case"Browser":n=c_(cn());break;case"Worker":n=`${c_(cn())}-${e}`;break;default:n=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${gs}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,n){const i=o=>new Promise((l,h)=>{try{const d=t(o);l(d)}catch(d){h(d)}});i.onAbort=n,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const n=[];try{for(const i of this.queue)await i(t),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dS(e,t={}){return jr(e,"GET","/v2/passwordPolicy",zr(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fS=6;class pS{constructor(t){var n,i,s,o;const l=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=l.minPasswordLength)!==null&&n!==void 0?n:fS,l.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=l.maxPasswordLength),l.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=l.containsLowercaseCharacter),l.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=l.containsUppercaseCharacter),l.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=l.containsNumericCharacter),l.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=l.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(i=t.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(o=t.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var n,i,s,o,l,h;const d={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,d),this.validatePasswordCharacterOptions(t,d),d.isValid&&(d.isValid=(n=d.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),d.isValid&&(d.isValid=(i=d.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),d.isValid&&(d.isValid=(s=d.containsLowercaseLetter)!==null&&s!==void 0?s:!0),d.isValid&&(d.isValid=(o=d.containsUppercaseLetter)!==null&&o!==void 0?o:!0),d.isValid&&(d.isValid=(l=d.containsNumericCharacter)!==null&&l!==void 0?l:!0),d.isValid&&(d.isValid=(h=d.containsNonAlphanumericCharacter)!==null&&h!==void 0?h:!0),d}validatePasswordLengthOptions(t,n){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=t.length>=i),s&&(n.meetsMaxPasswordLength=t.length<=s)}validatePasswordCharacterOptions(t,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let s=0;s<t.length;s++)i=t.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(t,n,i,s,o){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(t,n,i,s){this.app=t,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new u_(this),this.idTokenSubscription=new u_(this),this.beforeStateQueue=new hS(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=qy,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(t,n){return n&&(this._popupRedirectResolver=$i(n)),this._initializationPromise=this.queue(async()=>{var i,s,o;if(!this._deleted&&(this.persistenceManager=await oo.create(this,t),(i=this._resolvePersistenceManagerAvailable)===null||i===void 0||i.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const n=await jc(this,{idToken:t}),i=await ei._fromGetAccountInfoResponse(this,n,t);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var n;if(wn(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(h,h))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let s=i,o=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,h=s==null?void 0:s._redirectEventId,d=await this.tryRedirectSignIn(t);(!l||l===h)&&(d!=null&&d.user)&&(s=d.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(l){s=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return St(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(t){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(t){try{await Hc(t)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=GC()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(wn(this.app))return Promise.reject(Zi(this));const n=t?Te(t):null;return n&&St(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(t,n=!1){if(!this._deleted)return t&&St(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return wn(this.app)?Promise.reject(Zi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return wn(this.app)?Promise.reject(Zi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($i(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await dS(this),n=new pS(t);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new rl("auth","Firebase",t())}onAuthStateChanged(t,n,i){return this.registerStateListener(this.authStateSubscription,t,n,i)}beforeAuthStateChanged(t,n){return this.beforeStateQueue.pushCallback(t,n)}onIdTokenChanged(t,n,i){return this.registerStateListener(this.idTokenSubscription,t,n,i)}authStateReady(){return new Promise((t,n)=>{if(this.currentUser)t();else{const i=this.onAuthStateChanged(()=>{i(),t()},n)}})}async revokeAccessToken(t){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await lS(this,i)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,n){const i=await this.getOrInitRedirectPersistenceManager(n);return t===null?i.removeCurrentUser():i.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const n=t&&$i(t)||this._popupRedirectResolver;St(n,this,"argument-error"),this.redirectPersistenceManager=await oo.create(this,[$i(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var n,i;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===t?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(n=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,n,i,s){if(this._deleted)return()=>{};const o=typeof n=="function"?n:n.next.bind(n);let l=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(St(h,this,"internal-error"),h.then(()=>{l||o(this.currentUser)}),typeof n=="function"){const d=t.addObserver(n,i,s);return()=>{l=!0,d()}}else{const d=t.addObserver(n);return()=>{l=!0,d()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return St(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=rw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const i=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());i&&(n["X-Firebase-Client"]=i);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var t;if(wn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return n!=null&&n.error&&HC(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Hr(e){return Te(e)}class u_{constructor(t){this.auth=t,this.observer=null,this.addObserver=yP(n=>this.observer=n)}get next(){return St(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _S(e){xu=e}function sw(e){return xu.loadJS(e)}function gS(){return xu.recaptchaEnterpriseScript}function vS(){return xu.gapiScript}function yS(e){return`__${e}${Math.floor(Math.random()*1e6)}`}class wS{constructor(){this.enterprise=new TS}ready(t){t()}execute(t,n){return Promise.resolve("token")}render(t,n){return""}}class TS{ready(t){t()}execute(t,n){return Promise.resolve("token")}render(t,n){return""}}const ES="recaptcha-enterprise",ow="NO_RECAPTCHA";class bS{constructor(t){this.type=ES,this.auth=Hr(t)}async verify(t="verify",n=!1){async function i(o){if(!n){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(l,h)=>{tS(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const p=new JC(d);return o.tenantId==null?o._agentRecaptchaConfig=p:o._tenantRecaptchaConfigs[o.tenantId]=p,l(p.siteKey)}}).catch(d=>{h(d)})})}function s(o,l,h){const d=window.grecaptcha;s_(d)?d.enterprise.ready(()=>{d.enterprise.execute(o,{action:t}).then(p=>{l(p)}).catch(()=>{l(ow)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new wS().execute("siteKey",{action:"verify"}):new Promise((o,l)=>{i(this.auth).then(h=>{if(!n&&s_(window.grecaptcha))s(h,o,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let d=gS();d.length!==0&&(d+=h),sw(d).then(()=>{s(h,o,l)}).catch(p=>{l(p)})}}).catch(h=>{l(h)})})}}async function h_(e,t,n,i=!1,s=!1){const o=new bS(e);let l;if(s)l=ow;else try{l=await o.verify(n)}catch{l=await o.verify(n,!0)}const h=Object.assign({},t);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in h){const d=h.phoneEnrollmentInfo.phoneNumber,p=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:d,recaptchaToken:p,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){const d=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return i?Object.assign(h,{captchaResp:l}):Object.assign(h,{captchaResponse:l}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function td(e,t,n,i,s){var o;if(!((o=e._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await h_(e,t,n,n==="getOobCode");return i(e,l)}else return i(e,t).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const h=await h_(e,t,n,n==="getOobCode");return i(e,h)}else return Promise.reject(l)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(e,t){const n=lu(e,"auth");if(n.isInitialized()){const s=n.getImmediate(),o=n.getOptions();if(us(o,t??{}))return s;Kn(s,"already-initialized")}return n.initialize({options:t})}function PS(e,t){const n=(t==null?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map($i);t!=null&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,t==null?void 0:t.popupRedirectResolver)}function AS(e,t,n){const i=Hr(e);St(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const s=!1,o=aw(t),{host:l,port:h}=RS(t),d=h===null?"":`:${h}`,p={url:`${o}//${l}${d}/`},_=Object.freeze({host:l,port:h,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!i._canInitEmulator){St(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),St(us(p,i.config.emulator)&&us(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,CS()}function aw(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function RS(e){const t=aw(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const o=s[1];return{host:o,port:d_(i.substr(o.length+1))}}else{const[o,l]=i.split(":");return{host:o,port:d_(l)}}}function d_(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function CS(){function e(){const t=document.createElement("p"),n=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(t,n){this.providerId=t,this.signInMethod=n}toJSON(){return Wi("not implemented")}_getIdTokenResponse(t){return Wi("not implemented")}_linkToIdToken(t,n){return Wi("not implemented")}_getReauthenticationResolver(t){return Wi("not implemented")}}async function SS(e,t){return jr(e,"POST","/v1/accounts:signUp",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xS(e,t){return pl(e,"POST","/v1/accounts:signInWithPassword",zr(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kS(e,t){return pl(e,"POST","/v1/accounts:signInWithEmailLink",zr(e,t))}async function LS(e,t){return pl(e,"POST","/v1/accounts:signInWithEmailLink",zr(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya extends yf{constructor(t,n,i,s=null){super("password",i),this._email=t,this._password=n,this._tenantId=s}static _fromEmailAndPassword(t,n){return new Ya(t,n,"password")}static _fromEmailAndCode(t,n,i=null){return new Ya(t,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const n=typeof t=="string"?JSON.parse(t):t;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return td(t,n,"signInWithPassword",xS);case"emailLink":return kS(t,{email:this._email,oobCode:this._password});default:Kn(t,"internal-error")}}async _linkToIdToken(t,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return td(t,i,"signUpPassword",SS);case"emailLink":return LS(t,{idToken:n,email:this._email,oobCode:this._password});default:Kn(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ao(e,t){return pl(e,"POST","/v1/accounts:signInWithIdp",zr(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS="http://localhost";class ps extends yf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const n=new ps(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(n.idToken=t.idToken),t.accessToken&&(n.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(n.nonce=t.nonce),t.pendingToken&&(n.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(n.accessToken=t.oauthToken,n.secret=t.oauthTokenSecret):Kn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const n=typeof t=="string"?JSON.parse(t):t,{providerId:i,signInMethod:s}=n,o=ff(n,["providerId","signInMethod"]);if(!i||!s)return null;const l=new ps(i,s);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(t){const n=this.buildRequest();return ao(t,n)}_linkToIdToken(t,n){const i=this.buildRequest();return i.idToken=n,ao(t,i)}_getReauthenticationResolver(t){const n=this.buildRequest();return n.autoCreate=!1,ao(t,n)}buildRequest(){const t={requestUri:OS,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),t.postBody=sl(n)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MS(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function DS(e){const t=ha(da(e)).link,n=t?ha(da(t)).deep_link_id:null,i=ha(da(e)).deep_link_id;return(i?ha(da(i)).link:null)||i||n||t||e}class wf{constructor(t){var n,i,s,o,l,h;const d=ha(da(t)),p=(n=d.apiKey)!==null&&n!==void 0?n:null,_=(i=d.oobCode)!==null&&i!==void 0?i:null,v=MS((s=d.mode)!==null&&s!==void 0?s:null);St(p&&_&&v,"argument-error"),this.apiKey=p,this.operation=v,this.code=_,this.continueUrl=(o=d.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(l=d.languageCode)!==null&&l!==void 0?l:null,this.tenantId=(h=d.tenantId)!==null&&h!==void 0?h:null}static parseLink(t){const n=DS(t);try{return new wf(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(){this.providerId=So.PROVIDER_ID}static credential(t,n){return Ya._fromEmailAndPassword(t,n)}static credentialWithLink(t,n){const i=wf.parseLink(n);return St(i,"argument-error"),Ya._fromEmailAndCode(t,i.code,i.tenantId)}}So.PROVIDER_ID="password";So.EMAIL_PASSWORD_SIGN_IN_METHOD="password";So.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml extends Tf{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr extends ml{constructor(){super("facebook.com")}static credential(t){return ps._fromParams({providerId:vr.PROVIDER_ID,signInMethod:vr.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return vr.credentialFromTaggedObject(t)}static credentialFromError(t){return vr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return vr.credential(t.oauthAccessToken)}catch{return null}}}vr.FACEBOOK_SIGN_IN_METHOD="facebook.com";vr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi extends ml{constructor(){super("google.com"),this.addScope("profile")}static credential(t,n){return ps._fromParams({providerId:qi.PROVIDER_ID,signInMethod:qi.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})}static credentialFromResult(t){return qi.credentialFromTaggedObject(t)}static credentialFromError(t){return qi.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return qi.credential(n,i)}catch{return null}}}qi.GOOGLE_SIGN_IN_METHOD="google.com";qi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr extends ml{constructor(){super("github.com")}static credential(t){return ps._fromParams({providerId:yr.PROVIDER_ID,signInMethod:yr.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return yr.credentialFromTaggedObject(t)}static credentialFromError(t){return yr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return yr.credential(t.oauthAccessToken)}catch{return null}}}yr.GITHUB_SIGN_IN_METHOD="github.com";yr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr extends ml{constructor(){super("twitter.com")}static credential(t,n){return ps._fromParams({providerId:wr.PROVIDER_ID,signInMethod:wr.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:n})}static credentialFromResult(t){return wr.credentialFromTaggedObject(t)}static credentialFromError(t){return wr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=t;if(!n||!i)return null;try{return wr.credential(n,i)}catch{return null}}}wr.TWITTER_SIGN_IN_METHOD="twitter.com";wr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NS(e,t){return pl(e,"POST","/v1/accounts:signUp",zr(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,n,i,s=!1){const o=await ei._fromIdTokenResponse(t,i,s),l=f_(i);return new ms({user:o,providerId:l,_tokenResponse:i,operationType:n})}static async _forOperation(t,n,i){await t._updateTokensIfNecessary(i,!0);const s=f_(i);return new ms({user:t,providerId:s,_tokenResponse:i,operationType:n})}}function f_(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc extends Ai{constructor(t,n,i,s){var o;super(n.code,n.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,qc.prototype),this.customData={appName:t.name,tenantId:(o=t.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(t,n,i,s){return new qc(t,n,i,s)}}function lw(e,t,n,i){return(t==="reauthenticate"?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?qc._fromErrorAndOperation(e,o,t,i):o})}async function VS(e,t,n=!1){const i=await Qa(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return ms._forOperation(e,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function US(e,t,n=!1){const{auth:i}=e;if(wn(i.app))return Promise.reject(Zi(i));const s="reauthenticate";try{const o=await Qa(e,lw(i,s,t,e),n);St(o.idToken,i,"internal-error");const l=gf(o.idToken);St(l,i,"internal-error");const{sub:h}=l;return St(e.uid===h,i,"user-mismatch"),ms._forOperation(e,s,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&Kn(i,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cw(e,t,n=!1){if(wn(e.app))return Promise.reject(Zi(e));const i="signIn",s=await lw(e,i,t),o=await ms._fromIdTokenResponse(e,i,s);return n||await e._updateCurrentUser(o.user),o}async function FS(e,t){return cw(Hr(e),t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uw(e){const t=Hr(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function BS(e,t,n){if(wn(e.app))return Promise.reject(Zi(e));const i=Hr(e),l=await td(i,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",NS).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&uw(e),d}),h=await ms._fromIdTokenResponse(i,"signIn",l);return await i._updateCurrentUser(h.user),h}function zS(e,t,n){return wn(e.app)?Promise.reject(Zi(e)):FS(Te(e),So.credential(t,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&uw(e),i})}function jS(e,t,n,i){return Te(e).onIdTokenChanged(t,n,i)}function HS(e,t,n){return Te(e).beforeAuthStateChanged(t,n)}function qS(e,t,n,i){return Te(e).onAuthStateChanged(t,n,i)}function WS(e){return Te(e).signOut()}const Wc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw{constructor(t,n){this.storageRetriever=t,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Wc,"1"),this.storage.removeItem(Wc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,n){return this.storage.setItem(t,JSON.stringify(n)),Promise.resolve()}_get(t){const n=this.storage.getItem(t);return Promise.resolve(n?JSON.parse(n):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S=1e3,GS=10;class dw extends hw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,n)=>this.onStorageEvent(t,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=iw(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),s=this.localCache[n];i!==s&&t(n,s,i)}}onStorageEvent(t,n=!1){if(!t.key){this.forAllChangedKeys((l,h,d)=>{this.notifyListeners(l,d)});return}const i=t.key;n?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(i);!n&&this.localCache[i]===l||this.notifyListeners(i,l)},o=this.storage.getItem(i);uS()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,GS):s()}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:i}),!0)})},$S)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,n){await super._set(t,n),this.localCache[t]=JSON.stringify(n)}async _get(t){const n=await super._get(t);return this.localCache[t]=JSON.stringify(n),n}async _remove(t){await super._remove(t),delete this.localCache[t]}}dw.type="LOCAL";const KS=dw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw extends hw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,n){}_removeListener(t,n){}}fw.type="SESSION";const pw=fw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZS(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const n=this.receivers.find(s=>s.isListeningto(t));if(n)return n;const i=new ku(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const n=t,{eventId:i,eventType:s,data:o}=n.data,l=this.handlersMap[s];if(!(l!=null&&l.size))return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const h=Array.from(l).map(async p=>p(n.origin,o)),d=await ZS(h);n.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:d})}_subscribe(t,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(n)}_unsubscribe(t,n){this.handlersMap[t]&&n&&this.handlersMap[t].delete(n),(!n||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ku.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ef(e="",t=10){let n="";for(let i=0;i<t;i++)n+=Math.floor(Math.random()*10);return e+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,n,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,l;return new Promise((h,d)=>{const p=Ef("",20);s.port1.start();const _=setTimeout(()=>{d(new Error("unsupported_event"))},i);l={messageChannel:s,onMessage(v){const T=v;if(T.data.eventId===p)switch(T.data.status){case"ack":clearTimeout(_),o=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),h(T.data.response);break;default:clearTimeout(_),clearTimeout(o),d(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:t,eventId:p,data:n},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ei(){return window}function YS(e){Ei().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(){return typeof Ei().WorkerGlobalScope<"u"&&typeof Ei().importScripts=="function"}async function XS(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function JS(){var e;return((e=navigator==null?void 0:navigator.serviceWorker)===null||e===void 0?void 0:e.controller)||null}function tx(){return mw()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _w="firebaseLocalStorageDb",ex=1,$c="firebaseLocalStorage",gw="fbase_key";class _l{constructor(t){this.request=t}toPromise(){return new Promise((t,n)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Lu(e,t){return e.transaction([$c],t?"readwrite":"readonly").objectStore($c)}function nx(){const e=indexedDB.deleteDatabase(_w);return new _l(e).toPromise()}function ed(){const e=indexedDB.open(_w,ex);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const i=e.result;try{i.createObjectStore($c,{keyPath:gw})}catch(s){n(s)}}),e.addEventListener("success",async()=>{const i=e.result;i.objectStoreNames.contains($c)?t(i):(i.close(),await nx(),t(await ed()))})})}async function p_(e,t,n){const i=Lu(e,!0).put({[gw]:t,value:n});return new _l(i).toPromise()}async function ix(e,t){const n=Lu(e,!1).get(t),i=await new _l(n).toPromise();return i===void 0?null:i.value}function m_(e,t){const n=Lu(e,!0).delete(t);return new _l(n).toPromise()}const rx=800,sx=3;class vw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ed(),this.db)}async _withRetries(t){let n=0;for(;;)try{const i=await this._openDb();return await t(i)}catch(i){if(n++>sx)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return mw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ku._getInstance(tx()),this.receiver._subscribe("keyChanged",async(t,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(t,n)=>["keyChanged"])}async initializeSender(){var t,n;if(this.activeServiceWorker=await XS(),!this.activeServiceWorker)return;this.sender=new QS(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((n=i[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||JS()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await ed();return await p_(t,Wc,"1"),await m_(t,Wc),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>p_(i,t,n)),this.localCache[t]=n,this.notifyServiceWorker(t)))}async _get(t){const n=await this._withRetries(i=>ix(i,t));return this.localCache[t]=n,n}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(n=>m_(n,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(s=>{const o=Lu(s,!1).getAll();return new _l(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(t.length!==0)for(const{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),rx)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}vw.type="LOCAL";const ox=vw;new fl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yw(e,t){return t?$i(t):(St(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf extends yf{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return ao(t,this._buildIdpRequest())}_linkToIdToken(t,n){return ao(t,this._buildIdpRequest(n))}_getReauthenticationResolver(t){return ao(t,this._buildIdpRequest())}_buildIdpRequest(t){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(n.idToken=t),n}}function ax(e){return cw(e.auth,new bf(e),e.bypassAuthState)}function lx(e){const{auth:t,user:n}=e;return St(n,t,"internal-error"),US(n,new bf(e),e.bypassAuthState)}async function cx(e){const{auth:t,user:n}=e;return St(n,t,"internal-error"),VS(n,new bf(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(t,n,i,s,o=!1){this.auth=t,this.resolver=i,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(t,n)=>{this.pendingPromise={resolve:t,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(t){const{urlResponse:n,sessionId:i,postBody:s,tenantId:o,error:l,type:h}=t;if(l){this.reject(l);return}const d={auth:this.auth,requestUri:n,sessionId:i,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(d))}catch(p){this.reject(p)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return ax;case"linkViaPopup":case"linkViaRedirect":return cx;case"reauthViaPopup":case"reauthViaRedirect":return lx;default:Kn(this.auth,"internal-error")}}resolve(t){er(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){er(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ux=new fl(2e3,1e4);async function hx(e,t,n){if(wn(e.app))return Promise.reject(ii(e,"operation-not-supported-in-this-environment"));const i=Hr(e);qC(e,t,Tf);const s=yw(i,n);return new ss(i,"signInViaPopup",t,s).executeNotNull()}class ss extends ww{constructor(t,n,i,s,o){super(t,n,s,o),this.provider=i,this.authWindow=null,this.pollId=null,ss.currentPopupAction&&ss.currentPopupAction.cancel(),ss.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return St(t,this.auth,"internal-error"),t}async onExecution(){er(this.filter.length===1,"Popup operations only handle one event");const t=Ef();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(ii(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(ii(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ss.currentPopupAction=null}pollUserCancellation(){const t=()=>{var n,i;if(!((i=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ii(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,ux.get())};t()}}ss.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dx="pendingRedirect",gc=new Map;class fx extends ww{constructor(t,n,i=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let t=gc.get(this.auth._key());if(!t){try{const i=await px(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(i)}catch(n){t=()=>Promise.reject(n)}gc.set(this.auth._key(),t)}return this.bypassAuthState||gc.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const n=await this.auth._redirectUserForId(t.eventId);if(n)return this.user=n,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function px(e,t){const n=gx(t),i=_x(e);if(!await i._isAvailable())return!1;const s=await i._get(n)==="true";return await i._remove(n),s}function mx(e,t){gc.set(e._key(),t)}function _x(e){return $i(e._redirectPersistence)}function gx(e){return _c(dx,e.config.apiKey,e.name)}async function vx(e,t,n=!1){if(wn(e.app))return Promise.reject(Zi(e));const i=Hr(e),s=yw(i,t),l=await new fx(i,s,n).execute();return l&&!n&&(delete l.user._redirectEventId,await i._persistUserIfCurrent(l.user),await i._setRedirectUser(null,t)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yx=10*60*1e3;class wx{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(t,i)&&(n=!0,this.sendToConsumer(t,i),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!Tx(t)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=t,n=!0)),n}sendToConsumer(t,n){var i;if(t.error&&!Tw(t)){const s=((i=t.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";n.onError(ii(this.auth,s))}else n.onAuthEvent(t)}isEventForConsumer(t,n){const i=n.eventId===null||!!t.eventId&&t.eventId===n.eventId;return n.filter.includes(t.type)&&i}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=yx&&this.cachedEventUids.clear(),this.cachedEventUids.has(__(t))}saveEventToCache(t){this.cachedEventUids.add(__(t)),this.lastProcessedEventTime=Date.now()}}function __(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function Tw({type:e,error:t}){return e==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function Tx(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Tw(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ex(e,t={}){return jr(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ix=/^https?/;async function Px(e){if(e.config.emulator)return;const{authorizedDomains:t}=await Ex(e);for(const n of t)try{if(Ax(n))return}catch{}Kn(e,"unauthorized-domain")}function Ax(e){const t=Xh(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const l=new URL(e);return l.hostname===""&&i===""?n==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):n==="chrome-extension:"&&l.hostname===i}if(!Ix.test(n))return!1;if(bx.test(e))return i===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rx=new fl(3e4,6e4);function g_(){const e=Ei().___jsl;if(e!=null&&e.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}}function Cx(e){return new Promise((t,n)=>{var i,s,o;function l(){g_(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{g_(),n(ii(e,"network-request-failed"))},timeout:Rx.get()})}if(!((s=(i=Ei().gapi)===null||i===void 0?void 0:i.iframes)===null||s===void 0)&&s.Iframe)t(gapi.iframes.getContext());else if(!((o=Ei().gapi)===null||o===void 0)&&o.load)l();else{const h=yS("iframefcb");return Ei()[h]=()=>{gapi.load?l():n(ii(e,"network-request-failed"))},sw(`${vS()}?onload=${h}`).catch(d=>n(d))}}).catch(t=>{throw vc=null,t})}let vc=null;function Sx(e){return vc=vc||Cx(e),vc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xx=new fl(5e3,15e3),kx="__/auth/iframe",Lx="emulator/auth/iframe",Ox={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Mx=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Dx(e){const t=e.config;St(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?_f(t,Lx):`https://${e.config.authDomain}/${kx}`,i={apiKey:t.apiKey,appName:e.name,v:gs},s=Mx.get(e.config.apiHost);s&&(i.eid=s);const o=e._getFrameworks();return o.length&&(i.fw=o.join(",")),`${n}?${sl(i).slice(1)}`}async function Nx(e){const t=await Sx(e),n=Ei().gapi;return St(n,e,"internal-error"),t.open({where:document.body,url:Dx(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ox,dontclear:!0},i=>new Promise(async(s,o)=>{await i.restyle({setHideOnLeave:!1});const l=ii(e,"network-request-failed"),h=Ei().setTimeout(()=>{o(l)},xx.get());function d(){Ei().clearTimeout(h),s(i)}i.ping(d).then(d,()=>{o(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Ux=500,Fx=600,Bx="_blank",zx="http://localhost";class v_{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function jx(e,t,n,i=Ux,s=Fx){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-i)/2,0).toString();let h="";const d=Object.assign(Object.assign({},Vx),{width:i.toString(),height:s.toString(),top:o,left:l}),p=cn().toLowerCase();n&&(h=Xy(p)?Bx:n),Qy(p)&&(t=t||zx,d.scrollbars="yes");const _=Object.entries(d).reduce((T,[b,V])=>`${T}${b}=${V},`,"");if(cS(p)&&h!=="_self")return Hx(t||"",h),new v_(null);const v=window.open(t||"",h,_);St(v,e,"popup-blocked");try{v.focus()}catch{}return new v_(v)}function Hx(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx="__/auth/handler",Wx="emulator/auth/handler",$x=encodeURIComponent("fac");async function y_(e,t,n,i,s,o){St(e.config.authDomain,e,"auth-domain-config-required"),St(e.config.apiKey,e,"invalid-api-key");const l={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:gs,eventId:s};if(t instanceof Tf){t.setDefaultLanguage(e.languageCode),l.providerId=t.providerId||"",vP(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters()));for(const[_,v]of Object.entries({}))l[_]=v}if(t instanceof ml){const _=t.getScopes().filter(v=>v!=="");_.length>0&&(l.scopes=_.join(","))}e.tenantId&&(l.tid=e.tenantId);const h=l;for(const _ of Object.keys(h))h[_]===void 0&&delete h[_];const d=await e._getAppCheckToken(),p=d?`#${$x}=${encodeURIComponent(d)}`:"";return`${Gx(e)}?${sl(h).slice(1)}${p}`}function Gx({config:e}){return e.emulator?_f(e,Wx):`https://${e.authDomain}/${qx}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh="webStorageSupport";class Kx{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=pw,this._completeRedirectFn=vx,this._overrideRedirectResult=mx}async _openPopup(t,n,i,s){var o;er((o=this.eventManagers[t._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const l=await y_(t,n,i,Xh(),s);return jx(t,l,Ef())}async _openRedirect(t,n,i,s){await this._originValidation(t);const o=await y_(t,n,i,Xh(),s);return YS(o),new Promise(()=>{})}_initialize(t){const n=t._key();if(this.eventManagers[n]){const{manager:s,promise:o}=this.eventManagers[n];return s?Promise.resolve(s):(er(o,"If manager is not set, promise should be"),o)}const i=this.initAndGetManager(t);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(t){const n=await Nx(t),i=new wx(t);return n.register("authEvent",s=>(St(s==null?void 0:s.authEvent,t,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:i},this.iframes[t._key()]=n,i}_isIframeWebStorageSupported(t,n){this.iframes[t._key()].send(uh,{type:uh},s=>{var o;const l=(o=s==null?void 0:s[0])===null||o===void 0?void 0:o[uh];l!==void 0&&n(!!l),Kn(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const n=t._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Px(t)),this.originValidationPromises[n]}get _shouldInitProactively(){return iw()||Yy()||vf()}}const Zx=Kx;var w_="@firebase/auth",T_="1.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const n=this.auth.onIdTokenChanged(i=>{t((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,n),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const n=this.internalListeners.get(t);n&&(this.internalListeners.delete(t),n(),this.updateProactiveRefresh())}assertAuthConfigured(){St(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yx(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Xx(e){hs(new Cr("auth",(t,{options:n})=>{const i=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),o=t.getProvider("app-check-internal"),{apiKey:l,authDomain:h}=i.options;St(l&&!l.includes(":"),"invalid-api-key",{appName:i.name});const d={apiKey:l,authDomain:h,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:rw(e)},p=new mS(i,s,o,d);return PS(p,n),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,n,i)=>{t.getProvider("auth-internal").initialize()})),hs(new Cr("auth-internal",t=>{const n=Hr(t.getProvider("auth").getImmediate());return(i=>new Qx(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),yi(w_,T_,Yx(e)),yi(w_,T_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jx=5*60,tk=iv("authIdTokenMaxAge")||Jx;let E_=null;const ek=e=>async t=>{const n=t&&await t.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>tk)return;const s=n==null?void 0:n.token;E_!==s&&(E_=s,await fetch(e,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Ew(e=Rd()){const t=lu(e,"auth");if(t.isInitialized())return t.getImmediate();const n=IS(e,{popupRedirectResolver:Zx,persistence:[ox,KS,pw]}),i=iv("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(i,location.origin);if(location.origin===o.origin){const l=ek(o.toString());HS(n,l,()=>l(n.currentUser)),jS(n,h=>l(h))}}const s=tv("auth");return s&&AS(n,`http://${s}`),n}function nk(){var e,t;return(t=(e=document.getElementsByTagName("head"))===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:document}_S({loadJS(e){return new Promise((t,n)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=s=>{const o=ii("internal-error");o.customData=s,n(o)},i.type="text/javascript",i.charset="UTF-8",nk().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Xx("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bw="firebasestorage.googleapis.com",Iw="storageBucket",ik=2*60*1e3,rk=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce extends Ai{constructor(t,n,i=0){super(hh(t),`Firebase Storage: ${n} (${hh(t)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ce.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return hh(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Re;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Re||(Re={}));function hh(e){return"storage/"+e}function If(){const e="An unknown error occurred, please check the error payload for server response.";return new Ce(Re.UNKNOWN,e)}function sk(e){return new Ce(Re.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")}function ok(e){return new Ce(Re.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function ak(){const e="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ce(Re.UNAUTHENTICATED,e)}function lk(){return new Ce(Re.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function ck(e){return new Ce(Re.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function uk(){return new Ce(Re.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function hk(){return new Ce(Re.CANCELED,"User canceled the upload/download.")}function dk(e){return new Ce(Re.INVALID_URL,"Invalid URL '"+e+"'.")}function fk(e){return new Ce(Re.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function pk(){return new Ce(Re.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Iw+"' property when initializing the app?")}function mk(){return new Ce(Re.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function _k(){return new Ce(Re.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function gk(e){return new Ce(Re.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function nd(e){return new Ce(Re.INVALID_ARGUMENT,e)}function Pw(){return new Ce(Re.APP_DELETED,"The Firebase app was deleted.")}function vk(e){return new Ce(Re.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Oa(e,t){return new Ce(Re.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function ca(e){throw new Ce(Re.INTERNAL_ERROR,"Internal error: "+e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(t,n){this.bucket=t,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,n){let i;try{i=Dn.makeFromUrl(t,n)}catch{return new Dn(t,"")}if(i.path==="")return i;throw fk(t)}static makeFromUrl(t,n){let i=null;const s="([A-Za-z0-9.\\-_]+)";function o(J){J.path.charAt(J.path.length-1)==="/"&&(J.path_=J.path_.slice(0,-1))}const l="(/(.*))?$",h=new RegExp("^gs://"+s+l,"i"),d={bucket:1,path:3};function p(J){J.path_=decodeURIComponent(J.path)}const _="v[A-Za-z0-9_]+",v=n.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",b=new RegExp(`^https?://${v}/${_}/b/${s}/o${T}`,"i"),V={bucket:1,path:3},B=n===bw?"(?:storage.googleapis.com|storage.cloud.google.com)":n,H="([^?#]*)",et=new RegExp(`^https?://${B}/${s}/${H}`,"i"),Q=[{regex:h,indices:d,postModify:o},{regex:b,indices:V,postModify:p},{regex:et,indices:{bucket:1,path:2},postModify:p}];for(let J=0;J<Q.length;J++){const Et=Q[J],Pt=Et.regex.exec(t);if(Pt){const O=Pt[Et.indices.bucket];let I=Pt[Et.indices.path];I||(I=""),i=new Dn(O,I),Et.postModify(i);break}}if(i==null)throw dk(t);return i}}class yk{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wk(e,t,n){let i=1,s=null,o=null,l=!1,h=0;function d(){return h===2}let p=!1;function _(...H){p||(p=!0,t.apply(null,H))}function v(H){s=setTimeout(()=>{s=null,e(b,d())},H)}function T(){o&&clearTimeout(o)}function b(H,...et){if(p){T();return}if(H){T(),_.call(null,H,...et);return}if(d()||l){T(),_.call(null,H,...et);return}i<64&&(i*=2);let Q;h===1?(h=2,Q=0):Q=(i+Math.random())*1e3,v(Q)}let V=!1;function B(H){V||(V=!0,T(),!p&&(s!==null?(H||(h=2),clearTimeout(s),v(0)):H||(h=1)))}return v(0),o=setTimeout(()=>{l=!0,B(!0)},n),B}function Tk(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ek(e){return e!==void 0}function bk(e){return typeof e=="object"&&!Array.isArray(e)}function Pf(e){return typeof e=="string"||e instanceof String}function b_(e){return Af()&&e instanceof Blob}function Af(){return typeof Blob<"u"}function I_(e,t,n,i){if(i<t)throw nd(`Invalid value for '${e}'. Expected ${t} or greater.`);if(i>n)throw nd(`Invalid value for '${e}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ou(e,t,n){let i=t;return n==null&&(i=`https://${t}`),`${n}://${i}/v0${e}`}function Aw(e){const t=encodeURIComponent;let n="?";for(const i in e)if(e.hasOwnProperty(i)){const s=t(i)+"="+t(e[i]);n=n+s+"&"}return n=n.slice(0,-1),n}var as;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(as||(as={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ik(e,t){const n=e>=500&&e<600,s=[408,429].indexOf(e)!==-1,o=t.indexOf(e)!==-1;return n||s||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(t,n,i,s,o,l,h,d,p,_,v,T=!0){this.url_=t,this.method_=n,this.headers_=i,this.body_=s,this.successCodes_=o,this.additionalRetryCodes_=l,this.callback_=h,this.errorCallback_=d,this.timeout_=p,this.progressCallback_=_,this.connectionFactory_=v,this.retry=T,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((b,V)=>{this.resolve_=b,this.reject_=V,this.start_()})}start_(){const t=(i,s)=>{if(s){i(!1,new nc(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const l=h=>{const d=h.loaded,p=h.lengthComputable?h.total:-1;this.progressCallback_!==null&&this.progressCallback_(d,p)};this.progressCallback_!==null&&o.addUploadProgressListener(l),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(l),this.pendingConnection_=null;const h=o.getErrorCode()===as.NO_ERROR,d=o.getStatus();if(!h||Ik(d,this.additionalRetryCodes_)&&this.retry){const _=o.getErrorCode()===as.ABORT;i(!1,new nc(!1,null,_));return}const p=this.successCodes_.indexOf(d)!==-1;i(!0,new nc(p,o))})},n=(i,s)=>{const o=this.resolve_,l=this.reject_,h=s.connection;if(s.wasSuccessCode)try{const d=this.callback_(h,h.getResponse());Ek(d)?o(d):o()}catch(d){l(d)}else if(h!==null){const d=If();d.serverResponse=h.getErrorText(),this.errorCallback_?l(this.errorCallback_(h,d)):l(d)}else if(s.canceled){const d=this.appDelete_?Pw():hk();l(d)}else{const d=uk();l(d)}};this.canceled_?n(!1,new nc(!1,null,!0)):this.backoffId_=wk(t,n,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&Tk(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class nc{constructor(t,n,i){this.wasSuccessCode=t,this.connection=n,this.canceled=!!i}}function Ak(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function Rk(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function Ck(e,t){t&&(e["X-Firebase-GMPID"]=t)}function Sk(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function xk(e,t,n,i,s,o,l=!0){const h=Aw(e.urlParams),d=e.url+h,p=Object.assign({},e.headers);return Ck(p,t),Ak(p,n),Rk(p,o),Sk(p,i),new Pk(d,e.method,p,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kk(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Lk(...e){const t=kk();if(t!==void 0){const n=new t;for(let i=0;i<e.length;i++)n.append(e[i]);return n.getBlob()}else{if(Af())return new Blob(e);throw new Ce(Re.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Ok(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mk(e){if(typeof atob>"u")throw gk("base-64");return atob(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _i={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class dh{constructor(t,n){this.data=t,this.contentType=n||null}}function Dk(e,t){switch(e){case _i.RAW:return new dh(Rw(t));case _i.BASE64:case _i.BASE64URL:return new dh(Cw(e,t));case _i.DATA_URL:return new dh(Vk(t),Uk(t))}throw If()}function Rw(e){const t=[];for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);if(i<=127)t.push(i);else if(i<=2047)t.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(n<e.length-1&&(e.charCodeAt(n+1)&64512)===56320))t.push(239,191,189);else{const o=i,l=e.charCodeAt(++n);i=65536|(o&1023)<<10|l&1023,t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?t.push(239,191,189):t.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(t)}function Nk(e){let t;try{t=decodeURIComponent(e)}catch{throw Oa(_i.DATA_URL,"Malformed data URL.")}return Rw(t)}function Cw(e,t){switch(e){case _i.BASE64:{const s=t.indexOf("-")!==-1,o=t.indexOf("_")!==-1;if(s||o)throw Oa(e,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case _i.BASE64URL:{const s=t.indexOf("+")!==-1,o=t.indexOf("/")!==-1;if(s||o)throw Oa(e,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=Mk(t)}catch(s){throw s.message.includes("polyfill")?s:Oa(e,"Invalid character found")}const i=new Uint8Array(n.length);for(let s=0;s<n.length;s++)i[s]=n.charCodeAt(s);return i}class Sw{constructor(t){this.base64=!1,this.contentType=null;const n=t.match(/^data:([^,]+)?,/);if(n===null)throw Oa(_i.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=n[1]||null;i!=null&&(this.base64=Fk(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=t.substring(t.indexOf(",")+1)}}function Vk(e){const t=new Sw(e);return t.base64?Cw(_i.BASE64,t.rest):Nk(t.rest)}function Uk(e){return new Sw(e).contentType}function Fk(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(t,n){let i=0,s="";b_(t)?(this.data_=t,i=t.size,s=t.type):t instanceof ArrayBuffer?(n?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),i=this.data_.length):t instanceof Uint8Array&&(n?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),i=t.length),this.size_=i,this.type_=s}size(){return this.size_}type(){return this.type_}slice(t,n){if(b_(this.data_)){const i=this.data_,s=Ok(i,t,n);return s===null?null:new Tr(s)}else{const i=new Uint8Array(this.data_.buffer,t,n-t);return new Tr(i,!0)}}static getBlob(...t){if(Af()){const n=t.map(i=>i instanceof Tr?i.data_:i);return new Tr(Lk.apply(null,n))}else{const n=t.map(l=>Pf(l)?Dk(_i.RAW,l).data:l.data_);let i=0;n.forEach(l=>{i+=l.byteLength});const s=new Uint8Array(i);let o=0;return n.forEach(l=>{for(let h=0;h<l.length;h++)s[o++]=l[h]}),new Tr(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xw(e){let t;try{t=JSON.parse(e)}catch{return null}return bk(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bk(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function zk(e,t){const n=t.split("/").filter(i=>i.length>0).join("/");return e.length===0?n:e+"/"+n}function kw(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jk(e,t){return t}class fn{constructor(t,n,i,s){this.server=t,this.local=n||t,this.writable=!!i,this.xform=s||jk}}let ic=null;function Hk(e){return!Pf(e)||e.length<2?e:kw(e)}function Lw(){if(ic)return ic;const e=[];e.push(new fn("bucket")),e.push(new fn("generation")),e.push(new fn("metageneration")),e.push(new fn("name","fullPath",!0));function t(o,l){return Hk(l)}const n=new fn("name");n.xform=t,e.push(n);function i(o,l){return l!==void 0?Number(l):l}const s=new fn("size");return s.xform=i,e.push(s),e.push(new fn("timeCreated")),e.push(new fn("updated")),e.push(new fn("md5Hash",null,!0)),e.push(new fn("cacheControl",null,!0)),e.push(new fn("contentDisposition",null,!0)),e.push(new fn("contentEncoding",null,!0)),e.push(new fn("contentLanguage",null,!0)),e.push(new fn("contentType",null,!0)),e.push(new fn("metadata","customMetadata",!0)),ic=e,ic}function qk(e,t){function n(){const i=e.bucket,s=e.fullPath,o=new Dn(i,s);return t._makeStorageReference(o)}Object.defineProperty(e,"ref",{get:n})}function Wk(e,t,n){const i={};i.type="file";const s=n.length;for(let o=0;o<s;o++){const l=n[o];i[l.local]=l.xform(i,t[l.server])}return qk(i,e),i}function Ow(e,t,n){const i=xw(t);return i===null?null:Wk(e,i,n)}function $k(e,t,n,i){const s=xw(t);if(s===null||!Pf(s.downloadTokens))return null;const o=s.downloadTokens;if(o.length===0)return null;const l=encodeURIComponent;return o.split(",").map(p=>{const _=e.bucket,v=e.fullPath,T="/b/"+l(_)+"/o/"+l(v),b=Ou(T,n,i),V=Aw({alt:"media",token:p});return b+V})[0]}function Gk(e,t){const n={},i=t.length;for(let s=0;s<i;s++){const o=t[s];o.writable&&(n[o.server]=e[o.local])}return JSON.stringify(n)}class Rf{constructor(t,n,i,s){this.url=t,this.method=n,this.handler=i,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mw(e){if(!e)throw If()}function Kk(e,t){function n(i,s){const o=Ow(e,s,t);return Mw(o!==null),o}return n}function Zk(e,t){function n(i,s){const o=Ow(e,s,t);return Mw(o!==null),$k(o,s,e.host,e._protocol)}return n}function Dw(e){function t(n,i){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=lk():s=ak():n.getStatus()===402?s=ok(e.bucket):n.getStatus()===403?s=ck(e.path):s=i,s.status=n.getStatus(),s.serverResponse=i.serverResponse,s}return t}function Nw(e){const t=Dw(e);function n(i,s){let o=t(i,s);return i.getStatus()===404&&(o=sk(e.path)),o.serverResponse=s.serverResponse,o}return n}function Qk(e,t,n){const i=t.fullServerUrl(),s=Ou(i,e.host,e._protocol),o="GET",l=e.maxOperationRetryTime,h=new Rf(s,o,Zk(e,n),l);return h.errorHandler=Nw(t),h}function Yk(e,t){const n=t.fullServerUrl(),i=Ou(n,e.host,e._protocol),s="DELETE",o=e.maxOperationRetryTime;function l(d,p){}const h=new Rf(i,s,l,o);return h.successCodes=[200,204],h.errorHandler=Nw(t),h}function Xk(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function Jk(e,t,n){const i=Object.assign({},n);return i.fullPath=e.path,i.size=t.size(),i.contentType||(i.contentType=Xk(null,t)),i}function tL(e,t,n,i,s){const o=t.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function h(){let Q="";for(let J=0;J<2;J++)Q=Q+Math.random().toString().slice(2);return Q}const d=h();l["Content-Type"]="multipart/related; boundary="+d;const p=Jk(t,i,s),_=Gk(p,n),v="--"+d+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+_+`\r
--`+d+`\r
Content-Type: `+p.contentType+`\r
\r
`,T=`\r
--`+d+"--",b=Tr.getBlob(v,i,T);if(b===null)throw mk();const V={name:p.fullPath},B=Ou(o,e.host,e._protocol),H="POST",et=e.maxUploadRetryTime,Y=new Rf(B,H,Kk(e,n),et);return Y.urlParams=V,Y.headers=l,Y.body=b.uploadData(),Y.errorHandler=Dw(t),Y}class eL{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=as.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=as.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=as.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,n,i,s){if(this.sent_)throw ca("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,t,!0),s!==void 0)for(const o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ca("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ca("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ca("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ca("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class nL extends eL{initXhr(){this.xhr_.responseType="text"}}function Cf(){return new nL}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(t,n){this._service=t,n instanceof Dn?this._location=n:this._location=Dn.makeFromUrl(n,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,n){return new _s(t,n)}get root(){const t=new Dn(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return kw(this._location.path)}get storage(){return this._service}get parent(){const t=Bk(this._location.path);if(t===null)return null;const n=new Dn(this._location.bucket,t);return new _s(this._service,n)}_throwIfRoot(t){if(this._location.path==="")throw vk(t)}}function iL(e,t,n){e._throwIfRoot("uploadBytes");const i=tL(e.storage,e._location,Lw(),new Tr(t,!0),n);return e.storage.makeRequestWithTokens(i,Cf).then(s=>({metadata:s,ref:e}))}function rL(e){e._throwIfRoot("getDownloadURL");const t=Qk(e.storage,e._location,Lw());return e.storage.makeRequestWithTokens(t,Cf).then(n=>{if(n===null)throw _k();return n})}function sL(e){e._throwIfRoot("deleteObject");const t=Yk(e.storage,e._location);return e.storage.makeRequestWithTokens(t,Cf)}function oL(e,t){const n=zk(e._location.path,t),i=new Dn(e._location.bucket,n);return new _s(e.storage,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aL(e){return/^[A-Za-z]+:\/\//.test(e)}function lL(e,t){return new _s(e,t)}function Vw(e,t){if(e instanceof Sf){const n=e;if(n._bucket==null)throw pk();const i=new _s(n,n._bucket);return t!=null?Vw(i,t):i}else return t!==void 0?oL(e,t):e}function cL(e,t){if(t&&aL(t)){if(e instanceof Sf)return lL(e,t);throw nd("To use ref(service, url), the first argument must be a Storage instance.")}else return Vw(e,t)}function P_(e,t){const n=t==null?void 0:t[Iw];return n==null?null:Dn.makeFromBucketSpec(n,e)}function uL(e,t,n,i={}){e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:s}=i;s&&(e._overrideAuthToken=typeof s=="string"?s:rv(s,e.app.options.projectId))}class Sf{constructor(t,n,i,s,o){this.app=t,this._authProvider=n,this._appCheckProvider=i,this._url=s,this._firebaseVersion=o,this._bucket=null,this._host=bw,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=ik,this._maxUploadRetryTime=rk,this._requests=new Set,s!=null?this._bucket=Dn.makeFromBucketSpec(s,this._host):this._bucket=P_(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=Dn.makeFromBucketSpec(this._url,t):this._bucket=P_(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){I_("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){I_("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const n=await t.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(wn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new _s(this,t)}_makeRequest(t,n,i,s,o=!0){if(this._deleted)return new yk(Pw());{const l=xk(t,this._appId,i,s,n,this._firebaseVersion,o);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(t,n){const[i,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,n,i,s).getPromise()}}const A_="@firebase/storage",R_="0.13.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uw="storage";function Fw(e,t,n){return e=Te(e),iL(e,t,n)}function Bw(e){return e=Te(e),rL(e)}function hL(e){return e=Te(e),sL(e)}function id(e,t){return e=Te(e),cL(e,t)}function dL(e=Rd(),t){e=Te(e);const i=lu(e,Uw).getImmediate({identifier:t}),s=ev("storage");return s&&fL(i,...s),i}function fL(e,t,n,i={}){uL(e,t,n,i)}function pL(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new Sf(n,i,s,t,gs)}function mL(){hs(new Cr(Uw,pL,"PUBLIC").setMultipleInstances(!0)),yi(A_,R_,""),yi(A_,R_,"esm2017")}mL();const _L={apiKey:"AIzaSyDx3EgoNVGjwsjvugK7-YwfwxRX2aPSB6k",authDomain:"tripmaster-64cb7.firebaseapp.com",projectId:"tripmaster-64cb7",storageBucket:"tripmaster-64cb7.firebasestorage.app",messagingSenderId:"1015671912746",appId:"1:1015671912746:web:9379e6f43ed18c9fe38653",measurementId:"G-MD5JGE52F8"},xf=av(_L),me=IC(xf),rd=dL(xf),To=Ew(xf),gL={name:"TripCard",props:{trip:{type:Object,required:!0}},emits:["delete-trip"],methods:{deleteTrip(){this.$emit("delete-trip",this.trip.id)}}},vL={class:"col-md-4 mb-4"},yL={class:"card shadow-sm h-100"},wL={class:"card-body"},TL={class:"card-title"},EL={class:"card-text"};function bL(e,t,n,i,s,o){const l=kn("router-link");return ut(),ft("div",vL,[C("div",yL,[C("div",wL,[C("h5",TL,Nt(n.trip.name),1),C("p",EL,Nt(n.trip.country),1),ge(l,{to:`/trip/${n.trip.id}`,class:"btn btn-green"},{default:bo(()=>t[1]||(t[1]=[$e("View Trip")])),_:1},8,["to"]),C("button",{class:"btn btn-danger mt-3",onClick:t[0]||(t[0]=(...h)=>o.deleteTrip&&o.deleteTrip(...h))},"Delete Trip")])])])}const IL=Pn(gL,[["render",bL],["__scopeId","data-v-369e50f7"]]),PL={name:"AddTripModal",setup(e,{emit:t}){const n=ee({country:"",name:"",departureDate:"",arrivalDate:""}),i=ee(""),s=ee([]),o=ee(null);qS(To,p=>{p?o.value=p.uid:i.value="Musisz być zalogowany, aby dodać podróż."});const l=async()=>{try{const _=await(await fetch("https://restcountries.com/v3.1/all")).json();s.value=_.map(v=>v.name.common).sort()}catch(p){console.error("Błąd ładowania krajów:",p)}},h=async()=>{if(!o.value){i.value="Musisz być zalogowany, aby dodać podróż.";return}try{const p=await dl(En(me,"trips"),{...n.value,userId:o.value,createdAt:new Date});console.log("Trip created with ID:",p.id),t("add-trip",{id:p.id,...n.value,userId:o.value,createdAt:new Date}),d()}catch(p){console.error("Błąd zapisu do bazy:",p),i.value=`Błąd zapisu do bazy: ${p.message}`}},d=()=>{t("close")};return nl(l),{newTrip:n,countries:s,submitForm:h,closeModal:d,errorMessage:i}}},AL={class:"modal fade show d-block",tabindex:"-1",style:{background:"rgba(0,0,0,0.5)"}},RL={class:"modal-dialog"},CL={class:"modal-content"},SL={class:"modal-header"},xL={class:"modal-body"},kL={class:"mb-3"},LL=["value"],OL={class:"mb-3"},ML={class:"mb-3"},DL={class:"mb-3"},NL={key:0,class:"error"};function VL(e,t,n,i,s,o){return ut(),ft("div",AL,[C("div",RL,[C("div",CL,[C("div",SL,[t[6]||(t[6]=C("h5",{class:"modal-title"},"Dodaj podróż",-1)),C("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=(...l)=>i.closeModal&&i.closeModal(...l))})]),C("div",xL,[C("form",{onSubmit:t[5]||(t[5]=io((...l)=>i.submitForm&&i.submitForm(...l),["prevent"]))},[C("div",kL,[t[7]||(t[7]=C("label",{for:"country",class:"form-label"},"Kraj",-1)),pe(C("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>i.newTrip.country=l),id:"country",class:"form-select",required:""},[(ut(!0),ft(We,null,Qi(i.countries,l=>(ut(),ft("option",{key:l,value:l},Nt(l),9,LL))),128))],512),[[Ng,i.newTrip.country]])]),C("div",OL,[t[8]||(t[8]=C("label",{for:"name",class:"form-label"},"Nazwa podróży",-1)),pe(C("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>i.newTrip.name=l),type:"text",id:"name",class:"form-control",required:""},null,512),[[Ae,i.newTrip.name]])]),C("div",ML,[t[9]||(t[9]=C("label",{for:"departureDate",class:"form-label"},"Data wyjazdu (opcjonalnie)",-1)),pe(C("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>i.newTrip.departureDate=l),type:"date",id:"departureDate",class:"form-control"},null,512),[[Ae,i.newTrip.departureDate]])]),C("div",DL,[t[10]||(t[10]=C("label",{for:"arrivalDate",class:"form-label"},"Data przyjazdu (opcjonalnie)",-1)),pe(C("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>i.newTrip.arrivalDate=l),type:"date",id:"arrivalDate",class:"form-control"},null,512),[[Ae,i.newTrip.arrivalDate]])]),t[11]||(t[11]=C("button",{type:"submit",class:"btn btn-primary"},"Dodaj podróż",-1))],32),i.errorMessage?(ut(),ft("p",NL,Nt(i.errorMessage),1)):ne("",!0)])])])])}const UL=Pn(PL,[["render",VL],["__scopeId","data-v-92784b5a"]]),FL={name:"HomeView",components:{TripCard:IL,AddTripModal:UL},setup(){const e=ee([]),t=ee(!1),n=ee(null),i=ou(),s=async()=>{if(n.value)try{const _=Vy(En(me,"trips"),MC("userId","==",n.value)),v=await Yh(_);e.value=v.docs.map(T=>({id:T.id,...T.data()}))}catch(_){console.error("Error loading trips:",_)}},o=async _=>{try{const v=bn(me,"trips",_);await hl(v),e.value=e.value.filter(T=>T.id!==_)}catch(v){console.error("Error deleting trip:",v)}},l=_=>{e.value.push(_),p()},h=async()=>{try{await WS(To),console.log("User logged out"),i.push("/")}catch(_){console.error("Error logging out:",_)}},d=()=>{t.value=!0},p=()=>{t.value=!1};return To.onAuthStateChanged(_=>{_?(n.value=_.uid,s()):(n.value=null,e.value=[])}),nl(s),{trips:e,isModalVisible:t,showAddTripModal:d,closeModal:p,addTrip:l,deleteTrip:o,logout:h}}},BL={class:"container py-5"},zL={key:0,class:"text-center text-muted mt-5"},jL={key:1,class:"row"},HL={key:2,class:"d-flex justify-content-center mt-4"};function qL(e,t,n,i,s,o){const l=kn("TripCard"),h=kn("AddTripModal");return ut(),ft("div",BL,[C("button",{class:"btn btn-danger",onClick:t[0]||(t[0]=(...d)=>i.logout&&i.logout(...d))}," Log out "),t[4]||(t[4]=C("h1",{class:"text-center mb-4 display-4 fw-bold text-green"},"Trip Master",-1)),i.trips.length===0?(ut(),ft("div",zL,[t[3]||(t[3]=C("p",{class:"fs-5"},"You don't have any trips yet 😢",-1)),C("button",{class:"btn btn-green",onClick:t[1]||(t[1]=(...d)=>i.showAddTripModal&&i.showAddTripModal(...d))},"Add your first trip")])):(ut(),ft("div",jL,[(ut(!0),ft(We,null,Qi(i.trips,d=>(ut(),Eh(l,{key:d.id,trip:d,onDeleteTrip:i.deleteTrip},null,8,["trip","onDeleteTrip"]))),128))])),i.trips.length>0?(ut(),ft("div",HL,[C("button",{class:"btn btn-green",onClick:t[2]||(t[2]=(...d)=>i.showAddTripModal&&i.showAddTripModal(...d))},"Add new trip")])):ne("",!0),i.isModalVisible?(ut(),Eh(h,{key:3,onClose:i.closeModal,onAddTrip:i.addTrip},null,8,["onClose","onAddTrip"])):ne("",!0)])}const C_=Pn(FL,[["render",qL],["__scopeId","data-v-a7805922"]]);function WL(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ga={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var $L=ga.exports,S_;function GL(){return S_||(S_=1,function(e,t){(function(n,i){i(t)})($L,function(n){var i="1.9.4";function s(r){var a,u,f,g;for(u=1,f=arguments.length;u<f;u++){g=arguments[u];for(a in g)r[a]=g[a]}return r}var o=Object.create||function(){function r(){}return function(a){return r.prototype=a,new r}}();function l(r,a){var u=Array.prototype.slice;if(r.bind)return r.bind.apply(r,u.call(arguments,1));var f=u.call(arguments,2);return function(){return r.apply(a,f.length?f.concat(u.call(arguments)):arguments)}}var h=0;function d(r){return"_leaflet_id"in r||(r._leaflet_id=++h),r._leaflet_id}function p(r,a,u){var f,g,w,x;return x=function(){f=!1,g&&(w.apply(u,g),g=!1)},w=function(){f?g=arguments:(r.apply(u,arguments),setTimeout(x,a),f=!0)},w}function _(r,a,u){var f=a[1],g=a[0],w=f-g;return r===f&&u?r:((r-g)%w+w)%w+g}function v(){return!1}function T(r,a){if(a===!1)return r;var u=Math.pow(10,a===void 0?6:a);return Math.round(r*u)/u}function b(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function V(r){return b(r).split(/\s+/)}function B(r,a){Object.prototype.hasOwnProperty.call(r,"options")||(r.options=r.options?o(r.options):{});for(var u in a)r.options[u]=a[u];return r.options}function H(r,a,u){var f=[];for(var g in r)f.push(encodeURIComponent(u?g.toUpperCase():g)+"="+encodeURIComponent(r[g]));return(!a||a.indexOf("?")===-1?"?":"&")+f.join("&")}var et=/\{ *([\w_ -]+) *\}/g;function Y(r,a){return r.replace(et,function(u,f){var g=a[f];if(g===void 0)throw new Error("No value provided for variable "+u);return typeof g=="function"&&(g=g(a)),g})}var Q=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};function J(r,a){for(var u=0;u<r.length;u++)if(r[u]===a)return u;return-1}var Et="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Pt(r){return window["webkit"+r]||window["moz"+r]||window["ms"+r]}var O=0;function I(r){var a=+new Date,u=Math.max(0,16-(a-O));return O=a+u,window.setTimeout(r,u)}var S=window.requestAnimationFrame||Pt("RequestAnimationFrame")||I,M=window.cancelAnimationFrame||Pt("CancelAnimationFrame")||Pt("CancelRequestAnimationFrame")||function(r){window.clearTimeout(r)};function D(r,a,u){if(u&&S===I)r.call(a);else return S.call(window,l(r,a))}function k(r){r&&M.call(window,r)}var A={__proto__:null,extend:s,create:o,bind:l,get lastId(){return h},stamp:d,throttle:p,wrapNum:_,falseFn:v,formatNum:T,trim:b,splitWords:V,setOptions:B,getParamString:H,template:Y,isArray:Q,indexOf:J,emptyImageUrl:Et,requestFn:S,cancelFn:M,requestAnimFrame:D,cancelAnimFrame:k};function qt(){}qt.extend=function(r){var a=function(){B(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},u=a.__super__=this.prototype,f=o(u);f.constructor=a,a.prototype=f;for(var g in this)Object.prototype.hasOwnProperty.call(this,g)&&g!=="prototype"&&g!=="__super__"&&(a[g]=this[g]);return r.statics&&s(a,r.statics),r.includes&&(Ye(r.includes),s.apply(null,[f].concat(r.includes))),s(f,r),delete f.statics,delete f.includes,f.options&&(f.options=u.options?o(u.options):{},s(f.options,r.options)),f._initHooks=[],f.callInitHooks=function(){if(!this._initHooksCalled){u.callInitHooks&&u.callInitHooks.call(this),this._initHooksCalled=!0;for(var w=0,x=f._initHooks.length;w<x;w++)f._initHooks[w].call(this)}},a},qt.include=function(r){var a=this.prototype.options;return s(this.prototype,r),r.options&&(this.prototype.options=a,this.mergeOptions(r.options)),this},qt.mergeOptions=function(r){return s(this.prototype.options,r),this},qt.addInitHook=function(r){var a=Array.prototype.slice.call(arguments,1),u=typeof r=="function"?r:function(){this[r].apply(this,a)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(u),this};function Ye(r){if(!(typeof L>"u"||!L||!L.Mixin)){r=Q(r)?r:[r];for(var a=0;a<r.length;a++)r[a]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Xt={on:function(r,a,u){if(typeof r=="object")for(var f in r)this._on(f,r[f],a);else{r=V(r);for(var g=0,w=r.length;g<w;g++)this._on(r[g],a,u)}return this},off:function(r,a,u){if(!arguments.length)delete this._events;else if(typeof r=="object")for(var f in r)this._off(f,r[f],a);else{r=V(r);for(var g=arguments.length===1,w=0,x=r.length;w<x;w++)g?this._off(r[w]):this._off(r[w],a,u)}return this},_on:function(r,a,u,f){if(typeof a!="function"){console.warn("wrong listener type: "+typeof a);return}if(this._listens(r,a,u)===!1){u===this&&(u=void 0);var g={fn:a,ctx:u};f&&(g.once=!0),this._events=this._events||{},this._events[r]=this._events[r]||[],this._events[r].push(g)}},_off:function(r,a,u){var f,g,w;if(this._events&&(f=this._events[r],!!f)){if(arguments.length===1){if(this._firingCount)for(g=0,w=f.length;g<w;g++)f[g].fn=v;delete this._events[r];return}if(typeof a!="function"){console.warn("wrong listener type: "+typeof a);return}var x=this._listens(r,a,u);if(x!==!1){var F=f[x];this._firingCount&&(F.fn=v,this._events[r]=f=f.slice()),f.splice(x,1)}}},fire:function(r,a,u){if(!this.listens(r,u))return this;var f=s({},a,{type:r,target:this,sourceTarget:a&&a.sourceTarget||this});if(this._events){var g=this._events[r];if(g){this._firingCount=this._firingCount+1||1;for(var w=0,x=g.length;w<x;w++){var F=g[w],z=F.fn;F.once&&this.off(r,z,F.ctx),z.call(F.ctx||this,f)}this._firingCount--}}return u&&this._propagateEvent(f),this},listens:function(r,a,u,f){typeof r!="string"&&console.warn('"string" type argument expected');var g=a;typeof a!="function"&&(f=!!a,g=void 0,u=void 0);var w=this._events&&this._events[r];if(w&&w.length&&this._listens(r,g,u)!==!1)return!0;if(f){for(var x in this._eventParents)if(this._eventParents[x].listens(r,a,u,f))return!0}return!1},_listens:function(r,a,u){if(!this._events)return!1;var f=this._events[r]||[];if(!a)return!!f.length;u===this&&(u=void 0);for(var g=0,w=f.length;g<w;g++)if(f[g].fn===a&&f[g].ctx===u)return g;return!1},once:function(r,a,u){if(typeof r=="object")for(var f in r)this._on(f,r[f],a,!0);else{r=V(r);for(var g=0,w=r.length;g<w;g++)this._on(r[g],a,u,!0)}return this},addEventParent:function(r){return this._eventParents=this._eventParents||{},this._eventParents[d(r)]=r,this},removeEventParent:function(r){return this._eventParents&&delete this._eventParents[d(r)],this},_propagateEvent:function(r){for(var a in this._eventParents)this._eventParents[a].fire(r.type,s({layer:r.target,propagatedFrom:r.target},r),!0)}};Xt.addEventListener=Xt.on,Xt.removeEventListener=Xt.clearAllEventListeners=Xt.off,Xt.addOneTimeEventListener=Xt.once,Xt.fireEvent=Xt.fire,Xt.hasEventListeners=Xt.listens;var Ut=qt.extend(Xt);function ot(r,a,u){this.x=u?Math.round(r):r,this.y=u?Math.round(a):a}var Xe=Math.trunc||function(r){return r>0?Math.floor(r):Math.ceil(r)};ot.prototype={clone:function(){return new ot(this.x,this.y)},add:function(r){return this.clone()._add(vt(r))},_add:function(r){return this.x+=r.x,this.y+=r.y,this},subtract:function(r){return this.clone()._subtract(vt(r))},_subtract:function(r){return this.x-=r.x,this.y-=r.y,this},divideBy:function(r){return this.clone()._divideBy(r)},_divideBy:function(r){return this.x/=r,this.y/=r,this},multiplyBy:function(r){return this.clone()._multiplyBy(r)},_multiplyBy:function(r){return this.x*=r,this.y*=r,this},scaleBy:function(r){return new ot(this.x*r.x,this.y*r.y)},unscaleBy:function(r){return new ot(this.x/r.x,this.y/r.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Xe(this.x),this.y=Xe(this.y),this},distanceTo:function(r){r=vt(r);var a=r.x-this.x,u=r.y-this.y;return Math.sqrt(a*a+u*u)},equals:function(r){return r=vt(r),r.x===this.x&&r.y===this.y},contains:function(r){return r=vt(r),Math.abs(r.x)<=Math.abs(this.x)&&Math.abs(r.y)<=Math.abs(this.y)},toString:function(){return"Point("+T(this.x)+", "+T(this.y)+")"}};function vt(r,a,u){return r instanceof ot?r:Q(r)?new ot(r[0],r[1]):r==null?r:typeof r=="object"&&"x"in r&&"y"in r?new ot(r.x,r.y):new ot(r,a,u)}function Gt(r,a){if(r)for(var u=a?[r,a]:r,f=0,g=u.length;f<g;f++)this.extend(u[f])}Gt.prototype={extend:function(r){var a,u;if(!r)return this;if(r instanceof ot||typeof r[0]=="number"||"x"in r)a=u=vt(r);else if(r=zt(r),a=r.min,u=r.max,!a||!u)return this;return!this.min&&!this.max?(this.min=a.clone(),this.max=u.clone()):(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(u.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(u.y,this.max.y)),this},getCenter:function(r){return vt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,r)},getBottomLeft:function(){return vt(this.min.x,this.max.y)},getTopRight:function(){return vt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(r){var a,u;return typeof r[0]=="number"||r instanceof ot?r=vt(r):r=zt(r),r instanceof Gt?(a=r.min,u=r.max):a=u=r,a.x>=this.min.x&&u.x<=this.max.x&&a.y>=this.min.y&&u.y<=this.max.y},intersects:function(r){r=zt(r);var a=this.min,u=this.max,f=r.min,g=r.max,w=g.x>=a.x&&f.x<=u.x,x=g.y>=a.y&&f.y<=u.y;return w&&x},overlaps:function(r){r=zt(r);var a=this.min,u=this.max,f=r.min,g=r.max,w=g.x>a.x&&f.x<u.x,x=g.y>a.y&&f.y<u.y;return w&&x},isValid:function(){return!!(this.min&&this.max)},pad:function(r){var a=this.min,u=this.max,f=Math.abs(a.x-u.x)*r,g=Math.abs(a.y-u.y)*r;return zt(vt(a.x-f,a.y-g),vt(u.x+f,u.y+g))},equals:function(r){return r?(r=zt(r),this.min.equals(r.getTopLeft())&&this.max.equals(r.getBottomRight())):!1}};function zt(r,a){return!r||r instanceof Gt?r:new Gt(r,a)}function jt(r,a){if(r)for(var u=a?[r,a]:r,f=0,g=u.length;f<g;f++)this.extend(u[f])}jt.prototype={extend:function(r){var a=this._southWest,u=this._northEast,f,g;if(r instanceof Ft)f=r,g=r;else if(r instanceof jt){if(f=r._southWest,g=r._northEast,!f||!g)return this}else return r?this.extend(At(r)||ae(r)):this;return!a&&!u?(this._southWest=new Ft(f.lat,f.lng),this._northEast=new Ft(g.lat,g.lng)):(a.lat=Math.min(f.lat,a.lat),a.lng=Math.min(f.lng,a.lng),u.lat=Math.max(g.lat,u.lat),u.lng=Math.max(g.lng,u.lng)),this},pad:function(r){var a=this._southWest,u=this._northEast,f=Math.abs(a.lat-u.lat)*r,g=Math.abs(a.lng-u.lng)*r;return new jt(new Ft(a.lat-f,a.lng-g),new Ft(u.lat+f,u.lng+g))},getCenter:function(){return new Ft((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Ft(this.getNorth(),this.getWest())},getSouthEast:function(){return new Ft(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(r){typeof r[0]=="number"||r instanceof Ft||"lat"in r?r=At(r):r=ae(r);var a=this._southWest,u=this._northEast,f,g;return r instanceof jt?(f=r.getSouthWest(),g=r.getNorthEast()):f=g=r,f.lat>=a.lat&&g.lat<=u.lat&&f.lng>=a.lng&&g.lng<=u.lng},intersects:function(r){r=ae(r);var a=this._southWest,u=this._northEast,f=r.getSouthWest(),g=r.getNorthEast(),w=g.lat>=a.lat&&f.lat<=u.lat,x=g.lng>=a.lng&&f.lng<=u.lng;return w&&x},overlaps:function(r){r=ae(r);var a=this._southWest,u=this._northEast,f=r.getSouthWest(),g=r.getNorthEast(),w=g.lat>a.lat&&f.lat<u.lat,x=g.lng>a.lng&&f.lng<u.lng;return w&&x},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(r,a){return r?(r=ae(r),this._southWest.equals(r.getSouthWest(),a)&&this._northEast.equals(r.getNorthEast(),a)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ae(r,a){return r instanceof jt?r:new jt(r,a)}function Ft(r,a,u){if(isNaN(r)||isNaN(a))throw new Error("Invalid LatLng object: ("+r+", "+a+")");this.lat=+r,this.lng=+a,u!==void 0&&(this.alt=+u)}Ft.prototype={equals:function(r,a){if(!r)return!1;r=At(r);var u=Math.max(Math.abs(this.lat-r.lat),Math.abs(this.lng-r.lng));return u<=(a===void 0?1e-9:a)},toString:function(r){return"LatLng("+T(this.lat,r)+", "+T(this.lng,r)+")"},distanceTo:function(r){return at.distance(this,At(r))},wrap:function(){return at.wrapLatLng(this)},toBounds:function(r){var a=180*r/40075017,u=a/Math.cos(Math.PI/180*this.lat);return ae([this.lat-a,this.lng-u],[this.lat+a,this.lng+u])},clone:function(){return new Ft(this.lat,this.lng,this.alt)}};function At(r,a,u){return r instanceof Ft?r:Q(r)&&typeof r[0]!="object"?r.length===3?new Ft(r[0],r[1],r[2]):r.length===2?new Ft(r[0],r[1]):null:r==null?r:typeof r=="object"&&"lat"in r?new Ft(r.lat,"lng"in r?r.lng:r.lon,r.alt):a===void 0?null:new Ft(r,a,u)}var q={latLngToPoint:function(r,a){var u=this.projection.project(r),f=this.scale(a);return this.transformation._transform(u,f)},pointToLatLng:function(r,a){var u=this.scale(a),f=this.transformation.untransform(r,u);return this.projection.unproject(f)},project:function(r){return this.projection.project(r)},unproject:function(r){return this.projection.unproject(r)},scale:function(r){return 256*Math.pow(2,r)},zoom:function(r){return Math.log(r/256)/Math.LN2},getProjectedBounds:function(r){if(this.infinite)return null;var a=this.projection.bounds,u=this.scale(r),f=this.transformation.transform(a.min,u),g=this.transformation.transform(a.max,u);return new Gt(f,g)},infinite:!1,wrapLatLng:function(r){var a=this.wrapLng?_(r.lng,this.wrapLng,!0):r.lng,u=this.wrapLat?_(r.lat,this.wrapLat,!0):r.lat,f=r.alt;return new Ft(u,a,f)},wrapLatLngBounds:function(r){var a=r.getCenter(),u=this.wrapLatLng(a),f=a.lat-u.lat,g=a.lng-u.lng;if(f===0&&g===0)return r;var w=r.getSouthWest(),x=r.getNorthEast(),F=new Ft(w.lat-f,w.lng-g),z=new Ft(x.lat-f,x.lng-g);return new jt(F,z)}},at=s({},q,{wrapLng:[-180,180],R:6371e3,distance:function(r,a){var u=Math.PI/180,f=r.lat*u,g=a.lat*u,w=Math.sin((a.lat-r.lat)*u/2),x=Math.sin((a.lng-r.lng)*u/2),F=w*w+Math.cos(f)*Math.cos(g)*x*x,z=2*Math.atan2(Math.sqrt(F),Math.sqrt(1-F));return this.R*z}}),lt=6378137,mt={R:lt,MAX_LATITUDE:85.0511287798,project:function(r){var a=Math.PI/180,u=this.MAX_LATITUDE,f=Math.max(Math.min(u,r.lat),-u),g=Math.sin(f*a);return new ot(this.R*r.lng*a,this.R*Math.log((1+g)/(1-g))/2)},unproject:function(r){var a=180/Math.PI;return new Ft((2*Math.atan(Math.exp(r.y/this.R))-Math.PI/2)*a,r.x*a/this.R)},bounds:function(){var r=lt*Math.PI;return new Gt([-r,-r],[r,r])}()};function Kt(r,a,u,f){if(Q(r)){this._a=r[0],this._b=r[1],this._c=r[2],this._d=r[3];return}this._a=r,this._b=a,this._c=u,this._d=f}Kt.prototype={transform:function(r,a){return this._transform(r.clone(),a)},_transform:function(r,a){return a=a||1,r.x=a*(this._a*r.x+this._b),r.y=a*(this._c*r.y+this._d),r},untransform:function(r,a){return a=a||1,new ot((r.x/a-this._b)/this._a,(r.y/a-this._d)/this._c)}};function P(r,a,u,f){return new Kt(r,a,u,f)}var R=s({},at,{code:"EPSG:3857",projection:mt,transformation:function(){var r=.5/(Math.PI*mt.R);return P(r,.5,-r,.5)}()}),N=s({},R,{code:"EPSG:900913"});function W(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function K(r,a){var u="",f,g,w,x,F,z;for(f=0,w=r.length;f<w;f++){for(F=r[f],g=0,x=F.length;g<x;g++)z=F[g],u+=(g?"L":"M")+z.x+" "+z.y;u+=a?gt.svg?"z":"x":""}return u||"M0 0"}var $=document.documentElement.style,st="ActiveXObject"in window,it=st&&!document.addEventListener,nt="msLaunchUri"in navigator&&!("documentMode"in document),tt=Nn("webkit"),wt=Nn("android"),ct=Nn("android 2")||Nn("android 3"),_t=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),bt=wt&&Nn("Google")&&_t<537&&!("AudioNode"in window),yt=!!window.opera,Lt=!nt&&Nn("chrome"),Wt=Nn("gecko")&&!tt&&!yt&&!st,Be=!Lt&&Nn("safari"),ke=Nn("phantom"),un="OTransition"in $,ze=navigator.platform.indexOf("Win")===0,Zn=st&&"transition"in $,Ri="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ct,Le="MozPerspective"in $,_n=!window.L_DISABLE_3D&&(Zn||Ri||Le)&&!un&&!ke,oi=typeof orientation<"u"||Nn("mobile"),xo=oi&&tt,gl=oi&&Ri,ko=!window.PointerEvent&&window.MSPointerEvent,ir=!!(window.PointerEvent||ko),ws="ontouchstart"in window||!!window.TouchEvent,Lo=!window.L_NO_TOUCH&&(ws||ir),Ci=oi&&yt,vl=oi&&Wt,Ts=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,yl=function(){var r=!1;try{var a=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassiveEventSupport",v,a),window.removeEventListener("testPassiveEventSupport",v,a)}catch{}return r}(),qr=function(){return!!document.createElement("canvas").getContext}(),Es=!!(document.createElementNS&&W("svg").createSVGRect),Ge=!!Es&&function(){var r=document.createElement("div");return r.innerHTML="<svg/>",(r.firstChild&&r.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),wl=!Es&&function(){try{var r=document.createElement("div");r.innerHTML='<v:shape adj="1"/>';var a=r.firstChild;return a.style.behavior="url(#default#VML)",a&&typeof a.adj=="object"}catch{return!1}}(),Wr=navigator.platform.indexOf("Mac")===0,$r=navigator.platform.indexOf("Linux")===0;function Nn(r){return navigator.userAgent.toLowerCase().indexOf(r)>=0}var gt={ie:st,ielt9:it,edge:nt,webkit:tt,android:wt,android23:ct,androidStock:bt,opera:yt,chrome:Lt,gecko:Wt,safari:Be,phantom:ke,opera12:un,win:ze,ie3d:Zn,webkit3d:Ri,gecko3d:Le,any3d:_n,mobile:oi,mobileWebkit:xo,mobileWebkit3d:gl,msPointer:ko,pointer:ir,touch:Lo,touchNative:ws,mobileOpera:Ci,mobileGecko:vl,retina:Ts,passiveEvents:yl,canvas:qr,svg:Es,vml:wl,inlineSvg:Ge,mac:Wr,linux:$r},Si=gt.msPointer?"MSPointerDown":"pointerdown",Tl=gt.msPointer?"MSPointerMove":"pointermove",El=gt.msPointer?"MSPointerUp":"pointerup",Gr=gt.msPointer?"MSPointerCancel":"pointercancel",bs={touchstart:Si,touchmove:Tl,touchend:El,touchcancel:Gr},Is={touchstart:As,touchmove:Ps,touchend:Ps,touchcancel:Ps},Qn={},Yn=!1;function bl(r,a,u){return a==="touchstart"&&Pl(),Is[a]?(u=Is[a].bind(this,u),r.addEventListener(bs[a],u,!1),u):(console.warn("wrong event specified:",a),v)}function Il(r,a,u){if(!bs[a]){console.warn("wrong event specified:",a);return}r.removeEventListener(bs[a],u,!1)}function Oo(r){Qn[r.pointerId]=r}function Mo(r){Qn[r.pointerId]&&(Qn[r.pointerId]=r)}function Do(r){delete Qn[r.pointerId]}function Pl(){Yn||(document.addEventListener(Si,Oo,!0),document.addEventListener(Tl,Mo,!0),document.addEventListener(El,Do,!0),document.addEventListener(Gr,Do,!0),Yn=!0)}function Ps(r,a){if(a.pointerType!==(a.MSPOINTER_TYPE_MOUSE||"mouse")){a.touches=[];for(var u in Qn)a.touches.push(Qn[u]);a.changedTouches=[a],r(a)}}function As(r,a){a.MSPOINTER_TYPE_TOUCH&&a.pointerType===a.MSPOINTER_TYPE_TOUCH&&Ee(a),Ps(r,a)}function Al(r){var a={},u,f;for(f in r)u=r[f],a[f]=u&&u.bind?u.bind(r):u;return r=a,a.type="dblclick",a.detail=2,a.isTrusted=!1,a._simulated=!0,a}var No=200;function Kr(r,a){r.addEventListener("dblclick",a);var u=0,f;function g(w){if(w.detail!==1){f=w.detail;return}if(!(w.pointerType==="mouse"||w.sourceCapabilities&&!w.sourceCapabilities.firesTouchEvents)){var x=Ko(w);if(!(x.some(function(z){return z instanceof HTMLLabelElement&&z.attributes.for})&&!x.some(function(z){return z instanceof HTMLInputElement||z instanceof HTMLSelectElement}))){var F=Date.now();F-u<=No?(f++,f===2&&a(Al(w))):f=1,u=F}}}return r.addEventListener("click",g),{dblclick:a,simDblclick:g}}function xi(r,a){r.removeEventListener("dblclick",a.dblclick),r.removeEventListener("click",a.simDblclick)}var Zr=Li(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Qr=Li(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Vo=Qr==="webkitTransition"||Qr==="OTransition"?Qr+"End":"transitionend";function Uo(r){return typeof r=="string"?document.getElementById(r):r}function rr(r,a){var u=r.style[a]||r.currentStyle&&r.currentStyle[a];if((!u||u==="auto")&&document.defaultView){var f=document.defaultView.getComputedStyle(r,null);u=f?f[a]:null}return u==="auto"?null:u}function Zt(r,a,u){var f=document.createElement(r);return f.className=a||"",u&&u.appendChild(f),f}function he(r){var a=r.parentNode;a&&a.removeChild(r)}function Yr(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function ki(r){var a=r.parentNode;a&&a.lastChild!==r&&a.appendChild(r)}function sr(r){var a=r.parentNode;a&&a.firstChild!==r&&a.insertBefore(r,a.firstChild)}function Fo(r,a){if(r.classList!==void 0)return r.classList.contains(a);var u=Vn(r);return u.length>0&&new RegExp("(^|\\s)"+a+"(\\s|$)").test(u)}function Dt(r,a){if(r.classList!==void 0)for(var u=V(a),f=0,g=u.length;f<g;f++)r.classList.add(u[f]);else if(!Fo(r,a)){var w=Vn(r);Bo(r,(w?w+" ":"")+a)}}function ye(r,a){r.classList!==void 0?r.classList.remove(a):Bo(r,b((" "+Vn(r)+" ").replace(" "+a+" "," ")))}function Bo(r,a){r.className.baseVal===void 0?r.className=a:r.className.baseVal=a}function Vn(r){return r.correspondingElement&&(r=r.correspondingElement),r.className.baseVal===void 0?r.className:r.className.baseVal}function Pe(r,a){"opacity"in r.style?r.style.opacity=a:"filter"in r.style&&Rs(r,a)}function Rs(r,a){var u=!1,f="DXImageTransform.Microsoft.Alpha";try{u=r.filters.item(f)}catch{if(a===1)return}a=Math.round(a*100),u?(u.Enabled=a!==100,u.Opacity=a):r.style.filter+=" progid:"+f+"(opacity="+a+")"}function Li(r){for(var a=document.documentElement.style,u=0;u<r.length;u++)if(r[u]in a)return r[u];return!1}function ai(r,a,u){var f=a||new ot(0,0);r.style[Zr]=(gt.ie3d?"translate("+f.x+"px,"+f.y+"px)":"translate3d("+f.x+"px,"+f.y+"px,0)")+(u?" scale("+u+")":"")}function kt(r,a){r._leaflet_pos=a,gt.any3d?ai(r,a):(r.style.left=a.x+"px",r.style.top=a.y+"px")}function Un(r){return r._leaflet_pos||new ot(0,0)}var Xn,Jn,zo;if("onselectstart"in document)Xn=function(){Rt(window,"selectstart",Ee)},Jn=function(){ce(window,"selectstart",Ee)};else{var or=Li(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Xn=function(){if(or){var r=document.documentElement.style;zo=r[or],r[or]="none"}},Jn=function(){or&&(document.documentElement.style[or]=zo,zo=void 0)}}function jo(){Rt(window,"dragstart",Ee)}function Ho(){ce(window,"dragstart",Ee)}var Cs,qo;function Oi(r){for(;r.tabIndex===-1;)r=r.parentNode;r.style&&(An(),Cs=r,qo=r.style.outlineStyle,r.style.outlineStyle="none",Rt(window,"keydown",An))}function An(){Cs&&(Cs.style.outlineStyle=qo,Cs=void 0,qo=void 0,ce(window,"keydown",An))}function Wo(r){do r=r.parentNode;while((!r.offsetWidth||!r.offsetHeight)&&r!==document.body);return r}function Ss(r){var a=r.getBoundingClientRect();return{x:a.width/r.offsetWidth||1,y:a.height/r.offsetHeight||1,boundingClientRect:a}}var Rl={__proto__:null,TRANSFORM:Zr,TRANSITION:Qr,TRANSITION_END:Vo,get:Uo,getStyle:rr,create:Zt,remove:he,empty:Yr,toFront:ki,toBack:sr,hasClass:Fo,addClass:Dt,removeClass:ye,setClass:Bo,getClass:Vn,setOpacity:Pe,testProp:Li,setTransform:ai,setPosition:kt,getPosition:Un,get disableTextSelection(){return Xn},get enableTextSelection(){return Jn},disableImageDrag:jo,enableImageDrag:Ho,preventOutline:Oi,restoreOutline:An,getSizedParentNode:Wo,getScale:Ss};function Rt(r,a,u,f){if(a&&typeof a=="object")for(var g in a)$o(r,g,a[g],u);else{a=V(a);for(var w=0,x=a.length;w<x;w++)$o(r,a[w],u,f)}return this}var Fn="_leaflet_events";function ce(r,a,u,f){if(arguments.length===1)Cl(r),delete r[Fn];else if(a&&typeof a=="object")for(var g in a)Go(r,g,a[g],u);else if(a=V(a),arguments.length===2)Cl(r,function(F){return J(a,F)!==-1});else for(var w=0,x=a.length;w<x;w++)Go(r,a[w],u,f);return this}function Cl(r,a){for(var u in r[Fn]){var f=u.split(/\d/)[0];(!a||a(f))&&Go(r,f,null,null,u)}}var Bn={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function $o(r,a,u,f){var g=a+d(u)+(f?"_"+d(f):"");if(r[Fn]&&r[Fn][g])return this;var w=function(F){return u.call(f||r,F||window.event)},x=w;!gt.touchNative&&gt.pointer&&a.indexOf("touch")===0?w=bl(r,a,w):gt.touch&&a==="dblclick"?w=Kr(r,w):"addEventListener"in r?a==="touchstart"||a==="touchmove"||a==="wheel"||a==="mousewheel"?r.addEventListener(Bn[a]||a,w,gt.passiveEvents?{passive:!1}:!1):a==="mouseenter"||a==="mouseleave"?(w=function(F){F=F||window.event,Zo(r,F)&&x(F)},r.addEventListener(Bn[a],w,!1)):r.addEventListener(a,x,!1):r.attachEvent("on"+a,w),r[Fn]=r[Fn]||{},r[Fn][g]=w}function Go(r,a,u,f,g){g=g||a+d(u)+(f?"_"+d(f):"");var w=r[Fn]&&r[Fn][g];if(!w)return this;!gt.touchNative&&gt.pointer&&a.indexOf("touch")===0?Il(r,a,w):gt.touch&&a==="dblclick"?xi(r,w):"removeEventListener"in r?r.removeEventListener(Bn[a]||a,w,!1):r.detachEvent("on"+a,w),r[Fn][g]=null}function zn(r){return r.stopPropagation?r.stopPropagation():r.originalEvent?r.originalEvent._stopped=!0:r.cancelBubble=!0,this}function ar(r){return $o(r,"wheel",zn),this}function lr(r){return Rt(r,"mousedown touchstart dblclick contextmenu",zn),r._leaflet_disable_click=!0,this}function Ee(r){return r.preventDefault?r.preventDefault():r.returnValue=!1,this}function Rn(r){return Ee(r),zn(r),this}function Ko(r){if(r.composedPath)return r.composedPath();for(var a=[],u=r.target;u;)a.push(u),u=u.parentNode;return a}function xs(r,a){if(!a)return new ot(r.clientX,r.clientY);var u=Ss(a),f=u.boundingClientRect;return new ot((r.clientX-f.left)/u.x-a.clientLeft,(r.clientY-f.top)/u.y-a.clientTop)}var we=gt.linux&&gt.chrome?window.devicePixelRatio:gt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Sl(r){return gt.edge?r.wheelDeltaY/2:r.deltaY&&r.deltaMode===0?-r.deltaY/we:r.deltaY&&r.deltaMode===1?-r.deltaY*20:r.deltaY&&r.deltaMode===2?-r.deltaY*60:r.deltaX||r.deltaZ?0:r.wheelDelta?(r.wheelDeltaY||r.wheelDelta)/2:r.detail&&Math.abs(r.detail)<32765?-r.detail*20:r.detail?r.detail/-32765*60:0}function Zo(r,a){var u=a.relatedTarget;if(!u)return!0;try{for(;u&&u!==r;)u=u.parentNode}catch{return!1}return u!==r}var xl={__proto__:null,on:Rt,off:ce,stopPropagation:zn,disableScrollPropagation:ar,disableClickPropagation:lr,preventDefault:Ee,stop:Rn,getPropagationPath:Ko,getMousePosition:xs,getWheelDelta:Sl,isExternalTarget:Zo,addListener:Rt,removeListener:ce},Qo=Ut.extend({run:function(r,a,u,f){this.stop(),this._el=r,this._inProgress=!0,this._duration=u||.25,this._easeOutPower=1/Math.max(f||.5,.2),this._startPos=Un(r),this._offset=a.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=D(this._animate,this),this._step()},_step:function(r){var a=+new Date-this._startTime,u=this._duration*1e3;a<u?this._runFrame(this._easeOut(a/u),r):(this._runFrame(1),this._complete())},_runFrame:function(r,a){var u=this._startPos.add(this._offset.multiplyBy(r));a&&u._round(),kt(this._el,u),this.fire("step")},_complete:function(){k(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(r){return 1-Math.pow(1-r,this._easeOutPower)}}),$t=Ut.extend({options:{crs:R,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(r,a){a=B(this,a),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(r),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),a.maxBounds&&this.setMaxBounds(a.maxBounds),a.zoom!==void 0&&(this._zoom=this._limitZoom(a.zoom)),a.center&&a.zoom!==void 0&&this.setView(At(a.center),a.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Qr&&gt.any3d&&!gt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Rt(this._proxy,Vo,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(r,a,u){if(a=a===void 0?this._zoom:this._limitZoom(a),r=this._limitCenter(At(r),a,this.options.maxBounds),u=u||{},this._stop(),this._loaded&&!u.reset&&u!==!0){u.animate!==void 0&&(u.zoom=s({animate:u.animate},u.zoom),u.pan=s({animate:u.animate,duration:u.duration},u.pan));var f=this._zoom!==a?this._tryAnimatedZoom&&this._tryAnimatedZoom(r,a,u.zoom):this._tryAnimatedPan(r,u.pan);if(f)return clearTimeout(this._sizeTimer),this}return this._resetView(r,a,u.pan&&u.pan.noMoveStart),this},setZoom:function(r,a){return this._loaded?this.setView(this.getCenter(),r,{zoom:a}):(this._zoom=r,this)},zoomIn:function(r,a){return r=r||(gt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+r,a)},zoomOut:function(r,a){return r=r||(gt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-r,a)},setZoomAround:function(r,a,u){var f=this.getZoomScale(a),g=this.getSize().divideBy(2),w=r instanceof ot?r:this.latLngToContainerPoint(r),x=w.subtract(g).multiplyBy(1-1/f),F=this.containerPointToLatLng(g.add(x));return this.setView(F,a,{zoom:u})},_getBoundsCenterZoom:function(r,a){a=a||{},r=r.getBounds?r.getBounds():ae(r);var u=vt(a.paddingTopLeft||a.padding||[0,0]),f=vt(a.paddingBottomRight||a.padding||[0,0]),g=this.getBoundsZoom(r,!1,u.add(f));if(g=typeof a.maxZoom=="number"?Math.min(a.maxZoom,g):g,g===1/0)return{center:r.getCenter(),zoom:g};var w=f.subtract(u).divideBy(2),x=this.project(r.getSouthWest(),g),F=this.project(r.getNorthEast(),g),z=this.unproject(x.add(F).divideBy(2).add(w),g);return{center:z,zoom:g}},fitBounds:function(r,a){if(r=ae(r),!r.isValid())throw new Error("Bounds are not valid.");var u=this._getBoundsCenterZoom(r,a);return this.setView(u.center,u.zoom,a)},fitWorld:function(r){return this.fitBounds([[-90,-180],[90,180]],r)},panTo:function(r,a){return this.setView(r,this._zoom,{pan:a})},panBy:function(r,a){if(r=vt(r).round(),a=a||{},!r.x&&!r.y)return this.fire("moveend");if(a.animate!==!0&&!this.getSize().contains(r))return this._resetView(this.unproject(this.project(this.getCenter()).add(r)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Qo,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),a.noMoveStart||this.fire("movestart"),a.animate!==!1){Dt(this._mapPane,"leaflet-pan-anim");var u=this._getMapPanePos().subtract(r).round();this._panAnim.run(this._mapPane,u,a.duration||.25,a.easeLinearity)}else this._rawPanBy(r),this.fire("move").fire("moveend");return this},flyTo:function(r,a,u){if(u=u||{},u.animate===!1||!gt.any3d)return this.setView(r,a,u);this._stop();var f=this.project(this.getCenter()),g=this.project(r),w=this.getSize(),x=this._zoom;r=At(r),a=a===void 0?x:a;var F=Math.max(w.x,w.y),z=F*this.getZoomScale(x,a),X=g.distanceTo(f)||1,ht=1.42,Ct=ht*ht;function Ht(Me){var $l=Me?-1:1,hT=Me?z:F,dT=z*z-F*F+$l*Ct*Ct*X*X,fT=2*hT*Ct*X,Bu=dT/fT,Xf=Math.sqrt(Bu*Bu+1)-Bu,pT=Xf<1e-9?-18:Math.log(Xf);return pT}function dn(Me){return(Math.exp(Me)-Math.exp(-Me))/2}function He(Me){return(Math.exp(Me)+Math.exp(-Me))/2}function Hn(Me){return dn(Me)/He(Me)}var vn=Ht(0);function Hs(Me){return F*(He(vn)/He(vn+ht*Me))}function aT(Me){return F*(He(vn)*Hn(vn+ht*Me)-dn(vn))/Ct}function lT(Me){return 1-Math.pow(1-Me,1.5)}var cT=Date.now(),Qf=(Ht(1)-vn)/ht,uT=u.duration?1e3*u.duration:1e3*Qf*.8;function Yf(){var Me=(Date.now()-cT)/uT,$l=lT(Me)*Qf;Me<=1?(this._flyToFrame=D(Yf,this),this._move(this.unproject(f.add(g.subtract(f).multiplyBy(aT($l)/X)),x),this.getScaleZoom(F/Hs($l),x),{flyTo:!0})):this._move(r,a)._moveEnd(!0)}return this._moveStart(!0,u.noMoveStart),Yf.call(this),this},flyToBounds:function(r,a){var u=this._getBoundsCenterZoom(r,a);return this.flyTo(u.center,u.zoom,a)},setMaxBounds:function(r){return r=ae(r),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),r.isValid()?(this.options.maxBounds=r,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(r){var a=this.options.minZoom;return this.options.minZoom=r,this._loaded&&a!==r&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(r):this},setMaxZoom:function(r){var a=this.options.maxZoom;return this.options.maxZoom=r,this._loaded&&a!==r&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(r):this},panInsideBounds:function(r,a){this._enforcingBounds=!0;var u=this.getCenter(),f=this._limitCenter(u,this._zoom,ae(r));return u.equals(f)||this.panTo(f,a),this._enforcingBounds=!1,this},panInside:function(r,a){a=a||{};var u=vt(a.paddingTopLeft||a.padding||[0,0]),f=vt(a.paddingBottomRight||a.padding||[0,0]),g=this.project(this.getCenter()),w=this.project(r),x=this.getPixelBounds(),F=zt([x.min.add(u),x.max.subtract(f)]),z=F.getSize();if(!F.contains(w)){this._enforcingBounds=!0;var X=w.subtract(F.getCenter()),ht=F.extend(w).getSize().subtract(z);g.x+=X.x<0?-ht.x:ht.x,g.y+=X.y<0?-ht.y:ht.y,this.panTo(this.unproject(g),a),this._enforcingBounds=!1}return this},invalidateSize:function(r){if(!this._loaded)return this;r=s({animate:!1,pan:!0},r===!0?{animate:!0}:r);var a=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var u=this.getSize(),f=a.divideBy(2).round(),g=u.divideBy(2).round(),w=f.subtract(g);return!w.x&&!w.y?this:(r.animate&&r.pan?this.panBy(w):(r.pan&&this._rawPanBy(w),this.fire("move"),r.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:a,newSize:u}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(r){if(r=this._locateOptions=s({timeout:1e4,watch:!1},r),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var a=l(this._handleGeolocationResponse,this),u=l(this._handleGeolocationError,this);return r.watch?this._locationWatchId=navigator.geolocation.watchPosition(a,u,r):navigator.geolocation.getCurrentPosition(a,u,r),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(r){if(this._container._leaflet_id){var a=r.code,u=r.message||(a===1?"permission denied":a===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:a,message:"Geolocation error: "+u+"."})}},_handleGeolocationResponse:function(r){if(this._container._leaflet_id){var a=r.coords.latitude,u=r.coords.longitude,f=new Ft(a,u),g=f.toBounds(r.coords.accuracy*2),w=this._locateOptions;if(w.setView){var x=this.getBoundsZoom(g);this.setView(f,w.maxZoom?Math.min(x,w.maxZoom):x)}var F={latlng:f,bounds:g,timestamp:r.timestamp};for(var z in r.coords)typeof r.coords[z]=="number"&&(F[z]=r.coords[z]);this.fire("locationfound",F)}},addHandler:function(r,a){if(!a)return this;var u=this[r]=new a(this);return this._handlers.push(u),this.options[r]&&u.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),he(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(k(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var r;for(r in this._layers)this._layers[r].remove();for(r in this._panes)he(this._panes[r]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(r,a){var u="leaflet-pane"+(r?" leaflet-"+r.replace("Pane","")+"-pane":""),f=Zt("div",u,a||this._mapPane);return r&&(this._panes[r]=f),f},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var r=this.getPixelBounds(),a=this.unproject(r.getBottomLeft()),u=this.unproject(r.getTopRight());return new jt(a,u)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(r,a,u){r=ae(r),u=vt(u||[0,0]);var f=this.getZoom()||0,g=this.getMinZoom(),w=this.getMaxZoom(),x=r.getNorthWest(),F=r.getSouthEast(),z=this.getSize().subtract(u),X=zt(this.project(F,f),this.project(x,f)).getSize(),ht=gt.any3d?this.options.zoomSnap:1,Ct=z.x/X.x,Ht=z.y/X.y,dn=a?Math.max(Ct,Ht):Math.min(Ct,Ht);return f=this.getScaleZoom(dn,f),ht&&(f=Math.round(f/(ht/100))*(ht/100),f=a?Math.ceil(f/ht)*ht:Math.floor(f/ht)*ht),Math.max(g,Math.min(w,f))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ot(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(r,a){var u=this._getTopLeftPoint(r,a);return new Gt(u,u.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(r){return this.options.crs.getProjectedBounds(r===void 0?this.getZoom():r)},getPane:function(r){return typeof r=="string"?this._panes[r]:r},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(r,a){var u=this.options.crs;return a=a===void 0?this._zoom:a,u.scale(r)/u.scale(a)},getScaleZoom:function(r,a){var u=this.options.crs;a=a===void 0?this._zoom:a;var f=u.zoom(r*u.scale(a));return isNaN(f)?1/0:f},project:function(r,a){return a=a===void 0?this._zoom:a,this.options.crs.latLngToPoint(At(r),a)},unproject:function(r,a){return a=a===void 0?this._zoom:a,this.options.crs.pointToLatLng(vt(r),a)},layerPointToLatLng:function(r){var a=vt(r).add(this.getPixelOrigin());return this.unproject(a)},latLngToLayerPoint:function(r){var a=this.project(At(r))._round();return a._subtract(this.getPixelOrigin())},wrapLatLng:function(r){return this.options.crs.wrapLatLng(At(r))},wrapLatLngBounds:function(r){return this.options.crs.wrapLatLngBounds(ae(r))},distance:function(r,a){return this.options.crs.distance(At(r),At(a))},containerPointToLayerPoint:function(r){return vt(r).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(r){return vt(r).add(this._getMapPanePos())},containerPointToLatLng:function(r){var a=this.containerPointToLayerPoint(vt(r));return this.layerPointToLatLng(a)},latLngToContainerPoint:function(r){return this.layerPointToContainerPoint(this.latLngToLayerPoint(At(r)))},mouseEventToContainerPoint:function(r){return xs(r,this._container)},mouseEventToLayerPoint:function(r){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(r))},mouseEventToLatLng:function(r){return this.layerPointToLatLng(this.mouseEventToLayerPoint(r))},_initContainer:function(r){var a=this._container=Uo(r);if(a){if(a._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Rt(a,"scroll",this._onScroll,this),this._containerId=d(a)},_initLayout:function(){var r=this._container;this._fadeAnimated=this.options.fadeAnimation&&gt.any3d,Dt(r,"leaflet-container"+(gt.touch?" leaflet-touch":"")+(gt.retina?" leaflet-retina":"")+(gt.ielt9?" leaflet-oldie":"")+(gt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var a=rr(r,"position");a!=="absolute"&&a!=="relative"&&a!=="fixed"&&a!=="sticky"&&(r.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var r=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),kt(this._mapPane,new ot(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Dt(r.markerPane,"leaflet-zoom-hide"),Dt(r.shadowPane,"leaflet-zoom-hide"))},_resetView:function(r,a,u){kt(this._mapPane,new ot(0,0));var f=!this._loaded;this._loaded=!0,a=this._limitZoom(a),this.fire("viewprereset");var g=this._zoom!==a;this._moveStart(g,u)._move(r,a)._moveEnd(g),this.fire("viewreset"),f&&this.fire("load")},_moveStart:function(r,a){return r&&this.fire("zoomstart"),a||this.fire("movestart"),this},_move:function(r,a,u,f){a===void 0&&(a=this._zoom);var g=this._zoom!==a;return this._zoom=a,this._lastCenter=r,this._pixelOrigin=this._getNewPixelOrigin(r),f?u&&u.pinch&&this.fire("zoom",u):((g||u&&u.pinch)&&this.fire("zoom",u),this.fire("move",u)),this},_moveEnd:function(r){return r&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return k(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(r){kt(this._mapPane,this._getMapPanePos().subtract(r))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(r){this._targets={},this._targets[d(this._container)]=this;var a=r?ce:Rt;a(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&a(window,"resize",this._onResize,this),gt.any3d&&this.options.transform3DLimit&&(r?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){k(this._resizeRequest),this._resizeRequest=D(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var r=this._getMapPanePos();Math.max(Math.abs(r.x),Math.abs(r.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(r,a){for(var u=[],f,g=a==="mouseout"||a==="mouseover",w=r.target||r.srcElement,x=!1;w;){if(f=this._targets[d(w)],f&&(a==="click"||a==="preclick")&&this._draggableMoved(f)){x=!0;break}if(f&&f.listens(a,!0)&&(g&&!Zo(w,r)||(u.push(f),g))||w===this._container)break;w=w.parentNode}return!u.length&&!x&&!g&&this.listens(a,!0)&&(u=[this]),u},_isClickDisabled:function(r){for(;r&&r!==this._container;){if(r._leaflet_disable_click)return!0;r=r.parentNode}},_handleDOMEvent:function(r){var a=r.target||r.srcElement;if(!(!this._loaded||a._leaflet_disable_events||r.type==="click"&&this._isClickDisabled(a))){var u=r.type;u==="mousedown"&&Oi(a),this._fireDOMEvent(r,u)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(r,a,u){if(r.type==="click"){var f=s({},r);f.type="preclick",this._fireDOMEvent(f,f.type,u)}var g=this._findEventTargets(r,a);if(u){for(var w=[],x=0;x<u.length;x++)u[x].listens(a,!0)&&w.push(u[x]);g=w.concat(g)}if(g.length){a==="contextmenu"&&Ee(r);var F=g[0],z={originalEvent:r};if(r.type!=="keypress"&&r.type!=="keydown"&&r.type!=="keyup"){var X=F.getLatLng&&(!F._radius||F._radius<=10);z.containerPoint=X?this.latLngToContainerPoint(F.getLatLng()):this.mouseEventToContainerPoint(r),z.layerPoint=this.containerPointToLayerPoint(z.containerPoint),z.latlng=X?F.getLatLng():this.layerPointToLatLng(z.layerPoint)}for(x=0;x<g.length;x++)if(g[x].fire(a,z,!0),z.originalEvent._stopped||g[x].options.bubblingMouseEvents===!1&&J(this._mouseEvents,a)!==-1)return}},_draggableMoved:function(r){return r=r.dragging&&r.dragging.enabled()?r:this,r.dragging&&r.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var r=0,a=this._handlers.length;r<a;r++)this._handlers[r].disable()},whenReady:function(r,a){return this._loaded?r.call(a||this,{target:this}):this.on("load",r,a),this},_getMapPanePos:function(){return Un(this._mapPane)||new ot(0,0)},_moved:function(){var r=this._getMapPanePos();return r&&!r.equals([0,0])},_getTopLeftPoint:function(r,a){var u=r&&a!==void 0?this._getNewPixelOrigin(r,a):this.getPixelOrigin();return u.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(r,a){var u=this.getSize()._divideBy(2);return this.project(r,a)._subtract(u)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(r,a,u){var f=this._getNewPixelOrigin(u,a);return this.project(r,a)._subtract(f)},_latLngBoundsToNewLayerBounds:function(r,a,u){var f=this._getNewPixelOrigin(u,a);return zt([this.project(r.getSouthWest(),a)._subtract(f),this.project(r.getNorthWest(),a)._subtract(f),this.project(r.getSouthEast(),a)._subtract(f),this.project(r.getNorthEast(),a)._subtract(f)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(r){return this.latLngToLayerPoint(r).subtract(this._getCenterLayerPoint())},_limitCenter:function(r,a,u){if(!u)return r;var f=this.project(r,a),g=this.getSize().divideBy(2),w=new Gt(f.subtract(g),f.add(g)),x=this._getBoundsOffset(w,u,a);return Math.abs(x.x)<=1&&Math.abs(x.y)<=1?r:this.unproject(f.add(x),a)},_limitOffset:function(r,a){if(!a)return r;var u=this.getPixelBounds(),f=new Gt(u.min.add(r),u.max.add(r));return r.add(this._getBoundsOffset(f,a))},_getBoundsOffset:function(r,a,u){var f=zt(this.project(a.getNorthEast(),u),this.project(a.getSouthWest(),u)),g=f.min.subtract(r.min),w=f.max.subtract(r.max),x=this._rebound(g.x,-w.x),F=this._rebound(g.y,-w.y);return new ot(x,F)},_rebound:function(r,a){return r+a>0?Math.round(r-a)/2:Math.max(0,Math.ceil(r))-Math.max(0,Math.floor(a))},_limitZoom:function(r){var a=this.getMinZoom(),u=this.getMaxZoom(),f=gt.any3d?this.options.zoomSnap:1;return f&&(r=Math.round(r/f)*f),Math.max(a,Math.min(u,r))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ye(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(r,a){var u=this._getCenterOffset(r)._trunc();return(a&&a.animate)!==!0&&!this.getSize().contains(u)?!1:(this.panBy(u,a),!0)},_createAnimProxy:function(){var r=this._proxy=Zt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(r),this.on("zoomanim",function(a){var u=Zr,f=this._proxy.style[u];ai(this._proxy,this.project(a.center,a.zoom),this.getZoomScale(a.zoom,1)),f===this._proxy.style[u]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){he(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var r=this.getCenter(),a=this.getZoom();ai(this._proxy,this.project(r,a),this.getZoomScale(a,1))},_catchTransitionEnd:function(r){this._animatingZoom&&r.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(r,a,u){if(this._animatingZoom)return!0;if(u=u||{},!this._zoomAnimated||u.animate===!1||this._nothingToAnimate()||Math.abs(a-this._zoom)>this.options.zoomAnimationThreshold)return!1;var f=this.getZoomScale(a),g=this._getCenterOffset(r)._divideBy(1-1/f);return u.animate!==!0&&!this.getSize().contains(g)?!1:(D(function(){this._moveStart(!0,u.noMoveStart||!1)._animateZoom(r,a,!0)},this),!0)},_animateZoom:function(r,a,u,f){this._mapPane&&(u&&(this._animatingZoom=!0,this._animateToCenter=r,this._animateToZoom=a,Dt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:r,zoom:a,noUpdate:f}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ye(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ks(r,a){return new $t(r,a)}var gn=qt.extend({options:{position:"topright"},initialize:function(r){B(this,r)},getPosition:function(){return this.options.position},setPosition:function(r){var a=this._map;return a&&a.removeControl(this),this.options.position=r,a&&a.addControl(this),this},getContainer:function(){return this._container},addTo:function(r){this.remove(),this._map=r;var a=this._container=this.onAdd(r),u=this.getPosition(),f=r._controlCorners[u];return Dt(a,"leaflet-control"),u.indexOf("bottom")!==-1?f.insertBefore(a,f.firstChild):f.appendChild(a),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(he(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(r){this._map&&r&&r.screenX>0&&r.screenY>0&&this._map.getContainer().focus()}}),hn=function(r){return new gn(r)};$t.include({addControl:function(r){return r.addTo(this),this},removeControl:function(r){return r.remove(),this},_initControlPos:function(){var r=this._controlCorners={},a="leaflet-",u=this._controlContainer=Zt("div",a+"control-container",this._container);function f(g,w){var x=a+g+" "+a+w;r[g+w]=Zt("div",x,u)}f("top","left"),f("top","right"),f("bottom","left"),f("bottom","right")},_clearControlPos:function(){for(var r in this._controlCorners)he(this._controlCorners[r]);he(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Yo=gn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(r,a,u,f){return u<f?-1:f<u?1:0}},initialize:function(r,a,u){B(this,u),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var f in r)this._addLayer(r[f],f);for(f in a)this._addLayer(a[f],f,!0)},onAdd:function(r){this._initLayout(),this._update(),this._map=r,r.on("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(r){return gn.prototype.addTo.call(this,r),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(r,a){return this._addLayer(r,a),this._map?this._update():this},addOverlay:function(r,a){return this._addLayer(r,a,!0),this._map?this._update():this},removeLayer:function(r){r.off("add remove",this._onLayerChange,this);var a=this._getLayer(d(r));return a&&this._layers.splice(this._layers.indexOf(a),1),this._map?this._update():this},expand:function(){Dt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var r=this._map.getSize().y-(this._container.offsetTop+50);return r<this._section.clientHeight?(Dt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=r+"px"):ye(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ye(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var r="leaflet-control-layers",a=this._container=Zt("div",r),u=this.options.collapsed;a.setAttribute("aria-haspopup",!0),lr(a),ar(a);var f=this._section=Zt("section",r+"-list");u&&(this._map.on("click",this.collapse,this),Rt(a,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var g=this._layersLink=Zt("a",r+"-toggle",a);g.href="#",g.title="Layers",g.setAttribute("role","button"),Rt(g,{keydown:function(w){w.keyCode===13&&this._expandSafely()},click:function(w){Ee(w),this._expandSafely()}},this),u||this.expand(),this._baseLayersList=Zt("div",r+"-base",f),this._separator=Zt("div",r+"-separator",f),this._overlaysList=Zt("div",r+"-overlays",f),a.appendChild(f)},_getLayer:function(r){for(var a=0;a<this._layers.length;a++)if(this._layers[a]&&d(this._layers[a].layer)===r)return this._layers[a]},_addLayer:function(r,a,u){this._map&&r.on("add remove",this._onLayerChange,this),this._layers.push({layer:r,name:a,overlay:u}),this.options.sortLayers&&this._layers.sort(l(function(f,g){return this.options.sortFunction(f.layer,g.layer,f.name,g.name)},this)),this.options.autoZIndex&&r.setZIndex&&(this._lastZIndex++,r.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Yr(this._baseLayersList),Yr(this._overlaysList),this._layerControlInputs=[];var r,a,u,f,g=0;for(u=0;u<this._layers.length;u++)f=this._layers[u],this._addItem(f),a=a||f.overlay,r=r||!f.overlay,g+=f.overlay?0:1;return this.options.hideSingleBase&&(r=r&&g>1,this._baseLayersList.style.display=r?"":"none"),this._separator.style.display=a&&r?"":"none",this},_onLayerChange:function(r){this._handlingClick||this._update();var a=this._getLayer(d(r.target)),u=a.overlay?r.type==="add"?"overlayadd":"overlayremove":r.type==="add"?"baselayerchange":null;u&&this._map.fire(u,a)},_createRadioElement:function(r,a){var u='<input type="radio" class="leaflet-control-layers-selector" name="'+r+'"'+(a?' checked="checked"':"")+"/>",f=document.createElement("div");return f.innerHTML=u,f.firstChild},_addItem:function(r){var a=document.createElement("label"),u=this._map.hasLayer(r.layer),f;r.overlay?(f=document.createElement("input"),f.type="checkbox",f.className="leaflet-control-layers-selector",f.defaultChecked=u):f=this._createRadioElement("leaflet-base-layers_"+d(this),u),this._layerControlInputs.push(f),f.layerId=d(r.layer),Rt(f,"click",this._onInputClick,this);var g=document.createElement("span");g.innerHTML=" "+r.name;var w=document.createElement("span");a.appendChild(w),w.appendChild(f),w.appendChild(g);var x=r.overlay?this._overlaysList:this._baseLayersList;return x.appendChild(a),this._checkDisabledLayers(),a},_onInputClick:function(){if(!this._preventClick){var r=this._layerControlInputs,a,u,f=[],g=[];this._handlingClick=!0;for(var w=r.length-1;w>=0;w--)a=r[w],u=this._getLayer(a.layerId).layer,a.checked?f.push(u):a.checked||g.push(u);for(w=0;w<g.length;w++)this._map.hasLayer(g[w])&&this._map.removeLayer(g[w]);for(w=0;w<f.length;w++)this._map.hasLayer(f[w])||this._map.addLayer(f[w]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var r=this._layerControlInputs,a,u,f=this._map.getZoom(),g=r.length-1;g>=0;g--)a=r[g],u=this._getLayer(a.layerId).layer,a.disabled=u.options.minZoom!==void 0&&f<u.options.minZoom||u.options.maxZoom!==void 0&&f>u.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var r=this._section;this._preventClick=!0,Rt(r,"click",Ee),this.expand();var a=this;setTimeout(function(){ce(r,"click",Ee),a._preventClick=!1})}}),Mu=function(r,a,u){return new Yo(r,a,u)},Mi=gn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(r){var a="leaflet-control-zoom",u=Zt("div",a+" leaflet-bar"),f=this.options;return this._zoomInButton=this._createButton(f.zoomInText,f.zoomInTitle,a+"-in",u,this._zoomIn),this._zoomOutButton=this._createButton(f.zoomOutText,f.zoomOutTitle,a+"-out",u,this._zoomOut),this._updateDisabled(),r.on("zoomend zoomlevelschange",this._updateDisabled,this),u},onRemove:function(r){r.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(r){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(r.shiftKey?3:1))},_zoomOut:function(r){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(r.shiftKey?3:1))},_createButton:function(r,a,u,f,g){var w=Zt("a",u,f);return w.innerHTML=r,w.href="#",w.title=a,w.setAttribute("role","button"),w.setAttribute("aria-label",a),lr(w),Rt(w,"click",Rn),Rt(w,"click",g,this),Rt(w,"click",this._refocusOnMap,this),w},_updateDisabled:function(){var r=this._map,a="leaflet-disabled";ye(this._zoomInButton,a),ye(this._zoomOutButton,a),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||r._zoom===r.getMinZoom())&&(Dt(this._zoomOutButton,a),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||r._zoom===r.getMaxZoom())&&(Dt(this._zoomInButton,a),this._zoomInButton.setAttribute("aria-disabled","true"))}});$t.mergeOptions({zoomControl:!0}),$t.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Mi,this.addControl(this.zoomControl))});var kl=function(r){return new Mi(r)},Ls=gn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(r){var a="leaflet-control-scale",u=Zt("div",a),f=this.options;return this._addScales(f,a+"-line",u),r.on(f.updateWhenIdle?"moveend":"move",this._update,this),r.whenReady(this._update,this),u},onRemove:function(r){r.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(r,a,u){r.metric&&(this._mScale=Zt("div",a,u)),r.imperial&&(this._iScale=Zt("div",a,u))},_update:function(){var r=this._map,a=r.getSize().y/2,u=r.distance(r.containerPointToLatLng([0,a]),r.containerPointToLatLng([this.options.maxWidth,a]));this._updateScales(u)},_updateScales:function(r){this.options.metric&&r&&this._updateMetric(r),this.options.imperial&&r&&this._updateImperial(r)},_updateMetric:function(r){var a=this._getRoundNum(r),u=a<1e3?a+" m":a/1e3+" km";this._updateScale(this._mScale,u,a/r)},_updateImperial:function(r){var a=r*3.2808399,u,f,g;a>5280?(u=a/5280,f=this._getRoundNum(u),this._updateScale(this._iScale,f+" mi",f/u)):(g=this._getRoundNum(a),this._updateScale(this._iScale,g+" ft",g/a))},_updateScale:function(r,a,u){r.style.width=Math.round(this.options.maxWidth*u)+"px",r.innerHTML=a},_getRoundNum:function(r){var a=Math.pow(10,(Math.floor(r)+"").length-1),u=r/a;return u=u>=10?10:u>=5?5:u>=3?3:u>=2?2:1,a*u}}),Os=function(r){return new Ls(r)},Ll='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',cr=gn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(gt.inlineSvg?Ll+" ":"")+"Leaflet</a>"},initialize:function(r){B(this,r),this._attributions={}},onAdd:function(r){r.attributionControl=this,this._container=Zt("div","leaflet-control-attribution"),lr(this._container);for(var a in r._layers)r._layers[a].getAttribution&&this.addAttribution(r._layers[a].getAttribution());return this._update(),r.on("layeradd",this._addAttribution,this),this._container},onRemove:function(r){r.off("layeradd",this._addAttribution,this)},_addAttribution:function(r){r.layer.getAttribution&&(this.addAttribution(r.layer.getAttribution()),r.layer.once("remove",function(){this.removeAttribution(r.layer.getAttribution())},this))},setPrefix:function(r){return this.options.prefix=r,this._update(),this},addAttribution:function(r){return r?(this._attributions[r]||(this._attributions[r]=0),this._attributions[r]++,this._update(),this):this},removeAttribution:function(r){return r?(this._attributions[r]&&(this._attributions[r]--,this._update()),this):this},_update:function(){if(this._map){var r=[];for(var a in this._attributions)this._attributions[a]&&r.push(a);var u=[];this.options.prefix&&u.push(this.options.prefix),r.length&&u.push(r.join(", ")),this._container.innerHTML=u.join(' <span aria-hidden="true">|</span> ')}}});$t.mergeOptions({attributionControl:!0}),$t.addInitHook(function(){this.options.attributionControl&&new cr().addTo(this)});var Du=function(r){return new cr(r)};gn.Layers=Yo,gn.Zoom=Mi,gn.Scale=Ls,gn.Attribution=cr,hn.layers=Mu,hn.zoom=kl,hn.scale=Os,hn.attribution=Du;var Cn=qt.extend({initialize:function(r){this._map=r},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Cn.addTo=function(r,a){return r.addHandler(a,this),this};var Xr={Events:Xt},Xo=gt.touch?"touchstart mousedown":"mousedown",ti=Ut.extend({options:{clickTolerance:3},initialize:function(r,a,u,f){B(this,f),this._element=r,this._dragStartTarget=a||r,this._preventOutline=u},enable:function(){this._enabled||(Rt(this._dragStartTarget,Xo,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ti._dragging===this&&this.finishDrag(!0),ce(this._dragStartTarget,Xo,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(r){if(this._enabled&&(this._moved=!1,!Fo(this._element,"leaflet-zoom-anim"))){if(r.touches&&r.touches.length!==1){ti._dragging===this&&this.finishDrag();return}if(!(ti._dragging||r.shiftKey||r.which!==1&&r.button!==1&&!r.touches)&&(ti._dragging=this,this._preventOutline&&Oi(this._element),jo(),Xn(),!this._moving)){this.fire("down");var a=r.touches?r.touches[0]:r,u=Wo(this._element);this._startPoint=new ot(a.clientX,a.clientY),this._startPos=Un(this._element),this._parentScale=Ss(u);var f=r.type==="mousedown";Rt(document,f?"mousemove":"touchmove",this._onMove,this),Rt(document,f?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(r){if(this._enabled){if(r.touches&&r.touches.length>1){this._moved=!0;return}var a=r.touches&&r.touches.length===1?r.touches[0]:r,u=new ot(a.clientX,a.clientY)._subtract(this._startPoint);!u.x&&!u.y||Math.abs(u.x)+Math.abs(u.y)<this.options.clickTolerance||(u.x/=this._parentScale.x,u.y/=this._parentScale.y,Ee(r),this._moved||(this.fire("dragstart"),this._moved=!0,Dt(document.body,"leaflet-dragging"),this._lastTarget=r.target||r.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Dt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(u),this._moving=!0,this._lastEvent=r,this._updatePosition())}},_updatePosition:function(){var r={originalEvent:this._lastEvent};this.fire("predrag",r),kt(this._element,this._newPos),this.fire("drag",r)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(r){ye(document.body,"leaflet-dragging"),this._lastTarget&&(ye(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),ce(document,"mousemove touchmove",this._onMove,this),ce(document,"mouseup touchend touchcancel",this._onUp,this),Ho(),Jn();var a=this._moved&&this._moving;this._moving=!1,ti._dragging=!1,a&&this.fire("dragend",{noInertia:r,distance:this._newPos.distanceTo(this._startPos)})}});function Ms(r,a,u){var f,g=[1,4,2,8],w,x,F,z,X,ht,Ct,Ht;for(w=0,ht=r.length;w<ht;w++)r[w]._code=li(r[w],a);for(F=0;F<4;F++){for(Ct=g[F],f=[],w=0,ht=r.length,x=ht-1;w<ht;x=w++)z=r[w],X=r[x],z._code&Ct?X._code&Ct||(Ht=je(X,z,Ct,a,u),Ht._code=li(Ht,a),f.push(Ht)):(X._code&Ct&&(Ht=je(X,z,Ct,a,u),Ht._code=li(Ht,a),f.push(Ht)),f.push(z));r=f}return r}function Ds(r,a){var u,f,g,w,x,F,z,X,ht;if(!r||r.length===0)throw new Error("latlngs not passed");c(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var Ct=At([0,0]),Ht=ae(r),dn=Ht.getNorthWest().distanceTo(Ht.getSouthWest())*Ht.getNorthEast().distanceTo(Ht.getNorthWest());dn<1700&&(Ct=Ns(r));var He=r.length,Hn=[];for(u=0;u<He;u++){var vn=At(r[u]);Hn.push(a.project(At([vn.lat-Ct.lat,vn.lng-Ct.lng])))}for(F=z=X=0,u=0,f=He-1;u<He;f=u++)g=Hn[u],w=Hn[f],x=g.y*w.x-w.y*g.x,z+=(g.x+w.x)*x,X+=(g.y+w.y)*x,F+=x*3;F===0?ht=Hn[0]:ht=[z/F,X/F];var Hs=a.unproject(vt(ht));return At([Hs.lat+Ct.lat,Hs.lng+Ct.lng])}function Ns(r){for(var a=0,u=0,f=0,g=0;g<r.length;g++){var w=At(r[g]);a+=w.lat,u+=w.lng,f++}return At([a/f,u/f])}var Vs={__proto__:null,clipPolygon:Ms,polygonCenter:Ds,centroid:Ns};function Jo(r,a){if(!a||!r.length)return r.slice();var u=a*a;return r=Ml(r,u),r=Ol(r,u),r}function ta(r,a,u){return Math.sqrt(jn(r,a,u,!0))}function Di(r,a,u){return jn(r,a,u)}function Ol(r,a){var u=r.length,f=typeof Uint8Array<"u"?Uint8Array:Array,g=new f(u);g[0]=g[u-1]=1,Us(r,g,a,0,u-1);var w,x=[];for(w=0;w<u;w++)g[w]&&x.push(r[w]);return x}function Us(r,a,u,f,g){var w=0,x,F,z;for(F=f+1;F<=g-1;F++)z=jn(r[F],r[f],r[g],!0),z>w&&(x=F,w=z);w>u&&(a[x]=1,Us(r,a,u,f,x),Us(r,a,u,x,g))}function Ml(r,a){for(var u=[r[0]],f=1,g=0,w=r.length;f<w;f++)Dl(r[f],r[g])>a&&(u.push(r[f]),g=f);return g<w-1&&u.push(r[w-1]),u}var ea;function Jr(r,a,u,f,g){var w=f?ea:li(r,u),x=li(a,u),F,z,X;for(ea=x;;){if(!(w|x))return[r,a];if(w&x)return!1;F=w||x,z=je(r,a,F,u,g),X=li(z,u),F===w?(r=z,w=X):(a=z,x=X)}}function je(r,a,u,f,g){var w=a.x-r.x,x=a.y-r.y,F=f.min,z=f.max,X,ht;return u&8?(X=r.x+w*(z.y-r.y)/x,ht=z.y):u&4?(X=r.x+w*(F.y-r.y)/x,ht=F.y):u&2?(X=z.x,ht=r.y+x*(z.x-r.x)/w):u&1&&(X=F.x,ht=r.y+x*(F.x-r.x)/w),new ot(X,ht,g)}function li(r,a){var u=0;return r.x<a.min.x?u|=1:r.x>a.max.x&&(u|=2),r.y<a.min.y?u|=4:r.y>a.max.y&&(u|=8),u}function Dl(r,a){var u=a.x-r.x,f=a.y-r.y;return u*u+f*f}function jn(r,a,u,f){var g=a.x,w=a.y,x=u.x-g,F=u.y-w,z=x*x+F*F,X;return z>0&&(X=((r.x-g)*x+(r.y-w)*F)/z,X>1?(g=u.x,w=u.y):X>0&&(g+=x*X,w+=F*X)),x=r.x-g,F=r.y-w,f?x*x+F*F:new ot(g,w)}function c(r){return!Q(r[0])||typeof r[0][0]!="object"&&typeof r[0][0]<"u"}function m(r){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),c(r)}function y(r,a){var u,f,g,w,x,F,z,X;if(!r||r.length===0)throw new Error("latlngs not passed");c(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var ht=At([0,0]),Ct=ae(r),Ht=Ct.getNorthWest().distanceTo(Ct.getSouthWest())*Ct.getNorthEast().distanceTo(Ct.getNorthWest());Ht<1700&&(ht=Ns(r));var dn=r.length,He=[];for(u=0;u<dn;u++){var Hn=At(r[u]);He.push(a.project(At([Hn.lat-ht.lat,Hn.lng-ht.lng])))}for(u=0,f=0;u<dn-1;u++)f+=He[u].distanceTo(He[u+1])/2;if(f===0)X=He[0];else for(u=0,w=0;u<dn-1;u++)if(x=He[u],F=He[u+1],g=x.distanceTo(F),w+=g,w>f){z=(w-f)/g,X=[F.x-z*(F.x-x.x),F.y-z*(F.y-x.y)];break}var vn=a.unproject(vt(X));return At([vn.lat+ht.lat,vn.lng+ht.lng])}var E={__proto__:null,simplify:Jo,pointToSegmentDistance:ta,closestPointOnSegment:Di,clipSegment:Jr,_getEdgeIntersection:je,_getBitCode:li,_sqClosestPointOnSegment:jn,isFlat:c,_flat:m,polylineCenter:y},U={project:function(r){return new ot(r.lng,r.lat)},unproject:function(r){return new Ft(r.y,r.x)},bounds:new Gt([-180,-90],[180,90])},j={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Gt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(r){var a=Math.PI/180,u=this.R,f=r.lat*a,g=this.R_MINOR/u,w=Math.sqrt(1-g*g),x=w*Math.sin(f),F=Math.tan(Math.PI/4-f/2)/Math.pow((1-x)/(1+x),w/2);return f=-u*Math.log(Math.max(F,1e-10)),new ot(r.lng*a*u,f)},unproject:function(r){for(var a=180/Math.PI,u=this.R,f=this.R_MINOR/u,g=Math.sqrt(1-f*f),w=Math.exp(-r.y/u),x=Math.PI/2-2*Math.atan(w),F=0,z=.1,X;F<15&&Math.abs(z)>1e-7;F++)X=g*Math.sin(x),X=Math.pow((1-X)/(1+X),g/2),z=Math.PI/2-2*Math.atan(w*X)-x,x+=z;return new Ft(x*a,r.x*a/u)}},rt={__proto__:null,LonLat:U,Mercator:j,SphericalMercator:mt},le=s({},at,{code:"EPSG:3395",projection:j,transformation:function(){var r=.5/(Math.PI*j.R);return P(r,.5,-r,.5)}()}),Oe=s({},at,{code:"EPSG:4326",projection:U,transformation:P(1/180,1,-1/180,.5)}),Jt=s({},q,{projection:U,transformation:P(1,0,-1,0),scale:function(r){return Math.pow(2,r)},zoom:function(r){return Math.log(r)/Math.LN2},distance:function(r,a){var u=a.lng-r.lng,f=a.lat-r.lat;return Math.sqrt(u*u+f*f)},infinite:!0});q.Earth=at,q.EPSG3395=le,q.EPSG3857=R,q.EPSG900913=N,q.EPSG4326=Oe,q.Simple=Jt;var ue=Ut.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(r){return r.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(r){return r&&r.removeLayer(this),this},getPane:function(r){return this._map.getPane(r?this.options[r]||r:this.options.pane)},addInteractiveTarget:function(r){return this._map._targets[d(r)]=this,this},removeInteractiveTarget:function(r){return delete this._map._targets[d(r)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(r){var a=r.target;if(a.hasLayer(this)){if(this._map=a,this._zoomAnimated=a._zoomAnimated,this.getEvents){var u=this.getEvents();a.on(u,this),this.once("remove",function(){a.off(u,this)},this)}this.onAdd(a),this.fire("add"),a.fire("layeradd",{layer:this})}}});$t.include({addLayer:function(r){if(!r._layerAdd)throw new Error("The provided object is not a Layer.");var a=d(r);return this._layers[a]?this:(this._layers[a]=r,r._mapToAdd=this,r.beforeAdd&&r.beforeAdd(this),this.whenReady(r._layerAdd,r),this)},removeLayer:function(r){var a=d(r);return this._layers[a]?(this._loaded&&r.onRemove(this),delete this._layers[a],this._loaded&&(this.fire("layerremove",{layer:r}),r.fire("remove")),r._map=r._mapToAdd=null,this):this},hasLayer:function(r){return d(r)in this._layers},eachLayer:function(r,a){for(var u in this._layers)r.call(a,this._layers[u]);return this},_addLayers:function(r){r=r?Q(r)?r:[r]:[];for(var a=0,u=r.length;a<u;a++)this.addLayer(r[a])},_addZoomLimit:function(r){(!isNaN(r.options.maxZoom)||!isNaN(r.options.minZoom))&&(this._zoomBoundLayers[d(r)]=r,this._updateZoomLevels())},_removeZoomLimit:function(r){var a=d(r);this._zoomBoundLayers[a]&&(delete this._zoomBoundLayers[a],this._updateZoomLevels())},_updateZoomLevels:function(){var r=1/0,a=-1/0,u=this._getZoomSpan();for(var f in this._zoomBoundLayers){var g=this._zoomBoundLayers[f].options;r=g.minZoom===void 0?r:Math.min(r,g.minZoom),a=g.maxZoom===void 0?a:Math.max(a,g.maxZoom)}this._layersMaxZoom=a===-1/0?void 0:a,this._layersMinZoom=r===1/0?void 0:r,u!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var be=ue.extend({initialize:function(r,a){B(this,a),this._layers={};var u,f;if(r)for(u=0,f=r.length;u<f;u++)this.addLayer(r[u])},addLayer:function(r){var a=this.getLayerId(r);return this._layers[a]=r,this._map&&this._map.addLayer(r),this},removeLayer:function(r){var a=r in this._layers?r:this.getLayerId(r);return this._map&&this._layers[a]&&this._map.removeLayer(this._layers[a]),delete this._layers[a],this},hasLayer:function(r){var a=typeof r=="number"?r:this.getLayerId(r);return a in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(r){var a=Array.prototype.slice.call(arguments,1),u,f;for(u in this._layers)f=this._layers[u],f[r]&&f[r].apply(f,a);return this},onAdd:function(r){this.eachLayer(r.addLayer,r)},onRemove:function(r){this.eachLayer(r.removeLayer,r)},eachLayer:function(r,a){for(var u in this._layers)r.call(a,this._layers[u]);return this},getLayer:function(r){return this._layers[r]},getLayers:function(){var r=[];return this.eachLayer(r.push,r),r},setZIndex:function(r){return this.invoke("setZIndex",r)},getLayerId:function(r){return d(r)}}),ur=function(r,a){return new be(r,a)},Se=be.extend({addLayer:function(r){return this.hasLayer(r)?this:(r.addEventParent(this),be.prototype.addLayer.call(this,r),this.fire("layeradd",{layer:r}))},removeLayer:function(r){return this.hasLayer(r)?(r in this._layers&&(r=this._layers[r]),r.removeEventParent(this),be.prototype.removeLayer.call(this,r),this.fire("layerremove",{layer:r})):this},setStyle:function(r){return this.invoke("setStyle",r)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var r=new jt;for(var a in this._layers){var u=this._layers[a];r.extend(u.getBounds?u.getBounds():u.getLatLng())}return r}}),Fs=function(r,a){return new Se(r,a)},ci=qt.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(r){B(this,r)},createIcon:function(r){return this._createIcon("icon",r)},createShadow:function(r){return this._createIcon("shadow",r)},_createIcon:function(r,a){var u=this._getIconUrl(r);if(!u){if(r==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var f=this._createImg(u,a&&a.tagName==="IMG"?a:null);return this._setIconStyles(f,r),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),f},_setIconStyles:function(r,a){var u=this.options,f=u[a+"Size"];typeof f=="number"&&(f=[f,f]);var g=vt(f),w=vt(a==="shadow"&&u.shadowAnchor||u.iconAnchor||g&&g.divideBy(2,!0));r.className="leaflet-marker-"+a+" "+(u.className||""),w&&(r.style.marginLeft=-w.x+"px",r.style.marginTop=-w.y+"px"),g&&(r.style.width=g.x+"px",r.style.height=g.y+"px")},_createImg:function(r,a){return a=a||document.createElement("img"),a.src=r,a},_getIconUrl:function(r){return gt.retina&&this.options[r+"RetinaUrl"]||this.options[r+"Url"]}});function jw(r){return new ci(r)}var na=ci.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(r){return typeof na.imagePath!="string"&&(na.imagePath=this._detectIconPath()),(this.options.imagePath||na.imagePath)+ci.prototype._getIconUrl.call(this,r)},_stripUrl:function(r){var a=function(u,f,g){var w=f.exec(u);return w&&w[g]};return r=a(r,/^url\((['"])?(.+)\1\)$/,2),r&&a(r,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var r=Zt("div","leaflet-default-icon-path",document.body),a=rr(r,"background-image")||rr(r,"backgroundImage");if(document.body.removeChild(r),a=this._stripUrl(a),a)return a;var u=document.querySelector('link[href$="leaflet.css"]');return u?u.href.substring(0,u.href.length-11-1):""}}),kf=Cn.extend({initialize:function(r){this._marker=r},addHooks:function(){var r=this._marker._icon;this._draggable||(this._draggable=new ti(r,r,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Dt(r,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ye(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(r){var a=this._marker,u=a._map,f=this._marker.options.autoPanSpeed,g=this._marker.options.autoPanPadding,w=Un(a._icon),x=u.getPixelBounds(),F=u.getPixelOrigin(),z=zt(x.min._subtract(F).add(g),x.max._subtract(F).subtract(g));if(!z.contains(w)){var X=vt((Math.max(z.max.x,w.x)-z.max.x)/(x.max.x-z.max.x)-(Math.min(z.min.x,w.x)-z.min.x)/(x.min.x-z.min.x),(Math.max(z.max.y,w.y)-z.max.y)/(x.max.y-z.max.y)-(Math.min(z.min.y,w.y)-z.min.y)/(x.min.y-z.min.y)).multiplyBy(f);u.panBy(X,{animate:!1}),this._draggable._newPos._add(X),this._draggable._startPos._add(X),kt(a._icon,this._draggable._newPos),this._onDrag(r),this._panRequest=D(this._adjustPan.bind(this,r))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(r){this._marker.options.autoPan&&(k(this._panRequest),this._panRequest=D(this._adjustPan.bind(this,r)))},_onDrag:function(r){var a=this._marker,u=a._shadow,f=Un(a._icon),g=a._map.layerPointToLatLng(f);u&&kt(u,f),a._latlng=g,r.latlng=g,r.oldLatLng=this._oldLatLng,a.fire("move",r).fire("drag",r)},_onDragEnd:function(r){k(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",r)}}),Nl=ue.extend({options:{icon:new na,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(r,a){B(this,a),this._latlng=At(r)},onAdd:function(r){this._zoomAnimated=this._zoomAnimated&&r.options.markerZoomAnimation,this._zoomAnimated&&r.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(r){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&r.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(r){var a=this._latlng;return this._latlng=At(r),this.update(),this.fire("move",{oldLatLng:a,latlng:this._latlng})},setZIndexOffset:function(r){return this.options.zIndexOffset=r,this.update()},getIcon:function(){return this.options.icon},setIcon:function(r){return this.options.icon=r,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var r=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(r)}return this},_initIcon:function(){var r=this.options,a="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),u=r.icon.createIcon(this._icon),f=!1;u!==this._icon&&(this._icon&&this._removeIcon(),f=!0,r.title&&(u.title=r.title),u.tagName==="IMG"&&(u.alt=r.alt||"")),Dt(u,a),r.keyboard&&(u.tabIndex="0",u.setAttribute("role","button")),this._icon=u,r.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Rt(u,"focus",this._panOnFocus,this);var g=r.icon.createShadow(this._shadow),w=!1;g!==this._shadow&&(this._removeShadow(),w=!0),g&&(Dt(g,a),g.alt=""),this._shadow=g,r.opacity<1&&this._updateOpacity(),f&&this.getPane().appendChild(this._icon),this._initInteraction(),g&&w&&this.getPane(r.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ce(this._icon,"focus",this._panOnFocus,this),he(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&he(this._shadow),this._shadow=null},_setPos:function(r){this._icon&&kt(this._icon,r),this._shadow&&kt(this._shadow,r),this._zIndex=r.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(r){this._icon&&(this._icon.style.zIndex=this._zIndex+r)},_animateZoom:function(r){var a=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center).round();this._setPos(a)},_initInteraction:function(){if(this.options.interactive&&(Dt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),kf)){var r=this.options.draggable;this.dragging&&(r=this.dragging.enabled(),this.dragging.disable()),this.dragging=new kf(this),r&&this.dragging.enable()}},setOpacity:function(r){return this.options.opacity=r,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var r=this.options.opacity;this._icon&&Pe(this._icon,r),this._shadow&&Pe(this._shadow,r)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var r=this._map;if(r){var a=this.options.icon.options,u=a.iconSize?vt(a.iconSize):vt(0,0),f=a.iconAnchor?vt(a.iconAnchor):vt(0,0);r.panInside(this._latlng,{paddingTopLeft:f,paddingBottomRight:u.subtract(f)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Hw(r,a){return new Nl(r,a)}var hr=ue.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(r){this._renderer=r.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(r){return B(this,r),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&r&&Object.prototype.hasOwnProperty.call(r,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Vl=hr.extend({options:{fill:!0,radius:10},initialize:function(r,a){B(this,a),this._latlng=At(r),this._radius=this.options.radius},setLatLng:function(r){var a=this._latlng;return this._latlng=At(r),this.redraw(),this.fire("move",{oldLatLng:a,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(r){return this.options.radius=this._radius=r,this.redraw()},getRadius:function(){return this._radius},setStyle:function(r){var a=r&&r.radius||this._radius;return hr.prototype.setStyle.call(this,r),this.setRadius(a),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var r=this._radius,a=this._radiusY||r,u=this._clickTolerance(),f=[r+u,a+u];this._pxBounds=new Gt(this._point.subtract(f),this._point.add(f))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(r){return r.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function qw(r,a){return new Vl(r,a)}var Nu=Vl.extend({initialize:function(r,a,u){if(typeof a=="number"&&(a=s({},u,{radius:a})),B(this,a),this._latlng=At(r),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(r){return this._mRadius=r,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var r=[this._radius,this._radiusY||this._radius];return new jt(this._map.layerPointToLatLng(this._point.subtract(r)),this._map.layerPointToLatLng(this._point.add(r)))},setStyle:hr.prototype.setStyle,_project:function(){var r=this._latlng.lng,a=this._latlng.lat,u=this._map,f=u.options.crs;if(f.distance===at.distance){var g=Math.PI/180,w=this._mRadius/at.R/g,x=u.project([a+w,r]),F=u.project([a-w,r]),z=x.add(F).divideBy(2),X=u.unproject(z).lat,ht=Math.acos((Math.cos(w*g)-Math.sin(a*g)*Math.sin(X*g))/(Math.cos(a*g)*Math.cos(X*g)))/g;(isNaN(ht)||ht===0)&&(ht=w/Math.cos(Math.PI/180*a)),this._point=z.subtract(u.getPixelOrigin()),this._radius=isNaN(ht)?0:z.x-u.project([X,r-ht]).x,this._radiusY=z.y-x.y}else{var Ct=f.unproject(f.project(this._latlng).subtract([this._mRadius,0]));this._point=u.latLngToLayerPoint(this._latlng),this._radius=this._point.x-u.latLngToLayerPoint(Ct).x}this._updateBounds()}});function Ww(r,a,u){return new Nu(r,a,u)}var Ni=hr.extend({options:{smoothFactor:1,noClip:!1},initialize:function(r,a){B(this,a),this._setLatLngs(r)},getLatLngs:function(){return this._latlngs},setLatLngs:function(r){return this._setLatLngs(r),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(r){for(var a=1/0,u=null,f=jn,g,w,x=0,F=this._parts.length;x<F;x++)for(var z=this._parts[x],X=1,ht=z.length;X<ht;X++){g=z[X-1],w=z[X];var Ct=f(r,g,w,!0);Ct<a&&(a=Ct,u=f(r,g,w))}return u&&(u.distance=Math.sqrt(a)),u},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return y(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(r,a){return a=a||this._defaultShape(),r=At(r),a.push(r),this._bounds.extend(r),this.redraw()},_setLatLngs:function(r){this._bounds=new jt,this._latlngs=this._convertLatLngs(r)},_defaultShape:function(){return c(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(r){for(var a=[],u=c(r),f=0,g=r.length;f<g;f++)u?(a[f]=At(r[f]),this._bounds.extend(a[f])):a[f]=this._convertLatLngs(r[f]);return a},_project:function(){var r=new Gt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,r),this._bounds.isValid()&&r.isValid()&&(this._rawPxBounds=r,this._updateBounds())},_updateBounds:function(){var r=this._clickTolerance(),a=new ot(r,r);this._rawPxBounds&&(this._pxBounds=new Gt([this._rawPxBounds.min.subtract(a),this._rawPxBounds.max.add(a)]))},_projectLatlngs:function(r,a,u){var f=r[0]instanceof Ft,g=r.length,w,x;if(f){for(x=[],w=0;w<g;w++)x[w]=this._map.latLngToLayerPoint(r[w]),u.extend(x[w]);a.push(x)}else for(w=0;w<g;w++)this._projectLatlngs(r[w],a,u)},_clipPoints:function(){var r=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}var a=this._parts,u,f,g,w,x,F,z;for(u=0,g=0,w=this._rings.length;u<w;u++)for(z=this._rings[u],f=0,x=z.length;f<x-1;f++)F=Jr(z[f],z[f+1],r,f,!0),F&&(a[g]=a[g]||[],a[g].push(F[0]),(F[1]!==z[f+1]||f===x-2)&&(a[g].push(F[1]),g++))}},_simplifyPoints:function(){for(var r=this._parts,a=this.options.smoothFactor,u=0,f=r.length;u<f;u++)r[u]=Jo(r[u],a)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(r,a){var u,f,g,w,x,F,z=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(u=0,w=this._parts.length;u<w;u++)for(F=this._parts[u],f=0,x=F.length,g=x-1;f<x;g=f++)if(!(!a&&f===0)&&ta(r,F[g],F[f])<=z)return!0;return!1}});function $w(r,a){return new Ni(r,a)}Ni._flat=m;var Bs=Ni.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ds(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(r){var a=Ni.prototype._convertLatLngs.call(this,r),u=a.length;return u>=2&&a[0]instanceof Ft&&a[0].equals(a[u-1])&&a.pop(),a},_setLatLngs:function(r){Ni.prototype._setLatLngs.call(this,r),c(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return c(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var r=this._renderer._bounds,a=this.options.weight,u=new ot(a,a);if(r=new Gt(r.min.subtract(u),r.max.add(u)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}for(var f=0,g=this._rings.length,w;f<g;f++)w=Ms(this._rings[f],r,!0),w.length&&this._parts.push(w)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(r){var a=!1,u,f,g,w,x,F,z,X;if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(w=0,z=this._parts.length;w<z;w++)for(u=this._parts[w],x=0,X=u.length,F=X-1;x<X;F=x++)f=u[x],g=u[F],f.y>r.y!=g.y>r.y&&r.x<(g.x-f.x)*(r.y-f.y)/(g.y-f.y)+f.x&&(a=!a);return a||Ni.prototype._containsPoint.call(this,r,!0)}});function Gw(r,a){return new Bs(r,a)}var Vi=Se.extend({initialize:function(r,a){B(this,a),this._layers={},r&&this.addData(r)},addData:function(r){var a=Q(r)?r:r.features,u,f,g;if(a){for(u=0,f=a.length;u<f;u++)g=a[u],(g.geometries||g.geometry||g.features||g.coordinates)&&this.addData(g);return this}var w=this.options;if(w.filter&&!w.filter(r))return this;var x=Ul(r,w);return x?(x.feature=zl(r),x.defaultOptions=x.options,this.resetStyle(x),w.onEachFeature&&w.onEachFeature(r,x),this.addLayer(x)):this},resetStyle:function(r){return r===void 0?this.eachLayer(this.resetStyle,this):(r.options=s({},r.defaultOptions),this._setLayerStyle(r,this.options.style),this)},setStyle:function(r){return this.eachLayer(function(a){this._setLayerStyle(a,r)},this)},_setLayerStyle:function(r,a){r.setStyle&&(typeof a=="function"&&(a=a(r.feature)),r.setStyle(a))}});function Ul(r,a){var u=r.type==="Feature"?r.geometry:r,f=u?u.coordinates:null,g=[],w=a&&a.pointToLayer,x=a&&a.coordsToLatLng||Vu,F,z,X,ht;if(!f&&!u)return null;switch(u.type){case"Point":return F=x(f),Lf(w,r,F,a);case"MultiPoint":for(X=0,ht=f.length;X<ht;X++)F=x(f[X]),g.push(Lf(w,r,F,a));return new Se(g);case"LineString":case"MultiLineString":return z=Fl(f,u.type==="LineString"?0:1,x),new Ni(z,a);case"Polygon":case"MultiPolygon":return z=Fl(f,u.type==="Polygon"?1:2,x),new Bs(z,a);case"GeometryCollection":for(X=0,ht=u.geometries.length;X<ht;X++){var Ct=Ul({geometry:u.geometries[X],type:"Feature",properties:r.properties},a);Ct&&g.push(Ct)}return new Se(g);case"FeatureCollection":for(X=0,ht=u.features.length;X<ht;X++){var Ht=Ul(u.features[X],a);Ht&&g.push(Ht)}return new Se(g);default:throw new Error("Invalid GeoJSON object.")}}function Lf(r,a,u,f){return r?r(a,u):new Nl(u,f&&f.markersInheritOptions&&f)}function Vu(r){return new Ft(r[1],r[0],r[2])}function Fl(r,a,u){for(var f=[],g=0,w=r.length,x;g<w;g++)x=a?Fl(r[g],a-1,u):(u||Vu)(r[g]),f.push(x);return f}function Uu(r,a){return r=At(r),r.alt!==void 0?[T(r.lng,a),T(r.lat,a),T(r.alt,a)]:[T(r.lng,a),T(r.lat,a)]}function Bl(r,a,u,f){for(var g=[],w=0,x=r.length;w<x;w++)g.push(a?Bl(r[w],c(r[w])?0:a-1,u,f):Uu(r[w],f));return!a&&u&&g.length>0&&g.push(g[0].slice()),g}function zs(r,a){return r.feature?s({},r.feature,{geometry:a}):zl(a)}function zl(r){return r.type==="Feature"||r.type==="FeatureCollection"?r:{type:"Feature",properties:{},geometry:r}}var Fu={toGeoJSON:function(r){return zs(this,{type:"Point",coordinates:Uu(this.getLatLng(),r)})}};Nl.include(Fu),Nu.include(Fu),Vl.include(Fu),Ni.include({toGeoJSON:function(r){var a=!c(this._latlngs),u=Bl(this._latlngs,a?1:0,!1,r);return zs(this,{type:(a?"Multi":"")+"LineString",coordinates:u})}}),Bs.include({toGeoJSON:function(r){var a=!c(this._latlngs),u=a&&!c(this._latlngs[0]),f=Bl(this._latlngs,u?2:a?1:0,!0,r);return a||(f=[f]),zs(this,{type:(u?"Multi":"")+"Polygon",coordinates:f})}}),be.include({toMultiPoint:function(r){var a=[];return this.eachLayer(function(u){a.push(u.toGeoJSON(r).geometry.coordinates)}),zs(this,{type:"MultiPoint",coordinates:a})},toGeoJSON:function(r){var a=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(a==="MultiPoint")return this.toMultiPoint(r);var u=a==="GeometryCollection",f=[];return this.eachLayer(function(g){if(g.toGeoJSON){var w=g.toGeoJSON(r);if(u)f.push(w.geometry);else{var x=zl(w);x.type==="FeatureCollection"?f.push.apply(f,x.features):f.push(x)}}}),u?zs(this,{geometries:f,type:"GeometryCollection"}):{type:"FeatureCollection",features:f}}});function Of(r,a){return new Vi(r,a)}var Kw=Of,jl=ue.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(r,a,u){this._url=r,this._bounds=ae(a),B(this,u)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Dt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){he(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(r){return this.options.opacity=r,this._image&&this._updateOpacity(),this},setStyle:function(r){return r.opacity&&this.setOpacity(r.opacity),this},bringToFront:function(){return this._map&&ki(this._image),this},bringToBack:function(){return this._map&&sr(this._image),this},setUrl:function(r){return this._url=r,this._image&&(this._image.src=r),this},setBounds:function(r){return this._bounds=ae(r),this._map&&this._reset(),this},getEvents:function(){var r={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var r=this._url.tagName==="IMG",a=this._image=r?this._url:Zt("img");if(Dt(a,"leaflet-image-layer"),this._zoomAnimated&&Dt(a,"leaflet-zoom-animated"),this.options.className&&Dt(a,this.options.className),a.onselectstart=v,a.onmousemove=v,a.onload=l(this.fire,this,"load"),a.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(a.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),r){this._url=a.src;return}a.src=this._url,a.alt=this.options.alt},_animateZoom:function(r){var a=this._map.getZoomScale(r.zoom),u=this._map._latLngBoundsToNewLayerBounds(this._bounds,r.zoom,r.center).min;ai(this._image,u,a)},_reset:function(){var r=this._image,a=new Gt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),u=a.getSize();kt(r,a.min),r.style.width=u.x+"px",r.style.height=u.y+"px"},_updateOpacity:function(){Pe(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var r=this.options.errorOverlayUrl;r&&this._url!==r&&(this._url=r,this._image.src=r)},getCenter:function(){return this._bounds.getCenter()}}),Zw=function(r,a,u){return new jl(r,a,u)},Mf=jl.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var r=this._url.tagName==="VIDEO",a=this._image=r?this._url:Zt("video");if(Dt(a,"leaflet-image-layer"),this._zoomAnimated&&Dt(a,"leaflet-zoom-animated"),this.options.className&&Dt(a,this.options.className),a.onselectstart=v,a.onmousemove=v,a.onloadeddata=l(this.fire,this,"load"),r){for(var u=a.getElementsByTagName("source"),f=[],g=0;g<u.length;g++)f.push(u[g].src);this._url=u.length>0?f:[a.src];return}Q(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(a.style,"objectFit")&&(a.style.objectFit="fill"),a.autoplay=!!this.options.autoplay,a.loop=!!this.options.loop,a.muted=!!this.options.muted,a.playsInline=!!this.options.playsInline;for(var w=0;w<this._url.length;w++){var x=Zt("source");x.src=this._url[w],a.appendChild(x)}}});function Qw(r,a,u){return new Mf(r,a,u)}var Df=jl.extend({_initImage:function(){var r=this._image=this._url;Dt(r,"leaflet-image-layer"),this._zoomAnimated&&Dt(r,"leaflet-zoom-animated"),this.options.className&&Dt(r,this.options.className),r.onselectstart=v,r.onmousemove=v}});function Yw(r,a,u){return new Df(r,a,u)}var ui=ue.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(r,a){r&&(r instanceof Ft||Q(r))?(this._latlng=At(r),B(this,a)):(B(this,r),this._source=a),this.options.content&&(this._content=this.options.content)},openOn:function(r){return r=arguments.length?r:this._source._map,r.hasLayer(this)||r.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(r){return this._map?this.close():(arguments.length?this._source=r:r=this._source,this._prepareOpen(),this.openOn(r._map)),this},onAdd:function(r){this._zoomAnimated=r._zoomAnimated,this._container||this._initLayout(),r._fadeAnimated&&Pe(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),r._fadeAnimated&&Pe(this._container,1),this.bringToFront(),this.options.interactive&&(Dt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(r){r._fadeAnimated?(Pe(this._container,0),this._removeTimeout=setTimeout(l(he,void 0,this._container),200)):he(this._container),this.options.interactive&&(ye(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(r){return this._latlng=At(r),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(r){return this._content=r,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var r={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ki(this._container),this},bringToBack:function(){return this._map&&sr(this._container),this},_prepareOpen:function(r){var a=this._source;if(!a._map)return!1;if(a instanceof Se){a=null;var u=this._source._layers;for(var f in u)if(u[f]._map){a=u[f];break}if(!a)return!1;this._source=a}if(!r)if(a.getCenter)r=a.getCenter();else if(a.getLatLng)r=a.getLatLng();else if(a.getBounds)r=a.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(r),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var r=this._contentNode,a=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof a=="string")r.innerHTML=a;else{for(;r.hasChildNodes();)r.removeChild(r.firstChild);r.appendChild(a)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var r=this._map.latLngToLayerPoint(this._latlng),a=vt(this.options.offset),u=this._getAnchor();this._zoomAnimated?kt(this._container,r.add(u)):a=a.add(r).add(u);var f=this._containerBottom=-a.y,g=this._containerLeft=-Math.round(this._containerWidth/2)+a.x;this._container.style.bottom=f+"px",this._container.style.left=g+"px"}},_getAnchor:function(){return[0,0]}});$t.include({_initOverlay:function(r,a,u,f){var g=a;return g instanceof r||(g=new r(f).setContent(a)),u&&g.setLatLng(u),g}}),ue.include({_initOverlay:function(r,a,u,f){var g=u;return g instanceof r?(B(g,f),g._source=this):(g=a&&!f?a:new r(f,this),g.setContent(u)),g}});var Hl=ui.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(r){return r=arguments.length?r:this._source._map,!r.hasLayer(this)&&r._popup&&r._popup.options.autoClose&&r.removeLayer(r._popup),r._popup=this,ui.prototype.openOn.call(this,r)},onAdd:function(r){ui.prototype.onAdd.call(this,r),r.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof hr||this._source.on("preclick",zn))},onRemove:function(r){ui.prototype.onRemove.call(this,r),r.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof hr||this._source.off("preclick",zn))},getEvents:function(){var r=ui.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(r.preclick=this.close),this.options.keepInView&&(r.moveend=this._adjustPan),r},_initLayout:function(){var r="leaflet-popup",a=this._container=Zt("div",r+" "+(this.options.className||"")+" leaflet-zoom-animated"),u=this._wrapper=Zt("div",r+"-content-wrapper",a);if(this._contentNode=Zt("div",r+"-content",u),lr(a),ar(this._contentNode),Rt(a,"contextmenu",zn),this._tipContainer=Zt("div",r+"-tip-container",a),this._tip=Zt("div",r+"-tip",this._tipContainer),this.options.closeButton){var f=this._closeButton=Zt("a",r+"-close-button",a);f.setAttribute("role","button"),f.setAttribute("aria-label","Close popup"),f.href="#close",f.innerHTML='<span aria-hidden="true">&#215;</span>',Rt(f,"click",function(g){Ee(g),this.close()},this)}},_updateLayout:function(){var r=this._contentNode,a=r.style;a.width="",a.whiteSpace="nowrap";var u=r.offsetWidth;u=Math.min(u,this.options.maxWidth),u=Math.max(u,this.options.minWidth),a.width=u+1+"px",a.whiteSpace="",a.height="";var f=r.offsetHeight,g=this.options.maxHeight,w="leaflet-popup-scrolled";g&&f>g?(a.height=g+"px",Dt(r,w)):ye(r,w),this._containerWidth=this._container.offsetWidth},_animateZoom:function(r){var a=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center),u=this._getAnchor();kt(this._container,a.add(u))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var r=this._map,a=parseInt(rr(this._container,"marginBottom"),10)||0,u=this._container.offsetHeight+a,f=this._containerWidth,g=new ot(this._containerLeft,-u-this._containerBottom);g._add(Un(this._container));var w=r.layerPointToContainerPoint(g),x=vt(this.options.autoPanPadding),F=vt(this.options.autoPanPaddingTopLeft||x),z=vt(this.options.autoPanPaddingBottomRight||x),X=r.getSize(),ht=0,Ct=0;w.x+f+z.x>X.x&&(ht=w.x+f-X.x+z.x),w.x-ht-F.x<0&&(ht=w.x-F.x),w.y+u+z.y>X.y&&(Ct=w.y+u-X.y+z.y),w.y-Ct-F.y<0&&(Ct=w.y-F.y),(ht||Ct)&&(this.options.keepInView&&(this._autopanning=!0),r.fire("autopanstart").panBy([ht,Ct]))}},_getAnchor:function(){return vt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Xw=function(r,a){return new Hl(r,a)};$t.mergeOptions({closePopupOnClick:!0}),$t.include({openPopup:function(r,a,u){return this._initOverlay(Hl,r,a,u).openOn(this),this},closePopup:function(r){return r=arguments.length?r:this._popup,r&&r.close(),this}}),ue.include({bindPopup:function(r,a){return this._popup=this._initOverlay(Hl,this._popup,r,a),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(r){return this._popup&&(this instanceof Se||(this._popup._source=this),this._popup._prepareOpen(r||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(r){return this._popup&&this._popup.setContent(r),this},getPopup:function(){return this._popup},_openPopup:function(r){if(!(!this._popup||!this._map)){Rn(r);var a=r.layer||r.target;if(this._popup._source===a&&!(a instanceof hr)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(r.latlng);return}this._popup._source=a,this.openPopup(r.latlng)}},_movePopup:function(r){this._popup.setLatLng(r.latlng)},_onKeyPress:function(r){r.originalEvent.keyCode===13&&this._openPopup(r)}});var ql=ui.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(r){ui.prototype.onAdd.call(this,r),this.setOpacity(this.options.opacity),r.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(r){ui.prototype.onRemove.call(this,r),r.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var r=ui.prototype.getEvents.call(this);return this.options.permanent||(r.preclick=this.close),r},_initLayout:function(){var r="leaflet-tooltip",a=r+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Zt("div",a),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(r){var a,u,f=this._map,g=this._container,w=f.latLngToContainerPoint(f.getCenter()),x=f.layerPointToContainerPoint(r),F=this.options.direction,z=g.offsetWidth,X=g.offsetHeight,ht=vt(this.options.offset),Ct=this._getAnchor();F==="top"?(a=z/2,u=X):F==="bottom"?(a=z/2,u=0):F==="center"?(a=z/2,u=X/2):F==="right"?(a=0,u=X/2):F==="left"?(a=z,u=X/2):x.x<w.x?(F="right",a=0,u=X/2):(F="left",a=z+(ht.x+Ct.x)*2,u=X/2),r=r.subtract(vt(a,u,!0)).add(ht).add(Ct),ye(g,"leaflet-tooltip-right"),ye(g,"leaflet-tooltip-left"),ye(g,"leaflet-tooltip-top"),ye(g,"leaflet-tooltip-bottom"),Dt(g,"leaflet-tooltip-"+F),kt(g,r)},_updatePosition:function(){var r=this._map.latLngToLayerPoint(this._latlng);this._setPosition(r)},setOpacity:function(r){this.options.opacity=r,this._container&&Pe(this._container,r)},_animateZoom:function(r){var a=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center);this._setPosition(a)},_getAnchor:function(){return vt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Jw=function(r,a){return new ql(r,a)};$t.include({openTooltip:function(r,a,u){return this._initOverlay(ql,r,a,u).openOn(this),this},closeTooltip:function(r){return r.close(),this}}),ue.include({bindTooltip:function(r,a){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(ql,this._tooltip,r,a),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(r){if(!(!r&&this._tooltipHandlersAdded)){var a=r?"off":"on",u={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?u.add=this._openTooltip:(u.mouseover=this._openTooltip,u.mouseout=this.closeTooltip,u.click=this._openTooltip,this._map?this._addFocusListeners():u.add=this._addFocusListeners),this._tooltip.options.sticky&&(u.mousemove=this._moveTooltip),this[a](u),this._tooltipHandlersAdded=!r}},openTooltip:function(r){return this._tooltip&&(this instanceof Se||(this._tooltip._source=this),this._tooltip._prepareOpen(r)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(r){return this._tooltip&&this._tooltip.setContent(r),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(r){var a=typeof r.getElement=="function"&&r.getElement();a&&(Rt(a,"focus",function(){this._tooltip._source=r,this.openTooltip()},this),Rt(a,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(r){var a=typeof r.getElement=="function"&&r.getElement();a&&a.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(r){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var a=this;this._map.once("moveend",function(){a._openOnceFlag=!1,a._openTooltip(r)});return}this._tooltip._source=r.layer||r.target,this.openTooltip(this._tooltip.options.sticky?r.latlng:void 0)}},_moveTooltip:function(r){var a=r.latlng,u,f;this._tooltip.options.sticky&&r.originalEvent&&(u=this._map.mouseEventToContainerPoint(r.originalEvent),f=this._map.containerPointToLayerPoint(u),a=this._map.layerPointToLatLng(f)),this._tooltip.setLatLng(a)}});var Nf=ci.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(r){var a=r&&r.tagName==="DIV"?r:document.createElement("div"),u=this.options;if(u.html instanceof Element?(Yr(a),a.appendChild(u.html)):a.innerHTML=u.html!==!1?u.html:"",u.bgPos){var f=vt(u.bgPos);a.style.backgroundPosition=-f.x+"px "+-f.y+"px"}return this._setIconStyles(a,"icon"),a},createShadow:function(){return null}});function tT(r){return new Nf(r)}ci.Default=na;var ia=ue.extend({options:{tileSize:256,opacity:1,updateWhenIdle:gt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(r){B(this,r)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(r){r._addZoomLimit(this)},onRemove:function(r){this._removeAllTiles(),he(this._container),r._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ki(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(sr(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(r){return this.options.opacity=r,this._updateOpacity(),this},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var r=this._clampZoom(this._map.getZoom());r!==this._tileZoom&&(this._tileZoom=r,this._updateLevels()),this._update()}return this},getEvents:function(){var r={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),r.move=this._onMove),this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},createTile:function(){return document.createElement("div")},getTileSize:function(){var r=this.options.tileSize;return r instanceof ot?r:new ot(r,r)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(r){for(var a=this.getPane().children,u=-r(-1/0,1/0),f=0,g=a.length,w;f<g;f++)w=a[f].style.zIndex,a[f]!==this._container&&w&&(u=r(u,+w));isFinite(u)&&(this.options.zIndex=u+r(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!gt.ielt9){Pe(this._container,this.options.opacity);var r=+new Date,a=!1,u=!1;for(var f in this._tiles){var g=this._tiles[f];if(!(!g.current||!g.loaded)){var w=Math.min(1,(r-g.loaded)/200);Pe(g.el,w),w<1?a=!0:(g.active?u=!0:this._onOpaqueTile(g),g.active=!0)}}u&&!this._noPrune&&this._pruneTiles(),a&&(k(this._fadeFrame),this._fadeFrame=D(this._updateOpacity,this))}},_onOpaqueTile:v,_initContainer:function(){this._container||(this._container=Zt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var r=this._tileZoom,a=this.options.maxZoom;if(r!==void 0){for(var u in this._levels)u=Number(u),this._levels[u].el.children.length||u===r?(this._levels[u].el.style.zIndex=a-Math.abs(r-u),this._onUpdateLevel(u)):(he(this._levels[u].el),this._removeTilesAtZoom(u),this._onRemoveLevel(u),delete this._levels[u]);var f=this._levels[r],g=this._map;return f||(f=this._levels[r]={},f.el=Zt("div","leaflet-tile-container leaflet-zoom-animated",this._container),f.el.style.zIndex=a,f.origin=g.project(g.unproject(g.getPixelOrigin()),r).round(),f.zoom=r,this._setZoomTransform(f,g.getCenter(),g.getZoom()),v(f.el.offsetWidth),this._onCreateLevel(f)),this._level=f,f}},_onUpdateLevel:v,_onRemoveLevel:v,_onCreateLevel:v,_pruneTiles:function(){if(this._map){var r,a,u=this._map.getZoom();if(u>this.options.maxZoom||u<this.options.minZoom){this._removeAllTiles();return}for(r in this._tiles)a=this._tiles[r],a.retain=a.current;for(r in this._tiles)if(a=this._tiles[r],a.current&&!a.active){var f=a.coords;this._retainParent(f.x,f.y,f.z,f.z-5)||this._retainChildren(f.x,f.y,f.z,f.z+2)}for(r in this._tiles)this._tiles[r].retain||this._removeTile(r)}},_removeTilesAtZoom:function(r){for(var a in this._tiles)this._tiles[a].coords.z===r&&this._removeTile(a)},_removeAllTiles:function(){for(var r in this._tiles)this._removeTile(r)},_invalidateAll:function(){for(var r in this._levels)he(this._levels[r].el),this._onRemoveLevel(Number(r)),delete this._levels[r];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(r,a,u,f){var g=Math.floor(r/2),w=Math.floor(a/2),x=u-1,F=new ot(+g,+w);F.z=+x;var z=this._tileCoordsToKey(F),X=this._tiles[z];return X&&X.active?(X.retain=!0,!0):(X&&X.loaded&&(X.retain=!0),x>f?this._retainParent(g,w,x,f):!1)},_retainChildren:function(r,a,u,f){for(var g=2*r;g<2*r+2;g++)for(var w=2*a;w<2*a+2;w++){var x=new ot(g,w);x.z=u+1;var F=this._tileCoordsToKey(x),z=this._tiles[F];if(z&&z.active){z.retain=!0;continue}else z&&z.loaded&&(z.retain=!0);u+1<f&&this._retainChildren(g,w,u+1,f)}},_resetView:function(r){var a=r&&(r.pinch||r.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),a,a)},_animateZoom:function(r){this._setView(r.center,r.zoom,!0,r.noUpdate)},_clampZoom:function(r){var a=this.options;return a.minNativeZoom!==void 0&&r<a.minNativeZoom?a.minNativeZoom:a.maxNativeZoom!==void 0&&a.maxNativeZoom<r?a.maxNativeZoom:r},_setView:function(r,a,u,f){var g=Math.round(a);this.options.maxZoom!==void 0&&g>this.options.maxZoom||this.options.minZoom!==void 0&&g<this.options.minZoom?g=void 0:g=this._clampZoom(g);var w=this.options.updateWhenZooming&&g!==this._tileZoom;(!f||w)&&(this._tileZoom=g,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),g!==void 0&&this._update(r),u||this._pruneTiles(),this._noPrune=!!u),this._setZoomTransforms(r,a)},_setZoomTransforms:function(r,a){for(var u in this._levels)this._setZoomTransform(this._levels[u],r,a)},_setZoomTransform:function(r,a,u){var f=this._map.getZoomScale(u,r.zoom),g=r.origin.multiplyBy(f).subtract(this._map._getNewPixelOrigin(a,u)).round();gt.any3d?ai(r.el,g,f):kt(r.el,g)},_resetGrid:function(){var r=this._map,a=r.options.crs,u=this._tileSize=this.getTileSize(),f=this._tileZoom,g=this._map.getPixelWorldBounds(this._tileZoom);g&&(this._globalTileRange=this._pxBoundsToTileRange(g)),this._wrapX=a.wrapLng&&!this.options.noWrap&&[Math.floor(r.project([0,a.wrapLng[0]],f).x/u.x),Math.ceil(r.project([0,a.wrapLng[1]],f).x/u.y)],this._wrapY=a.wrapLat&&!this.options.noWrap&&[Math.floor(r.project([a.wrapLat[0],0],f).y/u.x),Math.ceil(r.project([a.wrapLat[1],0],f).y/u.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(r){var a=this._map,u=a._animatingZoom?Math.max(a._animateToZoom,a.getZoom()):a.getZoom(),f=a.getZoomScale(u,this._tileZoom),g=a.project(r,this._tileZoom).floor(),w=a.getSize().divideBy(f*2);return new Gt(g.subtract(w),g.add(w))},_update:function(r){var a=this._map;if(a){var u=this._clampZoom(a.getZoom());if(r===void 0&&(r=a.getCenter()),this._tileZoom!==void 0){var f=this._getTiledPixelBounds(r),g=this._pxBoundsToTileRange(f),w=g.getCenter(),x=[],F=this.options.keepBuffer,z=new Gt(g.getBottomLeft().subtract([F,-F]),g.getTopRight().add([F,-F]));if(!(isFinite(g.min.x)&&isFinite(g.min.y)&&isFinite(g.max.x)&&isFinite(g.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var X in this._tiles){var ht=this._tiles[X].coords;(ht.z!==this._tileZoom||!z.contains(new ot(ht.x,ht.y)))&&(this._tiles[X].current=!1)}if(Math.abs(u-this._tileZoom)>1){this._setView(r,u);return}for(var Ct=g.min.y;Ct<=g.max.y;Ct++)for(var Ht=g.min.x;Ht<=g.max.x;Ht++){var dn=new ot(Ht,Ct);if(dn.z=this._tileZoom,!!this._isValidTile(dn)){var He=this._tiles[this._tileCoordsToKey(dn)];He?He.current=!0:x.push(dn)}}if(x.sort(function(vn,Hs){return vn.distanceTo(w)-Hs.distanceTo(w)}),x.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Hn=document.createDocumentFragment();for(Ht=0;Ht<x.length;Ht++)this._addTile(x[Ht],Hn);this._level.el.appendChild(Hn)}}}},_isValidTile:function(r){var a=this._map.options.crs;if(!a.infinite){var u=this._globalTileRange;if(!a.wrapLng&&(r.x<u.min.x||r.x>u.max.x)||!a.wrapLat&&(r.y<u.min.y||r.y>u.max.y))return!1}if(!this.options.bounds)return!0;var f=this._tileCoordsToBounds(r);return ae(this.options.bounds).overlaps(f)},_keyToBounds:function(r){return this._tileCoordsToBounds(this._keyToTileCoords(r))},_tileCoordsToNwSe:function(r){var a=this._map,u=this.getTileSize(),f=r.scaleBy(u),g=f.add(u),w=a.unproject(f,r.z),x=a.unproject(g,r.z);return[w,x]},_tileCoordsToBounds:function(r){var a=this._tileCoordsToNwSe(r),u=new jt(a[0],a[1]);return this.options.noWrap||(u=this._map.wrapLatLngBounds(u)),u},_tileCoordsToKey:function(r){return r.x+":"+r.y+":"+r.z},_keyToTileCoords:function(r){var a=r.split(":"),u=new ot(+a[0],+a[1]);return u.z=+a[2],u},_removeTile:function(r){var a=this._tiles[r];a&&(he(a.el),delete this._tiles[r],this.fire("tileunload",{tile:a.el,coords:this._keyToTileCoords(r)}))},_initTile:function(r){Dt(r,"leaflet-tile");var a=this.getTileSize();r.style.width=a.x+"px",r.style.height=a.y+"px",r.onselectstart=v,r.onmousemove=v,gt.ielt9&&this.options.opacity<1&&Pe(r,this.options.opacity)},_addTile:function(r,a){var u=this._getTilePos(r),f=this._tileCoordsToKey(r),g=this.createTile(this._wrapCoords(r),l(this._tileReady,this,r));this._initTile(g),this.createTile.length<2&&D(l(this._tileReady,this,r,null,g)),kt(g,u),this._tiles[f]={el:g,coords:r,current:!0},a.appendChild(g),this.fire("tileloadstart",{tile:g,coords:r})},_tileReady:function(r,a,u){a&&this.fire("tileerror",{error:a,tile:u,coords:r});var f=this._tileCoordsToKey(r);u=this._tiles[f],u&&(u.loaded=+new Date,this._map._fadeAnimated?(Pe(u.el,0),k(this._fadeFrame),this._fadeFrame=D(this._updateOpacity,this)):(u.active=!0,this._pruneTiles()),a||(Dt(u.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:u.el,coords:r})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),gt.ielt9||!this._map._fadeAnimated?D(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(r){return r.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(r){var a=new ot(this._wrapX?_(r.x,this._wrapX):r.x,this._wrapY?_(r.y,this._wrapY):r.y);return a.z=r.z,a},_pxBoundsToTileRange:function(r){var a=this.getTileSize();return new Gt(r.min.unscaleBy(a).floor(),r.max.unscaleBy(a).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var r in this._tiles)if(!this._tiles[r].loaded)return!1;return!0}});function eT(r){return new ia(r)}var js=ia.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(r,a){this._url=r,a=B(this,a),a.detectRetina&&gt.retina&&a.maxZoom>0?(a.tileSize=Math.floor(a.tileSize/2),a.zoomReverse?(a.zoomOffset--,a.minZoom=Math.min(a.maxZoom,a.minZoom+1)):(a.zoomOffset++,a.maxZoom=Math.max(a.minZoom,a.maxZoom-1)),a.minZoom=Math.max(0,a.minZoom)):a.zoomReverse?a.minZoom=Math.min(a.maxZoom,a.minZoom):a.maxZoom=Math.max(a.minZoom,a.maxZoom),typeof a.subdomains=="string"&&(a.subdomains=a.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(r,a){return this._url===r&&a===void 0&&(a=!0),this._url=r,a||this.redraw(),this},createTile:function(r,a){var u=document.createElement("img");return Rt(u,"load",l(this._tileOnLoad,this,a,u)),Rt(u,"error",l(this._tileOnError,this,a,u)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(u.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(u.referrerPolicy=this.options.referrerPolicy),u.alt="",u.src=this.getTileUrl(r),u},getTileUrl:function(r){var a={r:gt.retina?"@2x":"",s:this._getSubdomain(r),x:r.x,y:r.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var u=this._globalTileRange.max.y-r.y;this.options.tms&&(a.y=u),a["-y"]=u}return Y(this._url,s(a,this.options))},_tileOnLoad:function(r,a){gt.ielt9?setTimeout(l(r,this,null,a),0):r(null,a)},_tileOnError:function(r,a,u){var f=this.options.errorTileUrl;f&&a.getAttribute("src")!==f&&(a.src=f),r(u,a)},_onTileRemove:function(r){r.tile.onload=null},_getZoomForUrl:function(){var r=this._tileZoom,a=this.options.maxZoom,u=this.options.zoomReverse,f=this.options.zoomOffset;return u&&(r=a-r),r+f},_getSubdomain:function(r){var a=Math.abs(r.x+r.y)%this.options.subdomains.length;return this.options.subdomains[a]},_abortLoading:function(){var r,a;for(r in this._tiles)if(this._tiles[r].coords.z!==this._tileZoom&&(a=this._tiles[r].el,a.onload=v,a.onerror=v,!a.complete)){a.src=Et;var u=this._tiles[r].coords;he(a),delete this._tiles[r],this.fire("tileabort",{tile:a,coords:u})}},_removeTile:function(r){var a=this._tiles[r];if(a)return a.el.setAttribute("src",Et),ia.prototype._removeTile.call(this,r)},_tileReady:function(r,a,u){if(!(!this._map||u&&u.getAttribute("src")===Et))return ia.prototype._tileReady.call(this,r,a,u)}});function Vf(r,a){return new js(r,a)}var Uf=js.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(r,a){this._url=r;var u=s({},this.defaultWmsParams);for(var f in a)f in this.options||(u[f]=a[f]);a=B(this,a);var g=a.detectRetina&&gt.retina?2:1,w=this.getTileSize();u.width=w.x*g,u.height=w.y*g,this.wmsParams=u},onAdd:function(r){this._crs=this.options.crs||r.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var a=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[a]=this._crs.code,js.prototype.onAdd.call(this,r)},getTileUrl:function(r){var a=this._tileCoordsToNwSe(r),u=this._crs,f=zt(u.project(a[0]),u.project(a[1])),g=f.min,w=f.max,x=(this._wmsVersion>=1.3&&this._crs===Oe?[g.y,g.x,w.y,w.x]:[g.x,g.y,w.x,w.y]).join(","),F=js.prototype.getTileUrl.call(this,r);return F+H(this.wmsParams,F,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+x},setParams:function(r,a){return s(this.wmsParams,r),a||this.redraw(),this}});function nT(r,a){return new Uf(r,a)}js.WMS=Uf,Vf.wms=nT;var Ui=ue.extend({options:{padding:.1},initialize:function(r){B(this,r),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Dt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var r={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(r.zoomanim=this._onAnimZoom),r},_onAnimZoom:function(r){this._updateTransform(r.center,r.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(r,a){var u=this._map.getZoomScale(a,this._zoom),f=this._map.getSize().multiplyBy(.5+this.options.padding),g=this._map.project(this._center,a),w=f.multiplyBy(-u).add(g).subtract(this._map._getNewPixelOrigin(r,a));gt.any3d?ai(this._container,w,u):kt(this._container,w)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var r in this._layers)this._layers[r]._reset()},_onZoomEnd:function(){for(var r in this._layers)this._layers[r]._project()},_updatePaths:function(){for(var r in this._layers)this._layers[r]._update()},_update:function(){var r=this.options.padding,a=this._map.getSize(),u=this._map.containerPointToLayerPoint(a.multiplyBy(-r)).round();this._bounds=new Gt(u,u.add(a.multiplyBy(1+r*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ff=Ui.extend({options:{tolerance:0},getEvents:function(){var r=Ui.prototype.getEvents.call(this);return r.viewprereset=this._onViewPreReset,r},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ui.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var r=this._container=document.createElement("canvas");Rt(r,"mousemove",this._onMouseMove,this),Rt(r,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Rt(r,"mouseout",this._handleMouseOut,this),r._leaflet_disable_events=!0,this._ctx=r.getContext("2d")},_destroyContainer:function(){k(this._redrawRequest),delete this._ctx,he(this._container),ce(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var r;this._redrawBounds=null;for(var a in this._layers)r=this._layers[a],r._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ui.prototype._update.call(this);var r=this._bounds,a=this._container,u=r.getSize(),f=gt.retina?2:1;kt(a,r.min),a.width=f*u.x,a.height=f*u.y,a.style.width=u.x+"px",a.style.height=u.y+"px",gt.retina&&this._ctx.scale(2,2),this._ctx.translate(-r.min.x,-r.min.y),this.fire("update")}},_reset:function(){Ui.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(r){this._updateDashArray(r),this._layers[d(r)]=r;var a=r._order={layer:r,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=a),this._drawLast=a,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(r){this._requestRedraw(r)},_removePath:function(r){var a=r._order,u=a.next,f=a.prev;u?u.prev=f:this._drawLast=f,f?f.next=u:this._drawFirst=u,delete r._order,delete this._layers[d(r)],this._requestRedraw(r)},_updatePath:function(r){this._extendRedrawBounds(r),r._project(),r._update(),this._requestRedraw(r)},_updateStyle:function(r){this._updateDashArray(r),this._requestRedraw(r)},_updateDashArray:function(r){if(typeof r.options.dashArray=="string"){var a=r.options.dashArray.split(/[, ]+/),u=[],f,g;for(g=0;g<a.length;g++){if(f=Number(a[g]),isNaN(f))return;u.push(f)}r.options._dashArray=u}else r.options._dashArray=r.options.dashArray},_requestRedraw:function(r){this._map&&(this._extendRedrawBounds(r),this._redrawRequest=this._redrawRequest||D(this._redraw,this))},_extendRedrawBounds:function(r){if(r._pxBounds){var a=(r.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Gt,this._redrawBounds.extend(r._pxBounds.min.subtract([a,a])),this._redrawBounds.extend(r._pxBounds.max.add([a,a]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var r=this._redrawBounds;if(r){var a=r.getSize();this._ctx.clearRect(r.min.x,r.min.y,a.x,a.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var r,a=this._redrawBounds;if(this._ctx.save(),a){var u=a.getSize();this._ctx.beginPath(),this._ctx.rect(a.min.x,a.min.y,u.x,u.y),this._ctx.clip()}this._drawing=!0;for(var f=this._drawFirst;f;f=f.next)r=f.layer,(!a||r._pxBounds&&r._pxBounds.intersects(a))&&r._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(r,a){if(this._drawing){var u,f,g,w,x=r._parts,F=x.length,z=this._ctx;if(F){for(z.beginPath(),u=0;u<F;u++){for(f=0,g=x[u].length;f<g;f++)w=x[u][f],z[f?"lineTo":"moveTo"](w.x,w.y);a&&z.closePath()}this._fillStroke(z,r)}}},_updateCircle:function(r){if(!(!this._drawing||r._empty())){var a=r._point,u=this._ctx,f=Math.max(Math.round(r._radius),1),g=(Math.max(Math.round(r._radiusY),1)||f)/f;g!==1&&(u.save(),u.scale(1,g)),u.beginPath(),u.arc(a.x,a.y/g,f,0,Math.PI*2,!1),g!==1&&u.restore(),this._fillStroke(u,r)}},_fillStroke:function(r,a){var u=a.options;u.fill&&(r.globalAlpha=u.fillOpacity,r.fillStyle=u.fillColor||u.color,r.fill(u.fillRule||"evenodd")),u.stroke&&u.weight!==0&&(r.setLineDash&&r.setLineDash(a.options&&a.options._dashArray||[]),r.globalAlpha=u.opacity,r.lineWidth=u.weight,r.strokeStyle=u.color,r.lineCap=u.lineCap,r.lineJoin=u.lineJoin,r.stroke())},_onClick:function(r){for(var a=this._map.mouseEventToLayerPoint(r),u,f,g=this._drawFirst;g;g=g.next)u=g.layer,u.options.interactive&&u._containsPoint(a)&&(!(r.type==="click"||r.type==="preclick")||!this._map._draggableMoved(u))&&(f=u);this._fireEvent(f?[f]:!1,r)},_onMouseMove:function(r){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var a=this._map.mouseEventToLayerPoint(r);this._handleMouseHover(r,a)}},_handleMouseOut:function(r){var a=this._hoveredLayer;a&&(ye(this._container,"leaflet-interactive"),this._fireEvent([a],r,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(r,a){if(!this._mouseHoverThrottled){for(var u,f,g=this._drawFirst;g;g=g.next)u=g.layer,u.options.interactive&&u._containsPoint(a)&&(f=u);f!==this._hoveredLayer&&(this._handleMouseOut(r),f&&(Dt(this._container,"leaflet-interactive"),this._fireEvent([f],r,"mouseover"),this._hoveredLayer=f)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,r),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(r,a,u){this._map._fireDOMEvent(a,u||a.type,r)},_bringToFront:function(r){var a=r._order;if(a){var u=a.next,f=a.prev;if(u)u.prev=f;else return;f?f.next=u:u&&(this._drawFirst=u),a.prev=this._drawLast,this._drawLast.next=a,a.next=null,this._drawLast=a,this._requestRedraw(r)}},_bringToBack:function(r){var a=r._order;if(a){var u=a.next,f=a.prev;if(f)f.next=u;else return;u?u.prev=f:f&&(this._drawLast=f),a.prev=null,a.next=this._drawFirst,this._drawFirst.prev=a,this._drawFirst=a,this._requestRedraw(r)}}});function Bf(r){return gt.canvas?new Ff(r):null}var ra=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(r){return document.createElement("<lvml:"+r+' class="lvml">')}}catch{}return function(r){return document.createElement("<"+r+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),iT={_initContainer:function(){this._container=Zt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ui.prototype._update.call(this),this.fire("update"))},_initPath:function(r){var a=r._container=ra("shape");Dt(a,"leaflet-vml-shape "+(this.options.className||"")),a.coordsize="1 1",r._path=ra("path"),a.appendChild(r._path),this._updateStyle(r),this._layers[d(r)]=r},_addPath:function(r){var a=r._container;this._container.appendChild(a),r.options.interactive&&r.addInteractiveTarget(a)},_removePath:function(r){var a=r._container;he(a),r.removeInteractiveTarget(a),delete this._layers[d(r)]},_updateStyle:function(r){var a=r._stroke,u=r._fill,f=r.options,g=r._container;g.stroked=!!f.stroke,g.filled=!!f.fill,f.stroke?(a||(a=r._stroke=ra("stroke")),g.appendChild(a),a.weight=f.weight+"px",a.color=f.color,a.opacity=f.opacity,f.dashArray?a.dashStyle=Q(f.dashArray)?f.dashArray.join(" "):f.dashArray.replace(/( *, *)/g," "):a.dashStyle="",a.endcap=f.lineCap.replace("butt","flat"),a.joinstyle=f.lineJoin):a&&(g.removeChild(a),r._stroke=null),f.fill?(u||(u=r._fill=ra("fill")),g.appendChild(u),u.color=f.fillColor||f.color,u.opacity=f.fillOpacity):u&&(g.removeChild(u),r._fill=null)},_updateCircle:function(r){var a=r._point.round(),u=Math.round(r._radius),f=Math.round(r._radiusY||u);this._setPath(r,r._empty()?"M0 0":"AL "+a.x+","+a.y+" "+u+","+f+" 0,"+65535*360)},_setPath:function(r,a){r._path.v=a},_bringToFront:function(r){ki(r._container)},_bringToBack:function(r){sr(r._container)}},Wl=gt.vml?ra:W,sa=Ui.extend({_initContainer:function(){this._container=Wl("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Wl("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){he(this._container),ce(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ui.prototype._update.call(this);var r=this._bounds,a=r.getSize(),u=this._container;(!this._svgSize||!this._svgSize.equals(a))&&(this._svgSize=a,u.setAttribute("width",a.x),u.setAttribute("height",a.y)),kt(u,r.min),u.setAttribute("viewBox",[r.min.x,r.min.y,a.x,a.y].join(" ")),this.fire("update")}},_initPath:function(r){var a=r._path=Wl("path");r.options.className&&Dt(a,r.options.className),r.options.interactive&&Dt(a,"leaflet-interactive"),this._updateStyle(r),this._layers[d(r)]=r},_addPath:function(r){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(r._path),r.addInteractiveTarget(r._path)},_removePath:function(r){he(r._path),r.removeInteractiveTarget(r._path),delete this._layers[d(r)]},_updatePath:function(r){r._project(),r._update()},_updateStyle:function(r){var a=r._path,u=r.options;a&&(u.stroke?(a.setAttribute("stroke",u.color),a.setAttribute("stroke-opacity",u.opacity),a.setAttribute("stroke-width",u.weight),a.setAttribute("stroke-linecap",u.lineCap),a.setAttribute("stroke-linejoin",u.lineJoin),u.dashArray?a.setAttribute("stroke-dasharray",u.dashArray):a.removeAttribute("stroke-dasharray"),u.dashOffset?a.setAttribute("stroke-dashoffset",u.dashOffset):a.removeAttribute("stroke-dashoffset")):a.setAttribute("stroke","none"),u.fill?(a.setAttribute("fill",u.fillColor||u.color),a.setAttribute("fill-opacity",u.fillOpacity),a.setAttribute("fill-rule",u.fillRule||"evenodd")):a.setAttribute("fill","none"))},_updatePoly:function(r,a){this._setPath(r,K(r._parts,a))},_updateCircle:function(r){var a=r._point,u=Math.max(Math.round(r._radius),1),f=Math.max(Math.round(r._radiusY),1)||u,g="a"+u+","+f+" 0 1,0 ",w=r._empty()?"M0 0":"M"+(a.x-u)+","+a.y+g+u*2+",0 "+g+-u*2+",0 ";this._setPath(r,w)},_setPath:function(r,a){r._path.setAttribute("d",a)},_bringToFront:function(r){ki(r._path)},_bringToBack:function(r){sr(r._path)}});gt.vml&&sa.include(iT);function zf(r){return gt.svg||gt.vml?new sa(r):null}$t.include({getRenderer:function(r){var a=r.options.renderer||this._getPaneRenderer(r.options.pane)||this.options.renderer||this._renderer;return a||(a=this._renderer=this._createRenderer()),this.hasLayer(a)||this.addLayer(a),a},_getPaneRenderer:function(r){if(r==="overlayPane"||r===void 0)return!1;var a=this._paneRenderers[r];return a===void 0&&(a=this._createRenderer({pane:r}),this._paneRenderers[r]=a),a},_createRenderer:function(r){return this.options.preferCanvas&&Bf(r)||zf(r)}});var jf=Bs.extend({initialize:function(r,a){Bs.prototype.initialize.call(this,this._boundsToLatLngs(r),a)},setBounds:function(r){return this.setLatLngs(this._boundsToLatLngs(r))},_boundsToLatLngs:function(r){return r=ae(r),[r.getSouthWest(),r.getNorthWest(),r.getNorthEast(),r.getSouthEast()]}});function rT(r,a){return new jf(r,a)}sa.create=Wl,sa.pointsToPath=K,Vi.geometryToLayer=Ul,Vi.coordsToLatLng=Vu,Vi.coordsToLatLngs=Fl,Vi.latLngToCoords=Uu,Vi.latLngsToCoords=Bl,Vi.getFeature=zs,Vi.asFeature=zl,$t.mergeOptions({boxZoom:!0});var Hf=Cn.extend({initialize:function(r){this._map=r,this._container=r._container,this._pane=r._panes.overlayPane,this._resetStateTimeout=0,r.on("unload",this._destroy,this)},addHooks:function(){Rt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){ce(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){he(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(r){if(!r.shiftKey||r.which!==1&&r.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Xn(),jo(),this._startPoint=this._map.mouseEventToContainerPoint(r),Rt(document,{contextmenu:Rn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(r){this._moved||(this._moved=!0,this._box=Zt("div","leaflet-zoom-box",this._container),Dt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(r);var a=new Gt(this._point,this._startPoint),u=a.getSize();kt(this._box,a.min),this._box.style.width=u.x+"px",this._box.style.height=u.y+"px"},_finish:function(){this._moved&&(he(this._box),ye(this._container,"leaflet-crosshair")),Jn(),Ho(),ce(document,{contextmenu:Rn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(r){if(!(r.which!==1&&r.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var a=new jt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(a).fire("boxzoomend",{boxZoomBounds:a})}},_onKeyDown:function(r){r.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});$t.addInitHook("addHandler","boxZoom",Hf),$t.mergeOptions({doubleClickZoom:!0});var qf=Cn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(r){var a=this._map,u=a.getZoom(),f=a.options.zoomDelta,g=r.originalEvent.shiftKey?u-f:u+f;a.options.doubleClickZoom==="center"?a.setZoom(g):a.setZoomAround(r.containerPoint,g)}});$t.addInitHook("addHandler","doubleClickZoom",qf),$t.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Wf=Cn.extend({addHooks:function(){if(!this._draggable){var r=this._map;this._draggable=new ti(r._mapPane,r._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),r.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),r.on("zoomend",this._onZoomEnd,this),r.whenReady(this._onZoomEnd,this))}Dt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ye(this._map._container,"leaflet-grab"),ye(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var r=this._map;if(r._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var a=ae(this._map.options.maxBounds);this._offsetLimit=zt(this._map.latLngToContainerPoint(a.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(a.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;r.fire("movestart").fire("dragstart"),r.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(r){if(this._map.options.inertia){var a=this._lastTime=+new Date,u=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(u),this._times.push(a),this._prunePositions(a)}this._map.fire("move",r).fire("drag",r)},_prunePositions:function(r){for(;this._positions.length>1&&r-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var r=this._map.getSize().divideBy(2),a=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=a.subtract(r).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(r,a){return r-(r-a)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var r=this._draggable._newPos.subtract(this._draggable._startPos),a=this._offsetLimit;r.x<a.min.x&&(r.x=this._viscousLimit(r.x,a.min.x)),r.y<a.min.y&&(r.y=this._viscousLimit(r.y,a.min.y)),r.x>a.max.x&&(r.x=this._viscousLimit(r.x,a.max.x)),r.y>a.max.y&&(r.y=this._viscousLimit(r.y,a.max.y)),this._draggable._newPos=this._draggable._startPos.add(r)}},_onPreDragWrap:function(){var r=this._worldWidth,a=Math.round(r/2),u=this._initialWorldOffset,f=this._draggable._newPos.x,g=(f-a+u)%r+a-u,w=(f+a+u)%r-a-u,x=Math.abs(g+u)<Math.abs(w+u)?g:w;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=x},_onDragEnd:function(r){var a=this._map,u=a.options,f=!u.inertia||r.noInertia||this._times.length<2;if(a.fire("dragend",r),f)a.fire("moveend");else{this._prunePositions(+new Date);var g=this._lastPos.subtract(this._positions[0]),w=(this._lastTime-this._times[0])/1e3,x=u.easeLinearity,F=g.multiplyBy(x/w),z=F.distanceTo([0,0]),X=Math.min(u.inertiaMaxSpeed,z),ht=F.multiplyBy(X/z),Ct=X/(u.inertiaDeceleration*x),Ht=ht.multiplyBy(-Ct/2).round();!Ht.x&&!Ht.y?a.fire("moveend"):(Ht=a._limitOffset(Ht,a.options.maxBounds),D(function(){a.panBy(Ht,{duration:Ct,easeLinearity:x,noMoveStart:!0,animate:!0})}))}}});$t.addInitHook("addHandler","dragging",Wf),$t.mergeOptions({keyboard:!0,keyboardPanDelta:80});var $f=Cn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(r){this._map=r,this._setPanDelta(r.options.keyboardPanDelta),this._setZoomDelta(r.options.zoomDelta)},addHooks:function(){var r=this._map._container;r.tabIndex<=0&&(r.tabIndex="0"),Rt(r,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),ce(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var r=document.body,a=document.documentElement,u=r.scrollTop||a.scrollTop,f=r.scrollLeft||a.scrollLeft;this._map._container.focus(),window.scrollTo(f,u)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(r){var a=this._panKeys={},u=this.keyCodes,f,g;for(f=0,g=u.left.length;f<g;f++)a[u.left[f]]=[-1*r,0];for(f=0,g=u.right.length;f<g;f++)a[u.right[f]]=[r,0];for(f=0,g=u.down.length;f<g;f++)a[u.down[f]]=[0,r];for(f=0,g=u.up.length;f<g;f++)a[u.up[f]]=[0,-1*r]},_setZoomDelta:function(r){var a=this._zoomKeys={},u=this.keyCodes,f,g;for(f=0,g=u.zoomIn.length;f<g;f++)a[u.zoomIn[f]]=r;for(f=0,g=u.zoomOut.length;f<g;f++)a[u.zoomOut[f]]=-r},_addHooks:function(){Rt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){ce(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(r){if(!(r.altKey||r.ctrlKey||r.metaKey)){var a=r.keyCode,u=this._map,f;if(a in this._panKeys){if(!u._panAnim||!u._panAnim._inProgress)if(f=this._panKeys[a],r.shiftKey&&(f=vt(f).multiplyBy(3)),u.options.maxBounds&&(f=u._limitOffset(vt(f),u.options.maxBounds)),u.options.worldCopyJump){var g=u.wrapLatLng(u.unproject(u.project(u.getCenter()).add(f)));u.panTo(g)}else u.panBy(f)}else if(a in this._zoomKeys)u.setZoom(u.getZoom()+(r.shiftKey?3:1)*this._zoomKeys[a]);else if(a===27&&u._popup&&u._popup.options.closeOnEscapeKey)u.closePopup();else return;Rn(r)}}});$t.addInitHook("addHandler","keyboard",$f),$t.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Gf=Cn.extend({addHooks:function(){Rt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){ce(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(r){var a=Sl(r),u=this._map.options.wheelDebounceTime;this._delta+=a,this._lastMousePos=this._map.mouseEventToContainerPoint(r),this._startTime||(this._startTime=+new Date);var f=Math.max(u-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),f),Rn(r)},_performZoom:function(){var r=this._map,a=r.getZoom(),u=this._map.options.zoomSnap||0;r._stop();var f=this._delta/(this._map.options.wheelPxPerZoomLevel*4),g=4*Math.log(2/(1+Math.exp(-Math.abs(f))))/Math.LN2,w=u?Math.ceil(g/u)*u:g,x=r._limitZoom(a+(this._delta>0?w:-w))-a;this._delta=0,this._startTime=null,x&&(r.options.scrollWheelZoom==="center"?r.setZoom(a+x):r.setZoomAround(this._lastMousePos,a+x))}});$t.addInitHook("addHandler","scrollWheelZoom",Gf);var sT=600;$t.mergeOptions({tapHold:gt.touchNative&&gt.safari&&gt.mobile,tapTolerance:15});var Kf=Cn.extend({addHooks:function(){Rt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){ce(this._map._container,"touchstart",this._onDown,this)},_onDown:function(r){if(clearTimeout(this._holdTimeout),r.touches.length===1){var a=r.touches[0];this._startPos=this._newPos=new ot(a.clientX,a.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(Rt(document,"touchend",Ee),Rt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",a))},this),sT),Rt(document,"touchend touchcancel contextmenu",this._cancel,this),Rt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function r(){ce(document,"touchend",Ee),ce(document,"touchend touchcancel",r)},_cancel:function(){clearTimeout(this._holdTimeout),ce(document,"touchend touchcancel contextmenu",this._cancel,this),ce(document,"touchmove",this._onMove,this)},_onMove:function(r){var a=r.touches[0];this._newPos=new ot(a.clientX,a.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(r,a){var u=new MouseEvent(r,{bubbles:!0,cancelable:!0,view:window,screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY});u._simulated=!0,a.target.dispatchEvent(u)}});$t.addInitHook("addHandler","tapHold",Kf),$t.mergeOptions({touchZoom:gt.touch,bounceAtZoomLimits:!0});var Zf=Cn.extend({addHooks:function(){Dt(this._map._container,"leaflet-touch-zoom"),Rt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ye(this._map._container,"leaflet-touch-zoom"),ce(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(r){var a=this._map;if(!(!r.touches||r.touches.length!==2||a._animatingZoom||this._zooming)){var u=a.mouseEventToContainerPoint(r.touches[0]),f=a.mouseEventToContainerPoint(r.touches[1]);this._centerPoint=a.getSize()._divideBy(2),this._startLatLng=a.containerPointToLatLng(this._centerPoint),a.options.touchZoom!=="center"&&(this._pinchStartLatLng=a.containerPointToLatLng(u.add(f)._divideBy(2))),this._startDist=u.distanceTo(f),this._startZoom=a.getZoom(),this._moved=!1,this._zooming=!0,a._stop(),Rt(document,"touchmove",this._onTouchMove,this),Rt(document,"touchend touchcancel",this._onTouchEnd,this),Ee(r)}},_onTouchMove:function(r){if(!(!r.touches||r.touches.length!==2||!this._zooming)){var a=this._map,u=a.mouseEventToContainerPoint(r.touches[0]),f=a.mouseEventToContainerPoint(r.touches[1]),g=u.distanceTo(f)/this._startDist;if(this._zoom=a.getScaleZoom(g,this._startZoom),!a.options.bounceAtZoomLimits&&(this._zoom<a.getMinZoom()&&g<1||this._zoom>a.getMaxZoom()&&g>1)&&(this._zoom=a._limitZoom(this._zoom)),a.options.touchZoom==="center"){if(this._center=this._startLatLng,g===1)return}else{var w=u._add(f)._divideBy(2)._subtract(this._centerPoint);if(g===1&&w.x===0&&w.y===0)return;this._center=a.unproject(a.project(this._pinchStartLatLng,this._zoom).subtract(w),this._zoom)}this._moved||(a._moveStart(!0,!1),this._moved=!0),k(this._animRequest);var x=l(a._move,a,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=D(x,this,!0),Ee(r)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,k(this._animRequest),ce(document,"touchmove",this._onTouchMove,this),ce(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});$t.addInitHook("addHandler","touchZoom",Zf),$t.BoxZoom=Hf,$t.DoubleClickZoom=qf,$t.Drag=Wf,$t.Keyboard=$f,$t.ScrollWheelZoom=Gf,$t.TapHold=Kf,$t.TouchZoom=Zf,n.Bounds=Gt,n.Browser=gt,n.CRS=q,n.Canvas=Ff,n.Circle=Nu,n.CircleMarker=Vl,n.Class=qt,n.Control=gn,n.DivIcon=Nf,n.DivOverlay=ui,n.DomEvent=xl,n.DomUtil=Rl,n.Draggable=ti,n.Evented=Ut,n.FeatureGroup=Se,n.GeoJSON=Vi,n.GridLayer=ia,n.Handler=Cn,n.Icon=ci,n.ImageOverlay=jl,n.LatLng=Ft,n.LatLngBounds=jt,n.Layer=ue,n.LayerGroup=be,n.LineUtil=E,n.Map=$t,n.Marker=Nl,n.Mixin=Xr,n.Path=hr,n.Point=ot,n.PolyUtil=Vs,n.Polygon=Bs,n.Polyline=Ni,n.Popup=Hl,n.PosAnimation=Qo,n.Projection=rt,n.Rectangle=jf,n.Renderer=Ui,n.SVG=sa,n.SVGOverlay=Df,n.TileLayer=js,n.Tooltip=ql,n.Transformation=Kt,n.Util=A,n.VideoOverlay=Mf,n.bind=l,n.bounds=zt,n.canvas=Bf,n.circle=Ww,n.circleMarker=qw,n.control=hn,n.divIcon=tT,n.extend=s,n.featureGroup=Fs,n.geoJSON=Of,n.geoJson=Kw,n.gridLayer=eT,n.icon=jw,n.imageOverlay=Zw,n.latLng=At,n.latLngBounds=ae,n.layerGroup=ur,n.map=ks,n.marker=Hw,n.point=vt,n.polygon=Gw,n.polyline=$w,n.popup=Xw,n.rectangle=rT,n.setOptions=B,n.stamp=d,n.svg=zf,n.svgOverlay=Yw,n.tileLayer=Vf,n.tooltip=Jw,n.transformation=P,n.version=i,n.videoOverlay=Qw;var oT=window.L;n.noConflict=function(){return window.L=oT,this},window.L=n})}(ga,ga.exports)),ga.exports}var KL=GL();const pi=WL(KL),ZL=new pi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),QL=new pi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),YL=new pi.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),XL={name:"TravelPoints",props:{tripId:{type:String,required:!0},countryCoords:{type:Array,default:()=>[52.237049,21.017532]},initialZoom:{type:Number,default:6}},data(){return{map:null,markerGroup:null,userLocationMarker:null,tempMarker:null,searchQuery:"",selectedCategory:"",suggestions:[],highlightedIndex:-1,points:[],unsubscribe:null,errorMessage:"",successMessage:"",userCoords:null,isAddingFromMap:!1}},mounted(){this.initMap(),this.loadPoints(),this.setupMapClickHandler()},beforeUnmount(){this.unsubscribe&&this.unsubscribe(),this.map&&this.map.remove()},methods:{initMap(){this.map=pi.map("map").setView(this.countryCoords,this.initialZoom),pi.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(this.map),this.markerGroup=pi.layerGroup().addTo(this.map)},setupMapClickHandler(){this.map.on("click",e=>{if(!this.selectedCategory){this.errorMessage="Please select a category first";return}this.tempMarker&&this.map.removeLayer(this.tempMarker),this.tempMarker=pi.marker(e.latlng,{icon:YL,draggable:!0}).addTo(this.map).bindPopup("New point - "+this.selectedCategory).openPopup(),this.isAddingFromMap=!0,this.userCoords=[e.latlng.lat,e.latlng.lng],this.reverseGeocode([e.latlng.lat,e.latlng.lng])})},handleMapClick(e){},async centerToCurrentLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{this.userCoords=[e.coords.latitude,e.coords.longitude],this.map.setView(this.userCoords,13),this.userLocationMarker?this.userLocationMarker.setLatLng(this.userCoords):this.userLocationMarker=pi.marker(this.userCoords,{icon:ZL,title:"Your Current Location"}).addTo(this.map),this.reverseGeocode(this.userCoords)},e=>{console.error("Geolocation error:",e),this.errorMessage="Unable to retrieve your location: "+e.message},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0}):this.errorMessage="Geolocation is not supported by your browser"},async reverseGeocode(e){try{const n=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${e[0]}&lon=${e[1]}`)).json();n.display_name?this.searchQuery=n.display_name:this.searchQuery=`Point at ${e[0].toFixed(4)}, ${e[1].toFixed(4)}`}catch(t){console.error("Reverse geocoding failed:",t),this.searchQuery=`Point at ${e[0].toFixed(4)}, ${e[1].toFixed(4)}`}},async addPoint(){if(!this.selectedCategory){this.errorMessage="Please select a category first";return}try{let e,t=this.searchQuery;if(this.isAddingFromMap&&this.userCoords)e=this.userCoords,t=this.searchQuery||`Point at ${e[0].toFixed(4)}, ${e[1].toFixed(4)}`,this.tempMarker&&(this.map.removeLayer(this.tempMarker),this.tempMarker=null);else if(this.searchQuery){const s=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${this.searchQuery}`)).json();if(!s.length){this.errorMessage="Location not found.";return}e=[parseFloat(s[0].lat),parseFloat(s[0].lon)],t=s[0].display_name}else{this.errorMessage="Please provide a location or click on the map";return}const n={name:t,category:this.selectedCategory,coords:e,createdAt:new Date};await dl(En(me,"trips",this.tripId,"points"),n),this.searchQuery="",this.selectedCategory="",this.errorMessage="",this.isAddingFromMap=!1,this.successMessage="Point added successfully!",setTimeout(()=>this.successMessage="",3e3)}catch(e){console.error("Error adding point:",e),this.errorMessage="Failed to add point: "+e.message}},loadPoints(){this.unsubscribe=wo(En(me,"trips",this.tripId,"points"),e=>{if(this.markerGroup.clearLayers(),this.points=[],e.forEach(t=>{const n=t.data(),i=pi.marker(n.coords,{draggable:!1,icon:QL}).addTo(this.markerGroup).bindPopup(`<b>${n.name}</b><br>${n.category}`);this.points.push({id:t.id,...n,marker:i})}),this.points.length>0){const t=new pi.featureGroup(this.points.map(n=>n.marker));this.map.fitBounds(t.getBounds().pad(.2))}else this.map.setView(this.countryCoords,this.initialZoom)},e=>{console.error("Error loading points:",e),this.errorMessage="Failed to load points"})},async deletePoint(e){const t=this.points[e];try{await hl(bn(me,"trips",this.tripId,"points",t.id)),this.markerGroup.removeLayer(t.marker),this.points.splice(e,1),this.successMessage="Point deleted successfully!",setTimeout(()=>this.successMessage="",3e3)}catch(n){console.error("Error deleting point:",n),this.errorMessage="Failed to delete point"}},async fetchSuggestions(){if(this.searchQuery.length<3){this.suggestions=[];return}try{const e=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${this.searchQuery}&limit=5`);this.suggestions=await e.json(),this.highlightedIndex=-1}catch(e){console.error("Error fetching suggestions:",e),this.errorMessage="Failed to load suggestions"}},highlightNext(){this.highlightedIndex<this.suggestions.length-1&&this.highlightedIndex++},highlightPrev(){this.highlightedIndex>0&&this.highlightedIndex--},selectHighlighted(){this.highlightedIndex>=0&&this.selectSuggestion(this.suggestions[this.highlightedIndex])},selectSuggestion(e){if(this.searchQuery=e.display_name,this.suggestions=[],this.highlightedIndex=-1,e.lat&&e.lon){const t=[parseFloat(e.lat),parseFloat(e.lon)];this.map.setView(t,13)}}}},JL={class:"container py-4"},t1={key:0,class:"alert alert-danger"},e1={key:1,class:"alert alert-success"},n1={class:"row mb-4"},i1={class:"col-md-6"},r1={class:"mb-3 position-relative"},s1={key:0,class:"list-group position-absolute w-100 z-3"},o1=["onClick"],a1={class:"col-md-6"},l1={class:"mb-3"},c1={class:"mb-4 d-flex gap-2"},u1={class:"mb-3"},h1={class:"list-group"},d1={class:"text-muted small"},f1=["onClick"];function p1(e,t,n,i,s,o){return ut(),ft("div",JL,[t[12]||(t[12]=C("h2",{class:"mb-4"},"Your Travel Points",-1)),s.errorMessage?(ut(),ft("div",t1,Nt(s.errorMessage),1)):ne("",!0),s.successMessage?(ut(),ft("div",e1,Nt(s.successMessage),1)):ne("",!0),C("div",n1,[C("div",i1,[C("div",r1,[pe(C("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.searchQuery=l),onInput:t[1]||(t[1]=(...l)=>o.fetchSuggestions&&o.fetchSuggestions(...l)),onKeydown:[t[2]||(t[2]=Qu(io((...l)=>o.highlightNext&&o.highlightNext(...l),["prevent"]),["down"])),t[3]||(t[3]=Qu(io((...l)=>o.highlightPrev&&o.highlightPrev(...l),["prevent"]),["up"])),t[4]||(t[4]=Qu(io((...l)=>o.selectHighlighted&&o.selectHighlighted(...l),["prevent"]),["enter"]))],type:"text",class:"form-control",placeholder:"Enter location name"},null,544),[[Ae,s.searchQuery]]),s.suggestions.length?(ut(),ft("ul",s1,[(ut(!0),ft(We,null,Qi(s.suggestions,(l,h)=>(ut(),ft("li",{key:h,class:Ja(["list-group-item",{active:h===s.highlightedIndex}]),onClick:d=>o.selectSuggestion(l)},Nt(l.display_name),11,o1))),128))])):ne("",!0)])]),C("div",a1,[C("div",l1,[pe(C("select",{"onUpdate:modelValue":t[5]||(t[5]=l=>s.selectedCategory=l),class:"form-select"},t[9]||(t[9]=[YE('<option value="" disabled data-v-7d78bfaf>Select Category</option><option value="Attraction" data-v-7d78bfaf>Attraction</option><option value="Accommodation" data-v-7d78bfaf>Accommodation</option><option value="Restaurant" data-v-7d78bfaf>Restaurant</option><option value="Other" data-v-7d78bfaf>Other</option>',5)]),512),[[Ng,s.selectedCategory]])])])]),C("div",c1,[C("button",{class:"btn btn-primary",onClick:t[6]||(t[6]=(...l)=>o.addPoint&&o.addPoint(...l))},"Add Point"),C("button",{class:"btn btn-secondary",onClick:t[7]||(t[7]=(...l)=>o.centerToCurrentLocation&&o.centerToCurrentLocation(...l))},t[10]||(t[10]=[C("i",{class:"bi bi-geo-alt"},null,-1),$e(" Use My Current Location ")]))]),C("div",u1,[t[11]||(t[11]=C("h4",null,"Your Added Points:",-1)),C("ul",h1,[(ut(!0),ft(We,null,Qi(s.points,(l,h)=>(ut(),ft("li",{key:h,class:"list-group-item d-flex justify-content-between align-items-center"},[C("div",null,[C("strong",null,Nt(l.name),1),$e(" - "+Nt(l.category)+" ",1),C("div",d1,"("+Nt(l.coords[0].toFixed(4))+", "+Nt(l.coords[1].toFixed(4))+")",1)]),C("button",{class:"btn btn-danger btn-sm",onClick:d=>o.deletePoint(h)},"Delete",8,f1)]))),128))])]),C("div",{id:"map",style:{height:"500px"},onClick:t[8]||(t[8]=(...l)=>o.handleMapClick&&o.handleMapClick(...l))})])}const m1=Pn(XL,[["render",p1],["__scopeId","data-v-7d78bfaf"]]),_1={name:"BudgetPlanner",props:["trip"],data(){return{totalBudget:0,expenses:[],newExpense:{name:"",amount:0,persons:0,description:"",date:"",file:null,paid:!1},errorMessage:"",unsubscribeBudget:null,unsubscribeExpenses:null}},computed:{totalSpent(){return this.expenses.reduce((e,t)=>e+Number(t.amount),0)},remainingBudget(){return(this.totalBudget-this.totalSpent).toFixed(2)}},created(){this.loadBudget(),this.loadExpenses()},beforeUnmount(){this.unsubscribeBudget&&this.unsubscribeBudget(),this.unsubscribeExpenses&&this.unsubscribeExpenses()},methods:{async loadBudget(){this.unsubscribeBudget=wo(bn(me,"trips",this.trip.id),e=>{if(e.exists()){const t=e.data();this.totalBudget=t.budget||0}},e=>{console.error("Error loading budget:",e),this.errorMessage="Failed to load budget"})},async updateBudget(){try{await ka(bn(me,"trips",this.trip.id),{budget:this.totalBudget})}catch(e){console.error("Error updating budget:",e),this.errorMessage="Failed to update budget"}},loadExpenses(){this.unsubscribeExpenses=wo(En(me,"trips",this.trip.id,"expenses"),e=>{this.expenses=[],e.forEach(t=>{this.expenses.push({id:t.id,...t.data()})})},e=>{console.error("Error loading expenses:",e),this.errorMessage="Failed to load expenses"})},handleFileUpload(e){const t=e.target.files[0];t&&(this.newExpense.file=URL.createObjectURL(t))},async addExpense(){if(!this.newExpense.name.trim()||this.newExpense.amount<=0){this.errorMessage="Please enter the expense name and an amount greater than 0!";return}try{await dl(En(me,"trips",this.trip.id,"expenses"),{name:this.newExpense.name,amount:Number(this.newExpense.amount),persons:Number(this.newExpense.persons)||0,description:this.newExpense.description||"",date:this.newExpense.date||"",file:this.newExpense.file||null,paid:!1,createdAt:new Date}),this.newExpense={name:"",amount:0,persons:0,description:"",date:"",file:null,paid:!1},this.errorMessage=""}catch(e){console.error("Error adding expense:",e),this.errorMessage="Failed to add expense"}},async updateExpense(e){try{await ka(bn(me,"trips",this.trip.id,"expenses",e.id),{paid:e.paid})}catch(t){console.error("Error updating expense:",t),this.errorMessage="Failed to update expense"}},async deleteExpense(e){try{await hl(bn(me,"trips",this.trip.id,"expenses",e))}catch(t){console.error("Error deleting expense:",t),this.errorMessage="Failed to delete expense"}}}},g1={class:"container py-4"},v1={class:"row mb-4"},y1={class:"col-md-4"},w1={class:"card text-white bg-success mb-3"},T1={class:"card-body"},E1={class:"card-text"},b1={class:"col-md-4"},I1={class:"card text-white bg-danger mb-3"},P1={class:"card-body"},A1={class:"card-text"},R1={class:"col-md-4"},C1={class:"card text-white bg-info mb-3"},S1={class:"card-body"},x1={class:"mb-4"},k1={class:"mb-2"},L1={class:"mb-2"},O1={class:"mb-2"},M1={key:0,class:"text-muted"},D1={class:"mb-2"},N1={class:"mb-2"},V1={class:"mb-2"},U1={key:0,class:"error"},F1={key:0},B1={class:"list-group"},z1={class:"d-flex justify-content-between align-items-center flex-wrap"},j1={class:"text-muted"},H1={key:0},q1={key:1},W1={key:2},$1={key:0},G1=["href"],K1={class:"form-check"},Z1=["onUpdate:modelValue","id","onChange"],Q1=["for"],Y1=["onClick"];function X1(e,t,n,i,s,o){return ut(),ft("div",g1,[C("h3",null,"Travel Budget - "+Nt(n.trip.name),1),C("div",v1,[C("div",y1,[C("div",w1,[C("div",T1,[t[9]||(t[9]=C("h5",{class:"card-title"},"Remaining",-1)),C("p",E1,Nt(o.remainingBudget)+" PLN ",1)])])]),C("div",b1,[C("div",I1,[C("div",P1,[t[10]||(t[10]=C("h5",{class:"card-title"},"Spent",-1)),C("p",A1,Nt(o.totalSpent)+" PLN ",1)])])]),C("div",R1,[C("div",C1,[C("div",S1,[t[11]||(t[11]=C("h5",{class:"card-title"},"Total Budget",-1)),pe(C("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.totalBudget=l),type:"number",class:"form-control",onChange:t[1]||(t[1]=(...l)=>o.updateBudget&&o.updateBudget(...l))},null,544),[[Ae,s.totalBudget,void 0,{number:!0}]]),t[12]||(t[12]=$e(" PLN "))])])])]),C("div",x1,[t[14]||(t[14]=C("h4",null,"Add New Expense",-1)),C("div",k1,[pe(C("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>s.newExpense.name=l),placeholder:"Expense Name (required)",class:"form-control",required:""},null,512),[[Ae,s.newExpense.name]])]),C("div",L1,[pe(C("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>s.newExpense.amount=l),placeholder:"Expense Amount (PLN, required)",type:"number",class:"form-control",required:"",min:"0",step:"0.01"},null,512),[[Ae,s.newExpense.amount,void 0,{number:!0}]])]),C("div",O1,[pe(C("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>s.newExpense.persons=l),placeholder:"Number of persons to split (optional)",type:"number",class:"form-control",min:"0"},null,512),[[Ae,s.newExpense.persons,void 0,{number:!0}]]),s.newExpense.persons>0?(ut(),ft("small",M1," Even split: "+Nt((s.newExpense.amount/s.newExpense.persons).toFixed(2))+" PLN per person ",1)):ne("",!0)]),C("div",D1,[pe(C("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>s.newExpense.description=l),placeholder:"Expense Description (optional)",class:"form-control"},null,512),[[Ae,s.newExpense.description]])]),C("div",N1,[pe(C("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>s.newExpense.date=l),type:"date",class:"form-control",placeholder:"Expense Date (optional)"},null,512),[[Ae,s.newExpense.date]])]),C("div",V1,[C("input",{type:"file",onChange:t[7]||(t[7]=(...l)=>o.handleFileUpload&&o.handleFileUpload(...l)),class:"form-control"},null,32),t[13]||(t[13]=C("small",{class:"text-muted"},"Attach photo/file (optional)",-1))]),C("button",{class:"btn btn-primary",onClick:t[8]||(t[8]=(...l)=>o.addExpense&&o.addExpense(...l))},"Add Expense"),s.errorMessage?(ut(),ft("p",U1,Nt(s.errorMessage),1)):ne("",!0)]),s.expenses.length?(ut(),ft("div",F1,[t[15]||(t[15]=C("h4",null,"Expenses",-1)),C("ul",B1,[(ut(!0),ft(We,null,Qi(s.expenses,(l,h)=>(ut(),ft("li",{key:l.id,class:"list-group-item"},[C("div",z1,[C("div",null,[C("strong",null,Nt(l.name),1),$e(" - "+Nt(l.amount)+" PLN ",1),C("div",j1,[l.date?(ut(),ft("span",H1,"Date: "+Nt(l.date)+" | ",1)):ne("",!0),l.description?(ut(),ft("span",q1,"Description: "+Nt(l.description)+" | ",1)):ne("",!0),l.persons?(ut(),ft("span",W1," Split between: "+Nt(l.persons)+" ("+Nt((l.amount/l.persons).toFixed(2))+" PLN/person) | ",1)):ne("",!0)]),l.file?(ut(),ft("div",$1,[C("a",{href:l.file,target:"_blank"},"View Attachment",8,G1)])):ne("",!0)]),C("div",K1,[pe(C("input",{type:"checkbox","onUpdate:modelValue":d=>l.paid=d,class:"form-check-input",id:"paid-"+h,onChange:d=>o.updateExpense(l)},null,40,Z1),[[Dg,l.paid]]),C("label",{for:"paid-"+h,class:"form-check-label"},"Paid",8,Q1)]),C("button",{class:"btn btn-danger btn-sm",onClick:d=>o.deleteExpense(l.id)},"Delete",8,Y1)])]))),128))])])):ne("",!0)])}const J1=Pn(_1,[["render",X1],["__scopeId","data-v-8069346c"]]),tO={name:"PackingList",props:["trip"],data(){return{categories:[],selectedCategory:null,showAddCategory:!1,showAddItem:!1,newCategory:"",newItem:"",unsubscribe:null}},created(){this.loadPackingList()},beforeUnmount(){this.unsubscribe&&this.unsubscribe()},methods:{async loadPackingList(){try{const e=En(me,"trips",this.trip.id,"packingList");this.unsubscribe=wo(e,t=>{this.categories=[],t.forEach(n=>{const i=n.data();this.categories.push({id:n.id,name:i.name,items:i.items||[]})})})}catch(e){console.error("Error loading packing list:",e)}},async selectCategory(e){this.selectedCategory=e,this.showAddItem=!1},async addCategory(){if(this.newCategory.trim())try{const e=bn(En(me,"trips",this.trip.id,"packingList"));await FC(e,{name:this.newCategory.trim(),items:[]}),this.newCategory="",this.showAddCategory=!1}catch(e){console.error("Error adding category:",e)}},async addItem(){if(!(!this.selectedCategory||!this.newItem.trim()))try{if(!this.categories.find(s=>s.name===this.selectedCategory))return;const n=(await Yh(En(me,"trips",this.trip.id,"packingList"))).docs.find(s=>s.data().name===this.selectedCategory);if(!n)return;const i=[...n.data().items,{id:Date.now().toString(),name:this.newItem.trim(),checked:!1}];await ka(bn(me,"trips",this.trip.id,"packingList",n.id),{items:i}),this.newItem="",this.showAddItem=!1}catch(e){console.error("Error adding item:",e)}},async updateItem(e){try{const t=this.categories.find(s=>s.items.some(o=>o.id===e.id));if(!t)return;const i=(await Yh(En(me,"trips",this.trip.id,"packingList"))).docs.find(s=>s.id===t.id);if(!i)return;await ka(bn(me,"trips",this.trip.id,"packingList",i.id),{items:t.items})}catch(t){console.error("Error updating item:",t)}},async deleteItem(e){try{const t=this.categories.find(s=>s.items.some(o=>o.id===e));if(!t)return;const n=t.items.filter(s=>s.id!==e),i=bn(me,"trips",this.trip.id,"packingList",t.id);await ka(i,{items:n})}catch(t){console.error("Error deleting item:",t)}},getItemsForCategory(e){const t=this.categories.find(n=>n.name===e);return t?t.items:[]},countRemaining(e){const t=this.categories.find(n=>n.name===e);return t?t.items.filter(n=>!n.checked).length:0}}},eO={class:"container py-4"},nO={class:"row mb-4"},iO=["onClick"],rO={class:"card-body text-center"},sO={class:"card-title"},oO={class:"card-text"},aO={class:"mb-4 d-flex gap-3"},lO=["disabled"],cO={key:0,class:"mb-3"},uO={key:1,class:"mb-3"},hO={key:2},dO={class:"list-group w-75"},fO=["onUpdate:modelValue","onChange"],pO=["onClick"];function mO(e,t,n,i,s,o){return ut(),ft("div",eO,[C("h3",null,"Packing List - "+Nt(n.trip.name),1),C("div",nO,[(ut(!0),ft(We,null,Qi(s.categories,(l,h)=>(ut(),ft("div",{key:h,class:"col-md-3 mb-3"},[C("div",{class:"card h-100",onClick:d=>o.selectCategory(l.name),style:{cursor:"pointer"}},[C("div",rO,[C("h5",sO,Nt(l.name),1),C("p",oO," checked off: "+Nt(o.countRemaining(l.name))+" / "+Nt(l.items.length),1)])],8,iO)]))),128))]),C("div",aO,[C("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=l=>s.showAddCategory=!0)},"Add Category"),C("button",{class:"btn btn-success",onClick:t[1]||(t[1]=l=>s.showAddItem=!0),disabled:!s.selectedCategory},"Add Item "+Nt(s.selectedCategory),9,lO)]),s.showAddCategory?(ut(),ft("div",cO,[pe(C("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>s.newCategory=l),placeholder:"Category Name",class:"form-control w-50 d-inline"},null,512),[[Ae,s.newCategory]]),C("button",{class:"btn btn-secondary ms-2",onClick:t[3]||(t[3]=(...l)=>o.addCategory&&o.addCategory(...l))},"Add")])):ne("",!0),s.showAddItem&&s.selectedCategory?(ut(),ft("div",uO,[pe(C("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>s.newItem=l),placeholder:"Item Name",class:"form-control w-50 d-inline"},null,512),[[Ae,s.newItem]]),C("button",{class:"btn btn-secondary ms-2",onClick:t[5]||(t[5]=(...l)=>o.addItem&&o.addItem(...l))},"Add")])):ne("",!0),s.selectedCategory?(ut(),ft("div",hO,[C("h4",null,"Items in Category: "+Nt(s.selectedCategory),1),C("ul",dO,[(ut(!0),ft(We,null,Qi(o.getItemsForCategory(s.selectedCategory),(l,h)=>(ut(),ft("li",{key:l.id,class:"list-group-item d-flex justify-content-between align-items-center"},[C("div",null,[pe(C("input",{type:"checkbox","onUpdate:modelValue":d=>l.checked=d,class:"form-check-input me-2",onChange:d=>o.updateItem(l)},null,40,fO),[[Dg,l.checked]]),C("span",{class:Ja({"text-decoration-line-through":l.checked})},Nt(l.name),3)]),C("button",{class:"btn btn-sm btn-danger",onClick:d=>o.deleteItem(l.id)},"Delete",8,pO)]))),128))])])):ne("",!0)])}const _O=Pn(tO,[["render",mO],["__scopeId","data-v-52daa792"]]),gO={name:"Reservations",props:["trip"],data(){return{newReservation:{name:"",link:"",file:null},reservations:[],loading:!1,errorMessage:"",unsubscribe:null}},created(){this.loadReservations()},beforeUnmount(){this.unsubscribe&&this.unsubscribe()},methods:{async loadReservations(){this.loading=!0;try{this.unsubscribe=wo(En(me,"trips",this.trip.id,"reservations"),e=>{this.reservations=[],e.forEach(t=>{this.reservations.push({id:t.id,...t.data()})}),this.loading=!1},e=>{console.error("Error loading reservations:",e),this.errorMessage="Failed to load reservations",this.loading=!1})}catch(e){console.error("Error:",e),this.errorMessage="Failed to load reservations",this.loading=!1}},handleFileUpload(e){this.newReservation.file=e.target.files[0]},async addReservation(){if(!this.newReservation.name.trim()){this.errorMessage="Please enter a reservation name";return}this.loading=!0,this.errorMessage="";try{let e="";if(this.newReservation.file){const t=id(rd,`reservations/${this.trip.id}/${Date.now()}_${this.newReservation.file.name}`);await Fw(t,this.newReservation.file),e=await Bw(t)}await dl(En(me,"trips",this.trip.id,"reservations"),{name:this.newReservation.name.trim(),link:this.newReservation.link.trim()||null,fileUrl:e||null,createdAt:new Date}),this.newReservation={name:"",link:"",file:null}}catch(e){console.error("Error adding reservation:",e),this.errorMessage="Failed to add reservation"}finally{this.loading=!1}},async deleteReservation(e){if(confirm("Are you sure you want to delete this reservation?")){this.loading=!0;try{await hl(bn(me,"trips",this.trip.id,"reservations",e))}catch(t){console.error("Error deleting reservation:",t),this.errorMessage="Failed to delete reservation"}finally{this.loading=!1}}}}},vO={class:"container py-4"},yO={class:"mb-3"},wO=["disabled"],TO={key:0,class:"text-danger mt-2"},EO={key:0,class:"text-center my-4"},bO={key:1},IO={class:"list-group"},PO={class:"d-flex justify-content-between align-items-center"},AO={key:0},RO=["href"],CO={key:1},SO=["href"],xO=["onClick"];function kO(e,t,n,i,s,o){return ut(),ft("div",vO,[C("h3",null,"Reservations - "+Nt(n.trip.name),1),C("div",yO,[pe(C("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.newReservation.name=l),placeholder:"Reservation name (e.g. Flight to Paris)",class:"form-control mb-2",required:""},null,512),[[Ae,s.newReservation.name]]),pe(C("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>s.newReservation.link=l),placeholder:"Reservation link (optional)",class:"form-control mb-2",type:"url"},null,512),[[Ae,s.newReservation.link]]),C("input",{type:"file",onChange:t[2]||(t[2]=(...l)=>o.handleFileUpload&&o.handleFileUpload(...l)),class:"form-control mb-2"},null,32),C("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=(...l)=>o.addReservation&&o.addReservation(...l)),disabled:!s.newReservation.name.trim()}," Add Reservation ",8,wO),s.errorMessage?(ut(),ft("p",TO,Nt(s.errorMessage),1)):ne("",!0)]),s.loading?(ut(),ft("div",EO,t[4]||(t[4]=[C("div",{class:"spinner-border",role:"status"},[C("span",{class:"visually-hidden"},"Loading...")],-1)]))):ne("",!0),s.reservations.length?(ut(),ft("div",bO,[t[5]||(t[5]=C("h4",null,"Reservations List",-1)),C("ul",IO,[(ut(!0),ft(We,null,Qi(s.reservations,l=>(ut(),ft("li",{key:l.id,class:"list-group-item"},[C("div",PO,[C("div",null,[C("strong",null,Nt(l.name),1),l.link?(ut(),ft("div",AO,[C("a",{href:l.link,target:"_blank",class:"text-decoration-none"},"Open Link",8,RO)])):ne("",!0),l.fileUrl?(ut(),ft("div",CO,[C("a",{href:l.fileUrl,target:"_blank",class:"text-decoration-none"},"View Attachment",8,SO)])):ne("",!0)]),C("button",{class:"btn btn-sm btn-danger",onClick:h=>o.deleteReservation(l.id)},"Delete",8,xO)])]))),128))])])):ne("",!0)])}const LO=Pn(gO,[["render",kO],["__scopeId","data-v-69bf73fb"]]),OO={name:"TravelDiary",props:{trip:{type:Object,required:!0}},setup(e){const t=ee(""),n=ee(""),i=ee([]),s=ee(null),o=ee(null),l=ee(""),h=ee(!1),d=ee(!1),p=ee(""),_=ee(!1),v=ee(null),T=ee(null),b=ee(null),V=()=>{d.value=!0;const k=Vy(En(me,"trips",e.trip.id,"diaryEntries"),DC("createdAt","desc"));return wo(k,A=>{i.value=A.docs.map(qt=>({id:qt.id,...qt.data()})),d.value=!1},A=>{console.error("Error loading entries:",A),p.value="Failed to load diary entries",d.value=!1})},B=()=>{_.value&&Y(),T.value.click()},H=k=>{const A=k.target.files[0];if(A){if(A.size>5*1024*1024){p.value="Image size should be less than 5MB";return}s.value=A;const qt=new FileReader;qt.onload=Ye=>{o.value=Ye.target.result},qt.readAsDataURL(A)}},et=async()=>{try{_.value=!0,b.value=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1}),v.value&&(v.value.srcObject=b.value)}catch(k){console.error("Error accessing camera:",k),p.value="Could not access camera. Please check permissions.",_.value=!1}},Y=()=>{b.value&&(b.value.getTracks().forEach(k=>k.stop()),b.value=null),_.value=!1},Q=()=>{if(!v.value)return;const k=document.createElement("canvas");k.width=v.value.videoWidth,k.height=v.value.videoHeight,k.getContext("2d").drawImage(v.value,0,0,k.width,k.height),k.toBlob(qt=>{s.value=new File([qt],"camera-photo.jpg",{type:"image/jpeg"}),o.value=k.toDataURL("image/jpeg"),Y()},"image/jpeg",.9)},J=()=>{s.value=null,o.value=null},Et=async()=>{if(!s.value)return null;try{const k=`diaryEntries/${e.trip.id}/${Date.now()}_${s.value.name}`,A=id(rd,k);return await Fw(A,s.value),await Bw(A)}catch(k){throw console.error("Error uploading image:",k),k}},Pt=async()=>{if(!(!t.value.trim()||!n.value.trim())){h.value=!0,p.value="";try{let k=null;s.value&&(k=await Et()),await dl(En(me,"trips",e.trip.id,"diaryEntries"),{title:t.value.trim(),content:n.value.trim(),imageUrl:k,createdAt:new Date}),I()}catch(k){console.error("Error saving entry:",k),p.value="Failed to save diary entry"}finally{h.value=!1}}},O=async(k,A)=>{if(confirm("Are you sure you want to delete this entry?")){h.value=!0;try{if(A){const qt=id(rd,A);await hL(qt)}await hl(bn(me,"trips",e.trip.id,"diaryEntries",k))}catch(qt){console.error("Error deleting entry:",qt),p.value="Failed to delete diary entry"}finally{h.value=!1}}},I=()=>{t.value="",n.value="",s.value=null,o.value=null,p.value="",_.value&&Y()},S=k=>k?k.toDate().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";let M;nl(()=>{M=V()}),Td(()=>{M&&M(),_.value&&Y()});const D=qn(()=>i.value.filter(k=>k.title.toLowerCase().includes(l.value.toLowerCase())||k.content.toLowerCase().includes(l.value.toLowerCase())));return{diaryTitle:t,diaryContent:n,diaryEntries:i,imagePreview:o,searchQuery:l,loading:h,loadingEntries:d,errorMessage:p,cameraActive:_,cameraPreview:v,fileInput:T,saveDiaryEntry:Pt,resetForm:I,handleImageUpload:H,removeImage:J,deleteEntry:O,filteredDiaryEntries:D,formatDate:S,triggerFileInput:B,startCamera:et,stopCamera:Y,capturePhoto:Q}}},MO={class:"travel-diary"},DO={class:"mb-4"},NO={class:"mb-4"},VO={class:"mb-4"},UO={class:"d-flex gap-3"},FO=["disabled"],BO={key:0,class:"mb-4 camera-preview"},zO={ref:"cameraPreview",autoplay:"",playsinline:"",class:"img-fluid rounded"},jO={class:"d-flex justify-content-center mt-2"},HO={key:1,class:"mb-4"},qO=["src"],WO={class:"d-flex gap-3 mb-4"},$O=["disabled"],GO={key:0},KO={key:1,class:"spinner-border spinner-border-sm"},ZO={class:"my-4"},QO={key:2,class:"text-center my-4"},YO={key:3,class:"mt-5"},XO={class:"list-group"},JO={class:"d-flex justify-content-between align-items-start"},tM={class:"text-muted mb-2"},eM={class:"mb-2"},nM={key:0,class:"mb-2"},iM=["src"],rM=["onClick","disabled"],sM={key:4,class:"alert alert-info mt-4"};function oM(e,t,n,i,s,o){return ut(),ft("div",MO,[C("h3",null,"Travel Diary - "+Nt(n.trip.name),1),C("div",DO,[t[11]||(t[11]=C("label",{for:"diaryTitle",class:"form-label"},"Title",-1)),pe(C("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>i.diaryTitle=l),type:"text",id:"diaryTitle",class:"form-control",placeholder:"Enter the title",required:""},null,512),[[Ae,i.diaryTitle]])]),C("div",NO,[t[12]||(t[12]=C("label",{for:"diaryContent",class:"form-label"},"Content",-1)),pe(C("textarea",{"onUpdate:modelValue":t[1]||(t[1]=l=>i.diaryContent=l),id:"diaryContent",class:"form-control",rows:"4",placeholder:"Write your thoughts...",required:""},null,512),[[Ae,i.diaryContent]])]),C("div",VO,[t[15]||(t[15]=C("label",{class:"form-label"},"Add Photo",-1)),C("div",UO,[C("button",{class:"btn btn-outline-primary flex-grow-1",onClick:t[2]||(t[2]=(...l)=>i.triggerFileInput&&i.triggerFileInput(...l))},t[13]||(t[13]=[C("i",{class:"bi bi-upload"},null,-1),$e(" Upload Photo ")])),C("button",{class:"btn btn-outline-success flex-grow-1",onClick:t[3]||(t[3]=(...l)=>i.startCamera&&i.startCamera(...l)),disabled:i.cameraActive},t[14]||(t[14]=[C("i",{class:"bi bi-camera"},null,-1),$e(" Take Photo ")]),8,FO)]),C("input",{ref:"fileInput",type:"file",onChange:t[4]||(t[4]=(...l)=>i.handleImageUpload&&i.handleImageUpload(...l)),class:"d-none",accept:"image/*"},null,544)]),i.cameraActive?(ut(),ft("div",BO,[C("video",zO,null,512),C("div",jO,[C("button",{class:"btn btn-primary me-2",onClick:t[5]||(t[5]=(...l)=>i.capturePhoto&&i.capturePhoto(...l))},t[16]||(t[16]=[C("i",{class:"bi bi-camera-fill"},null,-1),$e(" Capture ")])),C("button",{class:"btn btn-danger",onClick:t[6]||(t[6]=(...l)=>i.stopCamera&&i.stopCamera(...l))},t[17]||(t[17]=[C("i",{class:"bi bi-x-circle"},null,-1),$e(" Cancel ")]))])])):ne("",!0),i.imagePreview?(ut(),ft("div",HO,[t[19]||(t[19]=C("h5",null,"Image Preview:",-1)),C("img",{src:i.imagePreview,alt:"Diary Image Preview",class:"img-fluid",style:{"max-height":"200px"}},null,8,qO),C("button",{class:"btn btn-sm btn-danger mt-2",onClick:t[7]||(t[7]=(...l)=>i.removeImage&&i.removeImage(...l))},t[18]||(t[18]=[C("i",{class:"bi bi-trash"},null,-1),$e(" Remove Image ")]))])):ne("",!0),C("div",WO,[C("button",{class:"btn btn-primary",onClick:t[8]||(t[8]=(...l)=>i.saveDiaryEntry&&i.saveDiaryEntry(...l)),disabled:!i.diaryTitle.trim()||!i.diaryContent.trim()||i.loading},[i.loading?(ut(),ft("span",KO)):(ut(),ft("span",GO,"Save"))],8,$O),C("button",{class:"btn btn-secondary",onClick:t[9]||(t[9]=(...l)=>i.resetForm&&i.resetForm(...l))},"Clear")]),C("div",ZO,[pe(C("input",{"onUpdate:modelValue":t[10]||(t[10]=l=>i.searchQuery=l),type:"text",class:"form-control",placeholder:"Search entries by title..."},null,512),[[Ae,i.searchQuery]])]),i.loadingEntries?(ut(),ft("div",QO,t[20]||(t[20]=[C("div",{class:"spinner-border",role:"status"},[C("span",{class:"visually-hidden"},"Loading...")],-1)]))):ne("",!0),i.filteredDiaryEntries.length?(ut(),ft("div",YO,[t[21]||(t[21]=C("h4",null,"Your Diary Entries",-1)),C("ul",XO,[(ut(!0),ft(We,null,Qi(i.filteredDiaryEntries,l=>(ut(),ft("li",{key:l.id,class:"list-group-item mb-3"},[C("div",JO,[C("div",null,[C("h5",null,Nt(l.title),1),C("p",tM,Nt(i.formatDate(l.createdAt)),1),C("p",eM,Nt(l.content),1),l.imageUrl?(ut(),ft("div",nM,[C("img",{src:l.imageUrl,alt:"Entry Image",class:"img-fluid rounded",style:{"max-height":"200px"}},null,8,iM)])):ne("",!0)]),C("button",{class:"btn btn-sm btn-danger",onClick:h=>i.deleteEntry(l.id,l.imageUrl),disabled:i.loading}," Delete ",8,rM)])]))),128))])])):ne("",!0),!i.loadingEntries&&!i.filteredDiaryEntries.length?(ut(),ft("div",sM," No diary entries found. Start by adding your first entry! ")):ne("",!0)])}const aM=Pn(OO,[["render",oM],["__scopeId","data-v-4bafcc56"]]),lM={name:"TripDetails",components:{TravelPoints:m1,Budget:J1,PackingList:_O,Reservations:LO,TravelDiary:aM},props:{id:{type:String,required:!0}},setup(e){const t=ee(null),n=ee(!1),i=ee(!1),s=ee(!1),o=ee(!1),l=ee(!1),h=async()=>{try{console.log("Loading trip with ID:",e.id);const V=bn(me,"trips",e.id),B=await UC(V);B.exists()?(t.value={id:B.id,...B.data()},console.log("Trip loaded:",t.value)):console.log("No trip found with this ID")}catch(V){console.error("Error loading trip:",V)}};return nl(h),ba(()=>e.id,V=>{V&&h()}),{trip:t,isTravelPointsVisible:n,isBudgetVisible:i,isPackingListVisible:s,isReservationsVisible:o,isTravelDiaryVisible:l,addTravelPoints:()=>{n.value=!0,i.value=!1,s.value=!1,o.value=!1,l.value=!1},planBudget:()=>{n.value=!1,i.value=!0,s.value=!1,o.value=!1,l.value=!1},addPackingList:()=>{n.value=!1,i.value=!1,s.value=!0,o.value=!1,l.value=!1},addReservations:()=>{n.value=!1,i.value=!1,s.value=!1,o.value=!0,l.value=!1},addTravelDiary:()=>{n.value=!1,i.value=!1,s.value=!1,o.value=!1,l.value=!0},closeSection:()=>{n.value=!1,i.value=!1,s.value=!1,o.value=!1,l.value=!1}}}},cM={class:"container py-5"},uM={class:"d-flex gap-3 my-4"},hM={key:0},dM={key:1},fM={key:2},pM={key:3},mM={key:4};function _M(e,t,n,i,s,o){var T;const l=kn("router-link"),h=kn("TravelPoints"),d=kn("Budget"),p=kn("PackingList"),_=kn("Reservations"),v=kn("TravelDiary");return ut(),ft("div",cM,[ge(l,{to:"/home",class:"btn btn-outline-secondary mb-3"},{default:bo(()=>t[5]||(t[5]=[$e("Back")])),_:1}),C("h2",null,Nt(i.trip?i.trip.name:"Loading...")+" - Details",1),C("p",null,[t[6]||(t[6]=C("strong",null,"Country:",-1)),$e(" "+Nt(i.trip?i.trip.country:"No data"),1)]),C("p",null,[t[7]||(t[7]=C("strong",null,"Departure Date:",-1)),$e(" "+Nt(i.trip?i.trip.departureDate:"No data"),1)]),C("p",null,[t[8]||(t[8]=C("strong",null,"Arrival Date:",-1)),$e(" "+Nt(i.trip?i.trip.arrivalDate:"No data"),1)]),C("div",uM,[C("button",{class:"btn btn-green",onClick:t[0]||(t[0]=(...b)=>i.addTravelPoints&&i.addTravelPoints(...b))},"Add Travel Points"),C("button",{class:"btn btn-green",onClick:t[1]||(t[1]=(...b)=>i.planBudget&&i.planBudget(...b))},"Budget Planning"),C("button",{class:"btn btn-green",onClick:t[2]||(t[2]=(...b)=>i.addPackingList&&i.addPackingList(...b))},"Add to Packing List"),C("button",{class:"btn btn-green",onClick:t[3]||(t[3]=(...b)=>i.addReservations&&i.addReservations(...b))},"Reservations"),C("button",{class:"btn btn-green",onClick:t[4]||(t[4]=(...b)=>i.addTravelDiary&&i.addTravelDiary(...b))},"Travel Diary")]),i.isTravelPointsVisible?(ut(),ft("div",hM,[ge(h,{tripId:(T=i.trip)==null?void 0:T.id,onClose:i.closeSection},null,8,["tripId","onClose"])])):ne("",!0),i.isBudgetVisible?(ut(),ft("div",dM,[ge(d,{trip:i.trip,onClose:i.closeSection},null,8,["trip","onClose"])])):ne("",!0),i.isPackingListVisible?(ut(),ft("div",fM,[ge(p,{trip:i.trip,onClose:i.closeSection},null,8,["trip","onClose"])])):ne("",!0),i.isReservationsVisible?(ut(),ft("div",pM,[ge(_,{trip:i.trip,onClose:i.closeSection},null,8,["trip","onClose"])])):ne("",!0),i.isTravelDiaryVisible?(ut(),ft("div",mM,[ge(v,{trip:i.trip,onClose:i.closeSection},null,8,["trip","onClose"])])):ne("",!0)])}const gM=Pn(lM,[["render",_M],["__scopeId","data-v-b57a532d"]]),vM={name:"Login",setup(){const e=ee(""),t=ee(""),n=ee(""),i=ou();return{email:e,password:t,loginWithEmail:async()=>{try{const h=await zS(To,e.value,t.value);console.log("User logged in:",h.user),i.push("/home")}catch(h){n.value="Login failed: "+h.message,console.error("Error during login",h)}},loginWithGoogle:async()=>{try{const h=new qi,d=await hx(To,h);console.log("User logged in with Google:",d.user),i.push("/home")}catch(h){n.value="Google login failed: "+h.message,console.error("Error during Google login",h)}},errorMessage:n,cancelLogin:()=>{i.push("/")}}}},yM={class:"login-page"},wM={key:0,class:"error"},TM={class:"input-group"},EM={class:"input-group"},bM={class:"action-buttons"};function IM(e,t,n,i,s,o){const l=kn("router-link");return ut(),ft("div",yM,[ge(l,{to:"/",class:"btn btn-outline-secondary mb-3"},{default:bo(()=>t[5]||(t[5]=[$e("Back")])),_:1}),t[9]||(t[9]=C("h1",null,"Welcome to Trip Master!",-1)),i.errorMessage?(ut(),ft("div",wM,Nt(i.errorMessage),1)):ne("",!0),C("form",{onSubmit:t[2]||(t[2]=io((...h)=>i.loginWithEmail&&i.loginWithEmail(...h),["prevent"]))},[C("div",TM,[t[6]||(t[6]=C("label",{for:"email"},"Email:",-1)),pe(C("input",{type:"email","onUpdate:modelValue":t[0]||(t[0]=h=>i.email=h),id:"email",required:""},null,512),[[Ae,i.email]])]),C("div",EM,[t[7]||(t[7]=C("label",{for:"password"},"Password:",-1)),pe(C("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=h=>i.password=h),id:"password",required:""},null,512),[[Ae,i.password]])]),t[8]||(t[8]=C("button",{type:"submit"},"Login",-1))],32),C("div",bM,[C("button",{class:"google-login",onClick:t[3]||(t[3]=(...h)=>i.loginWithGoogle&&i.loginWithGoogle(...h))},"Login with Google"),C("button",{class:"cancel",onClick:t[4]||(t[4]=(...h)=>i.cancelLogin&&i.cancelLogin(...h))},"Cancel")])])}const PM=Pn(vM,[["render",IM],["__scopeId","data-v-635a906c"]]),AM={setup(){const e=ee(""),t=ee(""),n=ee(""),i=ee(""),s=ou();return{email:e,password:t,confirmPassword:n,errorMessage:i,registerUser:async()=>{if(t.value!==n.value){i.value="Passwords do not match.";return}try{await BS(To,e.value,t.value),s.push("/login")}catch(h){i.value=h.message}},cancelRegistration:()=>{s.push("/")}}}},RM={class:"register"},CM={class:"input-group"},SM={class:"input-group"},xM={class:"input-group"},kM={key:0,class:"error"};function LM(e,t,n,i,s,o){const l=kn("router-link");return ut(),ft("div",RM,[ge(l,{to:"/",class:"btn btn-outline-secondary mb-3"},{default:bo(()=>t[5]||(t[5]=[$e("Back")])),_:1}),t[10]||(t[10]=C("h2",null,"Create an Account",-1)),C("form",{onSubmit:t[3]||(t[3]=io((...h)=>i.registerUser&&i.registerUser(...h),["prevent"]))},[C("div",CM,[t[6]||(t[6]=C("label",{for:"email"},"Email:",-1)),pe(C("input",{type:"email","onUpdate:modelValue":t[0]||(t[0]=h=>i.email=h),id:"email",required:""},null,512),[[Ae,i.email]])]),C("div",SM,[t[7]||(t[7]=C("label",{for:"password"},"Password:",-1)),pe(C("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=h=>i.password=h),id:"password",required:""},null,512),[[Ae,i.password]])]),C("div",xM,[t[8]||(t[8]=C("label",{for:"confirmPassword"},"Confirm Password:",-1)),pe(C("input",{type:"password","onUpdate:modelValue":t[2]||(t[2]=h=>i.confirmPassword=h),id:"confirmPassword",required:""},null,512),[[Ae,i.confirmPassword]])]),t[9]||(t[9]=C("button",{type:"submit"},"Register",-1))],32),i.errorMessage?(ut(),ft("p",kM,Nt(i.errorMessage),1)):ne("",!0),C("button",{class:"cancel",onClick:t[4]||(t[4]=(...h)=>i.cancelRegistration&&i.cancelRegistration(...h))},"Cancel")])}const OM=Pn(AM,[["render",LM],["__scopeId","data-v-3f081e27"]]),MM={},DM={class:"info-page"};function NM(e,t){const n=kn("router-link");return ut(),ft("div",DM,[ge(n,{to:"/",class:"btn btn-outline-secondary mb-3"},{default:bo(()=>t[0]||(t[0]=[$e("Back")])),_:1}),t[1]||(t[1]=C("div",{class:"about-app"},[C("h2",null,"About App"),C("p",null," Planning a trip can be overwhelming, but with TripMaster, organizing your adventures has never been easier. TripMaster is a comprehensive travel planning app designed to simplify every step of your journey—from choosing a destination to packing your bags. Whether you’re a spontaneous explorer or a meticulous planner, this app ensures that you can focus on the excitement of travel rather than the hassle of logistics. ")],-1)),t[2]||(t[2]=C("div",{class:"authors"},[C("h2",null,"Authors"),C("ul",null,[C("li",null,"Amanda Miśkiewicz"),C("li",null,"Julia Mieszaniec"),C("li",null,"Jan Paluch")])],-1))])}const VM=Pn(MM,[["render",NM],["__scopeId","data-v-fa494dfa"]]),UM=[{path:"/",name:"Home",component:QI,meta:{transition:"fade"}},{path:"/info",name:"Info",component:VM},{path:"/login",name:"Login",component:PM},{path:"/register",name:"Register",component:OM},{path:"/home",name:"HomeView",component:C_,meta:{requiresAuth:!0}},{path:"/trips",name:"Trips",component:C_,meta:{requiresAuth:!0}},{path:"/trip/:id",name:"TripDetails",component:gM,props:!0,meta:{requiresAuth:!0}},{path:"/:pathMatch(.*)*",redirect:"/"}],zw=jI({history:gI("/TripMaster/"),routes:UM,scrollBehavior(e,t,n){return n||{top:0}}});zw.beforeEach((e,t,n)=>{const i=Ew(),s=e.matched.some(l=>l.meta.requiresAuth),o=i.currentUser;s&&!o?n("/login"):n()});const FM="modulepreload",BM=function(e){return"/TripMaster/"+e},x_={},zM=function(t,n,i){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),h=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.allSettled(n.map(d=>{if(d=BM(d),d in x_)return;x_[d]=!0;const p=d.endsWith(".css"),_=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${_}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":FM,p||(v.as="script"),v.crossOrigin="",v.href=d,h&&v.setAttribute("nonce",h),document.head.appendChild(v),p)return new Promise((T,b)=>{v.addEventListener("load",T),v.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(l){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=l,window.dispatchEvent(h),!h.defaultPrevented)throw l}return s.then(l=>{for(const h of l||[])h.status==="rejected"&&o(h.reason);return t().catch(o)})};function jM(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:i,onRegistered:s,onRegisteredSW:o,onRegisterError:l}=e;let h,d;const p=async(v=!0)=>{await d};async function _(){if("serviceWorker"in navigator){if(h=await zM(async()=>{const{Workbox:v}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:v}},[]).then(({Workbox:v})=>new v("/TripMaster/sw.js",{scope:"/TripMaster/",type:"classic"})).catch(v=>{l==null||l(v)}),!h)return;h.addEventListener("activated",v=>{(v.isUpdate||v.isExternal)&&window.location.reload()}),h.addEventListener("installed",v=>{v.isUpdate||i==null||i()}),h.register({immediate:t}).then(v=>{o?o("/TripMaster/sw.js",v):s==null||s(v)}).catch(v=>{l==null||l(v)})}}return d=_(),p}Mb(Fb).use(zw).mount("#app");jM({onNeedRefresh(){console.log("Nowa wersja dostępna. Odśwież stronę!")},onOfflineReady(){console.log("Aplikacja jest teraz dostępna offline!")}});
